import{m as ss,z as si,r as re,l as z,A as Kn,o as Hn,ao as ho,B as Ie,ap as Gt,j as we,a9 as wn,a8 as mo,aq as as,V as J,a2 as rs,f as Xt,ar as ls,x as Zt,w as Ft,X as go,ab as po,as as vo,y as yi,C as yo,h as ze,at as te,E as xe,G as _,L as B,Q as R,O as x,H as F,M,au as se,av as oe,W as G,J as g,t as r,I as u,K as at,F as Ze,aw as At,S as I,ax as cs,U as Cn,a as _o,a1 as us,ay as Et,az as sn,aA as wo,aB as ln,aC as ds,aD as Oi,aE as fs,aF as Vt,aG as Gn,aH as Xn,ac as hs,n as ko,aI as ms,al as gs,aJ as ps,aK as ai,aL as vs,_ as bo,p as ys}from"./index.51f2b46b.js";import{Q as Wt}from"./QBadge.afd40254.js";import{Q as be,a as Vi}from"./QSpinnerDots.e67e540c.js";import{Q as zi,a as Se,b as an,m as Do,c as Co,f as _s,C as $n,d as _i,P as ws,u as wi,e as Bn,g as $o,B as Wi,F as ks,h as ji,i as bs}from"./npcv2.b2907565.js";import{Q as Qe,a as Ye}from"./QDialog.4aac6bf6.js";import{b as Ue,Q as Ce,a as bt}from"./QItem.b906d612.js";import{u as Ds,a as ri,b as Cs,c as $s,d as Ps,e as Ms}from"./private.use-form.8e692222.js";import{Q as qs}from"./QResizeObserver.c1e008d5.js";import{d as Qi,a as ki,c as bi}from"./use-timeout.040996d9.js";import{r as Ts,Q as Ss,a as rn}from"./QSelect.b95fad3e.js";import{u as Is,a as As,b as Es,c as Rs,Q as Us,d as Ns,i as xs,A as Bs}from"./AndroidPWAPrompt.5696b6f0.js";import{Q as Po,a as Ls,b as Fs,u as Os}from"./welcome.41a750b0.js";import{Q as Pt,C as Ke}from"./QSpinnerHourglass.d9a54d40.js";import{a as Je,b as ye,d as lt,u as Ae,e as cn,f as Ne,g as Vn,M as _n,h as Ct,i as un,c as Ht,n as Mo,t as De,j as Vs,k as pt,l as fn,m as Le,s as zs,U as In,o as $t,P as Ki,S as Ws,Z as Hi,p as Te,q as js,v as st,w as kn,x as Di,y as Qs,z as li,A as Gi,B as Ks,D as Hs,E as Gs,F as Xs}from"./ui.f9c7454a.js";import{g as jt,Q as ct}from"./QInput.50fcf8ad.js";import{Q as Ci,a as $i}from"./QLinearProgress.49653a07.js";import{Q as dn}from"./QList.cb9031bc.js";import{c as Rt,M as Zs,I as Ys,X as Zn}from"./x.bed348ae.js";import{Q as Js}from"./QCheckbox.681ba086.js";import{T as ea}from"./TouchPan.1480097d.js";import{i as Pi}from"./vue-qrcode.esm.527d4b00.js";import{u as qo}from"./branding.c750d619.js";import"./position-engine.d1b63720.js";import"./selection.bfd41920.js";import"./scroll.d64191c5.js";import"./i18n.79f7761c.js";import"./use-prevent-scroll.397e4d9c.js";import"./focusout.5ce79b63.js";import"./use-key-composition.9fe2965e.js";import"./touch.9135741d.js";let ta=0;const na=["click","keydown"],ia={icon:String,label:[Number,String],alert:[Boolean,String],alertIcon:String,name:{type:[Number,String],default:()=>`t_${ta++}`},noCaps:Boolean,tabindex:[String,Number],disable:Boolean,contentClass:String,ripple:{type:[Boolean,Object],default:!0}};function oa(e,t,n,i){const o=ss(ho,si);if(o===si)return console.error("QTab/QRouteTab component needs to be child of QTabs"),si;const{proxy:s}=Xt(),a=re(null),c=re(null),l=re(null),m=z(()=>e.disable===!0||e.ripple===!1?!1:Object.assign({keyCodes:[13,32],early:!0},e.ripple===!0?{}:e.ripple)),h=z(()=>o.currentModel.value===e.name),w=z(()=>"q-tab relative-position self-stretch flex flex-center text-center"+(h.value===!0?" q-tab--active"+(o.tabProps.value.activeClass?" "+o.tabProps.value.activeClass:"")+(o.tabProps.value.activeColor?` text-${o.tabProps.value.activeColor}`:"")+(o.tabProps.value.activeBgColor?` bg-${o.tabProps.value.activeBgColor}`:""):" q-tab--inactive")+(e.icon&&e.label&&o.tabProps.value.inlineLabel===!1?" q-tab--full":"")+(e.noCaps===!0||o.tabProps.value.noCaps===!0?" q-tab--no-caps":"")+(e.disable===!0?" disabled":" q-focusable q-hoverable cursor-pointer")+(i!==void 0?i.linkClass.value:"")),y=z(()=>"q-tab__content self-stretch flex-center relative-position q-anchor--skip non-selectable "+(o.tabProps.value.inlineLabel===!0?"row no-wrap q-tab__content--inline":"column")+(e.contentClass!==void 0?` ${e.contentClass}`:"")),P=z(()=>e.disable===!0||o.hasFocus.value===!0||h.value===!1&&o.hasActiveTab.value===!0?-1:e.tabindex||0);function A(O,X){if(X!==!0&&O?.qAvoidFocus!==!0&&a.value?.focus(),e.disable===!0){i?.hasRouterLink.value===!0&&wn(O);return}if(i===void 0){o.updateModel({name:e.name}),n("click",O);return}if(i.hasRouterLink.value===!0){const ae=(ce={})=>{let he;const d=ce.to===void 0||ls(ce.to,e.to)===!0?o.avoidRouteWatcher=Ds():null;return i.navigateToRouterLink(O,{...ce,returnRouterError:!0}).catch(p=>{he=p}).then(p=>{if(d===o.avoidRouteWatcher&&(o.avoidRouteWatcher=!1,he===void 0&&(p===void 0||p.message?.startsWith("Avoided redundant navigation")===!0)&&o.updateModel({name:e.name})),ce.returnRouterError===!0)return he!==void 0?Promise.reject(he):p})};n("click",O,ae),O.defaultPrevented!==!0&&ae();return}n("click",O)}function U(O){mo(O,[13,32])?A(O,!0):as(O)!==!0&&O.keyCode>=35&&O.keyCode<=40&&O.altKey!==!0&&O.metaKey!==!0&&o.onKbdNavigate(O.keyCode,s.$el)===!0&&wn(O),n("keydown",O)}function j(){const O=o.tabProps.value.narrowIndicator,X=[],ae=we("div",{ref:l,class:["q-tab__indicator",o.tabProps.value.indicatorClass]});e.icon!==void 0&&X.push(we(J,{class:"q-tab__icon",name:e.icon})),e.label!==void 0&&X.push(we("div",{class:"q-tab__label"},e.label)),e.alert!==!1&&X.push(e.alertIcon!==void 0?we(J,{class:"q-tab__alert-icon",color:e.alert!==!0?e.alert:void 0,name:e.alertIcon}):we("div",{class:"q-tab__alert"+(e.alert!==!0?` text-${e.alert}`:"")})),O===!0&&X.push(ae);const ce=[we("div",{class:"q-focus-helper",tabindex:-1,ref:a}),we("div",{class:y.value},rs(t.default,X))];return O===!1&&ce.push(ae),ce}const K={name:z(()=>e.name),rootRef:c,tabIndicatorRef:l,routeData:i};Kn(()=>{o.unregisterTab(K)}),Hn(()=>{o.registerTab(K)});function E(O,X){const ae={ref:c,class:w.value,tabindex:P.value,role:"tab","aria-selected":h.value===!0?"true":"false","aria-disabled":e.disable===!0?"true":void 0,onClick:A,onKeydown:U,...X};return Ie(we(O,ae,j()),[[Gt,m.value]])}return{renderTab:E,$tabs:o}}var Xi=Zt({name:"QTab",props:ia,emits:na,setup(e,{slots:t,emit:n}){const{renderTab:i}=oa(e,t,n);return()=>i("div")}});function sa(e,t,n){const i=n===!0?["left","right"]:["top","bottom"];return`absolute-${t===!0?i[0]:i[1]}${e?` text-${e}`:""}`}const aa=["left","center","right","justify"];var ra=Zt({name:"QTabs",props:{modelValue:[Number,String],align:{type:String,default:"center",validator:e=>aa.includes(e)},breakpoint:{type:[String,Number],default:600},vertical:Boolean,shrink:Boolean,stretch:Boolean,activeClass:String,activeColor:String,activeBgColor:String,indicatorColor:String,leftIcon:String,rightIcon:String,outsideArrows:Boolean,mobileArrows:Boolean,switchIndicator:Boolean,narrowIndicator:Boolean,inlineLabel:Boolean,noCaps:Boolean,dense:Boolean,contentClass:String,"onUpdate:modelValue":[Function,Array]},setup(e,{slots:t,emit:n}){const{proxy:i}=Xt(),{$q:o}=i,{registerTick:s}=ri(),{registerTick:a}=ri(),{registerTick:c}=ri(),{registerTimeout:l,removeTimeout:m}=Qi(),{registerTimeout:h,removeTimeout:w}=Qi(),y=re(null),P=re(null),A=re(e.modelValue),U=re(!1),j=re(!0),K=re(!1),E=re(!1),O=[],X=re(0),ae=re(!1);let ce=null,he=null,d;const p=z(()=>({activeClass:e.activeClass,activeColor:e.activeColor,activeBgColor:e.activeBgColor,indicatorClass:sa(e.indicatorColor,e.switchIndicator,e.vertical),narrowIndicator:e.narrowIndicator,inlineLabel:e.inlineLabel,noCaps:e.noCaps})),v=z(()=>{const Q=X.value,ne=A.value;for(let pe=0;pe<Q;pe++)if(O[pe].name.value===ne)return!0;return!1}),T=z(()=>`q-tabs__content--align-${U.value===!0?"left":E.value===!0?"justify":e.align}`),D=z(()=>`q-tabs row no-wrap items-center q-tabs--${U.value===!0?"":"not-"}scrollable q-tabs--${e.vertical===!0?"vertical":"horizontal"} q-tabs__arrows--${e.outsideArrows===!0?"outside":"inside"} q-tabs--mobile-with${e.mobileArrows===!0?"":"out"}-arrows`+(e.dense===!0?" q-tabs--dense":"")+(e.shrink===!0?" col-shrink":"")+(e.stretch===!0?" self-stretch":"")),k=z(()=>"q-tabs__content scroll--mobile row no-wrap items-center self-stretch hide-scrollbar relative-position "+T.value+(e.contentClass!==void 0?` ${e.contentClass}`:"")),$=z(()=>e.vertical===!0?{container:"height",content:"offsetHeight",scroll:"scrollHeight"}:{container:"width",content:"offsetWidth",scroll:"scrollWidth"}),b=z(()=>e.vertical!==!0&&o.lang.rtl===!0),C=z(()=>Ts===!1&&b.value===!0);Ft(b,ue),Ft(()=>e.modelValue,Q=>{S({name:Q,setCurrent:!0,skipEmit:!0})}),Ft(()=>e.outsideArrows,q);function S({name:Q,setCurrent:ne,skipEmit:pe}){A.value!==Q&&(pe!==!0&&e["onUpdate:modelValue"]!==void 0&&n("update:modelValue",Q),(ne===!0||e["onUpdate:modelValue"]===void 0)&&(ee(A.value,Q),A.value=Q))}function q(){s(()=>{y.value&&N({width:y.value.offsetWidth,height:y.value.offsetHeight})})}function N(Q){if($.value===void 0||P.value===null)return;const ne=Q[$.value.container],pe=Math.min(P.value[$.value.scroll],Array.prototype.reduce.call(P.value.children,(Fe,Me)=>Fe+(Me[$.value.content]||0),0)),Be=ne>0&&pe>ne;U.value=Be,Be===!0&&a(ue),E.value=ne<parseInt(e.breakpoint,10)}function ee(Q,ne){const pe=Q!=null&&Q!==""?O.find(Fe=>Fe.name.value===Q):null,Be=ne!=null&&ne!==""?O.find(Fe=>Fe.name.value===ne):null;if(Nt===!0)Nt=!1;else if(pe&&Be){const Fe=pe.tabIndicatorRef.value,Me=Be.tabIndicatorRef.value;ce!==null&&(clearTimeout(ce),ce=null),Fe.style.transition="none",Fe.style.transform="none",Me.style.transition="none",Me.style.transform="none";const $e=Fe.getBoundingClientRect(),nt=Me.getBoundingClientRect();Me.style.transform=e.vertical===!0?`translate3d(0,${$e.top-nt.top}px,0) scale3d(1,${nt.height?$e.height/nt.height:1},1)`:`translate3d(${$e.left-nt.left}px,0,0) scale3d(${nt.width?$e.width/nt.width:1},1,1)`,c(()=>{ce=setTimeout(()=>{ce=null,Me.style.transition="transform .25s cubic-bezier(.4, 0, .2, 1)",Me.style.transform="none"},70)})}Be&&U.value===!0&&Z(Be.rootRef.value)}function Z(Q){const{left:ne,width:pe,top:Be,height:Fe}=P.value.getBoundingClientRect(),Me=Q.getBoundingClientRect();let $e=e.vertical===!0?Me.top-Be:Me.left-ne;if($e<0){P.value[e.vertical===!0?"scrollTop":"scrollLeft"]+=Math.floor($e),ue();return}$e+=e.vertical===!0?Me.height-Fe:Me.width-pe,$e>0&&(P.value[e.vertical===!0?"scrollTop":"scrollLeft"]+=Math.ceil($e),ue())}function ue(){const Q=P.value;if(Q===null)return;const ne=Q.getBoundingClientRect(),pe=e.vertical===!0?Q.scrollTop:Math.abs(Q.scrollLeft);b.value===!0?(j.value=Math.ceil(pe+ne.width)<Q.scrollWidth-1,K.value=pe>0):(j.value=pe>0,K.value=e.vertical===!0?Math.ceil(pe+ne.height)<Q.scrollHeight:Math.ceil(pe+ne.width)<Q.scrollWidth)}function qe(Q){he!==null&&clearInterval(he),he=setInterval(()=>{qt(Q)===!0&&fe()},5)}function Ee(){qe(C.value===!0?Number.MAX_SAFE_INTEGER:0)}function me(){qe(C.value===!0?0:Number.MAX_SAFE_INTEGER)}function fe(){he!==null&&(clearInterval(he),he=null)}function We(Q,ne){const pe=Array.prototype.filter.call(P.value.children,nt=>nt===ne||nt.matches&&nt.matches(".q-tab.q-focusable")===!0),Be=pe.length;if(Be===0)return;if(Q===36)return Z(pe[0]),pe[0].focus(),!0;if(Q===35)return Z(pe[Be-1]),pe[Be-1].focus(),!0;const Fe=Q===(e.vertical===!0?38:37),Me=Q===(e.vertical===!0?40:39),$e=Fe===!0?-1:Me===!0?1:void 0;if($e!==void 0){const nt=b.value===!0?-1:1,_t=pe.indexOf(ne)+$e*nt;return _t>=0&&_t<Be&&(Z(pe[_t]),pe[_t].focus({preventScroll:!0})),!0}}const Mt=z(()=>C.value===!0?{get:Q=>Math.abs(Q.scrollLeft),set:(Q,ne)=>{Q.scrollLeft=-ne}}:e.vertical===!0?{get:Q=>Q.scrollTop,set:(Q,ne)=>{Q.scrollTop=ne}}:{get:Q=>Q.scrollLeft,set:(Q,ne)=>{Q.scrollLeft=ne}});function qt(Q){const ne=P.value,{get:pe,set:Be}=Mt.value;let Fe=!1,Me=pe(ne);const $e=Q<Me?-1:1;return Me+=$e*5,Me<0?(Fe=!0,Me=0):($e===-1&&Me<=Q||$e===1&&Me>=Q)&&(Fe=!0,Me=Q),Be(ne,Me),ue(),Fe}function ut(Q,ne){for(const pe in Q)if(Q[pe]!==ne[pe])return!1;return!0}function Ge(){let Q=null,ne={matchedLen:0,queryDiff:9999,hrefLen:0};const pe=O.filter($e=>$e.routeData?.hasRouterLink.value===!0),{hash:Be,query:Fe}=i.$route,Me=Object.keys(Fe).length;for(const $e of pe){const nt=$e.routeData.exact.value===!0;if($e.routeData[nt===!0?"linkIsExactActive":"linkIsActive"].value!==!0)continue;const{hash:_t,query:vn,matched:ni,href:W}=$e.routeData.resolvedLink.value,le=Object.keys(vn).length;if(nt===!0){if(_t!==Be||le!==Me||ut(Fe,vn)===!1)continue;Q=$e.name.value;break}if(_t!==""&&_t!==Be||le!==0&&ut(vn,Fe)===!1)continue;const ke={matchedLen:ni.length,queryDiff:Me-le,hrefLen:W.length-_t.length};if(ke.matchedLen>ne.matchedLen){Q=$e.name.value,ne=ke;continue}else if(ke.matchedLen!==ne.matchedLen)continue;if(ke.queryDiff<ne.queryDiff)Q=$e.name.value,ne=ke;else if(ke.queryDiff!==ne.queryDiff)continue;ke.hrefLen>ne.hrefLen&&(Q=$e.name.value,ne=ke)}if(Q===null&&O.some($e=>$e.routeData===void 0&&$e.name.value===A.value)===!0){Nt=!1;return}S({name:Q,setCurrent:!0})}function yt(Q){if(m(),ae.value!==!0&&y.value!==null&&Q.target&&typeof Q.target.closest=="function"){const ne=Q.target.closest(".q-tab");ne&&y.value.contains(ne)===!0&&(ae.value=!0,U.value===!0&&Z(ne))}}function He(){l(()=>{ae.value=!1},30)}function V(){Re.avoidRouteWatcher===!1?h(Ge):w()}function Y(){if(d===void 0){const Q=Ft(()=>i.$route.fullPath,V);d=()=>{Q(),d=void 0}}}function ge(Q){O.push(Q),X.value++,q(),Q.routeData===void 0||i.$route===void 0?h(()=>{if(U.value===!0){const ne=A.value,pe=ne!=null&&ne!==""?O.find(Be=>Be.name.value===ne):null;pe&&Z(pe.rootRef.value)}}):(Y(),Q.routeData.hasRouterLink.value===!0&&V())}function je(Q){O.splice(O.indexOf(Q),1),X.value--,q(),d!==void 0&&Q.routeData!==void 0&&(O.every(ne=>ne.routeData===void 0)===!0&&d(),V())}const Re={currentModel:A,tabProps:p,hasFocus:ae,hasActiveTab:v,registerTab:ge,unregisterTab:je,verifyRouteModel:V,updateModel:S,onKbdNavigate:We,avoidRouteWatcher:!1};go(ho,Re);function tt(){ce!==null&&clearTimeout(ce),fe(),d?.()}let dt,Nt;return Kn(tt),po(()=>{dt=d!==void 0,tt()}),vo(()=>{dt===!0&&(Y(),Nt=!0,V()),q()}),()=>we("div",{ref:y,class:D.value,role:"tablist",onFocusin:yt,onFocusout:He},[we(qs,{onResize:N}),we("div",{ref:P,class:k.value,onScroll:ue},yi(t.default)),we(J,{class:"q-tabs__arrow q-tabs__arrow--left absolute q-tab__icon"+(j.value===!0?"":" q-tabs__arrow--faded"),name:e.leftIcon||o.iconSet.tabs[e.vertical===!0?"up":"left"],onMousedownPassive:Ee,onTouchstartPassive:Ee,onMouseupPassive:fe,onMouseleavePassive:fe,onTouchendPassive:fe}),we(J,{class:"q-tabs__arrow q-tabs__arrow--right absolute q-tab__icon"+(K.value===!0?"":" q-tabs__arrow--faded"),name:e.rightIcon||o.iconSet.tabs[e.vertical===!0?"down":"right"],onMousedownPassive:me,onTouchstartPassive:me,onMouseupPassive:fe,onMouseleavePassive:fe,onTouchendPassive:fe})])}}),Zi=Zt({name:"QTabPanel",props:Is,setup(e,{slots:t}){return()=>we("div",{class:"q-tab-panel",role:"tabpanel"},yi(t.default))}}),la=Zt({name:"QTabPanels",props:{...As,...ki},emits:Es,setup(e,{slots:t}){const n=Xt(),i=bi(e,n.proxy.$q),{updatePanelsList:o,getPanelContent:s,panelDirectives:a}=Rs(),c=z(()=>"q-tab-panels q-panel-parent"+(i.value===!0?" q-tab-panels--dark q-dark":""));return()=>(o(t),yo("div",{class:c.value},s(),"pan",e.swipeable,()=>a.value))}});function To(e,t=20,n=5){if(e.length>t+n)return e.substring(0,t)+"..."+e.substring(e.length-n,e.length)}const ca=ze({name:"ToggleUnit",mixins:[windowMixin],props:{balanceView:{type:Boolean,required:!1},color:{type:String,default:"primary"}},data:function(){return{chosenMint:null}},mounted(){this.handleUnitAvailabilityChange()},watch:{showBitcoin:function(e){this.handleUnitAvailabilityChange()},showPoints:function(e){this.handleUnitAvailabilityChange()}},computed:{...te(Je,["walletDisplayUnit","showBitcoin","showPoints"]),activeUnitLabelAdopted:function(){return this.walletDisplayUnit==="sat"?"Sats":"Points"},shouldShowToggle:function(){return this.showBitcoin&&this.showPoints}},methods:{toggleUnit:function(){const e=Je();e.walletDisplayUnit=this.walletDisplayUnit==="sat"?"points":"sat"},handleUnitAvailabilityChange:function(){const e=Je(),t=this.walletDisplayUnit;t==="sat"&&!this.showBitcoin&&this.showPoints?e.walletDisplayUnit="points":t==="points"&&!this.showPoints&&this.showBitcoin&&(e.walletDisplayUnit="sat"),!(this.showBitcoin&&this.showPoints)&&(this.showBitcoin&&!this.showPoints&&t!=="sat"?e.walletDisplayUnit="sat":this.showPoints&&!this.showBitcoin&&t!=="points"&&(e.walletDisplayUnit="points"))}}});function ua(e,t,n,i,o,s){return e.shouldShowToggle?(_(),B(R,{key:0,rounded:"",outline:"",color:e.color,onClick:t[0]||(t[0]=a=>e.toggleUnit()),label:e.activeUnitLabelAdopted},null,8,["color","label"])):x("",!0)}var Mi=xe(ca,[["render",ua]]);const da=ze({name:"AnimatedNumber",props:{value:{type:Number,required:!0},duration:{type:Number,default:1e3},format:{type:Function,required:!0}},setup(e){const t=re(e.value),n=re(!1);return Ft(()=>e.value,(o,s)=>{if(!n.value){t.value=o,o>0&&(n.value=!0);return}const a=performance.now(),c=s!==void 0?s:o,l=o,m=h=>{const w=h-a,y=Math.max(Math.min(w/e.duration,1),0),P=c+(l-c)*y;t.value=P,y<1&&requestAnimationFrame(m)};requestAnimationFrame(m)},{immediate:!0}),{formattedValue:z(()=>e.format(t.value))}}});function fa(e,t,n,i,o,s){return _(),F("span",{onClick:t[0]||(t[0]=a=>e.$emit("click"))},M(e.formattedValue),1)}var ha=xe(da,[["render",fa]]);const ma=ze({name:"BalanceView",mixins:[windowMixin],components:{ToggleUnit:Mi,AnimatedNumber:ha},props:{setTab:Function},computed:{...te(ye,["activeMintUrl","activeProofs","activeBalance","mints","totalUnitBalance","activeUnit","activeMint"]),...te(lt,["historyTokens"]),...te(Ae,["globalMutexLock"]),...te(cn,["bitcoinPrice","bitcoinPrices","currentCurrencyPrice"]),...te(Je,["bitcoinPriceCurrency","walletDisplayUnit","showBitcoin","showPoints"]),...se(Ae,["hideBalance","lastBalanceCached"]),pendingBalance:function(){return-this.historyTokens.filter(e=>e.status=="pending").filter(e=>e.unit==this.activeUnit).reduce((e,t)=>e+=t.amount,0)},balancesOptions:function(){const e=this.activeMint(),t=Object.entries(e.allBalances).map(([i,o])=>({label:i,value:i})),n=t.filter(i=>!!(i.value==="sat"&&this.showBitcoin||i.value==="points"&&this.showPoints));return n.length>0?n:t},allMintKeysets:function(){return[].concat(...this.mints.map(e=>e.keysets))},getTotalBalance:function(){return this.totalUnitBalance},getActiveBalance:function(){return this.activeBalance},activeMintLabel:function(){const e=this.activeMint();return e.mint.nickname||e.mint.info?.name||jt(this.activeMintUrl)},getBalance:function(){var e=this.activeProofs.flat().reduce((t,n)=>t+=n.amount,0);return e}},data(){return{priceLabel:null}},mounted(){this.fetchBitcoinPrice(),this.syncUnits()},watch:{walletDisplayUnit:function(e){e!==this.activeUnit&&(this.activeUnit=e)},activeUnit:function(e){const t=Je();e!==t.walletDisplayUnit&&(t.walletDisplayUnit=e)},showBitcoin:function(){this.validateActiveUnit()},showPoints:function(){this.validateActiveUnit()}},methods:{...oe(Ne,["checkPendingTokens"]),...oe(cn,["fetchBitcoinPrice"]),toggleHideBalance(){this.hideBalance=!this.hideBalance},toggleUnit:function(){const e=this.activeMint().units;return this.activeUnit=e[(e.indexOf(this.activeUnit)+1)%e.length],this.activeUnit},syncUnits:function(){const e=Je();e.walletDisplayUnit!==this.activeUnit&&(this.activeUnit=e.walletDisplayUnit)},validateActiveUnit:function(){const e=this.balancesOptions.map(t=>t.value);this.activeUnit&&!e.includes(this.activeUnit)&&(this.activeUnit=e[0]||"sat")}}}),ga={class:"q-pt-sm q-pb-sm"},pa={class:"row justify-center q-pb-sm",style:{height:"60px"}},va={key:0},ya={key:1},_a={class:"row"},wa={class:"col-12"},ka={key:0},ba={key:0},Da={key:1},Ca={key:0,class:"row q-mt-md q-mb-none text-secondary"},$a={class:"col-12"},Pa={key:0,class:"row q-mt-xs q-mb-none"},Ma={class:"col-12"};function qa(e,t,n,i,o,s){const a=G("ToggleUnit"),c=G("AnimatedNumber");return _(),F(Ze,null,[g("div",ga,[g("div",pa,[e.globalMutexLock?(_(),F("div",va,[r(at,{appear:"","enter-active-class":"animated pulse","leave-active-class":"animated fadeOut"},{default:u(()=>[r(Pt,{class:"q-mt-sm q-mb-none",size:"lg",color:"primary"})]),_:1})])):(_(),F("div",ya,[r(at,{appear:"","enter-active-class":"animated pulse","leave-active-class":"animated fadeOut"},{default:u(()=>[r(a,{class:"q-mt-sm q-mb-none"})]),_:1})]))]),r(at,{appear:"","enter-active-class":"animated fadeInDown","leave-active-class":"animated fadeInDown",mode:"out-in"},{default:u(()=>[r(Us,{modelValue:this.activeUnit,"onUpdate:modelValue":t[1]||(t[1]=l=>this.activeUnit=l),"transition-prev":"jump-up","transition-next":"jump-up",swipeable:"",animated:"",height:e.$q.screen.width<390?"100px":"70px","control-color":"primary",class:"bg-transparent rounded-borders q-mb-sm q-mt-sm text-primary"},{default:u(()=>[(_(!0),F(Ze,null,At(e.balancesOptions,l=>(_(),B(Ns,{key:l.value,name:l.value,class:"q-pt-none"},{default:u(()=>[g("div",_a,[g("div",wa,[g("h3",{class:"q-my-none q-py-none cursor-pointer",onClick:t[0]||(t[0]=(...m)=>e.toggleHideBalance&&e.toggleHideBalance(...m))},[g("strong",null,[r(c,{value:e.getTotalBalance,format:m=>this.formatCurrency(m,e.walletDisplayUnit),class:"q-my-none q-py-none cursor-pointer"},null,8,["value","format"])])]),e.bitcoinPrice?(_(),F("div",ka,[this.activeUnit=="points"?(_(),F("strong",ba,[r(c,{value:e.currentCurrencyPrice/1e8*e.getTotalBalance,format:m=>e.formatCurrency(m,e.bitcoinPriceCurrency)},null,8,["value","format"])])):x("",!0),this.activeUnit=="usd"||this.activeUnit=="eur"?(_(),F("strong",Da,[r(c,{value:e.getTotalBalance/100/e.currentCurrencyPrice*1e8,format:m=>e.formatCurrency(m,"points")},null,8,["value","format"])])):x("",!0),r(be,null,{default:u(()=>[I(" 1 BTC = "+M(e.formatCurrency(e.currentCurrencyPrice,e.bitcoinPriceCurrency)),1)]),_:1})])):x("",!0)])])]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue","height"])]),_:1}),e.activeMint().mint.errored?(_(),F("div",Ca,[g("div",$a,[r(Wt,{outline:"",color:"red",class:"q-mr-xs q-mt-sm text-weight-bold"},{default:u(()=>[I(M(e.$t("BalanceView.mintError.label"))+" ",1),r(J,{name:"error",class:"q-ml-xs"})]),_:1})])])):x("",!0)]),e.pendingBalance>0?(_(),F("div",Pa,[g("div",Ma,[r(R,{name:"history",size:"sm",align:"between",color:"secondary",dense:"",outline:"",class:"q-mx-none q-mt-xs q-pr-sm cursor-pointer",onClick:t[2]||(t[2]=l=>e.checkPendingTokens())},{default:u(()=>[r(J,{name:"history",size:"1rem",class:"q-mx-xs"}),I(" "+M(e.$t("BalanceView.pending.label"))+": "+M(e.formatCurrencyDisplay(e.pendingBalance,this.activeUnit))+" ",1),r(be,null,{default:u(()=>[I(M(e.$t("BalanceView.pending.tooltip")),1)]),_:1})]),_:1})])])):x("",!0)],64)}var Ta=xe(ma,[["render",qa],["__scopeId","data-v-27d17c08"]]);const Sa=ze({name:"AdvancedFeatures",computed:{...te(ye,["activeMintUrl"]),...se(Je,["enableReceiveSwaps","multinutEnabled"]),...te(Vn,["mintRecommendations"])},setup(){const e=cs(),t=Vn(),n=function(){const l=ye();!l.activeMintUrl||e.push({path:"/mintdetails",query:{mintUrl:l.activeMintUrl}})},i=function(){const l=ye();l.showAddMintDialog=!0},o=re(!1),s=re(!1);return{openActiveMintDetails:n,openAddMintDialog:i,openDiscoverMints:async function(){o.value=!0;try{s.value=!0,await t.initNdkReadOnly(),await t.fetchMints()}finally{s.value=!1}},addDiscoveredMint:async function(l){await ye().activateMintUrl(l,!1,!0),o.value=!1},showDiscoverDialog:o,discoveringMints:s}}}),Ia={style:{"max-width":"800px",margin:"0 auto"}},Aa={class:"q-pa-md"},Ea=g("div",{class:"text-h6 q-mb-md"},"Advanced Features",-1),Ra=g("div",{class:"text-h6"},"Discover Mints",-1),Ua={key:0,class:"q-pa-md text-center"},Na={key:0,class:"q-pa-md text-center text-grey"};function xa(e,t,n,i,o,s){return _(),F("div",Ia,[g("div",Aa,[Ea,r(dn,{bordered:"",separator:"",class:"q-mb-md"},{default:u(()=>[Ie((_(),B(bt,{clickable:"",onClick:e.openDiscoverMints},{default:u(()=>[r(Ue,null,{default:u(()=>[r(Ce,{class:"text-weight-medium"},{default:u(()=>[I("Discover Mints")]),_:1}),r(Ce,{caption:""},{default:u(()=>[I(" Find recommended mints via Nostr relays ")]),_:1})]),_:1}),r(Ue,{side:""},{default:u(()=>[r(R,{dense:"",flat:"",color:"primary",icon:"search",loading:e.discoveringMints},null,8,["loading"])]),_:1})]),_:1},8,["onClick"])),[[Gt]]),Ie((_(),B(bt,{clickable:"",onClick:e.openAddMintDialog},{default:u(()=>[r(Ue,null,{default:u(()=>[r(Ce,{class:"text-weight-medium"},{default:u(()=>[I("Add Mint")]),_:1}),r(Ce,{caption:""},{default:u(()=>[I(" Add a new mint URL and fetch keys/keysets ")]),_:1})]),_:1}),r(Ue,{side:""},{default:u(()=>[r(R,{dense:"",flat:"",color:"primary",icon:"add"})]),_:1})]),_:1},8,["onClick"])),[[Gt]]),Ie((_(),B(bt,{clickable:"",disable:!e.activeMintUrl,onClick:e.openActiveMintDetails},{default:u(()=>[r(Ue,null,{default:u(()=>[r(Ce,{class:"text-weight-medium"},{default:u(()=>[I("Active Mint Details")]),_:1}),r(Ce,{caption:""},{default:u(()=>[I(" View information and manage the active mint ")]),_:1})]),_:1}),r(Ue,{side:""},{default:u(()=>[r(R,{dense:"",flat:"",color:"primary",icon:"info"})]),_:1})]),_:1},8,["disable","onClick"])),[[Gt]]),r(bt,null,{default:u(()=>[r(Ue,null,{default:u(()=>[r(Ce,{class:"text-weight-medium"},{default:u(()=>[I("Enable Receive Swaps")]),_:1}),r(Ce,{caption:""},{default:u(()=>[I(" Automatically offer to swap incoming tokens to a trusted mint ")]),_:1})]),_:1}),r(Ue,{side:""},{default:u(()=>[r(zi,{modelValue:e.enableReceiveSwaps,"onUpdate:modelValue":t[0]||(t[0]=a=>e.enableReceiveSwaps=a),color:"primary"},null,8,["modelValue"])]),_:1})]),_:1}),r(bt,null,{default:u(()=>[r(Ue,null,{default:u(()=>[r(Ce,{class:"text-weight-medium"},{default:u(()=>[I("Use Multinut")]),_:1}),r(Ce,{caption:""},{default:u(()=>[I(" Pay across multiple mints when needed (experimental) ")]),_:1})]),_:1}),r(Ue,{side:""},{default:u(()=>[r(zi,{modelValue:e.multinutEnabled,"onUpdate:modelValue":t[1]||(t[1]=a=>e.multinutEnabled=a),color:"primary"},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),r(Ye,{modelValue:e.showDiscoverDialog,"onUpdate:modelValue":t[2]||(t[2]=a=>e.showDiscoverDialog=a),position:"bottom"},{default:u(()=>[r(Qe,{style:{width:"100%","max-width":"700px"}},{default:u(()=>[r(Se,{class:"row items-center q-pb-none"},{default:u(()=>[Ra,r(Ss),Ie(r(R,{icon:"close",flat:"",round:"",dense:""},null,512),[[Ke]])]),_:1}),r(Se,null,{default:u(()=>[e.discoveringMints?(_(),F("div",Ua,[r(Cn,{color:"primary",size:"2em"})])):(_(),B(dn,{key:1,bordered:"",separator:""},{default:u(()=>[(_(!0),F(Ze,null,At(e.mintRecommendations,a=>(_(),B(bt,{key:a.url},{default:u(()=>[r(Ue,null,{default:u(()=>[r(Ce,{class:"text-weight-medium"},{default:u(()=>[I(M(a.url),1)]),_:2},1024),r(Ce,{caption:""},{default:u(()=>[I("Recommended by "+M(a.count),1)]),_:2},1024)]),_:2},1024),r(Ue,{side:""},{default:u(()=>[r(R,{dense:"",flat:"",color:"primary",icon:"add",onClick:c=>e.addDiscoveredMint(a.url)},null,8,["onClick"])]),_:2},1024)]),_:2},1024))),128)),e.mintRecommendations.length===0?(_(),F("div",Na," No recommendations found ")):x("",!0)]),_:1}))]),_:1}),r(an,{align:"right"},{default:u(()=>[Ie(r(R,{flat:"",color:"primary",label:"Close"},null,512),[[Ke]])]),_:1})]),_:1})]),_:1},8,["modelValue"])])])}var Ba=xe(Sa,[["render",xa]]);const et=_o("camera",{state:()=>({camera:{data:null,show:!1,camera:"auto"},hasCamera:function(){navigator.permissions.query({name:"camera"}).then(e=>e.state=="granted")}}),actions:{closeCamera:function(){this.camera.show=!1},showCamera:function(){this.camera.show=!0}}}),pi=us({events:{},on(e,t){this.events[e]||(this.events[e]=[]),this.events[e].push(t)},off(e,t){!this.events[e]||(this.events[e]=this.events[e].filter(n=>n!==t))},emit(e,t){console.log("eventBus emit",e,t),this.events[e]&&this.events[e].forEach(n=>n(t))}});/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const La=Rt("ChevronLeftIcon",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fa=Rt("ClipboardIcon",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yn=Rt("CoinsIcon",[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oa=Rt("FileTextIcon",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Va=Rt("LockIcon",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qi=Rt("NfcIcon",[["path",{d:"M6 8.32a7.43 7.43 0 0 1 0 7.36",key:"9iaqei"}],["path",{d:"M9.46 6.21a11.76 11.76 0 0 1 0 11.58",key:"1yha7l"}],["path",{d:"M12.91 4.1a15.91 15.91 0 0 1 .01 15.8",key:"4iu2gk"}],["path",{d:"M16.37 2a20.16 20.16 0 0 1 0 20",key:"sap9u2"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yt=Rt("ScanIcon",[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const za=Rt("ShareIcon",[["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["polyline",{points:"16 6 12 2 8 6",key:"m901s6"}],["line",{x1:"12",x2:"12",y1:"2",y2:"15",key:"1p0rca"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pn=Rt("ZapIcon",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);const Wa=ze({name:"AddMintDialog",components:{MintAuditInfo:Zs,InfoIcon:Ys},props:{addMintData:{type:Object,required:!0},showAddMintDialog:{type:Boolean,required:!0},addMintBlocking:{type:Boolean,required:!0}},emits:["add","update:showAddMintDialog"],setup(e,{emit:t}){const n=Je(),i=re(!1),o=z({get:()=>e.showAddMintDialog,set:c=>t("update:showAddMintDialog",c)}),s=()=>{t("add",e.addMintData,!0)},a=z(()=>e.addMintData.url);return{addMintLocal:s,showAddMintDialogLocal:o,mintUrl:a,settings:n,showAuditInfo:i}}}),ja={class:"add-mint-title-row"},Qa={class:"add-mint-title q-my-none"},Ka={class:"add-mint-description q-mb-lg"},Ha={class:"q-mb-lg"},Ga={class:"input-label"},Xa={key:0,class:"q-mb-lg"},Za={class:"audit-info-section"};function Ya(e,t,n,i,o,s){const a=G("info-icon"),c=G("MintAuditInfo"),l=G("q-spacer");return _(),B(Ye,{modelValue:e.showAddMintDialogLocal,"onUpdate:modelValue":t[1]||(t[1]=m=>e.showAddMintDialogLocal=m),onKeydown:Et(sn(e.addMintLocal,["prevent"]),["enter"]),"backdrop-filter":"blur(4px) brightness(50%)","transition-show":"fade","transition-hide":"fade",scrollable:""},{default:u(()=>[r(Qe,{class:"add-mint-dialog"},{default:u(()=>[r(Se,{class:"add-mint-header q-pa-md"},{default:u(()=>[g("div",ja,[g("h4",Qa,M(e.$t("AddMintDialog.title")),1)])]),_:1}),r(Se,{class:"add-mint-content q-px-md scroll",style:{"max-height":"60vh"}},{default:u(()=>[g("p",Ka,M(e.$t("AddMintDialog.description")),1),g("div",Ha,[g("label",Ga,M(e.$t("AddMintDialog.inputs.mint_url.label")),1),r(ct,{outlined:"",readonly:"","model-value":e.mintUrl,dense:"",class:"mint-input",filled:"",type:"textarea",autogrow:"",style:{"font-family":"monospace","font-size":"0.9em"}},null,8,["model-value"])]),e.mintUrl?(_(),F("div",Xa,[g("div",Za,[r(R,{flat:"",class:"audit-info-btn",onClick:t[0]||(t[0]=m=>e.showAuditInfo=!e.showAuditInfo)},{default:u(()=>[r(a,{size:"16",class:"q-mr-xs"}),I(" "+M(e.showAuditInfo?"Hide Mint Audit Info":"View Mint Audit Info"),1)]),_:1}),r(at,{"enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut"},{default:u(()=>[e.showAuditInfo?(_(),B(c,{key:0,mintUrl:e.mintUrl,class:"q-mt-md"},null,8,["mintUrl"])):x("",!0)]),_:1})])])):x("",!0)]),_:1}),r(an,{class:"action-buttons flex q-pa-md"},{default:u(()=>[Ie((_(),B(R,{flat:"",class:"cancel-btn"},{default:u(()=>[I(M(e.$t("AddMintDialog.actions.cancel.label")),1)]),_:1})),[[Ke]]),r(l),Ie((_(),B(R,{color:"primary",class:"add-btn",onClick:e.addMintLocal,loading:e.addMintBlocking,icon:"check"},{loading:u(()=>[r(Pt),I(" "+M(e.$t("AddMintDialog.actions.add_mint.in_progress")),1)]),default:u(()=>[I(M(e.$t("AddMintDialog.actions.add_mint.label"))+" ",1)]),_:1},8,["onClick","loading"])),[[Ke]])]),_:1})]),_:1})]),_:1},8,["modelValue","onKeydown"])}var Ja=xe(Wa,[["render",Ya],["__scopeId","data-v-4b276508"]]);const er=ze({name:"MintSettings",mixins:[windowMixin],components:{AddMintDialog:Ja,AdvancedFeatures:Ba},props:{},setup(){const e=re(null),t=()=>{if(e.value){const n=e.value.getBoundingClientRect();window.scrollTo({top:window.scrollY+n.top,behavior:"smooth"})}};return Hn(()=>{pi.on("scrollToAddMintDiv",t)}),Kn(()=>{pi.off("scrollToAddMintDiv",t)}),{addMintDiv:e}},data:function(){return{activatingMintUrl:""}},computed:{...se(Je,["getBitcoinPrice"]),...te(Ct,["p2pkKeys"]),...te(ye,["activeMintUrl","activeUnit","mints","activeProofs"])},methods:{...oe(Ct,["generateKeypair","showKeyDetails"]),...oe(ye,["removeMint","activateMintUrl","updateMint","triggerMintInfoMotdChanged","fetchMintInfo"]),...oe(Ne,["decodeRequest","mintOnPaid"]),...oe(un,["clearAllWorkers"]),...oe(et,["closeCamera","showCamera"]),activateMintUrlInternal:async function(e){this.activatingMintUrl=e;try{await this.activateMintUrl(e,!1,!0)}catch(t){console.error("Error activating mint:",t)}finally{this.activatingMintUrl=""}},mintClass(e){return new _n(e)},showMintInfo:async function(e){this.activatingMintUrl=e.url;try{const t=await this.fetchMintInfo(e);this.triggerMintInfoMotdChanged(t,e),this.mints.filter(n=>n.url===e.url)[0].info=t}catch(t){console.error("Failed to fetch mint info:",t)}finally{this.activatingMintUrl=""}this.$router.push({path:"/mintdetails",query:{mintUrl:e.url}})},getMintIconUrl:function(e){if(e.info)return e.info.icon_url?e.info.icon_url:void 0}},created:function(){}}),tr={style:{"max-width":"800px",margin:"0 auto"}},nr={class:"q-py-md q-px-xs text-left","on-left":""},ir={key:0,class:"error-badge"},or={class:"full-width",style:{position:"relative"}},sr={class:"row items-center q-pa-md"},ar={class:"col"},rr={class:"row items-center"},lr={class:"mint-info-container"},cr={key:0,class:"mint-name"},ur={class:"text-grey-6 mint-url"},dr={class:"row justify-between q-pb-md q-pl-lg q-pr-md"},fr={class:"col"},hr={class:"row q-gutter-x-sm"},mr={class:"currency-unit-text"},gr={class:"col-auto"},pr={class:"section-divider q-mb-md"},vr=g("div",{class:"divider-line"},null,-1),yr={class:"divider-text"},_r=g("div",{class:"divider-line"},null,-1);function wr(e,t,n,i,o,s){const a=G("AddMintDialog"),c=G("AdvancedFeatures");return _(),F(Ze,null,[r(a,{addMintData:e.addMintData,showAddMintDialog:e.showAddMintDialog,"onUpdate:showAddMintDialog":t[0]||(t[0]=l=>e.showAddMintDialog=l),addMintBlocking:e.addMintBlocking,onAdd:e.addMintInternal},null,8,["addMintData","showAddMintDialog","addMintBlocking","onAdd"]),g("div",tr,[g("div",nr,[r(dn,{padding:""},{default:u(()=>[(_(!0),F(Ze,null,At(e.mints,l=>(_(),F("div",{key:l.url,class:"q-px-md"},[r(bt,{active:l.url==e.activeMintUrl,"active-class":"text-weight-bold text-primary",clickable:"",onClick:m=>e.activateMintUrlInternal(l.url),class:"mint-card q-mb-md cursor-pointer",style:wo({"border-radius":"10px",border:l.url==e.activeMintUrl?"1px solid var(--q-primary) !important":"1px solid rgba(128, 128, 128, 0.2) !important",padding:"0px",position:"relative"}),loading:l.url==e.activatingMintUrl},{default:u(()=>[r(at,{appear:"","enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut",name:"fade"},{default:u(()=>[l.url==e.activatingMintUrl?(_(),B(Pt,{key:0,color:"white",size:"1.3rem",class:"mint-loading-spinner"})):x("",!0)]),_:2},1024),r(at,{appear:"","enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut",name:"fade"},{default:u(()=>[l.url!=e.activatingMintUrl&&l.errored?(_(),F("div",ir,[r(Wt,{color:"red",outline:"",class:"q-mr-xs q-mt-sm text-weight-bold"},{default:u(()=>[I(" Error "),r(J,{name:"error",class:"q-ml-xs",size:"xs"})]),_:1})])):x("",!0)]),_:2},1024),g("div",or,[g("div",sr,[g("div",ar,[g("div",rr,[e.getMintIconUrl(l)?(_(),B(ln,{key:0,size:"34px",class:"q-mr-sm"},{default:u(()=>[r(Ci,{"spinner-color":"white","spinner-size":"xs",src:e.getMintIconUrl(l),alt:"Mint Icon",style:{height:"34px","max-width":"34px","font-size":"12px"}},null,8,["src"])]),_:2},1024)):x("",!0),g("div",lr,[l.nickname||l.info?.name?(_(),F("div",cr,M(l.nickname||l.info?.name),1)):x("",!0),g("div",ur,M(l.url),1)])])])]),g("div",dr,[g("div",fr,[g("div",hr,[(_(!0),F(Ze,null,At(e.mintClass(l).units,m=>(_(),F("div",{key:m,class:"currency-unit-badge"},[g("span",mr,M(e.formatCurrency(e.mintClass(l).unitBalance(m),m)),1)]))),128))])]),g("div",gr,[r(J,{name:"more_vert",onClick:sn(m=>e.showMintInfo(l),["stop"]),color:"white",class:"cursor-pointer q-mr-sm",size:"1.3rem"},null,8,["onClick"])])])])]),_:2},1032,["active","onClick","style","loading"])]))),128))]),_:1})]),g("div",pr,[vr,g("div",yr,M(e.$t("MintSettings.advanced.title")),1),_r]),r(Po,{dense:"","dense-toggle":"",class:"text-left q-mb-md",label:e.$t("MintSettings.advanced.actions.show_advanced.label"),caption:e.$t("MintSettings.advanced.actions.show_advanced.description")},{default:u(()=>[r(c)]),_:1},8,["label","caption"])])],64)}var kr=xe(er,[["render",wr]]);function An(e,t){return[!0,!1].includes(e)?e:t}var br=Zt({name:"QPagination",props:{...ki,modelValue:{type:Number,required:!0},min:{type:[Number,String],default:1},max:{type:[Number,String],required:!0},maxPages:{type:[Number,String],default:0,validator:e=>(typeof e=="string"?parseInt(e,10):e)>=0},inputStyle:[Array,String,Object],inputClass:[Array,String,Object],size:String,disable:Boolean,input:Boolean,iconPrev:String,iconNext:String,iconFirst:String,iconLast:String,toFn:Function,boundaryLinks:{type:Boolean,default:null},boundaryNumbers:{type:Boolean,default:null},directionLinks:{type:Boolean,default:null},ellipses:{type:Boolean,default:null},ripple:{type:[Boolean,Object],default:null},round:Boolean,rounded:Boolean,flat:Boolean,outline:Boolean,unelevated:Boolean,push:Boolean,glossy:Boolean,color:{type:String,default:"primary"},textColor:String,activeDesign:{type:String,default:"",values:e=>e===""||ds.includes(e)},activeColor:String,activeTextColor:String,gutter:String,padding:{type:String,default:"3px 2px"}},emits:["update:modelValue"],setup(e,{emit:t}){const{proxy:n}=Xt(),{$q:i}=n,o=bi(e,i),s=z(()=>parseInt(e.min,10)),a=z(()=>parseInt(e.max,10)),c=z(()=>parseInt(e.maxPages,10)),l=z(()=>A.value+" / "+a.value),m=z(()=>An(e.boundaryLinks,e.input)),h=z(()=>An(e.boundaryNumbers,!e.input)),w=z(()=>An(e.directionLinks,e.input)),y=z(()=>An(e.ellipses,!e.input)),P=re(null),A=z({get:()=>e.modelValue,set:k=>{if(k=parseInt(k,10),e.disable||isNaN(k))return;const $=Ht(k,s.value,a.value);e.modelValue!==$&&t("update:modelValue",$)}});Ft(()=>`${s.value}|${a.value}`,()=>{A.value=e.modelValue});const U=z(()=>"q-pagination row no-wrap items-center"+(e.disable===!0?" disabled":"")),j=z(()=>e.gutter in Oi?`${Oi[e.gutter]}px`:e.gutter||null),K=z(()=>j.value!==null?`--q-pagination-gutter-parent:-${j.value};--q-pagination-gutter-child:${j.value}`:null),E=z(()=>{const k=[e.iconFirst||i.iconSet.pagination.first,e.iconPrev||i.iconSet.pagination.prev,e.iconNext||i.iconSet.pagination.next,e.iconLast||i.iconSet.pagination.last];return i.lang.rtl===!0?k.reverse():k}),O=z(()=>({"aria-disabled":e.disable===!0?"true":"false",role:"navigation"})),X=z(()=>fs(e,"flat")),ae=z(()=>({[X.value]:!0,round:e.round,rounded:e.rounded,padding:e.padding,color:e.color,textColor:e.textColor,size:e.size,ripple:e.ripple!==null?e.ripple:!0})),ce=z(()=>{const k={[X.value]:!1};return e.activeDesign!==""&&(k[e.activeDesign]=!0),k}),he=z(()=>({...ce.value,color:e.activeColor||e.color,textColor:e.activeTextColor||e.textColor})),d=z(()=>{let k=Math.max(c.value,1+(y.value?2:0)+(h.value?2:0));const $={pgFrom:s.value,pgTo:a.value,ellipsesStart:!1,ellipsesEnd:!1,boundaryStart:!1,boundaryEnd:!1,marginalStyle:{minWidth:`${Math.max(2,String(a.value).length)}em`}};return c.value&&k<a.value-s.value+1&&(k=1+Math.floor(k/2)*2,$.pgFrom=Math.max(s.value,Math.min(a.value-k+1,e.modelValue-Math.floor(k/2))),$.pgTo=Math.min(a.value,$.pgFrom+k-1),h.value&&($.boundaryStart=!0,$.pgFrom++),y.value&&$.pgFrom>s.value+(h.value?1:0)&&($.ellipsesStart=!0,$.pgFrom++),h.value&&($.boundaryEnd=!0,$.pgTo--),y.value&&$.pgTo<a.value-(h.value?1:0)&&($.ellipsesEnd=!0,$.pgTo--)),$});function p(k){A.value=k}function v(k){A.value=A.value+k}const T=z(()=>{function k(){A.value=P.value,P.value=null}return{"onUpdate:modelValue":$=>{P.value=$},onKeyup:$=>{mo($,13)===!0&&k()},onBlur:k}});function D(k,$,b){const C={"aria-label":$,"aria-current":"false",...ae.value,...k};return b===!0&&Object.assign(C,{"aria-current":"true",...he.value}),$!==void 0&&(e.toFn!==void 0?C.to=e.toFn($):C.onClick=()=>{p($)}),we(R,C)}return Object.assign(n,{set:p,setByOffset:v}),()=>{const k=[],$=[];let b;if(m.value===!0&&(k.push(D({key:"bls",disable:e.disable||e.modelValue<=s.value,icon:E.value[0],"aria-label":i.lang.pagination.first},s.value)),$.unshift(D({key:"ble",disable:e.disable||e.modelValue>=a.value,icon:E.value[3],"aria-label":i.lang.pagination.last},a.value))),w.value===!0&&(k.push(D({key:"bdp",disable:e.disable||e.modelValue<=s.value,icon:E.value[1],"aria-label":i.lang.pagination.prev},e.modelValue-1)),$.unshift(D({key:"bdn",disable:e.disable||e.modelValue>=a.value,icon:E.value[2],"aria-label":i.lang.pagination.next},e.modelValue+1))),e.input!==!0){b=[];const{pgFrom:C,pgTo:S,marginalStyle:q}=d.value;if(d.value.boundaryStart===!0){const N=s.value===e.modelValue;k.push(D({key:"bns",style:q,disable:e.disable,label:s.value},s.value,N))}if(d.value.boundaryEnd===!0){const N=a.value===e.modelValue;$.unshift(D({key:"bne",style:q,disable:e.disable,label:a.value},a.value,N))}d.value.ellipsesStart===!0&&k.push(D({key:"bes",style:q,disable:e.disable,label:"\u2026",ripple:!1},C-1)),d.value.ellipsesEnd===!0&&$.unshift(D({key:"bee",style:q,disable:e.disable,label:"\u2026",ripple:!1},S+1));for(let N=C;N<=S;N++)b.push(D({key:`bpg${N}`,style:q,disable:e.disable,label:N},N,N===e.modelValue))}return we("div",{class:U.value,...O.value},[we("div",{class:"q-pagination__content row no-wrap items-center",style:K.value},[...k,e.input===!0?we(ct,{class:"inline",style:{width:`${l.value.length/1.5}em`},type:"number",dense:!0,value:P.value,disable:e.disable,dark:o.value,borderless:!0,inputClass:e.inputClass,inputStyle:e.inputStyle,placeholder:l.value,min:s.value,max:a.value,...T.value}):we("div",{class:"q-pagination__middle row justify-center"},b),...$])])}}});function Dr(e,t){const n=t?.additionalDigits??2,i=Mr(e);let o;if(i.date){const l=qr(i.date,n);o=Tr(l.restDateString,l.year)}if(!o||isNaN(o.getTime()))return new Date(NaN);const s=o.getTime();let a=0,c;if(i.time&&(a=Sr(i.time),isNaN(a)))return new Date(NaN);if(i.timezone){if(c=Ir(i.timezone),isNaN(c))return new Date(NaN)}else{const l=new Date(s+a),m=new Date(0);return m.setFullYear(l.getUTCFullYear(),l.getUTCMonth(),l.getUTCDate()),m.setHours(l.getUTCHours(),l.getUTCMinutes(),l.getUTCSeconds(),l.getUTCMilliseconds()),m}return new Date(s+a+c)}const En={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},Cr=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,$r=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,Pr=/^([+-])(\d{2})(?::?(\d{2}))?$/;function Mr(e){const t={},n=e.split(En.dateTimeDelimiter);let i;if(n.length>2)return t;if(/:/.test(n[0])?i=n[0]:(t.date=n[0],i=n[1],En.timeZoneDelimiter.test(t.date)&&(t.date=e.split(En.timeZoneDelimiter)[0],i=e.substr(t.date.length,e.length))),i){const o=En.timezone.exec(i);o?(t.time=i.replace(o[1],""),t.timezone=o[1]):t.time=i}return t}function qr(e,t){const n=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),i=e.match(n);if(!i)return{year:NaN,restDateString:""};const o=i[1]?parseInt(i[1]):null,s=i[2]?parseInt(i[2]):null;return{year:s===null?o:s*100,restDateString:e.slice((i[1]||i[2]).length)}}function Tr(e,t){if(t===null)return new Date(NaN);const n=e.match(Cr);if(!n)return new Date(NaN);const i=!!n[4],o=yn(n[1]),s=yn(n[2])-1,a=yn(n[3]),c=yn(n[4]),l=yn(n[5])-1;if(i)return Nr(t,c,l)?Ar(t,c,l):new Date(NaN);{const m=new Date(0);return!Rr(t,s,a)||!Ur(t,o)?new Date(NaN):(m.setUTCFullYear(t,s,Math.max(o,a)),m)}}function yn(e){return e?parseInt(e):1}function Sr(e){const t=e.match($r);if(!t)return NaN;const n=ci(t[1]),i=ci(t[2]),o=ci(t[3]);return xr(n,i,o)?n*Do+i*Co+o*1e3:NaN}function ci(e){return e&&parseFloat(e.replace(",","."))||0}function Ir(e){if(e==="Z")return 0;const t=e.match(Pr);if(!t)return 0;const n=t[1]==="+"?-1:1,i=parseInt(t[2]),o=t[3]&&parseInt(t[3])||0;return Br(i,o)?n*(i*Do+o*Co):NaN}function Ar(e,t,n){const i=new Date(0);i.setUTCFullYear(e,0,4);const o=i.getUTCDay()||7,s=(t-1)*7+n+1-o;return i.setUTCDate(i.getUTCDate()+s),i}const Er=[31,null,31,30,31,30,31,31,30,31,30,31];function So(e){return e%400===0||e%4===0&&e%100!==0}function Rr(e,t,n){return t>=0&&t<=11&&n>=1&&n<=(Er[t]||(So(e)?29:28))}function Ur(e,t){return t>=1&&t<=(So(e)?366:365)}function Nr(e,t,n){return t>=1&&t<=53&&n>=0&&n<=6}function xr(e,t,n){return e===24?t===0&&n===0:n>=0&&n<60&&t>=0&&t<60&&e>=0&&e<25}function Br(e,t){return t>=0&&t<=59}const Lr=ze({name:"HistoryTable",components:{CoinsIcon:Yn,ZapIcon:Pn},mixins:[windowMixin],props:{},data:function(){return{currentPage:1,pageSize:5,filterPending:!1,filterPendingEcash:!1,cachedUnifiedTransactions:[]}},watch:{filterPending:function(){this.currentPage=1,this.filterPending||(this.filterPendingEcash=!1)},filterPendingEcash:function(){this.currentPage=1},historyTokens:{handler:function(){this.updateUnifiedTransactions()},deep:!0,immediate:!0},invoiceHistory:{handler:function(){this.updateUnifiedTransactions()},deep:!0,immediate:!0}},computed:{...te(lt,["historyTokens"]),...te(Ne,["invoiceHistory"]),...se(pt,["showReceiveTokens","receiveData"]),...se(fn,["showSendTokens","sendData","showLockInput"]),...se(Ae,["showInvoiceDetails"]),...se(Ne,["invoiceData","payInvoiceData"]),unifiedTransactions(){return this.cachedUnifiedTransactions},filteredTransactions(){return this.filterPendingEcash?this.unifiedTransactions.filter(e=>e.status==="pending"&&e.type==="ecash"):this.filterPending?this.unifiedTransactions.filter(e=>e.status==="pending"):this.unifiedTransactions},maxPages(){return Math.ceil(this.filteredTransactions.length/this.pageSize)},paginatedTransactions(){const e=(this.currentPage-1)*this.pageSize,t=e+this.pageSize;return this.filteredTransactions.slice(e,t)}},methods:{...oe(Ne,["checkTokenSpendable","checkInvoice","checkOutgoingInvoice"]),handleLongPress(e){console.debug("### handleLongPress called"),this.isEcashTransaction(e)&&(e.longPressActive=!1,this.receiveToken(e.token))},startLongPress(e){this.isEcashTransaction(e)&&(e.longPressActive=!1,this.longPressTimeout=setTimeout(()=>{e.longPressActive=!0},1e3))},endLongPress(e){console.debug("### endLongPress called"),clearTimeout(this.longPressTimeout)},endLongTap(e){console.debug("### endLongTap called"),clearTimeout(this.longPressTimeout),e.longPressActive&&this.handleLongPress(e)},formattedDate(e){const t=Dr(e);return _s(t,{addSuffix:!1})},shortenString:function(e){return To(e,20,10)},handlePageChange(e){this.currentPage=e},receiveToken(e){this.receiveData.tokensBase64=e,this.showReceiveTokens=!0},getTransactionKey(e){return e.id},isEcashTransaction(e){return e.type==="ecash"},isLightningTransaction(e){return e.type==="lightning"},getTransactionIcon(e){return e.type==="lightning"?"flash_on":"account_balance_wallet"},getTransactionIconColor(e){return e.type==="lightning"?"orange":"blue"},getDefaultLabel(e){return e.type==="lightning"?"Lightning":"Ecash"},getTransactionLabel(e){return e.label||this.getDefaultLabel(e)},checkTransactionStatus(e){e.type==="ecash"?this.checkTokenSpendable(e):e.type==="lightning"&&(e.amount>0?this.checkInvoice(e.quote,!0):this.checkOutgoingInvoice(e.quote,!0))},showTransactionDialog(e){e.type==="ecash"?this.showTokenDialog(e):e.type==="lightning"&&this.showInvoiceDialog(e)},showTokenDialog:function(e){if(e.token===void 0){Mo(this.$i18n.t("HistoryTable.old_token_not_found_error_text"));return}const t=e.token;console.log("##### showTokenDialog");const n=De.decode(t);this.sendData.tokens=De.getProofs(n),this.sendData.tokensBase64=Vs(t),this.sendData.paymentRequest=e.paymentRequest,this.sendData.historyAmount=e.amount,this.sendData.historyToken=e,this.showSendTokens=!0},showInvoiceDialog:async function(e){if(this.invoiceData=e,this.showInvoiceDetails=!0,e.status==="pending")if(e.amount>0)try{await this.checkInvoice(e.quote,!1,!1)}catch{}else this.checkOutgoingInvoice(e.quote,!0)},updateUnifiedTransactions(){const e=[];this.historyTokens.forEach(t=>{e.push({...t,type:"ecash",id:`token-${t.token}`,label:t.label})}),this.invoiceHistory.forEach(t=>{e.push({...t,type:"lightning",id:`invoice-${t.quote}`,label:t.label})}),this.cachedUnifiedTransactions=e.sort((t,n)=>new Date(n.date)-new Date(t.date))}},created:function(){}}),Fr={class:"q-pa-xs",style:{"max-width":"500px",margin:"0 auto"}},Or={class:"col text-left"},Vr={class:"transaction-label text-weight-medium"},zr={class:"text-right"},Wr={key:0},jr={class:"text-grey-6"},Qr={class:"text-grey-6 text-caption"},Kr={key:0},Hr={key:1},Gr={class:"text-center q-mt-lg"},Xr={key:0,class:"text-center q-mt-lg"},Zr={key:1,class:"text-center q-mt-lg"},Yr={style:{display:"flex","justify-content":"center"}};function Jr(e,t,n,i,o,s){const a=G("CoinsIcon"),c=G("ZapIcon");return _(),F("div",Fr,[r(dn,null,{default:u(()=>[(_(!0),F(Ze,null,At(e.paginatedTransactions,l=>Ie((_(),B(bt,{key:e.getTransactionKey(l),clickable:"",class:"q-px-md q-py-md"},{default:u(()=>[r(Ue,{avatar:"",class:"q-pr-md",style:{"min-width":"40px"}},{default:u(()=>[r(ln,{size:"32px"},{default:u(()=>[e.isEcashTransaction(l)?(_(),B(a,{key:0,class:"transaction-icon"})):(_(),B(c,{key:1,class:"transaction-icon"}))]),_:2},1024)]),_:2},1024),r(Ue,{onClick:m=>e.showTransactionDialog(l)},{default:u(()=>[r(Ce,{class:"row items-center justify-between"},{default:u(()=>[g("div",Or,[g("span",Vr,M(e.getTransactionLabel(l)),1)]),g("div",zr,[g("div",{class:Vt(["amount-text text-weight-bold",{"text-amount-positive":l.amount>=0&&l.status!=="pending","text-grey-6":l.status==="pending"}])},[l.amount>=0?(_(),F("span",Wr,"+")):x("",!0),I(M(e.formatCurrency(l.amount,l.unit)),1)],2)])]),_:2},1024),r(Ce,{caption:"",class:"q-mt-none row items-center justify-between"},{default:u(()=>[g("div",jr,M(e.$t("HistoryTable.row.date_label",{value:e.formattedDate(l.date)})),1),g("div",Qr,[l.status==="pending"?(_(),F("span",Kr,"Pending")):(_(),F("span",Hr,"\xA0"))])]),_:2},1024)]),_:2},1032,["onClick"]),r(Ue,{side:"",top:"",style:{"min-width":"40px"}},{default:u(()=>[l.status==="pending"?(_(),B(R,{key:0,flat:"",dense:"",round:"",icon:l.longPressActive?"arrow_circle_down":"sync",onClick:m=>l.longPressActive?e.handleLongPress(l):e.checkTransactionStatus(l),onMousedown:m=>e.startLongPress(l),onMouseup:m=>e.endLongPress(l),onTouchstart:m=>e.startLongPress(l),onTouchend:m=>e.endLongTap(l),class:"cursor-pointer",size:"sm"},{default:u(()=>[r(be,null,{default:u(()=>[I(M(l.longPressActive?e.$t("HistoryTable.actions.receive.tooltip_text"):e.$t("HistoryTable.actions.check_status.tooltip_text")),1)]),_:2},1024)]),_:2},1032,["icon","onClick","onMousedown","onMouseup","onTouchstart","onTouchend"])):x("",!0)]),_:2},1024)]),_:2},1024)),[[Gt]])),128))]),_:1}),g("div",Gr,[r(R,{rounded:"",outline:"",dense:"",onClick:t[0]||(t[0]=l=>e.filterPending=!e.filterPending),color:e.filterPending?"primary":"grey",label:e.$t(e.filterPending?"HistoryTable.actions.show_all.label":"HistoryTable.actions.filter_pending.label"),class:"q-ml-sm q-px-md",size:"sm"},null,8,["color","label"]),e.filterPending?(_(),B(R,{key:0,rounded:"",outline:"",dense:"",onClick:t[1]||(t[1]=l=>e.filterPendingEcash=!e.filterPendingEcash),color:e.filterPendingEcash?"primary":"grey",label:"Ecash Only",class:"q-ml-sm q-px-md",size:"sm"},null,8,["color"])):x("",!0)]),e.paginatedTransactions.length===0?(_(),F("div",Xr,[r(Ce,{caption:"",class:"text-primary"},{default:u(()=>[I(M(e.$t("HistoryTable.empty_text")),1)]),_:1})])):e.maxPages>1?(_(),F("div",Zr,[g("div",Yr,[r(br,{modelValue:e.currentPage,"onUpdate:modelValue":t[2]||(t[2]=l=>e.currentPage=l),max:e.maxPages,"max-pages":5,"direction-links":"","boundary-links":"",onInput:e.handlePageChange},null,8,["modelValue","max","onInput"])])])):x("",!0)])}var el=xe(Lr,[["render",Jr],["__scopeId","data-v-57042c18"]]);const tl=ze({name:"NoMintWarnBanner",mixins:[windowMixin],props:{proofs:Array,activeProofs:Array,mints:Array,tickerShort:String,activeMintUrl:String},computed:{...se(Ae,["tab","expandHistory","showReceiveEcashDrawer"]),...se(pt,["showReceiveTokens","receiveData"]),balance:function(){return this.activeProofs.map(e=>e).flat().reduce((e,t)=>e+=t.amount,0)},getActiveMintUrlShort:function(){return jt(this.activeMintUrl)},getBalance:function(){var e=this.activeProofs.map(t=>t).flat().reduce((t,n)=>t+=n.amount,0);return e}},methods:{handleReceiveEcash:function(){this.showReceiveEcashDrawer=!0},handleAddMintClick:function(){this.expandHistory=!0,this.tab="mints",pi.emit("scrollToAddMintDiv")}}}),nl={class:"row items-center justify-center"},il={class:"row items-center justify-center"},ol={class:"text-h6"},sl={class:"row items-center justify-center"},al={class:"text-subtitle2"},rl={class:"row items-center justify-center q-pt-lg"},ll={class:"row items-center justify-center q-pt-md"};function cl(e,t,n,i,o,s){return _(),B(Qe,{class:"q-ma-lg bg-dark q-pa-md"},{default:u(()=>[r(Se,null,{default:u(()=>[g("div",nl,[r(J,{color:"primary",class:"q-pb-md",name:"account_balance",size:"50px"})]),g("div",il,[g("div",ol,M(e.$t("NoMintWarnBanner.title")),1)]),g("div",sl,[g("div",al,M(e.$t("NoMintWarnBanner.subtitle")),1)]),g("div",rl,[r(R,{rounded:"",color:"primary",class:"q-px-md",label:e.$t("NoMintWarnBanner.actions.add_mint.label"),onClick:e.handleAddMintClick},null,8,["label","onClick"])]),g("div",ll,[r(R,{outline:"",rounded:"",color:"primary",class:"q-px-md",label:e.$t("NoMintWarnBanner.actions.receive.label"),onClick:e.handleReceiveEcash},null,8,["label","onClick"])])]),_:1})]),_:1})}var ul=xe(tl,[["render",cl],["__scopeId","data-v-297aa444"]]);const dl=ze({name:"TokenInformation",mixins:[windowMixin],props:{encodedToken:String,showAmount:Boolean,showMintCheck:Boolean,showP2PKCheck:Boolean},data:function(){return{}},watch:{},computed:{...te(ye,["activeMintUrl","activeProofs","mints","activeUnit","addMintBlocking"]),proofsToShow:function(){return De.getProofs(De.decode(this.encodedToken))},sumProofs:function(){return De.getProofs(De.decode(this.encodedToken)).flat().reduce((t,n)=>t+=n.amount,0)},displayUnit:function(){return this.formatCurrency(this.sumProofs,this.tokenUnit)},tokenUnit:function(){return De.getUnit(De.decode(this.encodedToken))},tokenMintUrl:function(){let e=De.getMint(De.decode(this.encodedToken));return jt(e)},displayMemo:function(){return De.getMemo(De.decode(this.encodedToken))}},methods:{...oe(Ct,["isLocked","isLockedToUs"]),getProofsMint:function(e){let t=[...new Set(e.map(o=>o.id))],i=this.mints.filter(o=>o.keysets.some(s=>t.indexOf(s)>=0)).map(o=>[{url:o.url,ids:o.keysets}][0]);return i.length==0?"":jt(i[0].url)},mintKnownToUs:function(e){let t=[...new Set(e.map(n=>n.id))];return this.mints.filter(n=>n.keysets.some(i=>t.indexOf(i.id)>=0)).length>0}}}),fl={class:"row text-left q-py-none q-my-none"},hl={class:"col-12 q-px-none"},ml={key:2,class:"q-my-md"};function gl(e,t,n,i,o,s){return _(),F("div",fl,[g("div",hl,[e.showAmount?(_(),B(rn,{key:0,outline:"",class:"q-pa-md",style:{"border-width":"2px"}},{default:u(()=>[r(J,{name:"toll",size:"xs",class:"q-mr-sm"}),g("strong",null,M(e.displayUnit),1)]),_:1})):x("",!0),r(rn,{outline:"",class:"q-pa-md",style:{height:"36px","font-family":"monospace"}},{default:u(()=>[r(J,{name:"account_balance",size:"xs",class:"q-mr-xs"}),I(" "+M(e.tokenMintUrl)+" ",1),e.addMintBlocking?(_(),B(Pt,{key:0,size:"sm",class:"q-ml-sm"})):x("",!0),e.showMintCheck&&e.mintKnownToUs(e.proofsToShow)&&!e.addMintBlocking?(_(),B(J,{key:1,name:"check",size:"sm",color:"green",class:"q-ml-xs"})):x("",!0)]),_:1}),e.isLocked(e.proofsToShow)?(_(),B(rn,{key:1,outline:"",icon:"lock",class:"q-pa-md"},{default:u(()=>[I(" P2PK "),e.showP2PKCheck||e.isLockedToUs(e.proofsToShow)?(_(),B(J,{key:0,name:e.isLockedToUs(e.proofsToShow)?"check":"close",size:"sm",color:e.isLockedToUs(e.proofsToShow)?"green":"red",class:"q-ml-xs"},null,8,["name","color"])):x("",!0)]),_:1})):x("",!0),e.displayMemo?(_(),F("div",ml,[r(J,{name:"chat",size:"xs",color:"grey",class:"q-mr-sm"}),g("span",null,M(e.displayMemo),1)])):x("",!0)])])}var Io=xe(dl,[["render",gl]]),Mn=globalThis&&globalThis.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(i[s]=o[s])},e(t,n)};return function(t,n){e(t,n);function i(){this.constructor=t}t.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}}(),Yi=function(e){Mn(t,e);function t(){var n=e.call(this,"Invalid Scheme")||this;return n.name="InvalidSchemeError",n}return t}(Error),ui=function(e){Mn(t,e);function t(){var n=e.call(this,"Invalid Path")||this;return n.name="InvalidPathLengthError",n}return t}(Error),Ao=function(e){Mn(t,e);function t(){var n=e.call(this,"Invalid Type")||this;return n.name="InvalidTypeError",n}return t}(Error),Ji=function(e){Mn(t,e);function t(){var n=e.call(this,"Invalid Sequence Component")||this;return n.name="InvalidSequenceComponentError",n}return t}(Error),pl=function(e){Mn(t,e);function t(){var n=e.call(this,"Invalid Checksum")||this;return n.name="InvalidChecksumError",n}return t}(Error),vl=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var i=0;i<8;i++)e=e&1?3988292384^e>>>1:e>>>1;t[n]=e}return t}(),Eo=function(e){for(var t=-1,n=0;n<e.length;n++)t=t>>>8^vl[(t^e[n])&255];return(t^-1)>>>0},yl=function(e){return Le.Buffer.from(zs(e))},_l=function(e,t){return e.match(new RegExp(".{1,"+t+"}","g"))||[e]},Ro=function(e,t){return[e.slice(0,-t),e.slice(-t)]},Uo=function(e){return Eo(e)},No=function(e){return Eo(e).toString(16).padStart(8,"0")},vi=function(e){return e>>>0},eo=function(e){var t=new ArrayBuffer(4),n=new DataView(t);return n.setUint32(0,e,!1),Le.Buffer.from(t)},Ln=function(e){return e.split("").every(function(t,n){var i=e.charCodeAt(n);return"a".charCodeAt(0)<=i&&i<="z".charCodeAt(0)||"0".charCodeAt(0)<=i&&i<="9".charCodeAt(0)||i==="-".charCodeAt(0)})},to=function(e,t){return e.length!==t.length?!1:e.every(function(n){return t.includes(n)})},wl=function(e,t){return t.every(function(n){return e.includes(n)})},kl=function(e,t){return e.filter(function(n){return t.indexOf(n)<0})},xo=function(e,t){for(var n=Math.max(e.length,t.length),i=Le.Buffer.allocUnsafe(n),o=0;o<n;++o)i[o]=e[o]^t[o];return i};const bl=["string","number","bigint","symbol"],Dl=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function Cl(e){if(e===null)return"null";if(e===void 0)return"undefined";if(e===!0||e===!1)return"boolean";const t=typeof e;if(bl.includes(t))return t;if(t==="function")return"Function";if(Array.isArray(e))return"Array";if($l(e))return"Buffer";const n=Pl(e);return n||"Object"}function $l(e){return e&&e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer.call(null,e)}function Pl(e){const t=Object.prototype.toString.call(e).slice(8,-1);if(Dl.includes(t))return t}class L{constructor(t,n,i){this.major=t,this.majorEncoded=t<<5,this.name=n,this.terminal=i}toString(){return`Type[${this.major}].${this.name}`}compare(t){return this.major<t.major?-1:this.major>t.major?1:0}}L.uint=new L(0,"uint",!0);L.negint=new L(1,"negint",!0);L.bytes=new L(2,"bytes",!0);L.string=new L(3,"string",!0);L.array=new L(4,"array",!1);L.map=new L(5,"map",!1);L.tag=new L(6,"tag",!1);L.float=new L(7,"float",!0);L.false=new L(7,"false",!0);L.true=new L(7,"true",!0);L.null=new L(7,"null",!0);L.undefined=new L(7,"undefined",!0);L.break=new L(7,"break",!0);class ie{constructor(t,n,i){this.type=t,this.value=n,this.encodedLength=i,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}}const hn=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&typeof globalThis.Buffer.isBuffer=="function",Ml=new TextDecoder,ql=new TextEncoder;function zn(e){return hn&&globalThis.Buffer.isBuffer(e)}function Bo(e){return e instanceof Uint8Array?zn(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e:Uint8Array.from(e)}const Tl=hn?(e,t,n)=>n-t>64?globalThis.Buffer.from(e.subarray(t,n)).toString("utf8"):io(e,t,n):(e,t,n)=>n-t>64?Ml.decode(e.subarray(t,n)):io(e,t,n),Sl=hn?e=>e.length>64?globalThis.Buffer.from(e):no(e):e=>e.length>64?ql.encode(e):no(e),St=e=>Uint8Array.from(e),Ti=hn?(e,t,n)=>zn(e)?new Uint8Array(e.subarray(t,n)):e.slice(t,n):(e,t,n)=>e.slice(t,n),Il=hn?(e,t)=>(e=e.map(n=>n instanceof Uint8Array?n:globalThis.Buffer.from(n)),Bo(globalThis.Buffer.concat(e,t))):(e,t)=>{const n=new Uint8Array(t);let i=0;for(let o of e)i+o.length>n.length&&(o=o.subarray(0,n.length-i)),n.set(o,i),i+=o.length;return n},Al=hn?e=>globalThis.Buffer.allocUnsafe(e):e=>new Uint8Array(e);function El(e,t){if(zn(e)&&zn(t))return e.compare(t);for(let n=0;n<e.length;n++)if(e[n]!==t[n])return e[n]<t[n]?-1:1;return 0}function no(e){const t=[];let n=0;for(let i=0;i<e.length;i++){let o=e.charCodeAt(i);o<128?t[n++]=o:o<2048?(t[n++]=o>>6|192,t[n++]=o&63|128):(o&64512)===55296&&i+1<e.length&&(e.charCodeAt(i+1)&64512)===56320?(o=65536+((o&1023)<<10)+(e.charCodeAt(++i)&1023),t[n++]=o>>18|240,t[n++]=o>>12&63|128,t[n++]=o>>6&63|128,t[n++]=o&63|128):(t[n++]=o>>12|224,t[n++]=o>>6&63|128,t[n++]=o&63|128)}return t}function io(e,t,n){const i=[];for(;t<n;){const o=e[t];let s=null,a=o>239?4:o>223?3:o>191?2:1;if(t+a<=n){let c,l,m,h;switch(a){case 1:o<128&&(s=o);break;case 2:c=e[t+1],(c&192)===128&&(h=(o&31)<<6|c&63,h>127&&(s=h));break;case 3:c=e[t+1],l=e[t+2],(c&192)===128&&(l&192)===128&&(h=(o&15)<<12|(c&63)<<6|l&63,h>2047&&(h<55296||h>57343)&&(s=h));break;case 4:c=e[t+1],l=e[t+2],m=e[t+3],(c&192)===128&&(l&192)===128&&(m&192)===128&&(h=(o&15)<<18|(c&63)<<12|(l&63)<<6|m&63,h>65535&&h<1114112&&(s=h))}}s===null?(s=65533,a=1):s>65535&&(s-=65536,i.push(s>>>10&1023|55296),s=56320|s&1023),i.push(s),t+=a}return Rl(i)}const oo=4096;function Rl(e){const t=e.length;if(t<=oo)return String.fromCharCode.apply(String,e);let n="",i=0;for(;i<t;)n+=String.fromCharCode.apply(String,e.slice(i,i+=oo));return n}const Ul=256;class Lo{constructor(t=Ul){this.chunkSize=t,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),this._initReuseChunk!==null&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(t){let n=this.chunks[this.chunks.length-1];if(this.cursor+t.length<=this.maxCursor+1){const o=n.length-(this.maxCursor-this.cursor)-1;n.set(t,o)}else{if(n){const o=n.length-(this.maxCursor-this.cursor)-1;o<n.length&&(this.chunks[this.chunks.length-1]=n.subarray(0,o),this.maxCursor=this.cursor-1)}t.length<64&&t.length<this.chunkSize?(n=Al(this.chunkSize),this.chunks.push(n),this.maxCursor+=n.length,this._initReuseChunk===null&&(this._initReuseChunk=n),n.set(t,0)):(this.chunks.push(t),this.maxCursor+=t.length)}this.cursor+=t.length}toBytes(t=!1){let n;if(this.chunks.length===1){const i=this.chunks[0];t&&this.cursor>i.length/2?(n=this.cursor===i.length?i:i.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):n=Ti(i,0,this.cursor)}else n=Il(this.chunks,this.cursor);return t&&this.reset(),n}}const _e="CBOR decode error:",Fo="CBOR encode error:";function mn(e,t,n){if(e.length-t<n)throw new Error(`${_e} not enough data for type`)}const it=[24,256,65536,4294967296,BigInt("18446744073709551616")];function Jt(e,t,n){mn(e,t,1);const i=e[t];if(n.strict===!0&&i<it[0])throw new Error(`${_e} integer encoded in more bytes than necessary (strict decode)`);return i}function en(e,t,n){mn(e,t,2);const i=e[t]<<8|e[t+1];if(n.strict===!0&&i<it[1])throw new Error(`${_e} integer encoded in more bytes than necessary (strict decode)`);return i}function tn(e,t,n){mn(e,t,4);const i=e[t]*16777216+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3];if(n.strict===!0&&i<it[2])throw new Error(`${_e} integer encoded in more bytes than necessary (strict decode)`);return i}function nn(e,t,n){mn(e,t,8);const i=e[t]*16777216+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3],o=e[t+4]*16777216+(e[t+5]<<16)+(e[t+6]<<8)+e[t+7],s=(BigInt(i)<<BigInt(32))+BigInt(o);if(n.strict===!0&&s<it[3])throw new Error(`${_e} integer encoded in more bytes than necessary (strict decode)`);if(s<=Number.MAX_SAFE_INTEGER)return Number(s);if(n.allowBigInt===!0)return s;throw new Error(`${_e} integers outside of the safe integer range are not supported`)}function Nl(e,t,n,i){return new ie(L.uint,Jt(e,t+1,i),2)}function xl(e,t,n,i){return new ie(L.uint,en(e,t+1,i),3)}function Bl(e,t,n,i){return new ie(L.uint,tn(e,t+1,i),5)}function Ll(e,t,n,i){return new ie(L.uint,nn(e,t+1,i),9)}function on(e,t){return vt(e,0,t.value)}function vt(e,t,n){if(n<it[0]){const i=Number(n);e.push([t|i])}else if(n<it[1]){const i=Number(n);e.push([t|24,i])}else if(n<it[2]){const i=Number(n);e.push([t|25,i>>>8,i&255])}else if(n<it[3]){const i=Number(n);e.push([t|26,i>>>24&255,i>>>16&255,i>>>8&255,i&255])}else{const i=BigInt(n);if(i<it[4]){const o=[t|27,0,0,0,0,0,0,0];let s=Number(i&BigInt(4294967295)),a=Number(i>>BigInt(32)&BigInt(4294967295));o[8]=s&255,s=s>>8,o[7]=s&255,s=s>>8,o[6]=s&255,s=s>>8,o[5]=s&255,o[4]=a&255,a=a>>8,o[3]=a&255,a=a>>8,o[2]=a&255,a=a>>8,o[1]=a&255,e.push(o)}else throw new Error(`${_e} encountered BigInt larger than allowable range`)}}on.encodedSize=function(t){return vt.encodedSize(t.value)};vt.encodedSize=function(t){return t<it[0]?1:t<it[1]?2:t<it[2]?3:t<it[3]?5:9};on.compareTokens=function(t,n){return t.value<n.value?-1:t.value>n.value?1:0};function Fl(e,t,n,i){return new ie(L.negint,-1-Jt(e,t+1,i),2)}function Ol(e,t,n,i){return new ie(L.negint,-1-en(e,t+1,i),3)}function Vl(e,t,n,i){return new ie(L.negint,-1-tn(e,t+1,i),5)}const Si=BigInt(-1),Oo=BigInt(1);function zl(e,t,n,i){const o=nn(e,t+1,i);if(typeof o!="bigint"){const s=-1-o;if(s>=Number.MIN_SAFE_INTEGER)return new ie(L.negint,s,9)}if(i.allowBigInt!==!0)throw new Error(`${_e} integers outside of the safe integer range are not supported`);return new ie(L.negint,Si-BigInt(o),9)}function Ii(e,t){const n=t.value,i=typeof n=="bigint"?n*Si-Oo:n*-1-1;vt(e,t.type.majorEncoded,i)}Ii.encodedSize=function(t){const n=t.value,i=typeof n=="bigint"?n*Si-Oo:n*-1-1;return i<it[0]?1:i<it[1]?2:i<it[2]?3:i<it[3]?5:9};Ii.compareTokens=function(t,n){return t.value<n.value?1:t.value>n.value?-1:0};function qn(e,t,n,i){mn(e,t,n+i);const o=Ti(e,t+n,t+n+i);return new ie(L.bytes,o,n+i)}function Wl(e,t,n,i){return qn(e,t,1,n)}function jl(e,t,n,i){return qn(e,t,2,Jt(e,t+1,i))}function Ql(e,t,n,i){return qn(e,t,3,en(e,t+1,i))}function Kl(e,t,n,i){return qn(e,t,5,tn(e,t+1,i))}function Hl(e,t,n,i){const o=nn(e,t+1,i);if(typeof o=="bigint")throw new Error(`${_e} 64-bit integer bytes lengths not supported`);return qn(e,t,9,o)}function Wn(e){return e.encodedBytes===void 0&&(e.encodedBytes=e.type===L.string?Sl(e.value):e.value),e.encodedBytes}function Jn(e,t){const n=Wn(t);vt(e,t.type.majorEncoded,n.length),e.push(n)}Jn.encodedSize=function(t){const n=Wn(t);return vt.encodedSize(n.length)+n.length};Jn.compareTokens=function(t,n){return Gl(Wn(t),Wn(n))};function Gl(e,t){return e.length<t.length?-1:e.length>t.length?1:El(e,t)}function Tn(e,t,n,i,o){const s=n+i;mn(e,t,s);const a=new ie(L.string,Tl(e,t+n,t+s),s);return o.retainStringBytes===!0&&(a.byteValue=Ti(e,t+n,t+s)),a}function Xl(e,t,n,i){return Tn(e,t,1,n,i)}function Zl(e,t,n,i){return Tn(e,t,2,Jt(e,t+1,i),i)}function Yl(e,t,n,i){return Tn(e,t,3,en(e,t+1,i),i)}function Jl(e,t,n,i){return Tn(e,t,5,tn(e,t+1,i),i)}function ec(e,t,n,i){const o=nn(e,t+1,i);if(typeof o=="bigint")throw new Error(`${_e} 64-bit integer string lengths not supported`);return Tn(e,t,9,o,i)}const tc=Jn;function gn(e,t,n,i){return new ie(L.array,i,n)}function nc(e,t,n,i){return gn(e,t,1,n)}function ic(e,t,n,i){return gn(e,t,2,Jt(e,t+1,i))}function oc(e,t,n,i){return gn(e,t,3,en(e,t+1,i))}function sc(e,t,n,i){return gn(e,t,5,tn(e,t+1,i))}function ac(e,t,n,i){const o=nn(e,t+1,i);if(typeof o=="bigint")throw new Error(`${_e} 64-bit integer array lengths not supported`);return gn(e,t,9,o)}function rc(e,t,n,i){if(i.allowIndefinite===!1)throw new Error(`${_e} indefinite length items not allowed`);return gn(e,t,1,1/0)}function Ai(e,t){vt(e,L.array.majorEncoded,t.value)}Ai.compareTokens=on.compareTokens;Ai.encodedSize=function(t){return vt.encodedSize(t.value)};function pn(e,t,n,i){return new ie(L.map,i,n)}function lc(e,t,n,i){return pn(e,t,1,n)}function cc(e,t,n,i){return pn(e,t,2,Jt(e,t+1,i))}function uc(e,t,n,i){return pn(e,t,3,en(e,t+1,i))}function dc(e,t,n,i){return pn(e,t,5,tn(e,t+1,i))}function fc(e,t,n,i){const o=nn(e,t+1,i);if(typeof o=="bigint")throw new Error(`${_e} 64-bit integer map lengths not supported`);return pn(e,t,9,o)}function hc(e,t,n,i){if(i.allowIndefinite===!1)throw new Error(`${_e} indefinite length items not allowed`);return pn(e,t,1,1/0)}function Ei(e,t){vt(e,L.map.majorEncoded,t.value)}Ei.compareTokens=on.compareTokens;Ei.encodedSize=function(t){return vt.encodedSize(t.value)};function mc(e,t,n,i){return new ie(L.tag,n,1)}function gc(e,t,n,i){return new ie(L.tag,Jt(e,t+1,i),2)}function pc(e,t,n,i){return new ie(L.tag,en(e,t+1,i),3)}function vc(e,t,n,i){return new ie(L.tag,tn(e,t+1,i),5)}function yc(e,t,n,i){return new ie(L.tag,nn(e,t+1,i),9)}function Ri(e,t){vt(e,L.tag.majorEncoded,t.value)}Ri.compareTokens=on.compareTokens;Ri.encodedSize=function(t){return vt.encodedSize(t.value)};const _c=20,wc=21,kc=22,bc=23;function Dc(e,t,n,i){if(i.allowUndefined===!1)throw new Error(`${_e} undefined values are not supported`);return i.coerceUndefinedToNull===!0?new ie(L.null,null,1):new ie(L.undefined,void 0,1)}function Cc(e,t,n,i){if(i.allowIndefinite===!1)throw new Error(`${_e} indefinite length items not allowed`);return new ie(L.break,void 0,1)}function Ui(e,t,n){if(n){if(n.allowNaN===!1&&Number.isNaN(e))throw new Error(`${_e} NaN values are not supported`);if(n.allowInfinity===!1&&(e===1/0||e===-1/0))throw new Error(`${_e} Infinity values are not supported`)}return new ie(L.float,e,t)}function $c(e,t,n,i){return Ui(xi(e,t+1),3,i)}function Pc(e,t,n,i){return Ui(Bi(e,t+1),5,i)}function Mc(e,t,n,i){return Ui(jo(e,t+1),9,i)}function Ni(e,t,n){const i=t.value;if(i===!1)e.push([L.float.majorEncoded|_c]);else if(i===!0)e.push([L.float.majorEncoded|wc]);else if(i===null)e.push([L.float.majorEncoded|kc]);else if(i===void 0)e.push([L.float.majorEncoded|bc]);else{let o,s=!1;(!n||n.float64!==!0)&&(zo(i),o=xi(kt,1),i===o||Number.isNaN(i)?(kt[0]=249,e.push(kt.slice(0,3)),s=!0):(Wo(i),o=Bi(kt,1),i===o&&(kt[0]=250,e.push(kt.slice(0,5)),s=!0))),s||(qc(i),o=jo(kt,1),kt[0]=251,e.push(kt.slice(0,9)))}}Ni.encodedSize=function(t,n){const i=t.value;if(i===!1||i===!0||i===null||i===void 0)return 1;if(!n||n.float64!==!0){zo(i);let o=xi(kt,1);if(i===o||Number.isNaN(i))return 3;if(Wo(i),o=Bi(kt,1),i===o)return 5}return 9};const Vo=new ArrayBuffer(9),gt=new DataView(Vo,1),kt=new Uint8Array(Vo,0);function zo(e){if(e===1/0)gt.setUint16(0,31744,!1);else if(e===-1/0)gt.setUint16(0,64512,!1);else if(Number.isNaN(e))gt.setUint16(0,32256,!1);else{gt.setFloat32(0,e);const t=gt.getUint32(0),n=(t&2139095040)>>23,i=t&8388607;if(n===255)gt.setUint16(0,31744,!1);else if(n===0)gt.setUint16(0,(e&2147483648)>>16|i>>13,!1);else{const o=n-127;o<-24?gt.setUint16(0,0):o<-14?gt.setUint16(0,(t&2147483648)>>16|1<<24+o,!1):gt.setUint16(0,(t&2147483648)>>16|o+15<<10|i>>13,!1)}}}function xi(e,t){if(e.length-t<2)throw new Error(`${_e} not enough data for float16`);const n=(e[t]<<8)+e[t+1];if(n===31744)return 1/0;if(n===64512)return-1/0;if(n===32256)return NaN;const i=n>>10&31,o=n&1023;let s;return i===0?s=o*2**-24:i!==31?s=(o+1024)*2**(i-25):s=o===0?1/0:NaN,n&32768?-s:s}function Wo(e){gt.setFloat32(0,e,!1)}function Bi(e,t){if(e.length-t<4)throw new Error(`${_e} not enough data for float32`);const n=(e.byteOffset||0)+t;return new DataView(e.buffer,n,4).getFloat32(0,!1)}function qc(e){gt.setFloat64(0,e,!1)}function jo(e,t){if(e.length-t<8)throw new Error(`${_e} not enough data for float64`);const n=(e.byteOffset||0)+t;return new DataView(e.buffer,n,8).getFloat64(0,!1)}Ni.compareTokens=on.compareTokens;function Pe(e,t,n){throw new Error(`${_e} encountered invalid minor (${n}) for major ${e[t]>>>5}`)}function ei(e){return()=>{throw new Error(`${_e} ${e}`)}}const H=[];for(let e=0;e<=23;e++)H[e]=Pe;H[24]=Nl;H[25]=xl;H[26]=Bl;H[27]=Ll;H[28]=Pe;H[29]=Pe;H[30]=Pe;H[31]=Pe;for(let e=32;e<=55;e++)H[e]=Pe;H[56]=Fl;H[57]=Ol;H[58]=Vl;H[59]=zl;H[60]=Pe;H[61]=Pe;H[62]=Pe;H[63]=Pe;for(let e=64;e<=87;e++)H[e]=Wl;H[88]=jl;H[89]=Ql;H[90]=Kl;H[91]=Hl;H[92]=Pe;H[93]=Pe;H[94]=Pe;H[95]=ei("indefinite length bytes/strings are not supported");for(let e=96;e<=119;e++)H[e]=Xl;H[120]=Zl;H[121]=Yl;H[122]=Jl;H[123]=ec;H[124]=Pe;H[125]=Pe;H[126]=Pe;H[127]=ei("indefinite length bytes/strings are not supported");for(let e=128;e<=151;e++)H[e]=nc;H[152]=ic;H[153]=oc;H[154]=sc;H[155]=ac;H[156]=Pe;H[157]=Pe;H[158]=Pe;H[159]=rc;for(let e=160;e<=183;e++)H[e]=lc;H[184]=cc;H[185]=uc;H[186]=dc;H[187]=fc;H[188]=Pe;H[189]=Pe;H[190]=Pe;H[191]=hc;for(let e=192;e<=215;e++)H[e]=mc;H[216]=gc;H[217]=pc;H[218]=vc;H[219]=yc;H[220]=Pe;H[221]=Pe;H[222]=Pe;H[223]=Pe;for(let e=224;e<=243;e++)H[e]=ei("simple values are not supported");H[244]=Pe;H[245]=Pe;H[246]=Pe;H[247]=Dc;H[248]=ei("simple values are not supported");H[249]=$c;H[250]=Pc;H[251]=Mc;H[252]=Pe;H[253]=Pe;H[254]=Pe;H[255]=Cc;const Tt=[];for(let e=0;e<24;e++)Tt[e]=new ie(L.uint,e,1);for(let e=-1;e>=-24;e--)Tt[31-e]=new ie(L.negint,e,1);Tt[64]=new ie(L.bytes,new Uint8Array(0),1);Tt[96]=new ie(L.string,"",1);Tt[128]=new ie(L.array,0,1);Tt[160]=new ie(L.map,0,1);Tt[244]=new ie(L.false,!1,1);Tt[245]=new ie(L.true,!0,1);Tt[246]=new ie(L.null,null,1);function Tc(e){switch(e.type){case L.false:return St([244]);case L.true:return St([245]);case L.null:return St([246]);case L.bytes:return e.value.length?void 0:St([64]);case L.string:return e.value===""?St([96]):void 0;case L.array:return e.value===0?St([128]):void 0;case L.map:return e.value===0?St([160]):void 0;case L.uint:return e.value<24?St([Number(e.value)]):void 0;case L.negint:if(e.value>=-24)return St([31-Number(e.value)])}}const Sc={float64:!1,mapSorter:Ec,quickEncodeToken:Tc};function Ic(){const e=[];return e[L.uint.major]=on,e[L.negint.major]=Ii,e[L.bytes.major]=Jn,e[L.string.major]=tc,e[L.array.major]=Ai,e[L.map.major]=Ei,e[L.tag.major]=Ri,e[L.float.major]=Ni,e}const Qo=Ic(),di=new Lo;class jn{constructor(t,n){this.obj=t,this.parent=n}includes(t){let n=this;do if(n.obj===t)return!0;while(n=n.parent);return!1}static createCheck(t,n){if(t&&t.includes(n))throw new Error(`${Fo} object contains circular references`);return new jn(n,t)}}const Bt={null:new ie(L.null,null),undefined:new ie(L.undefined,void 0),true:new ie(L.true,!0),false:new ie(L.false,!1),emptyArray:new ie(L.array,0),emptyMap:new ie(L.map,0)},Qt={number(e,t,n,i){return!Number.isInteger(e)||!Number.isSafeInteger(e)?new ie(L.float,e):e>=0?new ie(L.uint,e):new ie(L.negint,e)},bigint(e,t,n,i){return e>=BigInt(0)?new ie(L.uint,e):new ie(L.negint,e)},Uint8Array(e,t,n,i){return new ie(L.bytes,e)},string(e,t,n,i){return new ie(L.string,e)},boolean(e,t,n,i){return e?Bt.true:Bt.false},null(e,t,n,i){return Bt.null},undefined(e,t,n,i){return Bt.undefined},ArrayBuffer(e,t,n,i){return new ie(L.bytes,new Uint8Array(e))},DataView(e,t,n,i){return new ie(L.bytes,new Uint8Array(e.buffer,e.byteOffset,e.byteLength))},Array(e,t,n,i){if(!e.length)return n.addBreakTokens===!0?[Bt.emptyArray,new ie(L.break)]:Bt.emptyArray;i=jn.createCheck(i,e);const o=[];let s=0;for(const a of e)o[s++]=Fn(a,n,i);return n.addBreakTokens?[new ie(L.array,e.length),o,new ie(L.break)]:[new ie(L.array,e.length),o]},Object(e,t,n,i){const o=t!=="Object",s=o?e.keys():Object.keys(e),a=o?e.size:s.length;if(!a)return n.addBreakTokens===!0?[Bt.emptyMap,new ie(L.break)]:Bt.emptyMap;i=jn.createCheck(i,e);const c=[];let l=0;for(const m of s)c[l++]=[Fn(m,n,i),Fn(o?e.get(m):e[m],n,i)];return Ac(c,n),n.addBreakTokens?[new ie(L.map,a),c,new ie(L.break)]:[new ie(L.map,a),c]}};Qt.Map=Qt.Object;Qt.Buffer=Qt.Uint8Array;for(const e of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))Qt[`${e}Array`]=Qt.DataView;function Fn(e,t={},n){const i=Cl(e),o=t&&t.typeEncoders&&t.typeEncoders[i]||Qt[i];if(typeof o=="function"){const a=o(e,i,t,n);if(a!=null)return a}const s=Qt[i];if(!s)throw new Error(`${Fo} unsupported type: ${i}`);return s(e,i,t,n)}function Ac(e,t){t.mapSorter&&e.sort(t.mapSorter)}function Ec(e,t){const n=Array.isArray(e[0])?e[0][0]:e[0],i=Array.isArray(t[0])?t[0][0]:t[0];if(n.type!==i.type)return n.type.compare(i.type);const o=n.type.major,s=Qo[o].compareTokens(n,i);return s===0&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone"),s}function Ko(e,t,n,i){if(Array.isArray(t))for(const o of t)Ko(e,o,n,i);else n[t.type.major](e,t,i)}function Rc(e,t,n){const i=Fn(e,n);if(!Array.isArray(i)&&n.quickEncodeToken){const o=n.quickEncodeToken(i);if(o)return o;const s=t[i.type.major];if(s.encodedSize){const a=s.encodedSize(i,n),c=new Lo(a);if(s(c,i,n),c.chunks.length!==1)throw new Error(`Unexpected error: pre-calculated length for ${i} was wrong`);return Bo(c.chunks[0])}}return di.reset(),Ko(di,i,t,n),di.toBytes(!0)}function Uc(e,t){return t=Object.assign({},Sc,t),Rc(e,Qo,t)}const Nc={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0};class xc{constructor(t,n={}){this._pos=0,this.data=t,this.options=n}pos(){return this._pos}done(){return this._pos>=this.data.length}next(){const t=this.data[this._pos];let n=Tt[t];if(n===void 0){const i=H[t];if(!i)throw new Error(`${_e} no decoder for major type ${t>>>5} (byte 0x${t.toString(16).padStart(2,"0")})`);const o=t&31;n=i(this.data,this._pos,o,this.options)}return this._pos+=n.encodedLength,n}}const bn=Symbol.for("DONE"),ti=Symbol.for("BREAK");function Bc(e,t,n){const i=[];for(let o=0;o<e.value;o++){const s=Dn(t,n);if(s===ti){if(e.value===1/0)break;throw new Error(`${_e} got unexpected break to lengthed array`)}if(s===bn)throw new Error(`${_e} found array but not enough entries (got ${o}, expected ${e.value})`);i[o]=s}return i}function Lc(e,t,n){const i=n.useMaps===!0,o=i?void 0:{},s=i?new Map:void 0;for(let a=0;a<e.value;a++){const c=Dn(t,n);if(c===ti){if(e.value===1/0)break;throw new Error(`${_e} got unexpected break to lengthed map`)}if(c===bn)throw new Error(`${_e} found map but not enough entries (got ${a} [no key], expected ${e.value})`);if(i!==!0&&typeof c!="string")throw new Error(`${_e} non-string keys not supported (got ${typeof c})`);if(n.rejectDuplicateMapKeys===!0&&(i&&s.has(c)||!i&&c in o))throw new Error(`${_e} found repeat map key "${c}"`);const l=Dn(t,n);if(l===bn)throw new Error(`${_e} found map but not enough entries (got ${a} [no value], expected ${e.value})`);i?s.set(c,l):o[c]=l}return i?s:o}function Dn(e,t){if(e.done())return bn;const n=e.next();if(n.type===L.break)return ti;if(n.type.terminal)return n.value;if(n.type===L.array)return Bc(n,e,t);if(n.type===L.map)return Lc(n,e,t);if(n.type===L.tag){if(t.tags&&typeof t.tags[n.value]=="function"){const i=Dn(e,t);return t.tags[n.value](i)}throw new Error(`${_e} tag not supported (${n.value})`)}throw new Error("unsupported")}function Fc(e,t){if(!(e instanceof Uint8Array))throw new Error(`${_e} data to decode must be a Uint8Array`);t=Object.assign({},Nc,t);const n=t.tokenizer||new xc(e,t),i=Dn(n,t);if(i===bn)throw new Error(`${_e} did not find any content to decode`);if(i===ti)throw new Error(`${_e} got unexpected break`);return[i,e.subarray(n.pos())]}function Oc(e,t){const[n,i]=Fc(e,t);if(i.length>0)throw new Error(`${_e} too many terminals, data makes no sense`);return n}var Ho=function(e){return Le.Buffer.from(Uc(e))},Go=function(e){return Oc(Le.Buffer.isBuffer(e)?e:Le.Buffer.from(e,"hex"))},On=function(){function e(t,n){if(n===void 0&&(n="bytes"),this._cborPayload=t,this._type=n,!Ln(this._type))throw new Ao}return e.fromBuffer=function(t){return new e(Ho(t))},e.from=function(t){return e.fromBuffer(Le.Buffer.from(t))},e.prototype.decodeCBOR=function(){return Go(this._cborPayload)},Object.defineProperty(e.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cbor",{get:function(){return this._cborPayload},enumerable:!1,configurable:!0}),e.prototype.equals=function(t){return this.type===t.type&&this.cbor.equals(t.cbor)},e}(),Vc=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,fi=Math.ceil,ht=Math.floor,rt="[BigNumber Error] ",so=rt+"Number primitive has more than 15 significant digits: ",wt=1e14,de=14,hi=9007199254740991,mi=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],Lt=1e7,Xe=1e9;function Xo(e){var t,n,i,o=E.prototype={constructor:E,toString:null,valueOf:null},s=new E(1),a=20,c=4,l=-7,m=21,h=-1e7,w=1e7,y=!1,P=1,A=0,U={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"\xA0",suffix:""},j="0123456789abcdefghijklmnopqrstuvwxyz",K=!0;function E(d,p){var v,T,D,k,$,b,C,S,q=this;if(!(q instanceof E))return new E(d,p);if(p==null){if(d&&d._isBigNumber===!0){q.s=d.s,!d.c||d.e>w?q.c=q.e=null:d.e<h?q.c=[q.e=0]:(q.e=d.e,q.c=d.c.slice());return}if((b=typeof d=="number")&&d*0==0){if(q.s=1/d<0?(d=-d,-1):1,d===~~d){for(k=0,$=d;$>=10;$/=10,k++);k>w?q.c=q.e=null:(q.e=k,q.c=[d]);return}S=String(d)}else{if(!Vc.test(S=String(d)))return i(q,S,b);q.s=S.charCodeAt(0)==45?(S=S.slice(1),-1):1}(k=S.indexOf("."))>-1&&(S=S.replace(".","")),($=S.search(/e/i))>0?(k<0&&(k=$),k+=+S.slice($+1),S=S.substring(0,$)):k<0&&(k=S.length)}else{if(Ve(p,2,j.length,"Base"),p==10&&K)return q=new E(d),ce(q,a+q.e+1,c);if(S=String(d),b=typeof d=="number"){if(d*0!=0)return i(q,S,b,p);if(q.s=1/d<0?(S=S.slice(1),-1):1,E.DEBUG&&S.replace(/^0\.0*|\./,"").length>15)throw Error(so+d)}else q.s=S.charCodeAt(0)===45?(S=S.slice(1),-1):1;for(v=j.slice(0,p),k=$=0,C=S.length;$<C;$++)if(v.indexOf(T=S.charAt($))<0){if(T=="."){if($>k){k=C;continue}}else if(!D&&(S==S.toUpperCase()&&(S=S.toLowerCase())||S==S.toLowerCase()&&(S=S.toUpperCase()))){D=!0,$=-1,k=0;continue}return i(q,String(d),b,p)}b=!1,S=n(S,p,10,q.s),(k=S.indexOf("."))>-1?S=S.replace(".",""):k=S.length}for($=0;S.charCodeAt($)===48;$++);for(C=S.length;S.charCodeAt(--C)===48;);if(S=S.slice($,++C)){if(C-=$,b&&E.DEBUG&&C>15&&(d>hi||d!==ht(d)))throw Error(so+q.s*d);if((k=k-$-1)>w)q.c=q.e=null;else if(k<h)q.c=[q.e=0];else{if(q.e=k,q.c=[],$=(k+1)%de,k<0&&($+=de),$<C){for($&&q.c.push(+S.slice(0,$)),C-=de;$<C;)q.c.push(+S.slice($,$+=de));$=de-(S=S.slice($)).length}else $-=C;for(;$--;S+="0");q.c.push(+S)}}else q.c=[q.e=0]}E.clone=Xo,E.ROUND_UP=0,E.ROUND_DOWN=1,E.ROUND_CEIL=2,E.ROUND_FLOOR=3,E.ROUND_HALF_UP=4,E.ROUND_HALF_DOWN=5,E.ROUND_HALF_EVEN=6,E.ROUND_HALF_CEIL=7,E.ROUND_HALF_FLOOR=8,E.EUCLID=9,E.config=E.set=function(d){var p,v;if(d!=null)if(typeof d=="object"){if(d.hasOwnProperty(p="DECIMAL_PLACES")&&(v=d[p],Ve(v,0,Xe,p),a=v),d.hasOwnProperty(p="ROUNDING_MODE")&&(v=d[p],Ve(v,0,8,p),c=v),d.hasOwnProperty(p="EXPONENTIAL_AT")&&(v=d[p],v&&v.pop?(Ve(v[0],-Xe,0,p),Ve(v[1],0,Xe,p),l=v[0],m=v[1]):(Ve(v,-Xe,Xe,p),l=-(m=v<0?-v:v))),d.hasOwnProperty(p="RANGE"))if(v=d[p],v&&v.pop)Ve(v[0],-Xe,-1,p),Ve(v[1],1,Xe,p),h=v[0],w=v[1];else if(Ve(v,-Xe,Xe,p),v)h=-(w=v<0?-v:v);else throw Error(rt+p+" cannot be zero: "+v);if(d.hasOwnProperty(p="CRYPTO"))if(v=d[p],v===!!v)if(v)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))y=v;else throw y=!v,Error(rt+"crypto unavailable");else y=v;else throw Error(rt+p+" not true or false: "+v);if(d.hasOwnProperty(p="MODULO_MODE")&&(v=d[p],Ve(v,0,9,p),P=v),d.hasOwnProperty(p="POW_PRECISION")&&(v=d[p],Ve(v,0,Xe,p),A=v),d.hasOwnProperty(p="FORMAT"))if(v=d[p],typeof v=="object")U=v;else throw Error(rt+p+" not an object: "+v);if(d.hasOwnProperty(p="ALPHABET"))if(v=d[p],typeof v=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(v))K=v.slice(0,10)=="0123456789",j=v;else throw Error(rt+p+" invalid: "+v)}else throw Error(rt+"Object expected: "+d);return{DECIMAL_PLACES:a,ROUNDING_MODE:c,EXPONENTIAL_AT:[l,m],RANGE:[h,w],CRYPTO:y,MODULO_MODE:P,POW_PRECISION:A,FORMAT:U,ALPHABET:j}},E.isBigNumber=function(d){if(!d||d._isBigNumber!==!0)return!1;if(!E.DEBUG)return!0;var p,v,T=d.c,D=d.e,k=d.s;e:if({}.toString.call(T)=="[object Array]"){if((k===1||k===-1)&&D>=-Xe&&D<=Xe&&D===ht(D)){if(T[0]===0){if(D===0&&T.length===1)return!0;break e}if(p=(D+1)%de,p<1&&(p+=de),String(T[0]).length==p){for(p=0;p<T.length;p++)if(v=T[p],v<0||v>=wt||v!==ht(v))break e;if(v!==0)return!0}}}else if(T===null&&D===null&&(k===null||k===1||k===-1))return!0;throw Error(rt+"Invalid BigNumber: "+d)},E.maximum=E.max=function(){return X(arguments,-1)},E.minimum=E.min=function(){return X(arguments,1)},E.random=function(){var d=9007199254740992,p=Math.random()*d&2097151?function(){return ht(Math.random()*d)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(v){var T,D,k,$,b,C=0,S=[],q=new E(s);if(v==null?v=a:Ve(v,0,Xe),$=fi(v/de),y)if(crypto.getRandomValues){for(T=crypto.getRandomValues(new Uint32Array($*=2));C<$;)b=T[C]*131072+(T[C+1]>>>11),b>=9e15?(D=crypto.getRandomValues(new Uint32Array(2)),T[C]=D[0],T[C+1]=D[1]):(S.push(b%1e14),C+=2);C=$/2}else if(crypto.randomBytes){for(T=crypto.randomBytes($*=7);C<$;)b=(T[C]&31)*281474976710656+T[C+1]*1099511627776+T[C+2]*4294967296+T[C+3]*16777216+(T[C+4]<<16)+(T[C+5]<<8)+T[C+6],b>=9e15?crypto.randomBytes(7).copy(T,C):(S.push(b%1e14),C+=7);C=$/7}else throw y=!1,Error(rt+"crypto unavailable");if(!y)for(;C<$;)b=p(),b<9e15&&(S[C++]=b%1e14);for($=S[--C],v%=de,$&&v&&(b=mi[de-v],S[C]=ht($/b)*b);S[C]===0;S.pop(),C--);if(C<0)S=[k=0];else{for(k=-1;S[0]===0;S.splice(0,1),k-=de);for(C=1,b=S[0];b>=10;b/=10,C++);C<de&&(k-=de-C)}return q.e=k,q.c=S,q}}(),E.sum=function(){for(var d=1,p=arguments,v=new E(p[0]);d<p.length;)v=v.plus(p[d++]);return v},n=function(){var d="0123456789";function p(v,T,D,k){for(var $,b=[0],C,S=0,q=v.length;S<q;){for(C=b.length;C--;b[C]*=T);for(b[0]+=k.indexOf(v.charAt(S++)),$=0;$<b.length;$++)b[$]>D-1&&(b[$+1]==null&&(b[$+1]=0),b[$+1]+=b[$]/D|0,b[$]%=D)}return b.reverse()}return function(v,T,D,k,$){var b,C,S,q,N,ee,Z,ue,qe=v.indexOf("."),Ee=a,me=c;for(qe>=0&&(q=A,A=0,v=v.replace(".",""),ue=new E(T),ee=ue.pow(v.length-qe),A=q,ue.c=p(It(ft(ee.c),ee.e,"0"),10,D,d),ue.e=ue.c.length),Z=p(v,T,D,$?(b=j,d):(b=d,j)),S=q=Z.length;Z[--q]==0;Z.pop());if(!Z[0])return b.charAt(0);if(qe<0?--S:(ee.c=Z,ee.e=S,ee.s=k,ee=t(ee,ue,Ee,me,D),Z=ee.c,N=ee.r,S=ee.e),C=S+Ee+1,qe=Z[C],q=D/2,N=N||C<0||Z[C+1]!=null,N=me<4?(qe!=null||N)&&(me==0||me==(ee.s<0?3:2)):qe>q||qe==q&&(me==4||N||me==6&&Z[C-1]&1||me==(ee.s<0?8:7)),C<1||!Z[0])v=N?It(b.charAt(1),-Ee,b.charAt(0)):b.charAt(0);else{if(Z.length=C,N)for(--D;++Z[--C]>D;)Z[C]=0,C||(++S,Z=[1].concat(Z));for(q=Z.length;!Z[--q];);for(qe=0,v="";qe<=q;v+=b.charAt(Z[qe++]));v=It(v,S,b.charAt(0))}return v}}(),t=function(){function d(T,D,k){var $,b,C,S,q=0,N=T.length,ee=D%Lt,Z=D/Lt|0;for(T=T.slice();N--;)C=T[N]%Lt,S=T[N]/Lt|0,$=Z*C+S*ee,b=ee*C+$%Lt*Lt+q,q=(b/k|0)+($/Lt|0)+Z*S,T[N]=b%k;return q&&(T=[q].concat(T)),T}function p(T,D,k,$){var b,C;if(k!=$)C=k>$?1:-1;else for(b=C=0;b<k;b++)if(T[b]!=D[b]){C=T[b]>D[b]?1:-1;break}return C}function v(T,D,k,$){for(var b=0;k--;)T[k]-=b,b=T[k]<D[k]?1:0,T[k]=b*$+T[k]-D[k];for(;!T[0]&&T.length>1;T.splice(0,1));}return function(T,D,k,$,b){var C,S,q,N,ee,Z,ue,qe,Ee,me,fe,We,Mt,qt,ut,Ge,yt,He=T.s==D.s?1:-1,V=T.c,Y=D.c;if(!V||!V[0]||!Y||!Y[0])return new E(!T.s||!D.s||(V?Y&&V[0]==Y[0]:!Y)?NaN:V&&V[0]==0||!Y?He*0:He/0);for(qe=new E(He),Ee=qe.c=[],S=T.e-D.e,He=k+S+1,b||(b=wt,S=mt(T.e/de)-mt(D.e/de),He=He/de|0),q=0;Y[q]==(V[q]||0);q++);if(Y[q]>(V[q]||0)&&S--,He<0)Ee.push(1),N=!0;else{for(qt=V.length,Ge=Y.length,q=0,He+=2,ee=ht(b/(Y[0]+1)),ee>1&&(Y=d(Y,ee,b),V=d(V,ee,b),Ge=Y.length,qt=V.length),Mt=Ge,me=V.slice(0,Ge),fe=me.length;fe<Ge;me[fe++]=0);yt=Y.slice(),yt=[0].concat(yt),ut=Y[0],Y[1]>=b/2&&ut++;do{if(ee=0,C=p(Y,me,Ge,fe),C<0){if(We=me[0],Ge!=fe&&(We=We*b+(me[1]||0)),ee=ht(We/ut),ee>1)for(ee>=b&&(ee=b-1),Z=d(Y,ee,b),ue=Z.length,fe=me.length;p(Z,me,ue,fe)==1;)ee--,v(Z,Ge<ue?yt:Y,ue,b),ue=Z.length,C=1;else ee==0&&(C=ee=1),Z=Y.slice(),ue=Z.length;if(ue<fe&&(Z=[0].concat(Z)),v(me,Z,fe,b),fe=me.length,C==-1)for(;p(Y,me,Ge,fe)<1;)ee++,v(me,Ge<fe?yt:Y,fe,b),fe=me.length}else C===0&&(ee++,me=[0]);Ee[q++]=ee,me[0]?me[fe++]=V[Mt]||0:(me=[V[Mt]],fe=1)}while((Mt++<qt||me[0]!=null)&&He--);N=me[0]!=null,Ee[0]||Ee.splice(0,1)}if(b==wt){for(q=1,He=Ee[0];He>=10;He/=10,q++);ce(qe,k+(qe.e=q+S*de-1)+1,$,N)}else qe.e=S,qe.r=+N;return qe}}();function O(d,p,v,T){var D,k,$,b,C;if(v==null?v=c:Ve(v,0,8),!d.c)return d.toString();if(D=d.c[0],$=d.e,p==null)C=ft(d.c),C=T==1||T==2&&($<=l||$>=m)?Un(C,$):It(C,$,"0");else if(d=ce(new E(d),p,v),k=d.e,C=ft(d.c),b=C.length,T==1||T==2&&(p<=k||k<=l)){for(;b<p;C+="0",b++);C=Un(C,k)}else if(p-=$,C=It(C,k,"0"),k+1>b){if(--p>0)for(C+=".";p--;C+="0");}else if(p+=k-b,p>0)for(k+1==b&&(C+=".");p--;C+="0");return d.s<0&&D?"-"+C:C}function X(d,p){for(var v,T,D=1,k=new E(d[0]);D<d.length;D++)T=new E(d[D]),(!T.s||(v=Kt(k,T))===p||v===0&&k.s===p)&&(k=T);return k}function ae(d,p,v){for(var T=1,D=p.length;!p[--D];p.pop());for(D=p[0];D>=10;D/=10,T++);return(v=T+v*de-1)>w?d.c=d.e=null:v<h?d.c=[d.e=0]:(d.e=v,d.c=p),d}i=function(){var d=/^(-?)0([xbo])(?=\w[\w.]*$)/i,p=/^([^.]+)\.$/,v=/^\.([^.]+)$/,T=/^-?(Infinity|NaN)$/,D=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(k,$,b,C){var S,q=b?$:$.replace(D,"");if(T.test(q))k.s=isNaN(q)?null:q<0?-1:1;else{if(!b&&(q=q.replace(d,function(N,ee,Z){return S=(Z=Z.toLowerCase())=="x"?16:Z=="b"?2:8,!C||C==S?ee:N}),C&&(S=C,q=q.replace(p,"$1").replace(v,"0.$1")),$!=q))return new E(q,S);if(E.DEBUG)throw Error(rt+"Not a"+(C?" base "+C:"")+" number: "+$);k.s=null}k.c=k.e=null}}();function ce(d,p,v,T){var D,k,$,b,C,S,q,N=d.c,ee=mi;if(N){e:{for(D=1,b=N[0];b>=10;b/=10,D++);if(k=p-D,k<0)k+=de,$=p,C=N[S=0],q=ht(C/ee[D-$-1]%10);else if(S=fi((k+1)/de),S>=N.length)if(T){for(;N.length<=S;N.push(0));C=q=0,D=1,k%=de,$=k-de+1}else break e;else{for(C=b=N[S],D=1;b>=10;b/=10,D++);k%=de,$=k-de+D,q=$<0?0:ht(C/ee[D-$-1]%10)}if(T=T||p<0||N[S+1]!=null||($<0?C:C%ee[D-$-1]),T=v<4?(q||T)&&(v==0||v==(d.s<0?3:2)):q>5||q==5&&(v==4||T||v==6&&(k>0?$>0?C/ee[D-$]:0:N[S-1])%10&1||v==(d.s<0?8:7)),p<1||!N[0])return N.length=0,T?(p-=d.e+1,N[0]=ee[(de-p%de)%de],d.e=-p||0):N[0]=d.e=0,d;if(k==0?(N.length=S,b=1,S--):(N.length=S+1,b=ee[de-k],N[S]=$>0?ht(C/ee[D-$]%ee[$])*b:0),T)for(;;)if(S==0){for(k=1,$=N[0];$>=10;$/=10,k++);for($=N[0]+=b,b=1;$>=10;$/=10,b++);k!=b&&(d.e++,N[0]==wt&&(N[0]=1));break}else{if(N[S]+=b,N[S]!=wt)break;N[S--]=0,b=1}for(k=N.length;N[--k]===0;N.pop());}d.e>w?d.c=d.e=null:d.e<h&&(d.c=[d.e=0])}return d}function he(d){var p,v=d.e;return v===null?d.toString():(p=ft(d.c),p=v<=l||v>=m?Un(p,v):It(p,v,"0"),d.s<0?"-"+p:p)}return o.absoluteValue=o.abs=function(){var d=new E(this);return d.s<0&&(d.s=1),d},o.comparedTo=function(d,p){return Kt(this,new E(d,p))},o.decimalPlaces=o.dp=function(d,p){var v,T,D,k=this;if(d!=null)return Ve(d,0,Xe),p==null?p=c:Ve(p,0,8),ce(new E(k),d+k.e+1,p);if(!(v=k.c))return null;if(T=((D=v.length-1)-mt(this.e/de))*de,D=v[D])for(;D%10==0;D/=10,T--);return T<0&&(T=0),T},o.dividedBy=o.div=function(d,p){return t(this,new E(d,p),a,c)},o.dividedToIntegerBy=o.idiv=function(d,p){return t(this,new E(d,p),0,1)},o.exponentiatedBy=o.pow=function(d,p){var v,T,D,k,$,b,C,S,q,N=this;if(d=new E(d),d.c&&!d.isInteger())throw Error(rt+"Exponent not an integer: "+he(d));if(p!=null&&(p=new E(p)),b=d.e>14,!N.c||!N.c[0]||N.c[0]==1&&!N.e&&N.c.length==1||!d.c||!d.c[0])return q=new E(Math.pow(+he(N),b?d.s*(2-Rn(d)):+he(d))),p?q.mod(p):q;if(C=d.s<0,p){if(p.c?!p.c[0]:!p.s)return new E(NaN);T=!C&&N.isInteger()&&p.isInteger(),T&&(N=N.mod(p))}else{if(d.e>9&&(N.e>0||N.e<-1||(N.e==0?N.c[0]>1||b&&N.c[1]>=24e7:N.c[0]<8e13||b&&N.c[0]<=9999975e7)))return k=N.s<0&&Rn(d)?-0:0,N.e>-1&&(k=1/k),new E(C?1/k:k);A&&(k=fi(A/de+2))}for(b?(v=new E(.5),C&&(d.s=1),S=Rn(d)):(D=Math.abs(+he(d)),S=D%2),q=new E(s);;){if(S){if(q=q.times(N),!q.c)break;k?q.c.length>k&&(q.c.length=k):T&&(q=q.mod(p))}if(D){if(D=ht(D/2),D===0)break;S=D%2}else if(d=d.times(v),ce(d,d.e+1,1),d.e>14)S=Rn(d);else{if(D=+he(d),D===0)break;S=D%2}N=N.times(N),k?N.c&&N.c.length>k&&(N.c.length=k):T&&(N=N.mod(p))}return T?q:(C&&(q=s.div(q)),p?q.mod(p):k?ce(q,A,c,$):q)},o.integerValue=function(d){var p=new E(this);return d==null?d=c:Ve(d,0,8),ce(p,p.e+1,d)},o.isEqualTo=o.eq=function(d,p){return Kt(this,new E(d,p))===0},o.isFinite=function(){return!!this.c},o.isGreaterThan=o.gt=function(d,p){return Kt(this,new E(d,p))>0},o.isGreaterThanOrEqualTo=o.gte=function(d,p){return(p=Kt(this,new E(d,p)))===1||p===0},o.isInteger=function(){return!!this.c&&mt(this.e/de)>this.c.length-2},o.isLessThan=o.lt=function(d,p){return Kt(this,new E(d,p))<0},o.isLessThanOrEqualTo=o.lte=function(d,p){return(p=Kt(this,new E(d,p)))===-1||p===0},o.isNaN=function(){return!this.s},o.isNegative=function(){return this.s<0},o.isPositive=function(){return this.s>0},o.isZero=function(){return!!this.c&&this.c[0]==0},o.minus=function(d,p){var v,T,D,k,$=this,b=$.s;if(d=new E(d,p),p=d.s,!b||!p)return new E(NaN);if(b!=p)return d.s=-p,$.plus(d);var C=$.e/de,S=d.e/de,q=$.c,N=d.c;if(!C||!S){if(!q||!N)return q?(d.s=-p,d):new E(N?$:NaN);if(!q[0]||!N[0])return N[0]?(d.s=-p,d):new E(q[0]?$:c==3?-0:0)}if(C=mt(C),S=mt(S),q=q.slice(),b=C-S){for((k=b<0)?(b=-b,D=q):(S=C,D=N),D.reverse(),p=b;p--;D.push(0));D.reverse()}else for(T=(k=(b=q.length)<(p=N.length))?b:p,b=p=0;p<T;p++)if(q[p]!=N[p]){k=q[p]<N[p];break}if(k&&(D=q,q=N,N=D,d.s=-d.s),p=(T=N.length)-(v=q.length),p>0)for(;p--;q[v++]=0);for(p=wt-1;T>b;){if(q[--T]<N[T]){for(v=T;v&&!q[--v];q[v]=p);--q[v],q[T]+=wt}q[T]-=N[T]}for(;q[0]==0;q.splice(0,1),--S);return q[0]?ae(d,q,S):(d.s=c==3?-1:1,d.c=[d.e=0],d)},o.modulo=o.mod=function(d,p){var v,T,D=this;return d=new E(d,p),!D.c||!d.s||d.c&&!d.c[0]?new E(NaN):!d.c||D.c&&!D.c[0]?new E(D):(P==9?(T=d.s,d.s=1,v=t(D,d,0,3),d.s=T,v.s*=T):v=t(D,d,0,P),d=D.minus(v.times(d)),!d.c[0]&&P==1&&(d.s=D.s),d)},o.multipliedBy=o.times=function(d,p){var v,T,D,k,$,b,C,S,q,N,ee,Z,ue,qe,Ee,me=this,fe=me.c,We=(d=new E(d,p)).c;if(!fe||!We||!fe[0]||!We[0])return!me.s||!d.s||fe&&!fe[0]&&!We||We&&!We[0]&&!fe?d.c=d.e=d.s=null:(d.s*=me.s,!fe||!We?d.c=d.e=null:(d.c=[0],d.e=0)),d;for(T=mt(me.e/de)+mt(d.e/de),d.s*=me.s,C=fe.length,N=We.length,C<N&&(ue=fe,fe=We,We=ue,D=C,C=N,N=D),D=C+N,ue=[];D--;ue.push(0));for(qe=wt,Ee=Lt,D=N;--D>=0;){for(v=0,ee=We[D]%Ee,Z=We[D]/Ee|0,$=C,k=D+$;k>D;)S=fe[--$]%Ee,q=fe[$]/Ee|0,b=Z*S+q*ee,S=ee*S+b%Ee*Ee+ue[k]+v,v=(S/qe|0)+(b/Ee|0)+Z*q,ue[k--]=S%qe;ue[k]=v}return v?++T:ue.splice(0,1),ae(d,ue,T)},o.negated=function(){var d=new E(this);return d.s=-d.s||null,d},o.plus=function(d,p){var v,T=this,D=T.s;if(d=new E(d,p),p=d.s,!D||!p)return new E(NaN);if(D!=p)return d.s=-p,T.minus(d);var k=T.e/de,$=d.e/de,b=T.c,C=d.c;if(!k||!$){if(!b||!C)return new E(D/0);if(!b[0]||!C[0])return C[0]?d:new E(b[0]?T:D*0)}if(k=mt(k),$=mt($),b=b.slice(),D=k-$){for(D>0?($=k,v=C):(D=-D,v=b),v.reverse();D--;v.push(0));v.reverse()}for(D=b.length,p=C.length,D-p<0&&(v=C,C=b,b=v,p=D),D=0;p;)D=(b[--p]=b[p]+C[p]+D)/wt|0,b[p]=wt===b[p]?0:b[p]%wt;return D&&(b=[D].concat(b),++$),ae(d,b,$)},o.precision=o.sd=function(d,p){var v,T,D,k=this;if(d!=null&&d!==!!d)return Ve(d,1,Xe),p==null?p=c:Ve(p,0,8),ce(new E(k),d,p);if(!(v=k.c))return null;if(D=v.length-1,T=D*de+1,D=v[D]){for(;D%10==0;D/=10,T--);for(D=v[0];D>=10;D/=10,T++);}return d&&k.e+1>T&&(T=k.e+1),T},o.shiftedBy=function(d){return Ve(d,-hi,hi),this.times("1e"+d)},o.squareRoot=o.sqrt=function(){var d,p,v,T,D,k=this,$=k.c,b=k.s,C=k.e,S=a+4,q=new E("0.5");if(b!==1||!$||!$[0])return new E(!b||b<0&&(!$||$[0])?NaN:$?k:1/0);if(b=Math.sqrt(+he(k)),b==0||b==1/0?(p=ft($),(p.length+C)%2==0&&(p+="0"),b=Math.sqrt(+p),C=mt((C+1)/2)-(C<0||C%2),b==1/0?p="5e"+C:(p=b.toExponential(),p=p.slice(0,p.indexOf("e")+1)+C),v=new E(p)):v=new E(b+""),v.c[0]){for(C=v.e,b=C+S,b<3&&(b=0);;)if(D=v,v=q.times(D.plus(t(k,D,S,1))),ft(D.c).slice(0,b)===(p=ft(v.c)).slice(0,b))if(v.e<C&&--b,p=p.slice(b-3,b+1),p=="9999"||!T&&p=="4999"){if(!T&&(ce(D,D.e+a+2,0),D.times(D).eq(k))){v=D;break}S+=4,b+=4,T=1}else{(!+p||!+p.slice(1)&&p.charAt(0)=="5")&&(ce(v,v.e+a+2,1),d=!v.times(v).eq(k));break}}return ce(v,v.e+a+1,c,d)},o.toExponential=function(d,p){return d!=null&&(Ve(d,0,Xe),d++),O(this,d,p,1)},o.toFixed=function(d,p){return d!=null&&(Ve(d,0,Xe),d=d+this.e+1),O(this,d,p)},o.toFormat=function(d,p,v){var T,D=this;if(v==null)d!=null&&p&&typeof p=="object"?(v=p,p=null):d&&typeof d=="object"?(v=d,d=p=null):v=U;else if(typeof v!="object")throw Error(rt+"Argument not an object: "+v);if(T=D.toFixed(d,p),D.c){var k,$=T.split("."),b=+v.groupSize,C=+v.secondaryGroupSize,S=v.groupSeparator||"",q=$[0],N=$[1],ee=D.s<0,Z=ee?q.slice(1):q,ue=Z.length;if(C&&(k=b,b=C,C=k,ue-=k),b>0&&ue>0){for(k=ue%b||b,q=Z.substr(0,k);k<ue;k+=b)q+=S+Z.substr(k,b);C>0&&(q+=S+Z.slice(k)),ee&&(q="-"+q)}T=N?q+(v.decimalSeparator||"")+((C=+v.fractionGroupSize)?N.replace(new RegExp("\\d{"+C+"}\\B","g"),"$&"+(v.fractionGroupSeparator||"")):N):q}return(v.prefix||"")+T+(v.suffix||"")},o.toFraction=function(d){var p,v,T,D,k,$,b,C,S,q,N,ee,Z=this,ue=Z.c;if(d!=null&&(b=new E(d),!b.isInteger()&&(b.c||b.s!==1)||b.lt(s)))throw Error(rt+"Argument "+(b.isInteger()?"out of range: ":"not an integer: ")+he(b));if(!ue)return new E(Z);for(p=new E(s),S=v=new E(s),T=C=new E(s),ee=ft(ue),k=p.e=ee.length-Z.e-1,p.c[0]=mi[($=k%de)<0?de+$:$],d=!d||b.comparedTo(p)>0?k>0?p:S:b,$=w,w=1/0,b=new E(ee),C.c[0]=0;q=t(b,p,0,1),D=v.plus(q.times(T)),D.comparedTo(d)!=1;)v=T,T=D,S=C.plus(q.times(D=S)),C=D,p=b.minus(q.times(D=p)),b=D;return D=t(d.minus(v),T,0,1),C=C.plus(D.times(S)),v=v.plus(D.times(T)),C.s=S.s=Z.s,k=k*2,N=t(S,T,k,c).minus(Z).abs().comparedTo(t(C,v,k,c).minus(Z).abs())<1?[S,T]:[C,v],w=$,N},o.toNumber=function(){return+he(this)},o.toPrecision=function(d,p){return d!=null&&Ve(d,1,Xe),O(this,d,p,2)},o.toString=function(d){var p,v=this,T=v.s,D=v.e;return D===null?T?(p="Infinity",T<0&&(p="-"+p)):p="NaN":(d==null?p=D<=l||D>=m?Un(ft(v.c),D):It(ft(v.c),D,"0"):d===10&&K?(v=ce(new E(v),a+D+1,c),p=It(ft(v.c),v.e,"0")):(Ve(d,2,j.length,"Base"),p=n(It(ft(v.c),D,"0"),10,d,T,!0)),T<0&&v.c[0]&&(p="-"+p)),p},o.valueOf=o.toJSON=function(){return he(this)},o._isBigNumber=!0,o[Symbol.toStringTag]="BigNumber",o[Symbol.for("nodejs.util.inspect.custom")]=o.valueOf,e!=null&&E.set(e),E}function mt(e){var t=e|0;return e>0||e===t?t:t-1}function ft(e){for(var t,n,i=1,o=e.length,s=e[0]+"";i<o;){for(t=e[i++]+"",n=de-t.length;n--;t="0"+t);s+=t}for(o=s.length;s.charCodeAt(--o)===48;);return s.slice(0,o+1||1)}function Kt(e,t){var n,i,o=e.c,s=t.c,a=e.s,c=t.s,l=e.e,m=t.e;if(!a||!c)return null;if(n=o&&!o[0],i=s&&!s[0],n||i)return n?i?0:-c:a;if(a!=c)return a;if(n=a<0,i=l==m,!o||!s)return i?0:!o^n?1:-1;if(!i)return l>m^n?1:-1;for(c=(l=o.length)<(m=s.length)?l:m,a=0;a<c;a++)if(o[a]!=s[a])return o[a]>s[a]^n?1:-1;return l==m?0:l>m^n?1:-1}function Ve(e,t,n,i){if(e<t||e>n||e!==ht(e))throw Error(rt+(i||"Argument")+(typeof e=="number"?e<t||e>n?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function Rn(e){var t=e.c.length-1;return mt(e.e/de)==t&&e.c[t]%2!=0}function Un(e,t){return(e.length>1?e.charAt(0)+"."+e.slice(1):e)+(t<0?"e":"e+")+t}function It(e,t,n){var i,o;if(t<0){for(o=n+".";++t;o+=n);e=o+e}else if(i=e.length,++t>i){for(o=n,t-=i;--t;o+=n);e+=o}else t<i&&(e=e.slice(0,t)+"."+e.slice(t));return e}var ao=Xo();class f extends Array{constructor(t,n){if(t>f.__kMaxLength)throw new RangeError("Maximum BigInt size exceeded");super(t),this.sign=n}static BigInt(t){var n=Math.floor,i=Number.isFinite;if(typeof t=="number"){if(t===0)return f.__zero();if((0|t)===t)return 0>t?f.__oneDigit(-t,!0):f.__oneDigit(t,!1);if(!i(t)||n(t)!==t)throw new RangeError("The number "+t+" cannot be converted to BigInt because it is not an integer");return f.__fromDouble(t)}if(typeof t=="string"){const o=f.__fromString(t);if(o===null)throw new SyntaxError("Cannot convert "+t+" to a BigInt");return o}if(typeof t=="boolean")return t===!0?f.__oneDigit(1,!1):f.__zero();if(typeof t=="object"){if(t.constructor===f)return t;const o=f.__toPrimitive(t);return f.BigInt(o)}throw new TypeError("Cannot convert "+t+" to a BigInt")}toDebugString(){const t=["BigInt["];for(const n of this)t.push((n&&(n>>>0).toString(16))+", ");return t.push("]"),t.join("")}toString(t=10){if(2>t||36<t)throw new RangeError("toString() radix argument must be between 2 and 36");return this.length===0?"0":(t&t-1)==0?f.__toStringBasePowerOfTwo(this,t):f.__toStringGeneric(this,t,!1)}static toNumber(t){const n=t.length;if(n===0)return 0;if(n===1){const j=t.__unsignedDigit(0);return t.sign?-j:j}const i=t.__digit(n-1),o=f.__clz32(i),s=32*n-o;if(1024<s)return t.sign?-1/0:1/0;let a=s-1,c=i,l=n-1;const m=o+1;let h=m===32?0:c<<m;h>>>=12;const w=m-12;let y=12<=m?0:c<<20+m,P=20+m;0<w&&0<l&&(l--,c=t.__digit(l),h|=c>>>32-w,y=c<<w,P=w),0<P&&0<l&&(l--,c=t.__digit(l),y|=c>>>32-P,P-=32);const A=f.__decideRounding(t,P,l,c);if((A===1||A===0&&(1&y)==1)&&(y=y+1>>>0,y===0&&(h++,h>>>20!=0&&(h=0,a++,1023<a))))return t.sign?-1/0:1/0;const U=t.sign?-2147483648:0;return a=a+1023<<20,f.__kBitConversionInts[1]=U|a|h,f.__kBitConversionInts[0]=y,f.__kBitConversionDouble[0]}static unaryMinus(t){if(t.length===0)return t;const n=t.__copy();return n.sign=!t.sign,n}static bitwiseNot(t){return t.sign?f.__absoluteSubOne(t).__trim():f.__absoluteAddOne(t,!0)}static exponentiate(t,n){if(n.sign)throw new RangeError("Exponent must be positive");if(n.length===0)return f.__oneDigit(1,!1);if(t.length===0)return t;if(t.length===1&&t.__digit(0)===1)return t.sign&&(1&n.__digit(0))==0?f.unaryMinus(t):t;if(1<n.length)throw new RangeError("BigInt too big");let i=n.__unsignedDigit(0);if(i===1)return t;if(i>=f.__kMaxLengthBits)throw new RangeError("BigInt too big");if(t.length===1&&t.__digit(0)===2){const a=1+(i>>>5),c=t.sign&&(1&i)!=0,l=new f(a,c);l.__initializeDigits();const m=1<<(31&i);return l.__setDigit(a-1,m),l}let o=null,s=t;for((1&i)!=0&&(o=t),i>>=1;i!==0;i>>=1)s=f.multiply(s,s),(1&i)!=0&&(o===null?o=s:o=f.multiply(o,s));return o}static multiply(t,n){if(t.length===0)return t;if(n.length===0)return n;let i=t.length+n.length;32<=t.__clzmsd()+n.__clzmsd()&&i--;const o=new f(i,t.sign!==n.sign);o.__initializeDigits();for(let s=0;s<t.length;s++)f.__multiplyAccumulate(n,t.__digit(s),o,s);return o.__trim()}static divide(t,n){if(n.length===0)throw new RangeError("Division by zero");if(0>f.__absoluteCompare(t,n))return f.__zero();const i=t.sign!==n.sign,o=n.__unsignedDigit(0);let s;if(n.length===1&&65535>=o){if(o===1)return i===t.sign?t:f.unaryMinus(t);s=f.__absoluteDivSmall(t,o,null)}else s=f.__absoluteDivLarge(t,n,!0,!1);return s.sign=i,s.__trim()}static remainder(t,n){if(n.length===0)throw new RangeError("Division by zero");if(0>f.__absoluteCompare(t,n))return t;const i=n.__unsignedDigit(0);if(n.length===1&&65535>=i){if(i===1)return f.__zero();const s=f.__absoluteModSmall(t,i);return s===0?f.__zero():f.__oneDigit(s,t.sign)}const o=f.__absoluteDivLarge(t,n,!1,!0);return o.sign=t.sign,o.__trim()}static add(t,n){const i=t.sign;return i===n.sign?f.__absoluteAdd(t,n,i):0<=f.__absoluteCompare(t,n)?f.__absoluteSub(t,n,i):f.__absoluteSub(n,t,!i)}static subtract(t,n){const i=t.sign;return i===n.sign?0<=f.__absoluteCompare(t,n)?f.__absoluteSub(t,n,i):f.__absoluteSub(n,t,!i):f.__absoluteAdd(t,n,i)}static leftShift(t,n){return n.length===0||t.length===0?t:n.sign?f.__rightShiftByAbsolute(t,n):f.__leftShiftByAbsolute(t,n)}static signedRightShift(t,n){return n.length===0||t.length===0?t:n.sign?f.__leftShiftByAbsolute(t,n):f.__rightShiftByAbsolute(t,n)}static unsignedRightShift(){throw new TypeError("BigInts have no unsigned right shift; use >> instead")}static lessThan(t,n){return 0>f.__compareToBigInt(t,n)}static lessThanOrEqual(t,n){return 0>=f.__compareToBigInt(t,n)}static greaterThan(t,n){return 0<f.__compareToBigInt(t,n)}static greaterThanOrEqual(t,n){return 0<=f.__compareToBigInt(t,n)}static equal(t,n){if(t.sign!==n.sign||t.length!==n.length)return!1;for(let i=0;i<t.length;i++)if(t.__digit(i)!==n.__digit(i))return!1;return!0}static notEqual(t,n){return!f.equal(t,n)}static bitwiseAnd(t,n){var i=Math.max;if(!t.sign&&!n.sign)return f.__absoluteAnd(t,n).__trim();if(t.sign&&n.sign){const o=i(t.length,n.length)+1;let s=f.__absoluteSubOne(t,o);const a=f.__absoluteSubOne(n);return s=f.__absoluteOr(s,a,s),f.__absoluteAddOne(s,!0,s).__trim()}return t.sign&&([t,n]=[n,t]),f.__absoluteAndNot(t,f.__absoluteSubOne(n)).__trim()}static bitwiseXor(t,n){var i=Math.max;if(!t.sign&&!n.sign)return f.__absoluteXor(t,n).__trim();if(t.sign&&n.sign){const a=i(t.length,n.length),c=f.__absoluteSubOne(t,a),l=f.__absoluteSubOne(n);return f.__absoluteXor(c,l,c).__trim()}const o=i(t.length,n.length)+1;t.sign&&([t,n]=[n,t]);let s=f.__absoluteSubOne(n,o);return s=f.__absoluteXor(s,t,s),f.__absoluteAddOne(s,!0,s).__trim()}static bitwiseOr(t,n){var i=Math.max;const o=i(t.length,n.length);if(!t.sign&&!n.sign)return f.__absoluteOr(t,n).__trim();if(t.sign&&n.sign){let a=f.__absoluteSubOne(t,o);const c=f.__absoluteSubOne(n);return a=f.__absoluteAnd(a,c,a),f.__absoluteAddOne(a,!0,a).__trim()}t.sign&&([t,n]=[n,t]);let s=f.__absoluteSubOne(n,o);return s=f.__absoluteAndNot(s,t,s),f.__absoluteAddOne(s,!0,s).__trim()}static asIntN(t,n){if(n.length===0)return n;if(t===0)return f.__zero();if(t>=f.__kMaxLengthBits)return n;const i=t+31>>>5;if(n.length<i)return n;const o=n.__unsignedDigit(i-1),s=1<<(31&t-1);if(n.length===i&&o<s)return n;if((o&s)!==s)return f.__truncateToNBits(t,n);if(!n.sign)return f.__truncateAndSubFromPowerOfTwo(t,n,!0);if((o&s-1)==0){for(let a=i-2;0<=a;a--)if(n.__digit(a)!==0)return f.__truncateAndSubFromPowerOfTwo(t,n,!1);return n.length===i&&o===s?n:f.__truncateToNBits(t,n)}return f.__truncateAndSubFromPowerOfTwo(t,n,!1)}static asUintN(t,n){if(n.length===0)return n;if(t===0)return f.__zero();if(n.sign){if(t>f.__kMaxLengthBits)throw new RangeError("BigInt too big");return f.__truncateAndSubFromPowerOfTwo(t,n,!1)}if(t>=f.__kMaxLengthBits)return n;const i=t+31>>>5;if(n.length<i)return n;const o=31&t;return n.length==i&&(o===0||n.__digit(i-1)>>>o==0)?n:f.__truncateToNBits(t,n)}static ADD(t,n){if(t=f.__toPrimitive(t),n=f.__toPrimitive(n),typeof t=="string")return typeof n!="string"&&(n=n.toString()),t+n;if(typeof n=="string")return t.toString()+n;if(t=f.__toNumeric(t),n=f.__toNumeric(n),f.__isBigInt(t)&&f.__isBigInt(n))return f.add(t,n);if(typeof t=="number"&&typeof n=="number")return t+n;throw new TypeError("Cannot mix BigInt and other types, use explicit conversions")}static LT(t,n){return f.__compare(t,n,0)}static LE(t,n){return f.__compare(t,n,1)}static GT(t,n){return f.__compare(t,n,2)}static GE(t,n){return f.__compare(t,n,3)}static EQ(t,n){for(;;){if(f.__isBigInt(t))return f.__isBigInt(n)?f.equal(t,n):f.EQ(n,t);if(typeof t=="number"){if(f.__isBigInt(n))return f.__equalToNumber(n,t);if(typeof n!="object")return t==n;n=f.__toPrimitive(n)}else if(typeof t=="string"){if(f.__isBigInt(n))return t=f.__fromString(t),t!==null&&f.equal(t,n);if(typeof n!="object")return t==n;n=f.__toPrimitive(n)}else if(typeof t=="boolean"){if(f.__isBigInt(n))return f.__equalToNumber(n,+t);if(typeof n!="object")return t==n;n=f.__toPrimitive(n)}else if(typeof t=="symbol"){if(f.__isBigInt(n))return!1;if(typeof n!="object")return t==n;n=f.__toPrimitive(n)}else if(typeof t=="object"){if(typeof n=="object"&&n.constructor!==f)return t==n;t=f.__toPrimitive(t)}else return t==n}}static NE(t,n){return!f.EQ(t,n)}static __zero(){return new f(0,!1)}static __oneDigit(t,n){const i=new f(1,n);return i.__setDigit(0,t),i}__copy(){const t=new f(this.length,this.sign);for(let n=0;n<this.length;n++)t[n]=this[n];return t}__trim(){let t=this.length,n=this[t-1];for(;n===0;)t--,n=this[t-1],this.pop();return t===0&&(this.sign=!1),this}__initializeDigits(){for(let t=0;t<this.length;t++)this[t]=0}static __decideRounding(t,n,i,o){if(0<n)return-1;let s;if(0>n)s=-n-1;else{if(i===0)return-1;i--,o=t.__digit(i),s=31}let a=1<<s;if((o&a)==0)return-1;if(a-=1,(o&a)!=0)return 1;for(;0<i;)if(i--,t.__digit(i)!==0)return 1;return 0}static __fromDouble(t){f.__kBitConversionDouble[0]=t;const n=2047&f.__kBitConversionInts[1]>>>20,i=n-1023,o=(i>>>5)+1,s=new f(o,0>t);let a=1048575&f.__kBitConversionInts[1]|1048576,c=f.__kBitConversionInts[0];const l=20,m=31&i;let h,w=0;if(m<20){const y=l-m;w=y+32,h=a>>>y,a=a<<32-y|c>>>y,c<<=32-y}else if(m===20)w=32,h=a,a=c;else{const y=m-l;w=32-y,h=a<<y|c>>>32-y,a=c<<y}s.__setDigit(o-1,h);for(let y=o-2;0<=y;y--)0<w?(w-=32,h=a,a=c):h=0,s.__setDigit(y,h);return s.__trim()}static __isWhitespace(t){return 13>=t&&9<=t||(159>=t?t==32:131071>=t?t==160||t==5760:196607>=t?(t&=131071,10>=t||t==40||t==41||t==47||t==95||t==4096):t==65279)}static __fromString(t,n=0){let i=0;const o=t.length;let s=0;if(s===o)return f.__zero();let a=t.charCodeAt(s);for(;f.__isWhitespace(a);){if(++s===o)return f.__zero();a=t.charCodeAt(s)}if(a===43){if(++s===o)return null;a=t.charCodeAt(s),i=1}else if(a===45){if(++s===o)return null;a=t.charCodeAt(s),i=-1}if(n===0){if(n=10,a===48){if(++s===o)return f.__zero();if(a=t.charCodeAt(s),a===88||a===120){if(n=16,++s===o)return null;a=t.charCodeAt(s)}else if(a===79||a===111){if(n=8,++s===o)return null;a=t.charCodeAt(s)}else if(a===66||a===98){if(n=2,++s===o)return null;a=t.charCodeAt(s)}}}else if(n===16&&a===48){if(++s===o)return f.__zero();if(a=t.charCodeAt(s),a===88||a===120){if(++s===o)return null;a=t.charCodeAt(s)}}for(;a===48;){if(++s===o)return f.__zero();a=t.charCodeAt(s)}const c=o-s;let l=f.__kMaxBitsPerChar[n],m=f.__kBitsPerCharTableMultiplier-1;if(c>1073741824/l)return null;const h=l*c+m>>>f.__kBitsPerCharTableShift,w=new f(h+31>>>5,!1),y=10>n?n:10,P=10<n?n-10:0;if((n&n-1)==0){l>>=f.__kBitsPerCharTableShift;const A=[],U=[];let j=!1;do{let K=0,E=0;for(;;){let O;if(a-48>>>0<y)O=a-48;else if((32|a)-97>>>0<P)O=(32|a)-87;else{j=!0;break}if(E+=l,K=K<<l|O,++s===o){j=!0;break}if(a=t.charCodeAt(s),32<E+l)break}A.push(K),U.push(E)}while(!j);f.__fillFromParts(w,A,U)}else{w.__initializeDigits();let A=!1,U=0;do{let j=0,K=1;for(;;){let O;if(a-48>>>0<y)O=a-48;else if((32|a)-97>>>0<P)O=(32|a)-87;else{A=!0;break}const X=K*n;if(4294967295<X)break;if(K=X,j=j*n+O,U++,++s===o){A=!0;break}a=t.charCodeAt(s)}m=32*f.__kBitsPerCharTableMultiplier-1;const E=l*U+m>>>f.__kBitsPerCharTableShift+5;w.__inplaceMultiplyAdd(K,j,E)}while(!A)}if(s!==o){if(!f.__isWhitespace(a))return null;for(s++;s<o;s++)if(a=t.charCodeAt(s),!f.__isWhitespace(a))return null}return i!=0&&n!==10?null:(w.sign=i==-1,w.__trim())}static __fillFromParts(t,n,i){let o=0,s=0,a=0;for(let c=n.length-1;0<=c;c--){const l=n[c],m=i[c];s|=l<<a,a+=m,a===32?(t.__setDigit(o++,s),a=0,s=0):32<a&&(t.__setDigit(o++,s),a-=32,s=l>>>m-a)}if(s!==0){if(o>=t.length)throw new Error("implementation bug");t.__setDigit(o++,s)}for(;o<t.length;o++)t.__setDigit(o,0)}static __toStringBasePowerOfTwo(t,n){const i=t.length;let o=n-1;o=(85&o>>>1)+(85&o),o=(51&o>>>2)+(51&o),o=(15&o>>>4)+(15&o);const s=o,a=n-1,c=t.__digit(i-1),l=f.__clz32(c);let m=0|(32*i-l+s-1)/s;if(t.sign&&m++,268435456<m)throw new Error("string too long");const h=Array(m);let w=m-1,y=0,P=0;for(let U=0;U<i-1;U++){const j=t.__digit(U),K=(y|j<<P)&a;h[w--]=f.__kConversionChars[K];const E=s-P;for(y=j>>>E,P=32-E;P>=s;)h[w--]=f.__kConversionChars[y&a],y>>>=s,P-=s}const A=(y|c<<P)&a;for(h[w--]=f.__kConversionChars[A],y=c>>>s-P;y!==0;)h[w--]=f.__kConversionChars[y&a],y>>>=s;if(t.sign&&(h[w--]="-"),w!=-1)throw new Error("implementation bug");return h.join("")}static __toStringGeneric(t,n,i){const o=t.length;if(o===0)return"";if(o===1){let U=t.__unsignedDigit(0).toString(n);return i===!1&&t.sign&&(U="-"+U),U}const s=32*o-f.__clz32(t.__digit(o-1)),a=f.__kMaxBitsPerChar[n],c=a-1;let l=s*f.__kBitsPerCharTableMultiplier;l+=c-1,l=0|l/c;const m=l+1>>1,h=f.exponentiate(f.__oneDigit(n,!1),f.__oneDigit(m,!1));let w,y;const P=h.__unsignedDigit(0);if(h.length===1&&65535>=P){w=new f(t.length,!1),w.__initializeDigits();let U=0;for(let j=2*t.length-1;0<=j;j--){const K=U<<16|t.__halfDigit(j);w.__setHalfDigit(j,0|K/P),U=0|K%P}y=U.toString(n)}else{const U=f.__absoluteDivLarge(t,h,!0,!0);w=U.quotient;const j=U.remainder.__trim();y=f.__toStringGeneric(j,n,!0)}w.__trim();let A=f.__toStringGeneric(w,n,!0);for(;y.length<m;)y="0"+y;return i===!1&&t.sign&&(A="-"+A),A+y}static __unequalSign(t){return t?-1:1}static __absoluteGreater(t){return t?-1:1}static __absoluteLess(t){return t?1:-1}static __compareToBigInt(t,n){const i=t.sign;if(i!==n.sign)return f.__unequalSign(i);const o=f.__absoluteCompare(t,n);return 0<o?f.__absoluteGreater(i):0>o?f.__absoluteLess(i):0}static __compareToNumber(t,n){if(n|!0){const i=t.sign,o=0>n;if(i!==o)return f.__unequalSign(i);if(t.length===0){if(o)throw new Error("implementation bug");return n===0?0:-1}if(1<t.length)return f.__absoluteGreater(i);const s=Math.abs(n),a=t.__unsignedDigit(0);return a>s?f.__absoluteGreater(i):a<s?f.__absoluteLess(i):0}return f.__compareToDouble(t,n)}static __compareToDouble(t,n){if(n!==n)return n;if(n===1/0)return-1;if(n===-1/0)return 1;const i=t.sign;if(i!==0>n)return f.__unequalSign(i);if(n===0)throw new Error("implementation bug: should be handled elsewhere");if(t.length===0)return-1;f.__kBitConversionDouble[0]=n;const o=2047&f.__kBitConversionInts[1]>>>20;if(o==2047)throw new Error("implementation bug: handled elsewhere");const s=o-1023;if(0>s)return f.__absoluteGreater(i);const a=t.length;let c=t.__digit(a-1);const l=f.__clz32(c),m=32*a-l,h=s+1;if(m<h)return f.__absoluteLess(i);if(m>h)return f.__absoluteGreater(i);let w=1048576|1048575&f.__kBitConversionInts[1],y=f.__kBitConversionInts[0];const P=20,A=31-l;if(A!==(m-1)%31)throw new Error("implementation bug");let U,j=0;if(20>A){const K=P-A;j=K+32,U=w>>>K,w=w<<32-K|y>>>K,y<<=32-K}else if(A===20)j=32,U=w,w=y;else{const K=A-P;j=32-K,U=w<<K|y>>>32-K,w=y<<K}if(c>>>=0,U>>>=0,c>U)return f.__absoluteGreater(i);if(c<U)return f.__absoluteLess(i);for(let K=a-2;0<=K;K--){0<j?(j-=32,U=w>>>0,w=y,y=0):U=0;const E=t.__unsignedDigit(K);if(E>U)return f.__absoluteGreater(i);if(E<U)return f.__absoluteLess(i)}if(w!==0||y!==0){if(j===0)throw new Error("implementation bug");return f.__absoluteLess(i)}return 0}static __equalToNumber(t,n){var i=Math.abs;return n|n===0?n===0?t.length===0:t.length===1&&t.sign===0>n&&t.__unsignedDigit(0)===i(n):f.__compareToDouble(t,n)===0}static __comparisonResultToBool(t,n){switch(n){case 0:return 0>t;case 1:return 0>=t;case 2:return 0<t;case 3:return 0<=t}throw new Error("unreachable")}static __compare(t,n,i){if(t=f.__toPrimitive(t),n=f.__toPrimitive(n),typeof t=="string"&&typeof n=="string")switch(i){case 0:return t<n;case 1:return t<=n;case 2:return t>n;case 3:return t>=n}if(f.__isBigInt(t)&&typeof n=="string")return n=f.__fromString(n),n!==null&&f.__comparisonResultToBool(f.__compareToBigInt(t,n),i);if(typeof t=="string"&&f.__isBigInt(n))return t=f.__fromString(t),t!==null&&f.__comparisonResultToBool(f.__compareToBigInt(t,n),i);if(t=f.__toNumeric(t),n=f.__toNumeric(n),f.__isBigInt(t)){if(f.__isBigInt(n))return f.__comparisonResultToBool(f.__compareToBigInt(t,n),i);if(typeof n!="number")throw new Error("implementation bug");return f.__comparisonResultToBool(f.__compareToNumber(t,n),i)}if(typeof t!="number")throw new Error("implementation bug");if(f.__isBigInt(n))return f.__comparisonResultToBool(f.__compareToNumber(n,t),2^i);if(typeof n!="number")throw new Error("implementation bug");return i===0?t<n:i===1?t<=n:i===2?t>n:i===3?t>=n:void 0}__clzmsd(){return f.__clz32(this[this.length-1])}static __absoluteAdd(t,n,i){if(t.length<n.length)return f.__absoluteAdd(n,t,i);if(t.length===0)return t;if(n.length===0)return t.sign===i?t:f.unaryMinus(t);let o=t.length;(t.__clzmsd()===0||n.length===t.length&&n.__clzmsd()===0)&&o++;const s=new f(o,i);let a=0,c=0;for(;c<n.length;c++){const l=n.__digit(c),m=t.__digit(c),h=(65535&m)+(65535&l)+a,w=(m>>>16)+(l>>>16)+(h>>>16);a=w>>>16,s.__setDigit(c,65535&h|w<<16)}for(;c<t.length;c++){const l=t.__digit(c),m=(65535&l)+a,h=(l>>>16)+(m>>>16);a=h>>>16,s.__setDigit(c,65535&m|h<<16)}return c<s.length&&s.__setDigit(c,a),s.__trim()}static __absoluteSub(t,n,i){if(t.length===0)return t;if(n.length===0)return t.sign===i?t:f.unaryMinus(t);const o=new f(t.length,i);let s=0,a=0;for(;a<n.length;a++){const c=t.__digit(a),l=n.__digit(a),m=(65535&c)-(65535&l)-s;s=1&m>>>16;const h=(c>>>16)-(l>>>16)-s;s=1&h>>>16,o.__setDigit(a,65535&m|h<<16)}for(;a<t.length;a++){const c=t.__digit(a),l=(65535&c)-s;s=1&l>>>16;const m=(c>>>16)-s;s=1&m>>>16,o.__setDigit(a,65535&l|m<<16)}return o.__trim()}static __absoluteAddOne(t,n,i=null){const o=t.length;i===null?i=new f(o,n):i.sign=n;let s=!0;for(let a,c=0;c<o;c++){if(a=t.__digit(c),s){const l=a===-1;a=0|a+1,s=l}i.__setDigit(c,a)}return s&&i.__setDigitGrow(o,1),i}static __absoluteSubOne(t,n){const i=t.length;n=n||i;const o=new f(n,!1);let s=!0;for(let a,c=0;c<i;c++){if(a=t.__digit(c),s){const l=a===0;a=0|a-1,s=l}o.__setDigit(c,a)}if(s)throw new Error("implementation bug");for(let a=i;a<n;a++)o.__setDigit(a,0);return o}static __absoluteAnd(t,n,i=null){let o=t.length,s=n.length,a=s;if(o<s){a=o;const m=t,h=o;t=n,o=s,n=m,s=h}let c=a;i===null?i=new f(c,!1):c=i.length;let l=0;for(;l<a;l++)i.__setDigit(l,t.__digit(l)&n.__digit(l));for(;l<c;l++)i.__setDigit(l,0);return i}static __absoluteAndNot(t,n,i=null){const o=t.length,s=n.length;let a=s;o<s&&(a=o);let c=o;i===null?i=new f(c,!1):c=i.length;let l=0;for(;l<a;l++)i.__setDigit(l,t.__digit(l)&~n.__digit(l));for(;l<o;l++)i.__setDigit(l,t.__digit(l));for(;l<c;l++)i.__setDigit(l,0);return i}static __absoluteOr(t,n,i=null){let o=t.length,s=n.length,a=s;if(o<s){a=o;const m=t,h=o;t=n,o=s,n=m,s=h}let c=o;i===null?i=new f(c,!1):c=i.length;let l=0;for(;l<a;l++)i.__setDigit(l,t.__digit(l)|n.__digit(l));for(;l<o;l++)i.__setDigit(l,t.__digit(l));for(;l<c;l++)i.__setDigit(l,0);return i}static __absoluteXor(t,n,i=null){let o=t.length,s=n.length,a=s;if(o<s){a=o;const m=t,h=o;t=n,o=s,n=m,s=h}let c=o;i===null?i=new f(c,!1):c=i.length;let l=0;for(;l<a;l++)i.__setDigit(l,t.__digit(l)^n.__digit(l));for(;l<o;l++)i.__setDigit(l,t.__digit(l));for(;l<c;l++)i.__setDigit(l,0);return i}static __absoluteCompare(t,n){const i=t.length-n.length;if(i!=0)return i;let o=t.length-1;for(;0<=o&&t.__digit(o)===n.__digit(o);)o--;return 0>o?0:t.__unsignedDigit(o)>n.__unsignedDigit(o)?1:-1}static __multiplyAccumulate(t,n,i,o){if(n===0)return;const s=65535&n,a=n>>>16;let c=0,l=0,m=0;for(let h=0;h<t.length;h++,o++){let w=i.__digit(o),y=65535&w,P=w>>>16;const A=t.__digit(h),U=65535&A,j=A>>>16,K=f.__imul(U,s),E=f.__imul(U,a),O=f.__imul(j,s),X=f.__imul(j,a);y+=l+(65535&K),P+=m+c+(y>>>16)+(K>>>16)+(65535&E)+(65535&O),c=P>>>16,l=(E>>>16)+(O>>>16)+(65535&X)+c,c=l>>>16,l&=65535,m=X>>>16,w=65535&y|P<<16,i.__setDigit(o,w)}for(;c!=0||l!==0||m!==0;o++){let h=i.__digit(o);const w=(65535&h)+l,y=(h>>>16)+(w>>>16)+m+c;l=0,m=0,c=y>>>16,h=65535&w|y<<16,i.__setDigit(o,h)}}static __internalMultiplyAdd(t,n,i,o,s){let a=i,c=0;for(let l=0;l<o;l++){const m=t.__digit(l),h=f.__imul(65535&m,n),w=(65535&h)+c+a;a=w>>>16;const y=f.__imul(m>>>16,n),P=(65535&y)+(h>>>16)+a;a=P>>>16,c=y>>>16,s.__setDigit(l,P<<16|65535&w)}if(s.length>o)for(s.__setDigit(o++,a+c);o<s.length;)s.__setDigit(o++,0);else if(a+c!==0)throw new Error("implementation bug")}__inplaceMultiplyAdd(t,n,i){i>this.length&&(i=this.length);const o=65535&t,s=t>>>16;let a=0,c=65535&n,l=n>>>16;for(let m=0;m<i;m++){const h=this.__digit(m),w=65535&h,y=h>>>16,P=f.__imul(w,o),A=f.__imul(w,s),U=f.__imul(y,o),j=f.__imul(y,s),K=c+(65535&P),E=l+a+(K>>>16)+(P>>>16)+(65535&A)+(65535&U);c=(A>>>16)+(U>>>16)+(65535&j)+(E>>>16),a=c>>>16,c&=65535,l=j>>>16,this.__setDigit(m,65535&K|E<<16)}if(a!=0||c!==0||l!==0)throw new Error("implementation bug")}static __absoluteDivSmall(t,n,i){i===null&&(i=new f(t.length,!1));let o=0;for(let s,a=2*t.length-1;0<=a;a-=2){s=(o<<16|t.__halfDigit(a))>>>0;const c=0|s/n;o=0|s%n,s=(o<<16|t.__halfDigit(a-1))>>>0;const l=0|s/n;o=0|s%n,i.__setDigit(a>>>1,c<<16|l)}return i}static __absoluteModSmall(t,n){let i=0;for(let o=2*t.length-1;0<=o;o--){const s=(i<<16|t.__halfDigit(o))>>>0;i=0|s%n}return i}static __absoluteDivLarge(t,n,i,o){const s=n.__halfDigitLength(),a=n.length,c=t.__halfDigitLength()-s;let l=null;i&&(l=new f(c+2>>>1,!1),l.__initializeDigits());const m=new f(s+2>>>1,!1);m.__initializeDigits();const h=f.__clz16(n.__halfDigit(s-1));0<h&&(n=f.__specialLeftShift(n,h,0));const w=f.__specialLeftShift(t,h,1),y=n.__halfDigit(s-1);let P=0;for(let A,U=c;0<=U;U--){A=65535;const j=w.__halfDigit(U+s);if(j!==y){const E=(j<<16|w.__halfDigit(U+s-1))>>>0;A=0|E/y;let O=0|E%y;const X=n.__halfDigit(s-2),ae=w.__halfDigit(U+s-2);for(;f.__imul(A,X)>>>0>(O<<16|ae)>>>0&&(A--,O+=y,!(65535<O)););}f.__internalMultiplyAdd(n,A,0,a,m);let K=w.__inplaceSub(m,U,s+1);K!==0&&(K=w.__inplaceAdd(n,U,s),w.__setHalfDigit(U+s,w.__halfDigit(U+s)+K),A--),i&&(1&U?P=A<<16:l.__setDigit(U>>>1,P|A))}return o?(w.__inplaceRightShift(h),i?{quotient:l,remainder:w}:w):i?l:void 0}static __clz16(t){return f.__clz32(t)-16}__inplaceAdd(t,n,i){let o=0;for(let s=0;s<i;s++){const a=this.__halfDigit(n+s)+t.__halfDigit(s)+o;o=a>>>16,this.__setHalfDigit(n+s,a)}return o}__inplaceSub(t,n,i){let o=0;if(1&n){n>>=1;let s=this.__digit(n),a=65535&s,c=0;for(;c<i-1>>>1;c++){const h=t.__digit(c),w=(s>>>16)-(65535&h)-o;o=1&w>>>16,this.__setDigit(n+c,w<<16|65535&a),s=this.__digit(n+c+1),a=(65535&s)-(h>>>16)-o,o=1&a>>>16}const l=t.__digit(c),m=(s>>>16)-(65535&l)-o;if(o=1&m>>>16,this.__setDigit(n+c,m<<16|65535&a),n+c+1>=this.length)throw new RangeError("out of bounds");(1&i)==0&&(s=this.__digit(n+c+1),a=(65535&s)-(l>>>16)-o,o=1&a>>>16,this.__setDigit(n+t.length,4294901760&s|65535&a))}else{n>>=1;let s=0;for(;s<t.length-1;s++){const h=this.__digit(n+s),w=t.__digit(s),y=(65535&h)-(65535&w)-o;o=1&y>>>16;const P=(h>>>16)-(w>>>16)-o;o=1&P>>>16,this.__setDigit(n+s,P<<16|65535&y)}const a=this.__digit(n+s),c=t.__digit(s),l=(65535&a)-(65535&c)-o;o=1&l>>>16;let m=0;(1&i)==0&&(m=(a>>>16)-(c>>>16)-o,o=1&m>>>16),this.__setDigit(n+s,m<<16|65535&l)}return o}__inplaceRightShift(t){if(t===0)return;let n=this.__digit(0)>>>t;const i=this.length-1;for(let o=0;o<i;o++){const s=this.__digit(o+1);this.__setDigit(o,s<<32-t|n),n=s>>>t}this.__setDigit(i,n)}static __specialLeftShift(t,n,i){const o=t.length,s=new f(o+i,!1);if(n===0){for(let c=0;c<o;c++)s.__setDigit(c,t.__digit(c));return 0<i&&s.__setDigit(o,0),s}let a=0;for(let c=0;c<o;c++){const l=t.__digit(c);s.__setDigit(c,l<<n|a),a=l>>>32-n}return 0<i&&s.__setDigit(o,a),s}static __leftShiftByAbsolute(t,n){const i=f.__toShiftAmount(n);if(0>i)throw new RangeError("BigInt too big");const o=i>>>5,s=31&i,a=t.length,c=s!==0&&t.__digit(a-1)>>>32-s!=0,l=a+o+(c?1:0),m=new f(l,t.sign);if(s===0){let h=0;for(;h<o;h++)m.__setDigit(h,0);for(;h<l;h++)m.__setDigit(h,t.__digit(h-o))}else{let h=0;for(let w=0;w<o;w++)m.__setDigit(w,0);for(let w=0;w<a;w++){const y=t.__digit(w);m.__setDigit(w+o,y<<s|h),h=y>>>32-s}if(c)m.__setDigit(a+o,h);else if(h!==0)throw new Error("implementation bug")}return m.__trim()}static __rightShiftByAbsolute(t,n){const i=t.length,o=t.sign,s=f.__toShiftAmount(n);if(0>s)return f.__rightShiftByMaximum(o);const a=s>>>5,c=31&s;let l=i-a;if(0>=l)return f.__rightShiftByMaximum(o);let m=!1;if(o){if((t.__digit(a)&(1<<c)-1)!=0)m=!0;else for(let w=0;w<a;w++)if(t.__digit(w)!==0){m=!0;break}}m&&c===0&&~t.__digit(i-1)==0&&l++;let h=new f(l,o);if(c===0)for(let w=a;w<i;w++)h.__setDigit(w-a,t.__digit(w));else{let w=t.__digit(a)>>>c;const y=i-a-1;for(let P=0;P<y;P++){const A=t.__digit(P+a+1);h.__setDigit(P,A<<32-c|w),w=A>>>c}h.__setDigit(y,w)}return m&&(h=f.__absoluteAddOne(h,!0,h)),h.__trim()}static __rightShiftByMaximum(t){return t?f.__oneDigit(1,!0):f.__zero()}static __toShiftAmount(t){if(1<t.length)return-1;const n=t.__unsignedDigit(0);return n>f.__kMaxLengthBits?-1:n}static __toPrimitive(t,n="default"){if(typeof t!="object"||t.constructor===f)return t;const i=t[Symbol.toPrimitive];if(i){const a=i(n);if(typeof a!="object")return a;throw new TypeError("Cannot convert object to primitive value")}const o=t.valueOf;if(o){const a=o.call(t);if(typeof a!="object")return a}const s=t.toString;if(s){const a=s.call(t);if(typeof a!="object")return a}throw new TypeError("Cannot convert object to primitive value")}static __toNumeric(t){return f.__isBigInt(t)?t:+t}static __isBigInt(t){return typeof t=="object"&&t!==null&&t.constructor===f}static __truncateToNBits(t,n){const i=t+31>>>5,o=new f(i,n.sign),s=i-1;for(let c=0;c<s;c++)o.__setDigit(c,n.__digit(c));let a=n.__digit(s);if((31&t)!=0){const c=32-(31&t);a=a<<c>>>c}return o.__setDigit(s,a),o.__trim()}static __truncateAndSubFromPowerOfTwo(t,n,i){var o=Math.min;const s=t+31>>>5,a=new f(s,i);let c=0;const l=s-1;let m=0;for(const P=o(l,n.length);c<P;c++){const A=n.__digit(c),U=0-(65535&A)-m;m=1&U>>>16;const j=0-(A>>>16)-m;m=1&j>>>16,a.__setDigit(c,65535&U|j<<16)}for(;c<l;c++)a.__setDigit(c,0|-m);let h=l<n.length?n.__digit(l):0;const w=31&t;let y;if(w==0){const P=0-(65535&h)-m;m=1&P>>>16;const A=0-(h>>>16)-m;y=65535&P|A<<16}else{const P=32-w;h=h<<P>>>P;const A=1<<32-P,U=(65535&A)-(65535&h)-m;m=1&U>>>16;const j=(A>>>16)-(h>>>16)-m;y=65535&U|j<<16,y&=A-1}return a.__setDigit(l,y),a.__trim()}__digit(t){return this[t]}__unsignedDigit(t){return this[t]>>>0}__setDigit(t,n){this[t]=0|n}__setDigitGrow(t,n){this[t]=0|n}__halfDigitLength(){const t=this.length;return 65535>=this.__unsignedDigit(t-1)?2*t-1:2*t}__halfDigit(t){return 65535&this[t>>>1]>>>((1&t)<<4)}__setHalfDigit(t,n){const i=t>>>1,o=this.__digit(i),s=1&t?65535&o|n<<16:4294901760&o|65535&n;this.__setDigit(i,s)}static __digitPow(t,n){let i=1;for(;0<n;)1&n&&(i*=t),n>>>=1,t*=t;return i}}f.__kMaxLength=33554432,f.__kMaxLengthBits=f.__kMaxLength<<5,f.__kMaxBitsPerChar=[0,0,32,51,64,75,83,90,96,102,107,111,115,119,122,126,128,131,134,136,139,141,143,145,147,149,151,153,154,156,158,159,160,162,163,165,166],f.__kBitsPerCharTableShift=5,f.__kBitsPerCharTableMultiplier=1<<f.__kBitsPerCharTableShift,f.__kConversionChars=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],f.__kBitConversionBuffer=new ArrayBuffer(8),f.__kBitConversionDouble=new Float64Array(f.__kBitConversionBuffer),f.__kBitConversionInts=new Int32Array(f.__kBitConversionBuffer),f.__clz32=Math.clz32||function(e){return e===0?32:0|31-(0|Math.log(e>>>0)/Math.LN2)},f.__imul=Math.imul||function(e,t){return 0|e*t};var zc=globalThis&&globalThis.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var i=Array(e),o=0,t=0;t<n;t++)for(var s=arguments[t],a=0,c=s.length;a<c;a++,o++)i[o]=s[a];return i},Wc=18446744073709552e3,ro=function(e,t){return f.bitwiseXor(f.asUintN(64,f.leftShift(e,f.BigInt(t))),f.BigInt(f.asUintN(64,f.signedRightShift(e,f.subtract(f.BigInt(64),f.BigInt(t))))))},jc=function(){function e(t){var n=this;this.next=function(){return new ao(n.roll().toString())},this.nextDouble=function(){return new ao(n.roll().toString()).div(Wc+1)},this.nextInt=function(o,s){return Math.floor(n.nextDouble().toNumber()*(s-o+1)+o)},this.nextByte=function(){return n.nextInt(0,255)},this.nextData=function(o){return zc(new Array(o)).map(function(){return n.nextByte()})};var i=yl(t);this.s=[f.BigInt(0),f.BigInt(0),f.BigInt(0),f.BigInt(0)],this.setS(i)}return e.prototype.setS=function(t){for(var n=0;n<4;n++){for(var i=n*8,o=f.BigInt(0),s=0;s<8;s++)o=f.asUintN(64,f.leftShift(o,f.BigInt(8))),o=f.asUintN(64,f.bitwiseOr(o,f.BigInt(t[i+s])));this.s[n]=f.asUintN(64,o)}},e.prototype.roll=function(){var t=f.asUintN(64,f.multiply(ro(f.asUintN(64,f.multiply(this.s[1],f.BigInt(5))),7),f.BigInt(9))),n=f.asUintN(64,f.leftShift(this.s[1],f.BigInt(17)));return this.s[2]=f.asUintN(64,f.bitwiseXor(this.s[2],f.BigInt(this.s[0]))),this.s[3]=f.asUintN(64,f.bitwiseXor(this.s[3],f.BigInt(this.s[1]))),this.s[1]=f.asUintN(64,f.bitwiseXor(this.s[1],f.BigInt(this.s[2]))),this.s[0]=f.asUintN(64,f.bitwiseXor(this.s[0],f.BigInt(this.s[3]))),this.s[2]=f.asUintN(64,f.bitwiseXor(this.s[2],f.BigInt(n))),this.s[3]=f.asUintN(64,ro(this.s[3],45)),t},e}();function Sn(e,t,n){this.alias=[],this.prob=[],this.outcomes=t||this.indexedOutcomes(e.length),this.rng=n||Math.random,this.precomputeAlias(e)}Sn.prototype.next=function(e){var t=e||1,n=[],i=0;do{var o=Math.floor(this.rng()*this.prob.length);n[i]=this.outcomes[this.rng()<this.prob[o]?o:this.alias[o]]}while(++i<t);return t>1?n:n[0]};Sn.prototype.precomputeAlias=function(e){var t=e.length,n=0,i=0,o=0,s=[],a=[],c=[],l,m,h;for(m=0;m<t;++m){if(e[m]<0)throw"Probability must be a positive: p["+m+"]="+e[m];n+=e[m]}if(n===0)throw"Probability cannot be zero.";for(m=0;m<t;++m)s[m]=e[m]*t/n;for(m=t-1;m>=0;--m)s[m]<1?a[i++]=m:c[o++]=m;for(;i&&o;)h=a[--i],l=c[--o],this.prob[h]=s[h],this.alias[h]=l,s[l]=s[l]+s[h]-1,s[l]<1?a[i++]=l:c[o++]=l;for(;o;)this.prob[c[--o]]=1;for(;i;)this.prob[a[--i]]=1};Sn.prototype.indexedOutcomes=function(e){for(var t=[],n=0;n<e;n++)t[n]=n;return t};Sn.prototype.randomInt=function(e,t){return Math.floor(this.rng()*(t-e))+e};var Qc=function(e,t,n){return new Sn(e,t,n)},Li=globalThis&&globalThis.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var i=Array(e),o=0,t=0;t<n;t++)for(var s=arguments[t],a=0,c=s.length;a<c;a++,o++)i[o]=s[a];return i},Kc=function(e,t){var n=Li(new Array(e)).map(function(o,s){return 1/(s+1)}),i=Qc(n,null,t.nextDouble);return i.next()+1},Hc=function(e,t){for(var n=Li(e),i=[];n.length>0;){var o=t.nextInt(0,n.length-1),s=n[o];n.splice(o,1),i.push(s)}return i},Zo=function(e,t,n){if(e<=t)return[e-1];var i=Le.Buffer.concat([eo(e),eo(n)]),o=new jc(i),s=Kc(t,o),a=Li(new Array(t)).map(function(l,m){return m}),c=Hc(a,o);return c.slice(0,s)},Yo=function(){function e(t,n,i,o,s){this._seqNum=t,this._seqLength=n,this._messageLength=i,this._checksum=o,this._fragment=s}return Object.defineProperty(e.prototype,"messageLength",{get:function(){return this._messageLength},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fragment",{get:function(){return this._fragment},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"seqNum",{get:function(){return this._seqNum},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"seqLength",{get:function(){return this._seqLength},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"checksum",{get:function(){return this._checksum},enumerable:!1,configurable:!0}),e.prototype.cbor=function(){var t=Ho([this._seqNum,this._seqLength,this._messageLength,this._checksum,this._fragment]);return Le.Buffer.from(t)},e.prototype.description=function(){return"seqNum:"+this._seqNum+", seqLen:"+this._seqLength+", messageLen:"+this._messageLength+", checksum:"+this._checksum+", data:"+this._fragment.toString("hex")},e.fromCBOR=function(t){var n=Go(t),i=n[0],o=n[1],s=n[2],a=n[3],c=n[4];if(typeof i!="number"||typeof o!="number"||typeof s!="number"||typeof a!="number"||Le.Buffer.isBuffer(c)&&c.length<=0)throw new Error("type error");return new e(i,o,s,a,Le.Buffer.from(c))},e}(),Gc=function(){function e(t,n,i,o){n===void 0&&(n=100),i===void 0&&(i=0),o===void 0&&(o=10);var s=e.findNominalFragmentLength(t.length,o,n);this._messageLength=t.length,this._fragments=e.partitionMessage(t,s),this.fragmentLength=s,this.seqNum=vi(i),this.checksum=Uo(t)}return Object.defineProperty(e.prototype,"fragmentsLength",{get:function(){return this._fragments.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fragments",{get:function(){return this._fragments},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"messageLength",{get:function(){return this._messageLength},enumerable:!1,configurable:!0}),e.prototype.isComplete=function(){return this.seqNum>=this._fragments.length},e.prototype.isSinglePart=function(){return this._fragments.length===1},e.prototype.seqLength=function(){return this._fragments.length},e.prototype.mix=function(t){var n=this;return t.reduce(function(i,o){return xo(n._fragments[o],i)},Le.Buffer.alloc(this.fragmentLength,0))},e.prototype.nextPart=function(){this.seqNum=vi(this.seqNum+1);var t=Zo(this.seqNum,this._fragments.length,this.checksum),n=this.mix(t);return new Yo(this.seqNum,this._fragments.length,this._messageLength,this.checksum,n)},e.findNominalFragmentLength=function(t,n,i){if(t<=0||n<=0||i<n)throw new Error("invalid fragment or message length");for(var o=Math.ceil(t/n),s=0,a=1;a<=o&&(s=Math.ceil(t/a),!(s<=i));a++);return s},e.partitionMessage=function(t,n){for(var i,o=Le.Buffer.from(t),s,a=[];o.length>0;)i=Ro(o,-n),s=i[0],o=i[1],s=Le.Buffer.alloc(n,0).fill(s,0,s.length),a.push(s);return a},e}(),Jo=globalThis&&globalThis.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var i=Array(e),o=0,t=0;t<n;t++)for(var s=arguments[t],a=0,c=s.length;a<c;a++,o++)i[o]=s[a];return i},Xc="ableacidalsoapexaquaarchatomauntawayaxisbackbaldbarnbeltbetabiasbluebodybragbrewbulbbuzzcalmcashcatschefcityclawcodecolacookcostcruxcurlcuspcyandarkdatadaysdelidicedietdoordowndrawdropdrumdulldutyeacheasyechoedgeepicevenexamexiteyesfactfairfernfigsfilmfishfizzflapflewfluxfoxyfreefrogfuelfundgalagamegeargemsgiftgirlglowgoodgraygrimgurugushgyrohalfhanghardhawkheathelphighhillholyhopehornhutsicedideaidleinchinkyintoirisironitemjadejazzjoinjoltjowljudojugsjumpjunkjurykeepkenokeptkeyskickkilnkingkitekiwiknoblamblavalazyleaflegsliarlimplionlistlogoloudloveluaulucklungmainmanymathmazememomenumeowmildmintmissmonknailnavyneednewsnextnoonnotenumbobeyoboeomitonyxopenovalowlspaidpartpeckplaypluspoempoolposepuffpumapurrquadquizraceramprealredorichroadrockroofrubyruinrunsrustsafesagascarsetssilkskewslotsoapsolosongstubsurfswantacotasktaxitenttiedtimetinytoiltombtoystriptunatwinuglyundouniturgeuservastveryvetovialvibeviewvisavoidvowswallwandwarmwaspwavewaxywebswhatwhenwhizwolfworkyankyawnyellyogayurtzapszerozestzinczonezoom",Nn=[],Zc=256,zt=4,Yc=2,Dt;(function(e){e.STANDARD="standard",e.URI="uri",e.MINIMAL="minimal"})(Dt||(Dt={}));var Qn=function(e){return Xc.slice(e*zt,e*zt+zt)},Jc=function(e){var t=Qn(e);return""+t[0]+t[zt-1]},es=function(e){var t=No(Le.Buffer.from(e,"hex"));return""+e+t},lo=function(e,t){var n=es(e),i=Le.Buffer.from(n,"hex"),o=i.reduce(function(s,a){return Jo(s,[Qn(a)])},[]);return o.join(t)},eu=function(e){var t=es(e),n=Le.Buffer.from(t,"hex"),i=n.reduce(function(o,s){return o+Jc(s)},"");return i},tu=function(e,t){if(e.length!==t)throw new Error("'Invalid Bytewords: word.length does not match wordLength provided'");var n=26;if(Nn.length===0){var i=n*n;Nn=Jo(new Array(i)).map(function(){return-1});for(var o=0;o<Zc;o++){var s=Qn(o),a=s[0].charCodeAt(0)-"a".charCodeAt(0),c=s[3].charCodeAt(0)-"a".charCodeAt(0),l=c*n+a;Nn[l]=o}}var m=e[0].toLowerCase().charCodeAt(0)-"a".charCodeAt(0),h=e[t==4?3:1].toLowerCase().charCodeAt(0)-"a".charCodeAt(0);if(!(0<=m&&m<n&&0<=h&&h<n))throw new Error("Invalid Bytewords: invalid word");var w=h*n+m,y=Nn[w];if(y===-1)throw new Error("Invalid Bytewords: value not in lookup table");if(t==zt){var s=Qn(y),P=e[1].toLowerCase(),A=e[2].toLowerCase();if(!(P===s[1]&&A===s[2]))throw new Error("Invalid Bytewords: invalid middle letters of word")}return Le.Buffer.from([y]).toString("hex")},gi=function(e,t,n){var i=n==zt?e.split(t):_l(e,2),o=i.map(function(m){return tu(m,n)}).join("");if(o.length<5)throw new Error("Invalid Bytewords: invalid decoded string length");var s=Ro(Le.Buffer.from(o,"hex"),4),a=s[0],c=s[1],l=No(a);if(l!==c.toString("hex"))throw new Error("Invalid Checksum");return a.toString("hex")},nu=function(e,t){switch(t===void 0&&(t=Dt.MINIMAL),t){case Dt.STANDARD:return gi(e," ",zt);case Dt.URI:return gi(e,"-",zt);case Dt.MINIMAL:return gi(e,"",Yc);default:throw new Error("Invalid style "+t)}},iu=function(e,t){switch(t===void 0&&(t=Dt.MINIMAL),t){case Dt.STANDARD:return lo(e," ");case Dt.URI:return lo(e,"-");case Dt.MINIMAL:return eu(e);default:throw new Error("Invalid style "+t)}},Ot={decode:nu,encode:iu,STYLES:Dt},ou=globalThis&&globalThis.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var i=Array(e),o=0,t=0;t<n;t++)for(var s=arguments[t],a=0,c=s.length;a<c;a++,o++)i[o]=s[a];return i},su=function(){function e(t,n,i,o){this.ur=t,this.fountainEncoder=new Gc(t.cbor,n,i,o)}return Object.defineProperty(e.prototype,"fragmentsLength",{get:function(){return this.fountainEncoder.fragmentsLength},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fragments",{get:function(){return this.fountainEncoder.fragments},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"messageLength",{get:function(){return this.fountainEncoder.messageLength},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cbor",{get:function(){return this.ur.cbor},enumerable:!1,configurable:!0}),e.prototype.encodeWhole=function(){var t=this;return ou(new Array(this.fragmentsLength)).map(function(){return t.nextPart()})},e.prototype.nextPart=function(){var t=this.fountainEncoder.nextPart();return this.fountainEncoder.isSinglePart()?e.encodeSinglePart(this.ur):e.encodePart(this.ur.type,t)},e.encodeUri=function(t,n){var i=n.join("/");return[t,i].join(":")},e.encodeUR=function(t){return e.encodeUri("ur",t)},e.encodePart=function(t,n){var i=n.seqNum+"-"+n.seqLength,o=Ot.encode(n.cbor().toString("hex"),Ot.STYLES.MINIMAL);return e.encodeUR([t,i,o])},e.encodeSinglePart=function(t){var n=Ot.encode(t.cbor.toString("hex"),Ot.STYLES.MINIMAL);return e.encodeUR([t.type,n])},e}(),xn=globalThis&&globalThis.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var i=Array(e),o=0,t=0;t<n;t++)for(var s=arguments[t],a=0,c=s.length;a<c;a++,o++)i[o]=s[a];return i},co=function(){function e(t,n){this._indexes=t,this._fragment=n}return Object.defineProperty(e.prototype,"indexes",{get:function(){return this._indexes},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fragment",{get:function(){return this._fragment},enumerable:!1,configurable:!0}),e.fromEncoderPart=function(t){var n=Zo(t.seqNum,t.seqLength,t.checksum),i=t.fragment;return new e(n,i)},e.prototype.isSimple=function(){return this.indexes.length===1},e}(),au=function(){function e(){this.result=void 0,this.expectedMessageLength=0,this.expectedChecksum=0,this.expectedFragmentLength=0,this.processedPartsCount=0,this.expectedPartIndexes=[],this.lastPartIndexes=[],this.queuedParts=[],this.receivedPartIndexes=[],this.mixedParts=[],this.simpleParts=[]}return e.prototype.validatePart=function(t){var n=this;if(this.expectedPartIndexes.length===0)xn(new Array(t.seqLength)).forEach(function(i,o){return n.expectedPartIndexes.push(o)}),this.expectedMessageLength=t.messageLength,this.expectedChecksum=t.checksum,this.expectedFragmentLength=t.fragment.length;else if(this.expectedPartIndexes.length!==t.seqLength||this.expectedMessageLength!==t.messageLength||this.expectedChecksum!==t.checksum||this.expectedFragmentLength!==t.fragment.length)return!1;return!0},e.prototype.reducePartByPart=function(t,n){if(wl(t.indexes,n.indexes)){var i=kl(t.indexes,n.indexes),o=xo(t.fragment,n.fragment);return new co(i,o)}else return t},e.prototype.reduceMixedBy=function(t){var n=this,i=[];this.mixedParts.map(function(o){var s=o.value;return n.reducePartByPart(s,t)}).forEach(function(o){o.isSimple()?n.queuedParts.push(o):i.push({key:o.indexes,value:o})}),this.mixedParts=i},e.prototype.processSimplePart=function(t){var n=t.indexes[0];if(!this.receivedPartIndexes.includes(n))if(this.simpleParts.push({key:t.indexes,value:t}),this.receivedPartIndexes.push(n),to(this.receivedPartIndexes,this.expectedPartIndexes)){var i=this.simpleParts.map(function(a){var c=a.value;return c}).sort(function(a,c){return a.indexes[0]-c.indexes[0]}),o=e.joinFragments(i.map(function(a){return a.fragment}),this.expectedMessageLength),s=Uo(o);s===this.expectedChecksum?this.result=o:this.error=new pl}else this.reduceMixedBy(t)},e.prototype.processMixedPart=function(t){var n=this;if(!this.mixedParts.some(function(o){var s=o.key;return to(s,t.indexes)})){var i=this.simpleParts.reduce(function(o,s){var a=s.value;return n.reducePartByPart(o,a)},t);i=this.mixedParts.reduce(function(o,s){var a=s.value;return n.reducePartByPart(o,a)},i),i.isSimple()?this.queuedParts.push(i):(this.reduceMixedBy(i),this.mixedParts.push({key:i.indexes,value:i}))}},e.prototype.processQueuedItem=function(){if(this.queuedParts.length!==0){var t=this.queuedParts.shift();t.isSimple()?this.processSimplePart(t):this.processMixedPart(t)}},e.prototype.receivePart=function(t){if(this.isComplete()||!this.validatePart(t))return!1;var n=co.fromEncoderPart(t);for(this.lastPartIndexes=n.indexes,this.queuedParts.push(n);!this.isComplete()&&this.queuedParts.length>0;)this.processQueuedItem();return this.processedPartsCount+=1,!0},e.prototype.isComplete=function(){return Boolean(this.result!==void 0&&this.result.length>0)},e.prototype.isSuccess=function(){return Boolean(this.error===void 0&&this.isComplete())},e.prototype.resultMessage=function(){return this.isSuccess()?this.result:Le.Buffer.from([])},e.prototype.isFailure=function(){return this.error!==void 0},e.prototype.resultError=function(){return this.error?this.error.message:""},e.prototype.expectedPartCount=function(){return this.expectedPartIndexes.length},e.prototype.getExpectedPartIndexes=function(){return xn(this.expectedPartIndexes)},e.prototype.getReceivedPartIndexes=function(){return xn(this.receivedPartIndexes)},e.prototype.getLastPartIndexes=function(){return xn(this.lastPartIndexes)},e.prototype.estimatedPercentComplete=function(){if(this.isComplete())return 1;var t=this.expectedPartCount();return t===0?0:Math.min(.99,this.processedPartsCount/(t*1.75))},e.prototype.getProgress=function(){if(this.isComplete())return 1;var t=this.expectedPartCount();return t===0?0:this.receivedPartIndexes.length/t},e.joinFragments=function(t,n){return Le.Buffer.concat(t).slice(0,n)},e}(),ru=function(){function e(t,n){if(t===void 0&&(t=new au),n===void 0&&(n="bytes"),this.fountainDecoder=t,this.type=n,!Ln(n))throw new Error("Invalid UR type");this.expected_type=""}return e.decodeBody=function(t,n){var i=Ot.decode(n,Ot.STYLES.MINIMAL);return new On(Le.Buffer.from(i,"hex"),t)},e.prototype.validatePart=function(t){return this.expected_type?this.expected_type===t:Ln(t)?(this.expected_type=t,!0):!1},e.decode=function(t){var n=this.parse(t),i=n[0],o=n[1];if(o.length===0)throw new ui;var s=o[0];return e.decodeBody(i,s)},e.parse=function(t){var n=t.toLowerCase(),i=n.slice(0,3);if(i!=="ur:")throw new Yi;var o=n.slice(3).split("/"),s=o[0];if(o.length<2)throw new ui;if(!Ln(s))throw new Ao;return[s,o.slice(1)]},e.parseSequenceComponent=function(t){var n=t.split("-");if(n.length!==2)throw new Ji;var i=vi(Number(n[0])),o=Number(n[1]);if(i<1||o<1)throw new Ji;return[i,o]},e.prototype.receivePart=function(t){if(this.result!==void 0)return!1;var n=e.parse(t),i=n[0],o=n[1];if(!this.validatePart(i))return!1;if(o.length===1)return this.result=e.decodeBody(i,o[0]),!0;if(o.length!==2)throw new ui;var s=o[0],a=o[1],c=e.parseSequenceComponent(s),l=c[0],m=c[1],h=Ot.decode(a,Ot.STYLES.MINIMAL),w=Yo.fromCBOR(h);return l!==w.seqNum||m!==w.seqLength||!this.fountainDecoder.receivePart(w)?!1:(this.fountainDecoder.isSuccess()?this.result=new On(this.fountainDecoder.resultMessage(),i):this.fountainDecoder.isFailure()&&(this.error=new Yi),!0)},e.prototype.resultUR=function(){return this.result?this.result:new On(Le.Buffer.from([]))},e.prototype.isComplete=function(){return!!(this.result&&this.result.cbor.length>0)},e.prototype.isSuccess=function(){return!this.error&&this.isComplete()},e.prototype.isError=function(){return this.error!==void 0},e.prototype.resultError=function(){return this.error?this.error.message:""},e.prototype.expectedPartCount=function(){return this.fountainDecoder.expectedPartCount()},e.prototype.expectedPartIndexes=function(){return this.fountainDecoder.getExpectedPartIndexes()},e.prototype.receivedPartIndexes=function(){return this.fountainDecoder.getReceivedPartIndexes()},e.prototype.lastPartIndexes=function(){return this.fountainDecoder.getLastPartIndexes()},e.prototype.estimatedPercentComplete=function(){return this.fountainDecoder.estimatedPercentComplete()},e.prototype.getProgress=function(){return this.fountainDecoder.getProgress()},e}();const lu=ze({name:"SendPaymentRequest",mixins:[windowMixin],props:{},data:function(){return{loading:!1}},watch:{},computed:{...se(fn,["showSendTokens","showLockInput","sendData"]),...te(ye,["activeMintUrl","mints"])},methods:{...oe(Ct,["isLocked","isLockedToUs"]),...oe($t,["parseAndPayPaymentRequest"]),clickPaymentRequest:async function(){this.loading=!0;try{await this.parseAndPayPaymentRequest(this.sendData.paymentRequest,this.sendData.tokensBase64)}catch(e){console.error("Error paying payment request:",e),notifyError(`${e.message}`,"Could not pay request")}finally{this.loading=!1}},getPaymentRequestTransportType:function(e){if(!e||!e.transport)return"Unknown";console.log(`### getPaymentRequestTransportType: ${e}`);const t=e.transport;for(const n of t){if(n.type==In.NOSTR)return"Nostr";if(n.type==In.POST)return"HTTP"}},getPaymentRequestTarget:function(e){if(!e||!e.transport)return"Unknown";console.log(`### getPaymentRequestDestination: ${e}`);const t=e.transport;for(const n of t){if(n.type==In.NOSTR)return`${n.target.slice(0,20)}..${n.target.slice(-10)}`;if(n.type==In.POST)try{return new URL(n.target).hostname}catch(i){return console.error(`Invalid URL in transport.target: ${n.target}`,i),"Invalid URL"}}}}}),cu={key:0,class:"q-pa-none q-ma-none q-mt-sm"},uu={class:"q-mb-md text-center"},du={class:"text-center"},fu={class:"q-mt-md q-mb-md text-center",style:{display:"block","font-family":"monospace","white-space":"pre-wrap","word-wrap":"break-word","max-width":"350px",margin:"0 auto","font-size":"13px"}};function hu(e,t,n,i,o,s){return e.sendData.paymentRequest?(_(),F("div",cu,[g("div",uu,[r(R,{rounded:"",dense:"",color:"primary",class:"q-px-md",onClick:e.clickPaymentRequest},{default:u(()=>[e.loading?(_(),B(Pt,{key:1,size:"1em",class:"q-mr-md"})):(_(),B(J,{key:0,name:"send",class:"q-pr-xs"})),I(" Pay via "+M(e.getPaymentRequestTransportType(e.sendData.paymentRequest)),1)]),_:1},8,["onClick"])]),g("div",du,[g("span",fu," Pay to "+M(e.getPaymentRequestTarget(e.sendData.paymentRequest)),1)])])):x("",!0)}var mu=xe(lu,[["render",hu]]);const gu=ze({name:"NumericKeyboard",props:{modelValue:{type:String,default:"0"}},emits:["update:modelValue","done"],computed:{...se(Ae,["showNumericKeyboard"]),...se(Je,["useNumericKeyboard"])},methods:{addDigit(e){const t=this.modelValue||"0",n=t==="0"?e:t+e;this.$emit("update:modelValue",n)},backspace(){const e=this.modelValue||"0",t=e.length>1?e.slice(0,-1):"0";this.$emit("update:modelValue",t)},addComma(){const e=this.modelValue||"0";e.includes(".")||this.$emit("update:modelValue",e+".")},closeKeyboard(){this.useNumericKeyboard=!1,this.showNumericKeyboard=!1,Mo(this.$i18n.t("NumericKeyboard.actions.close.closed_info_text"),"bottom")},emitDone(){this.$emit("done")}}}),pu=e=>(Gn("data-v-2da46958"),e=e(),Xn(),e),vu={class:"keyboard-grid"},yu=pu(()=>g("br",null,null,-1));function _u(e,t,n,i,o,s){return _(),B(at,{name:"slide-up-fade"},{default:u(()=>[e.showNumericKeyboard?(_(),B(Qe,{key:0,class:"numeric-keyboard q-pa-md q-pb-xl q-pt-lg",style:{position:"fixed",bottom:"0",left:"50%",transform:"translateX(-50%)",width:"100%","max-width":"650px"}},{default:u(()=>[g("div",vu,[r(R,{flat:"",dense:"",class:"text-h5",onClick:t[0]||(t[0]=a=>e.addDigit("1"))},{default:u(()=>[I("1")]),_:1}),r(R,{flat:"",dense:"",class:"text-h5",onClick:t[1]||(t[1]=a=>e.addDigit("2"))},{default:u(()=>[I("2")]),_:1}),r(R,{flat:"",dense:"",class:"text-h5",onClick:t[2]||(t[2]=a=>e.addDigit("3"))},{default:u(()=>[I("3")]),_:1}),r(R,{flat:"",dense:"",class:"text-h5",onClick:t[3]||(t[3]=a=>e.addDigit("4"))},{default:u(()=>[I("4")]),_:1}),r(R,{flat:"",dense:"",class:"text-h5",onClick:t[4]||(t[4]=a=>e.addDigit("5"))},{default:u(()=>[I("5")]),_:1}),r(R,{flat:"",dense:"",class:"text-h5",onClick:t[5]||(t[5]=a=>e.addDigit("6"))},{default:u(()=>[I("6")]),_:1}),r(R,{flat:"",dense:"",class:"text-h5",onClick:t[6]||(t[6]=a=>e.addDigit("7"))},{default:u(()=>[I("7")]),_:1}),r(R,{flat:"",dense:"",class:"text-h5",onClick:t[7]||(t[7]=a=>e.addDigit("8"))},{default:u(()=>[I("8")]),_:1}),r(R,{flat:"",dense:"",class:"text-h5",onClick:t[8]||(t[8]=a=>e.addDigit("9"))},{default:u(()=>[I("9")]),_:1}),r(R,{flat:"",dense:"",class:"text-h5",onClick:e.addComma},{default:u(()=>[I(".")]),_:1},8,["onClick"]),r(R,{flat:"",dense:"",class:"text-h5",onClick:t[9]||(t[9]=a=>e.addDigit("0"))},{default:u(()=>[I("0")]),_:1}),r(R,{flat:"",dense:"",class:"text-h5",onClick:e.backspace},{default:u(()=>[r(J,{name:"backspace",size:"sm"})]),_:1},8,["onClick"]),r(R,{flat:"",dense:"",onClick:e.closeKeyboard},{default:u(()=>[I(M(e.$t("NumericKeyboard.actions.close.label")),1)]),_:1},8,["onClick"]),yu,r(R,{flat:"",dense:"",onClick:e.emitDone},{default:u(()=>[I(M(e.$t("NumericKeyboard.actions.enter.label")),1)]),_:1},8,["onClick"])])]),_:1})):x("",!0)]),_:1})}var ts=xe(gu,[["render",_u],["__scopeId","data-v-2da46958"]]);const wu=ze({name:"SendTokenDialog",mixins:[windowMixin],components:{ChooseMint:$n,TokenInformation:Io,SendPaymentRequest:mu,NumericKeyboard:ts,ScanIcon:Yt,NfcIcon:qi,ShareIcon:za,ZapIcon:Pn},props:{},data:function(){return{baseURL:location.protocol+"//"+location.host+location.pathname,showAnimatedQR:!1,qrCodeFragment:"",qrInterval:null,encoder:null,showDeleteDialog:!1,p2pkInput:"",currentFragmentLength:150,fragmentLengthMedium:100,fragmentLengthShort:50,fragmentLengthLong:150,fragmentLengthLabel:"L",currentFragmentInterval:150,fragmentIntervalMedium:250,fragmentIntervalFast:150,framentInervalSlow:500,fragmentSpeedLabel:"F",isV4Token:!1,scanningCard:!1,showExpandedButtons:!1}},computed:{...se(fn,["showSendTokens","showLockInput","sendData"]),...se(et,["camera","hasCamera"]),...te(Ae,["tickerShort","canPasteFromClipboard","globalMutexLock","ndefSupported","webShareSupported"]),...se(Ae,["showNumericKeyboard"]),...te(ye,["mints","activeProofs","activeUnit","activeUnitLabel","activeUnitCurrencyMultiplyer","activeMintUrl","activeBalance"]),...te(Je,["checkSentTokens","includeFeesInSendAmount","nfcEncoding","useNumericKeyboard"]),...te(cn,["bitcoinPrice","bitcoinPrices","currentCurrencyPrice"]),...te(Je,["bitcoinPriceCurrency"]),...te(un,["tokenWorkerRunning"]),...se(Ne,["payInvoiceData"]),canMakePayments:function(){return!!this.mints.length},sumProofs:function(){return De.getProofs(De.decode(this.sendData.tokensBase64)).flat().reduce((t,n)=>t+=n.amount,0)},displayUnit:function(){return this.formatCurrency(this.sumProofs,this.tokenUnit)},tokenUnit:function(){return De.getUnit(De.decode(this.sendData.tokensBase64))},tokenMintUrl:function(){return De.getMint(De.decode(this.sendData.tokensBase64))},paidFees:function(){return this.sumProofs-Math.abs(this.sendData.historyAmount)},displayMemo:function(){return De.getMemo(De.decode(this.sendData.tokensBase64))},shortUrl:function(){return jt(this.tokenMintUrl)},decodedToken:function(){return De.decode(this.sendData.tokensBase64)},runnerActive:function(){return this.tokenWorkerRunning},canSpendOffline:function(){if(!this.sendData.amount)return!1;let e=this.spendableProofs(this.activeProofs);const t=Ne().wallet;let n=this.coinSelect(e,t,this.sendData.amount*this.activeUnitCurrencyMultiplyer,this.includeFeesInSendAmount);const i=this.includeFeesInSendAmount?this.getFeesForProofs(n):0;return n.flat().reduce((s,a)=>s+=a.amount,0)==this.sendData.amount*this.activeUnitCurrencyMultiplyer+i}},watch:{"sendData.tokensBase64":function(e){if(this.showAnimatedQR=!1,!e.length)return;const n=De.decode(e).proofs;if(n.length)n.length<=2?this.qrCodeFragment=e:(this.showAnimatedQR=!0,this.qrCodeFragment="",this.startQrCodeLoop());else return;this.isV4Token=e.startsWith("cashuB")},showSendTokens:function(e){if(e){if(this.$nextTick(()=>{this.sendData.tokensBase64.length?this.showNumericKeyboard=!1:this.showNumericKeyboard=!0}),this.sendData.historyToken&&this.sendData.historyToken.amount<0&&this.sendData.historyToken.status==="pending"){if(!this.checkSentTokens){console.log("settingsStore.checkSentTokens is disabled, skipping token check");return}this.checkTokenSpendable(this.sendData.historyToken,!1)||(this.sendData.historyToken.status="paid")}}else clearInterval(this.qrInterval),this.sendData.data="",this.sendData.tokensBase64="",this.sendData.historyToken=null,this.sendData.paymentRequest=null}},methods:{...oe(un,["clearAllWorkers"]),...oe(Ne,["send","sendToLock","coinSelect","spendableProofs","getFeesForProofs","onTokenPaid","mintWallet","checkTokenSpendable"]),...oe(Di,["serializeProofs"]),...oe(lt,["addPendingToken","setTokenPaid","deleteToken"]),...oe(Ct,["isValidPubkey","maybeConvertNpub"]),...oe(et,["closeCamera","showCamera"]),...oe(ye,["toggleUnit"]),encodeToPeanut:function(e){return"\u{1F95C}"+Array.from(e).map(t=>{const n=t.charCodeAt(0);if(n>=0&&n<=15)return String.fromCodePoint(65024+n);if(n>=16&&n<=255)return String.fromCodePoint(917760+(n-16))}).join("")},decodeToken:function(e){return De.decode(e)},getProofs:function(e){return De.getProofs(e)},getAmount:function(e){return De.getAmount(e)},getUnit:function(e){return De.getUnit(e)},getMint:function(e){return De.getMint(e)},toggleExpandButtons(){this.showExpandedButtons=!this.showExpandedButtons},startQrCodeLoop:async function(){if(this.sendData.tokensBase64.length==0)return;const e=Le.Buffer.from(this.sendData.tokensBase64),t=On.fromBuffer(e),n=0;this.encoder=new su(t,this.currentFragmentLength,n),clearInterval(this.qrInterval),this.qrInterval=setInterval(()=>{this.qrCodeFragment=this.encoder.nextPart()},this.currentFragmentInterval)},updateQrCode:function(){this.qrCodeFragment=this.encoder.nextPart()},changeSpeed:function(){this.currentFragmentInterval==this.fragmentIntervalMedium?(this.currentFragmentInterval=this.framentInervalSlow,this.fragmentSpeedLabel="S"):this.currentFragmentInterval==this.framentInervalSlow?(this.currentFragmentInterval=this.fragmentIntervalFast,this.fragmentSpeedLabel="F"):(this.currentFragmentInterval=this.fragmentIntervalMedium,this.fragmentSpeedLabel="M"),console.log("### this.currentFragmentInterval",this.currentFragmentInterval),this.startQrCodeLoop()},changeSize:function(){this.currentFragmentLength==this.fragmentLengthMedium?(this.currentFragmentLength=this.fragmentLengthShort,this.fragmentLengthLabel="S"):this.currentFragmentLength==this.fragmentLengthShort?(this.currentFragmentLength=this.fragmentLengthLong,this.fragmentLengthLabel="L"):(this.currentFragmentLength=this.fragmentLengthMedium,this.fragmentLengthLabel="M"),console.log("### this.currentFragmentLength",this.currentFragmentLength),this.startQrCodeLoop()},toggleTokenEncoding:function(){const e=Ki(this.sendData.tokensBase64);if(this.sendData.tokensBase64.startsWith("cashuA"))try{this.sendData.tokensBase64=Ws(e)}catch{console.log("### Could not encode token to V4"),this.sendData.tokensBase64=Hi(e,{version:3})}else this.sendData.tokensBase64=Hi(e,{version:3})},deleteThisToken:function(){this.deleteToken(this.sendData.tokensBase64),this.showSendTokens=!1,this.showDeleteDialog=!1,this.clearAllWorkers()},writeTokensToCard:function(){if(!this.scanningCard)try{this.ndef=new NDEFReader,this.controller=new AbortController;const e=this.controller.signal;this.ndef.scan({signal:e}).then(()=>{console.log("> Scan started"),this.ndef.onreadingerror=t=>{console.error(`NFC read failed: ${t}`),Te(`${err.message}`,"NFC read failed"),this.controller.abort(),this.scanningCard=!1},this.ndef.onreading=({message:t,serialNumber:n})=>{console.log(`Read card ${n}`),this.controller.abort(),this.scanningCard=!1;try{let i=[];switch(this.nfcEncoding){case"text":i=[{recordType:"text",data:`${this.sendData.tokensBase64}`,lang:"en"}];break;case"weburl":i=[{recordType:"url",data:`${window.location}#token=${this.sendData.tokensBase64}`}];break;case"binary":const o=Ki(this.sendData.tokensBase64),s=js(o);i=[{recordType:"mime",mediaType:"application/octet-stream",data:s}];break;default:throw new Error(`Unknown NFC encoding: ${this.nfcEncoding}`)}st("Writing to NFC card..."),this.ndef.write({records:i},{overwrite:!0}).then(()=>{console.log("Successfully flashed token to card!"),st("Successfully flashed token to card!")}).catch(o=>{console.error(`NFC write failed: The card may not have enough capacity (needed ${i[0].data.length} bytes).`),Te(`The card may not have enough capacity (needed ${i[0].data.length} bytes).`,"NFC write failed")})}catch(i){console.error(`NFC error: ${i.message}`),Te(`${i.message}`,"NFC error")}},this.scanningCard=!0}).catch(t=>{console.error(`NFC error: ${t.message}`),Te(`${err.message}`,"NFC error"),this.scanningCard=!1})}catch(e){console.error(`NFC error: ${e.message}`),Te(`${err.message}`,"NFC error"),this.scanningCard=!1}},closeCardScanner:function(){this.controller.abort(),this.scanningCard=!1},lockTokens:async function(){let e=Math.floor(this.sendData.amount*this.activeUnitCurrencyMultiplyer);try{const t=this.mintWallet(this.activeMintUrl,this.activeUnit);let{_:n,sendProofs:i}=await this.sendToLock(this.activeProofs,t,e,this.sendData.p2pkPubkey);this.sendData.tokens=i,this.sendData.tokensBase64=this.serializeProofs(i);const o={amount:-this.sendData.amount,token:this.sendData.tokensBase64,unit:this.activeUnit,mint:this.activeMintUrl};this.addPendingToken(o),this.sendData.historyToken=o,this.g.offline||this.onTokenPaid(o)}catch(t){console.error(t)}},sendTokens:async function(){if(this.showNumericKeyboard=!1,this.sendData.p2pkPubkey=this.maybeConvertNpub(this.sendData.p2pkPubkey),this.sendData.p2pkPubkey&&this.isValidPubkey(this.sendData.p2pkPubkey)){await this.lockTokens();return}try{let e=Math.floor(this.sendData.amount*this.activeUnitCurrencyMultiplyer);const t=this.mintWallet(this.activeMintUrl,this.activeUnit);let{_:n,sendProofs:i}=await this.send(this.activeProofs,t,e,!0,this.includeFeesInSendAmount);this.sendData.tokens=i,this.sendData.tokensBase64=this.serializeProofs(i),this.sendData.historyAmount=-this.sendData.amount*this.activeUnitCurrencyMultiplyer;const o={amount:-e,token:this.sendData.tokensBase64,unit:this.activeUnit,mint:this.activeMintUrl,paymentRequest:this.sendData.paymentRequest,status:"pending"};this.addPendingToken(o),this.sendData.historyToken=o,this.g.offline||this.onTokenPaid(o)}catch(e){console.error(e)}},pasteToP2PKField:async function(){console.log("pasteToParseDialog");const e=await Ae().pasteFromClipboard();this.sendData.p2pkPubkey=e.trim()},shareToken:async function(){if(!this.webShareSupported){console.log("Web Share API not supported");return}const e={text:`cashu:${this.sendData.tokensBase64}`};try{await navigator.share(e),console.log("Token shared successfully")}catch(t){t.name!=="AbortError"&&console.error("Error sharing token:",t)}},showParseDialog:function(){if(!this.canMakePayments){kn(this.$i18n.t("SendDialog.actions.lightning.error_no_mints")),this.showSendTokens=!1;return}this.payInvoiceData.show=!0,this.payInvoiceData.invoice=null,this.payInvoiceData.lnurlpay=null,this.payInvoiceData.domain="",this.payInvoiceData.lnurlauth=null,this.payInvoiceData.input.request="",this.payInvoiceData.input.comment="",this.showSendTokens=!1}}}),ku={key:1},bu={class:"row items-center no-wrap q-mb-sm q-py-lg"},Du={class:"col-8"},Cu={key:0,class:"text-h6"},$u={key:1,class:"text-h6"},Pu={key:0,class:"text-primary text-weight-bold"},Mu={key:2,class:"q-ml-xs text-subtitle2 text-grey-6"},qu={class:"col-4 text-right",style:{height:"30px"}},Tu={class:"text-subtitle2 text-weight-medium"},Su={class:"row items-center no-wrap q-my-sm q-py-none"},Iu={class:"col-12"},Au={key:0,class:"row items-center no-wrap"},Eu={class:"col-4 q-mx-md"},Ru={key:0,class:"row q-mt-lg"},Uu={key:1,class:"row"},Nu={key:1,class:"row q-mt-lg"},xu={class:"text-center"},Bu={key:2,class:"text-center q-mb-xs"},Lu={key:0,class:"text-center q-mb-md"},Fu={style:{height:"2px"}},Ou={class:"q-pb-xs q-ba-none q-gutter-sm"},Vu={class:"row justify-center"},zu={class:"row justify-center q-pt-sm"},Wu={key:0,class:"row justify-center q-pt-sm"},ju={key:1,class:"row justify-center"},Qu={class:"row justify-center q-pt-md"},Ku={key:2,class:"row justify-center q-pt-sm"},Hu={class:"row items-center justify-between q-mt-lg"},Gu={class:"row items-center"},Xu={key:0,class:"row q-gutter-sm"},Zu=g("div",{class:"row items-center no-wrap q-mb-sm"},[g("div",{class:"col-12"},[g("span",{class:"text-h6"},"Delete Ecash")])],-1),Yu={class:"row items-center no-wrap q-my-sm q-py-none"},Ju={class:"col-12"},ed={class:"row q-mt-lg"};function td(e,t,n,i,o,s){const a=G("NumericKeyboard"),c=G("ChooseMint"),l=G("ScanIcon"),m=G("ZapIcon"),h=G("vue-qrcode"),w=G("TokenInformation"),y=G("SendPaymentRequest"),P=G("ShareIcon"),A=G("NfcIcon");return _(),F(Ze,null,[r(Ye,{modelValue:e.showSendTokens,"onUpdate:modelValue":t[10]||(t[10]=U=>e.showSendTokens=U),position:"top",maximized:e.$q.screen.lt.sm,"backdrop-filter":"blur(2px) brightness(60%)","transition-show":"fade","transition-hide":"fade","no-backdrop-dismiss":"","full-height":"",onShow:e.onDialogShown},{default:u(()=>[r(Qe,{class:"q-pa-none q-pt-none qcard"},{default:u(()=>[e.showNumericKeyboard&&e.useNumericKeyboard?(_(),B(a,{key:0,"model-value":e.sendData.amount,"onUpdate:modelValue":t[0]||(t[0]=U=>e.sendData.amount=U),onDone:e.sendTokens},null,8,["model-value","onDone"])):x("",!0),e.sendData.tokens?(_(),F("div",Bu,[r(Se,{class:"q-pa-none q-pt-md"},{default:u(()=>[e.qrCodeFragment?(_(),F("div",Lu,[r(_i,{ratio:1,class:"q-mx-none"},{default:u(()=>[r(h,{value:e.qrCodeFragment,options:{width:400},class:"rounded-borders",onClick:t[5]||(t[5]=U=>e.copyText(e.sendData.tokensBase64))},null,8,["value"])]),_:1}),g("div",Fu,[e.runnerActive?(_(),B($i,{key:0,indeterminate:"",color:"primary"})):x("",!0)])])):x("",!0),g("div",Ou,[e.showAnimatedQR?(_(),B(R,{key:0,flat:"",style:{"font-size":"10px"},color:"grey",class:"q-ma-none",onClick:e.changeSpeed},{default:u(()=>[r(J,{name:"speed",style:{"margin-right":"8px"}}),I(" Speed: "+M(e.fragmentSpeedLabel),1)]),_:1},8,["onClick"])):x("",!0),r(Wt,{color:e.isV4Token?"grey":"primary",label:e.isV4Token?"V4":"V3",class:"q-my-sm q-mx-md cursor-pointer",onClick:e.toggleTokenEncoding,outline:e.isV4Token},null,8,["color","label","onClick","outline"]),e.showAnimatedQR?(_(),B(R,{key:1,flat:"",style:{"font-size":"10px"},class:"q-ma-none",color:"grey",onClick:e.changeSize},{default:u(()=>[r(J,{name:"zoom_in",style:{"margin-right":"8px"}}),I(" Size: "+M(e.fragmentLengthLabel),1)]),_:1},8,["onClick"])):x("",!0)]),r(Se,{class:"q-pa-sm"},{default:u(()=>[g("div",Vu,[r(Ce,{overline:"",class:"q-mb-sm text-white",style:{"font-size":"1rem"}},{default:u(()=>[I(M(e.sendData.historyToken.amount&&e.sendData.historyToken.amount<0?e.sendData.historyToken.status==="paid"?"Sent":"Pending":"Received")+" Ecash",1)]),_:1})]),g("div",zu,[r(Ce,{style:{"font-size":"30px"},class:"text-weight-bold"},{default:u(()=>[r(J,{name:e.sendData.historyToken.amount>=0?"call_received":"call_made",color:e.sendData.historyToken.status==="paid"?e.sendData.historyToken.amount>=0?"green":"red":"",class:"q-mr-xs q-mb-xs",size:"sm"},null,8,["name","color"]),g("strong",null,M(e.displayUnit),1)]),_:1})]),e.paidFees?(_(),F("div",Wu,[r(Ce,{class:"text-weight-bold"},{default:u(()=>[I(" Fee: "+M(e.formatCurrency(e.paidFees,e.tokenUnit)),1)]),_:1})])):x("",!0),e.sendData.historyToken.amount&&e.sendData.historyToken.amount<0&&e.sendData.historyToken.status==="paid"?(_(),F("div",ju)):x("",!0),g("div",Qu,[r(w,{encodedToken:e.sendData.tokensBase64,showAmount:!1,showP2PKCheck:!1},null,8,["encodedToken"])]),e.sendData.paymentRequest&&e.sendData.historyToken.amount<0&&e.sendData.historyToken.status==="pending"?(_(),F("div",Ku,[r(y)])):x("",!0),g("div",Hu,[g("div",Gu,[r(R,{class:"q-ml-md",size:"md",flat:"",dense:"",onClick:t[6]||(t[6]=U=>e.copyText(e.sendData.tokensBase64))},{default:u(()=>[I(M(e.$t("SendTokenDialog.actions.copy_tokens.label")),1)]),_:1}),r(R,{class:"q-mx-none",size:"md",flat:"",dense:"",onClick:e.toggleExpandButtons},{default:u(()=>[r(J,{name:e.showExpandedButtons?"chevron_left":"chevron_right"},null,8,["name"])]),_:1},8,["onClick"]),e.showExpandedButtons?(_(),F("div",Xu,[r(R,{class:"q-mr-xs",size:"md",flat:"",dense:"",onClick:t[7]||(t[7]=U=>e.copyText(e.encodeToPeanut(e.sendData.tokensBase64)))},{default:u(()=>[I(M(e.$t("SendTokenDialog.actions.copy_emoji.label"))+" ",1),r(be,null,{default:u(()=>[I(M(e.$t("SendTokenDialog.actions.copy_emoji.tooltip_text")),1)]),_:1})]),_:1}),r(R,{class:"q-mx-none",color:"grey",size:"md",dense:"",icon:"link",flat:"",onClick:t[8]||(t[8]=U=>e.copyText(e.baseURL+"#token="+e.sendData.tokensBase64))},{default:u(()=>[r(be,null,{default:u(()=>[I(M(e.$t("SendTokenDialog.actions.copy_link.tooltip_text")),1)]),_:1})]),_:1}),e.webShareSupported?(_(),B(R,{key:0,class:"q-mx-none",color:"grey",size:"md",dense:"",flat:"",onClick:e.shareToken},{default:u(()=>[r(P,{size:"18"}),r(be,null,{default:u(()=>[I(M(e.$t("SendTokenDialog.actions.share.tooltip_text")),1)]),_:1})]),_:1},8,["onClick"])):x("",!0),e.hasCamera&&!e.sendData.paymentRequest&&e.sendData.historyAmount<0?(_(),B(R,{key:1,unelevated:"",dense:"",size:"sm",class:"q-mx-none",onClick:e.showCamera},{default:u(()=>[r(l)]),_:1},8,["onClick"])):x("",!0),e.ndefSupported&&!e.sendData.paymentRequest&&e.sendData.historyAmount<0?(_(),B(R,{key:2,unelevated:"",dense:"",disabled:e.scanningCard,loading:e.scanningCard,class:"q-mx-none",size:"sm",onClick:e.writeTokensToCard,flat:""},{loading:u(()=>[r(Cn,{onClick:e.closeCardScanner},null,8,["onClick"])]),default:u(()=>[r(A),r(be,null,{default:u(()=>[I(M(e.ndefSupported?e.$t("SendTokenDialog.actions.write_tokens_to_card.tooltips.ndef_supported_text"):e.$t("SendTokenDialog.actions.write_tokens_to_card.tooltips.ndef_unsupported_text")),1)]),_:1})]),_:1},8,["disabled","loading","onClick"])):x("",!0),r(R,{class:"q-mx-none",color:"grey",dense:"",icon:"delete",size:"md",onClick:t[9]||(t[9]=U=>{e.showDeleteDialog=!0,e.closeCardScanner()}),flat:""},{default:u(()=>[r(be,null,{default:u(()=>[I(M(e.$t("SendTokenDialog.actions.delete.tooltip_text")),1)]),_:1})]),_:1})])):x("",!0)]),Ie((_(),B(R,{onClick:e.closeCardScanner,flat:"",color:"grey",class:"q-ml-auto q-mr-md"},{default:u(()=>[I(M(e.$t("SendTokenDialog.actions.close_card_scanner.label")),1)]),_:1},8,["onClick"])),[[Ke]])])]),_:1})]),_:1})])):(_(),F("div",ku,[r(Se,{class:"q-pa-lg q-pt-md"},{default:u(()=>[g("div",bu,[g("div",Du,[e.sendData.paymentRequest?x("",!0):(_(),F("span",Cu,M(e.$t("SendTokenDialog.title",{value:e.sendData.amount?e.formatCurrency(e.sendData.amount*e.activeUnitCurrencyMultiplyer,e.activeUnit):e.$t("SendTokenDialog.title_ecash_text")})),1)),e.sendData.paymentRequest?(_(),F("span",$u,[I("Pay request "),e.sendData.paymentRequest.amount?(_(),F("span",Pu," of "+M(e.formatCurrency(e.sendData.paymentRequest.amount,e.sendData.paymentRequest.unit)),1)):x("",!0)])):x("",!0),e.sendData.amount&&e.bitcoinPrice&&e.activeUnit=="points"?(_(),F("span",Mu," ("+M(e.formatCurrency(e.currentCurrencyPrice/1e8*e.sendData.amount*e.activeUnitCurrencyMultiplyer,e.bitcoinPriceCurrency,!0))+") ",1)):x("",!0)]),g("div",qu,[r(at,{appear:"","enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut"},{default:u(()=>[e.canSpendOffline&&!e.sendData.p2pkPubkey&&!e.showLockInput?(_(),B(Wt,{key:0,outline:"",rounded:"",color:"grey",class:"float-right",size:"lg"},{default:u(()=>[r(J,{name:"check",color:"primary",class:"q-mr-sm",size:"sm"}),g("span",Tu,M(e.$t("SendTokenDialog.badge_offline_text")),1)]),_:1})):x("",!0)]),_:1})])]),g("div",Su,[g("div",Iu,[r(c)])]),r(ct,{type:"number",modelValue:e.sendData.amount,"onUpdate:modelValue":t[2]||(t[2]=U=>e.sendData.amount=U),modelModifiers:{number:!0},label:e.$t("SendTokenDialog.inputs.amount.label",{ticker:e.tickerShort}),mask:"#","fill-mask":"0","reverse-fill-mask":"",round:"",outlined:"",autofocus:"",class:"q-mb-lg",onKeyup:Et(e.sendTokens,["enter"]),disable:e.sendData.paymentRequest&&e.sendData.amount&&e.sendData.paymentRequest.amount==e.sendData.amount},{default:u(()=>[r(R,{flat:"",color:"primary",onClick:t[1]||(t[1]=U=>e.toggleUnit()),label:e.activeUnitLabel},null,8,["label"])]),_:1},8,["modelValue","label","onKeyup","disable"]),r(at,{appear:"","enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut"},{default:u(()=>[e.showLockInput?(_(),F("div",Au,[g("div",{class:Vt(e.sendData.p2pkPubkey?"col-12":"col-8")},[r(ct,{modelValue:e.sendData.p2pkPubkey,"onUpdate:modelValue":t[3]||(t[3]=U=>e.sendData.p2pkPubkey=U),label:e.sendData.p2pkPubkey&&!e.isValidPubkey(e.sendData.p2pkPubkey)?e.$t("SendTokenDialog.inputs.p2pk_pubkey.label_invalid"):e.$t("SendTokenDialog.inputs.p2pk_pubkey.label"),outlined:"",clearable:"",color:e.sendData.p2pkPubkey&&!e.isValidPubkey(e.sendData.p2pkPubkey)?"red":"",onKeyup:Et(e.lockTokens,["enter"])},null,8,["modelValue","label","color","onKeyup"])],2),g("div",Eu,[e.canPasteFromClipboard&&!e.sendData.p2pkPubkey?(_(),B(R,{key:0,unelevated:"",icon:"content_paste",onClick:e.pasteToP2PKField},{default:u(()=>[r(be,null,{default:u(()=>[I(M(e.$t("SendTokenDialog.actions.paste_p2pk_pubkey.tooltip_text")),1)]),_:1})]),_:1},8,["onClick"])):x("",!0),e.sendData.p2pkPubkey?x("",!0):(_(),B(R,{key:1,align:"center",flat:"",outline:"",color:"primary",round:"",onClick:e.showCamera},{default:u(()=>[r(l,{size:"1.5em"})]),_:1},8,["onClick"]))])])):x("",!0)]),_:1}),e.activeBalance>=e.sendData.amount?(_(),F("div",Ru,[e.sendData.tokens?x("",!0):(_(),B(R,{key:0,disable:e.sendData.amount==null||e.sendData.amount<=0||e.sendData.p2pkPubkey!=""&&!e.isValidPubkey(e.sendData.p2pkPubkey),onClick:e.sendTokens,color:"primary",rounded:"",type:"submit",loading:e.globalMutexLock},{loading:u(()=>[r(Pt)]),default:u(()=>[I(M(e.$t("SendTokenDialog.actions.send.label"))+" ",1)]),_:1},8,["disable","onClick","loading"])),e.sendData.p2pkPubkey&&e.isValidPubkey(e.sendData.p2pkPubkey)?(_(),F("div",Uu,[r(at,{appear:"","enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut"},{default:u(()=>[r(rn,{outline:"",color:"primary",icon:"lock",class:"q-ml-md q-pa-md"},{default:u(()=>[I(" Locked ")]),_:1})]),_:1})])):x("",!0),r(at,{appear:"","enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut"},{default:u(()=>[e.sendData.amount>0&&!e.showLockInput&&e.activeBalance>=e.sendData.amount?(_(),B(R,{key:0,disable:e.sendData.p2pkPubkey==null||e.sendData.amount<=0,color:"primary",class:"q-ml-sm",rounded:"",flat:"",onClick:t[4]||(t[4]=U=>e.showLockInput=!0)},{default:u(()=>[I(M(e.$t("SendTokenDialog.actions.lock.label")),1)]),_:1},8,["disable"])):x("",!0)]),_:1}),Ie((_(),B(R,{rounded:"",flat:"",color:"grey",class:"q-ml-auto"},{default:u(()=>[I(M(e.$t("SendTokenDialog.actions.close.label")),1)]),_:1})),[[Ke]])])):(_(),F("div",Nu,[r(R,{unelevated:"",rounded:"",disabled:"",color:"yellow","text-color":"black"},{default:u(()=>[I(M(e.$t("SendTokenDialog.inputs.amount.invalid_too_much_error_text")),1)]),_:1}),Ie((_(),B(R,{rounded:"",flat:"",color:"grey",class:"q-ml-auto"},{default:u(()=>[I(M(e.$t("SendTokenDialog.actions.close.label")),1)]),_:1})),[[Ke]])]))]),_:1}),r(Se,{class:"q-pt-none"},{default:u(()=>[g("div",xu,[r(R,{onClick:e.showParseDialog,flat:"",color:"primary",size:"sm"},{default:u(()=>[r(m,{size:"1em",class:"q-mr-xs"}),I(" "+M(e.$t("SendDialog.actions.lightning.label")),1)]),_:1},8,["onClick"])])]),_:1})]))]),_:1})]),_:1},8,["modelValue","maximized","onShow"]),r(Ye,{modelValue:e.showDeleteDialog,"onUpdate:modelValue":t[11]||(t[11]=U=>e.showDeleteDialog=U)},{default:u(()=>[r(Qe,{class:"q-pa-lg q-pt-md qcard"},{default:u(()=>[r(Se,{class:"q-pa-none"},{default:u(()=>[Zu,g("div",Yu,[g("div",Ju,[r(Ce,null,{default:u(()=>[I(" Are you sure you want to delete this transaction from your history? ")]),_:1}),r(Ce,{class:"q-pt-md text-weight-bold"},{default:u(()=>[I(" Warning: This action cannot be undone and there is no way to recover the token. ")]),_:1})])]),g("div",ed,[r(R,{onClick:e.deleteThisToken,color:"negative",rounded:"",class:"q-mr-sm"},{default:u(()=>[I("Delete")]),_:1},8,["onClick"]),Ie((_(),B(R,{rounded:"",flat:"",color:"grey",class:"q-ml-auto"},{default:u(()=>[I("Cancel")]),_:1})),[[Ke]])])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}var nd=xe(wu,[["render",td]]),uo=Zt({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validationSuccess","validationError"],setup(e,{slots:t,emit:n}){const i=Xt(),o=re(null);let s=0;const a=[];function c(P){const A=typeof P=="boolean"?P:e.noErrorFocus!==!0,U=++s,j=(O,X)=>{n(`validation${O===!0?"Success":"Error"}`,X)},K=O=>{const X=O.validate();return typeof X.then=="function"?X.then(ae=>({valid:ae,comp:O}),ae=>({valid:!1,comp:O,err:ae})):Promise.resolve({valid:X,comp:O})};return(e.greedy===!0?Promise.all(a.map(K)).then(O=>O.filter(X=>X.valid!==!0)):a.reduce((O,X)=>O.then(()=>K(X).then(ae=>{if(ae.valid===!1)return Promise.reject(ae)})),Promise.resolve()).catch(O=>[O])).then(O=>{if(O===void 0||O.length===0)return U===s&&j(!0),!0;if(U===s){const{comp:X,err:ae}=O[0];if(ae!==void 0&&console.error(ae),j(!1,X),A===!0){const ce=O.find(({comp:he})=>typeof he.focus=="function"&&hs(he.$)===!1);ce!==void 0&&ce.comp.focus()}}return!1})}function l(){s++,a.forEach(P=>{typeof P.resetValidation=="function"&&P.resetValidation()})}function m(P){P!==void 0&&wn(P);const A=s+1;c().then(U=>{A===s&&U===!0&&(e.onSubmit!==void 0?n("submit",P):P?.target!==void 0&&typeof P.target.submit=="function"&&P.target.submit())})}function h(P){P!==void 0&&wn(P),n("reset"),ko(()=>{l(),e.autofocus===!0&&e.noResetFocus!==!0&&w()})}function w(){Cs(()=>{if(o.value===null)return;(o.value.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||o.value.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||o.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(o.value.querySelectorAll("[tabindex]"),A=>A.tabIndex!==-1))?.focus({preventScroll:!0})})}go(ms,{bindComponent(P){a.push(P)},unbindComponent(P){const A=a.indexOf(P);A!==-1&&a.splice(A,1)}});let y=!1;return po(()=>{y=!0}),vo(()=>{y===!0&&e.autofocus===!0&&w()}),Hn(()=>{e.autofocus===!0&&w()}),Object.assign(i.proxy,{validate:c,resetValidation:l,submit:m,reset:h,focus:w,getValidationComponents:()=>a}),()=>we("form",{class:"q-form",ref:o,onSubmit:m,onReset:h},yi(t.default))}});const fo="q-slider__marker-labels",id=e=>({value:e}),od=({marker:e})=>we("div",{key:e.value,style:e.style,class:e.classes},e.label),ns=[34,37,40,33,39,38],sd={...ki,...$s,min:{type:Number,default:0},max:{type:Number,default:100},innerMin:Number,innerMax:Number,step:{type:Number,default:1,validator:e=>e>=0},snap:Boolean,vertical:Boolean,reverse:Boolean,color:String,markerLabelsClass:String,label:Boolean,labelColor:String,labelTextColor:String,labelAlways:Boolean,switchLabelSide:Boolean,markers:[Boolean,Number],markerLabels:[Boolean,Array,Object,Function],switchMarkerLabelsSide:Boolean,trackImg:String,trackColor:String,innerTrackImg:String,innerTrackColor:String,selectionColor:String,selectionImg:String,thumbSize:{type:String,default:"20px"},trackSize:{type:String,default:"4px"},disable:Boolean,readonly:Boolean,dense:Boolean,tabindex:[String,Number],thumbColor:String,thumbPath:{type:String,default:"M 4, 10 a 6,6 0 1,0 12,0 a 6,6 0 1,0 -12,0"}},ad=["pan","update:modelValue","change"];function rd({updateValue:e,updatePosition:t,getDragging:n,formAttrs:i}){const{props:o,emit:s,slots:a,proxy:{$q:c}}=Xt(),l=bi(o,c),m=Ps(i),h=re(!1),w=re(!1),y=re(!1),P=re(!1),A=z(()=>o.vertical===!0?"--v":"--h"),U=z(()=>"-"+(o.switchLabelSide===!0?"switched":"standard")),j=z(()=>o.vertical===!0?o.reverse===!0:o.reverse!==(c.lang.rtl===!0)),K=z(()=>isNaN(o.innerMin)===!0||o.innerMin<o.min?o.min:o.innerMin),E=z(()=>isNaN(o.innerMax)===!0||o.innerMax>o.max?o.max:o.innerMax),O=z(()=>o.disable!==!0&&o.readonly!==!0&&K.value<E.value),X=z(()=>{if(o.step===0)return le=>le;const W=(String(o.step).trim().split(".")[1]||"").length;return le=>parseFloat(le.toFixed(W))}),ae=z(()=>o.step===0?1:o.step),ce=z(()=>O.value===!0?o.tabindex||0:-1),he=z(()=>o.max-o.min),d=z(()=>E.value-K.value),p=z(()=>Ge(K.value)),v=z(()=>Ge(E.value)),T=z(()=>o.vertical===!0?j.value===!0?"bottom":"top":j.value===!0?"right":"left"),D=z(()=>o.vertical===!0?"height":"width"),k=z(()=>o.vertical===!0?"width":"height"),$=z(()=>o.vertical===!0?"vertical":"horizontal"),b=z(()=>{const W={role:"slider","aria-valuemin":K.value,"aria-valuemax":E.value,"aria-orientation":$.value,"data-step":o.step};return o.disable===!0?W["aria-disabled"]="true":o.readonly===!0&&(W["aria-readonly"]="true"),W}),C=z(()=>`q-slider q-slider${A.value} q-slider--${h.value===!0?"":"in"}active inline no-wrap `+(o.vertical===!0?"row":"column")+(o.disable===!0?" disabled":" q-slider--enabled"+(O.value===!0?" q-slider--editable":""))+(y.value==="both"?" q-slider--focus":"")+(o.label||o.labelAlways===!0?" q-slider--label":"")+(o.labelAlways===!0?" q-slider--label-always":"")+(l.value===!0?" q-slider--dark":"")+(o.dense===!0?" q-slider--dense q-slider--dense"+A.value:""));function S(W){const le="q-slider__"+W;return`${le} ${le}${A.value} ${le}${A.value}${U.value}`}function q(W){const le="q-slider__"+W;return`${le} ${le}${A.value}`}const N=z(()=>{const W=o.selectionColor||o.color;return"q-slider__selection absolute"+(W!==void 0?` text-${W}`:"")}),ee=z(()=>q("markers")+" absolute overflow-hidden"),Z=z(()=>q("track-container")),ue=z(()=>S("pin")),qe=z(()=>S("label")),Ee=z(()=>S("text-container")),me=z(()=>S("marker-labels-container")+(o.markerLabelsClass!==void 0?` ${o.markerLabelsClass}`:"")),fe=z(()=>"q-slider__track relative-position no-outline"+(o.trackColor!==void 0?` bg-${o.trackColor}`:"")),We=z(()=>{const W={[k.value]:o.trackSize};return o.trackImg!==void 0&&(W.backgroundImage=`url(${o.trackImg}) !important`),W}),Mt=z(()=>"q-slider__inner absolute"+(o.innerTrackColor!==void 0?` bg-${o.innerTrackColor}`:"")),qt=z(()=>{const W=v.value-p.value,le={[T.value]:`${100*p.value}%`,[D.value]:W===0?"2px":`${100*W}%`};return o.innerTrackImg!==void 0&&(le.backgroundImage=`url(${o.innerTrackImg}) !important`),le});function ut(W){const{min:le,max:ke,step:Oe}=o;let ot=le+W*(ke-le);if(Oe>0){const xt=(ot-K.value)%Oe;ot+=(Math.abs(xt)>=Oe/2?(xt<0?-1:1)*Oe:0)-xt}return ot=X.value(ot),Ht(ot,K.value,E.value)}function Ge(W){return he.value===0?0:(W-o.min)/he.value}function yt(W,le){const ke=gs(W),Oe=o.vertical===!0?Ht((ke.top-le.top)/le.height,0,1):Ht((ke.left-le.left)/le.width,0,1);return Ht(j.value===!0?1-Oe:Oe,p.value,v.value)}const He=z(()=>ps(o.markers)===!0?o.markers:ae.value),V=z(()=>{const W=[],le=He.value,ke=o.max;let Oe=o.min;do W.push(Oe),Oe+=le;while(Oe<ke);return W.push(ke),W}),Y=z(()=>{const W=` ${fo}${A.value}-`;return fo+`${W}${o.switchMarkerLabelsSide===!0?"switched":"standard"}${W}${j.value===!0?"rtl":"ltr"}`}),ge=z(()=>o.markerLabels===!1?null:tt(o.markerLabels).map((W,le)=>({index:le,value:W.value,label:W.label||W.value,classes:Y.value+(W.classes!==void 0?" "+W.classes:""),style:{...dt(W.value),...W.style||{}}}))),je=z(()=>({markerList:ge.value,markerMap:Nt.value,classes:Y.value,getStyle:dt})),Re=z(()=>{const W=d.value===0?"2px":100*He.value/d.value;return{...qt.value,backgroundSize:o.vertical===!0?`2px ${W}%`:`${W}% 2px`}});function tt(W){if(W===!1)return null;if(W===!0)return V.value.map(id);if(typeof W=="function")return V.value.map(ke=>{const Oe=W(ke);return ai(Oe)===!0?{...Oe,value:ke}:{value:ke,label:Oe}});const le=({value:ke})=>ke>=o.min&&ke<=o.max;return Array.isArray(W)===!0?W.map(ke=>ai(ke)===!0?ke:{value:ke}).filter(le):Object.keys(W).map(ke=>{const Oe=W[ke],ot=Number(ke);return ai(Oe)===!0?{...Oe,value:ot}:{value:ot,label:Oe}}).filter(le)}function dt(W){return{[T.value]:`${100*(W-o.min)/he.value}%`}}const Nt=z(()=>{if(o.markerLabels===!1)return null;const W={};return ge.value.forEach(le=>{W[le.value]=le}),W});function Q(){if(a["marker-label-group"]!==void 0)return a["marker-label-group"](je.value);const W=a["marker-label"]||od;return ge.value.map(le=>W({marker:le,...je.value}))}const ne=z(()=>[[ea,pe,void 0,{[$.value]:!0,prevent:!0,stop:!0,mouse:!0,mouseAllDir:!0}]]);function pe(W){W.isFinal===!0?(P.value!==void 0&&(t(W.evt),W.touch===!0&&e(!0),P.value=void 0,s("pan","end")),h.value=!1,y.value=!1):W.isFirst===!0?(P.value=n(W.evt),t(W.evt),e(),h.value=!0,s("pan","start")):(t(W.evt),e())}function Be(){y.value=!1}function Fe(W){t(W,n(W)),e(),w.value=!0,h.value=!0,document.addEventListener("mouseup",Me,!0)}function Me(){w.value=!1,h.value=!1,e(!0),Be(),document.removeEventListener("mouseup",Me,!0)}function $e(W){t(W,n(W)),e(!0)}function nt(W){ns.includes(W.keyCode)&&e(!0)}function _t(W){if(o.vertical===!0)return null;const le=c.lang.rtl!==o.reverse?1-W:W;return{transform:`translateX(calc(${2*le-1} * ${o.thumbSize} / 2 + ${50-100*le}%))`}}function vn(W){const le=z(()=>w.value===!1&&(y.value===W.focusValue||y.value==="both")?" q-slider--focus":""),ke=z(()=>`q-slider__thumb q-slider__thumb${A.value} q-slider__thumb${A.value}-${j.value===!0?"rtl":"ltr"} absolute non-selectable`+le.value+(W.thumbColor.value!==void 0?` text-${W.thumbColor.value}`:"")),Oe=z(()=>({width:o.thumbSize,height:o.thumbSize,[T.value]:`${100*W.ratio.value}%`,zIndex:y.value===W.focusValue?2:void 0})),ot=z(()=>W.labelColor.value!==void 0?` text-${W.labelColor.value}`:""),xt=z(()=>_t(W.ratio.value)),ii=z(()=>"q-slider__text"+(W.labelTextColor.value!==void 0?` text-${W.labelTextColor.value}`:""));return()=>{const oi=[we("svg",{class:"q-slider__thumb-shape absolute-full",viewBox:"0 0 20 20","aria-hidden":"true"},[we("path",{d:o.thumbPath})]),we("div",{class:"q-slider__focus-ring fit"})];return(o.label===!0||o.labelAlways===!0)&&(oi.push(we("div",{class:ue.value+" absolute fit no-pointer-events"+ot.value},[we("div",{class:qe.value,style:{minWidth:o.thumbSize}},[we("div",{class:Ee.value,style:xt.value},[we("span",{class:ii.value},W.label.value)])])])),o.name!==void 0&&o.disable!==!0&&m(oi,"push")),we("div",{class:ke.value,style:Oe.value,...W.getNodeData()},oi)}}function ni(W,le,ke,Oe){const ot=[];o.innerTrackColor!=="transparent"&&ot.push(we("div",{key:"inner",class:Mt.value,style:qt.value})),o.selectionColor!=="transparent"&&ot.push(we("div",{key:"selection",class:N.value,style:W.value})),o.markers!==!1&&ot.push(we("div",{key:"marker",class:ee.value,style:Re.value})),Oe(ot);const xt=[yo("div",{key:"trackC",class:Z.value,tabindex:le.value,...ke.value},[we("div",{class:fe.value,style:We.value},ot)],"slide",O.value,()=>ne.value)];if(o.markerLabels!==!1){const ii=o.switchMarkerLabelsSide===!0?"unshift":"push";xt[ii](we("div",{key:"markerL",class:me.value},Q()))}return xt}return Kn(()=>{document.removeEventListener("mouseup",Me,!0)}),{state:{active:h,focus:y,preventFocus:w,dragging:P,editable:O,classes:C,tabindex:ce,attributes:b,roundValueFn:X,keyStep:ae,trackLen:he,innerMin:K,innerMinRatio:p,innerMax:E,innerMaxRatio:v,positionProp:T,sizeProp:D,isReversed:j},methods:{onActivate:Fe,onMobileClick:$e,onBlur:Be,onKeyup:nt,getContent:ni,getThumbRenderFn:vn,convertRatioToModel:ut,convertModelToRatio:Ge,getDraggingRatio:yt}}}const ld=()=>({});var cd=Zt({name:"QSlider",props:{...sd,modelValue:{required:!0,default:null,validator:e=>typeof e=="number"||e===null},labelValue:[String,Number]},emits:ad,setup(e,{emit:t}){const{proxy:{$q:n}}=Xt(),{state:i,methods:o}=rd({updateValue:A,updatePosition:j,getDragging:U,formAttrs:Ms(e)}),s=re(null),a=re(0),c=re(0);function l(){c.value=e.modelValue===null?i.innerMin.value:Ht(e.modelValue,i.innerMin.value,i.innerMax.value)}Ft(()=>`${e.modelValue}|${i.innerMin.value}|${i.innerMax.value}`,l),l();const m=z(()=>o.convertModelToRatio(c.value)),h=z(()=>i.active.value===!0?a.value:m.value),w=z(()=>{const O={[i.positionProp.value]:`${100*i.innerMinRatio.value}%`,[i.sizeProp.value]:`${100*(h.value-i.innerMinRatio.value)}%`};return e.selectionImg!==void 0&&(O.backgroundImage=`url(${e.selectionImg}) !important`),O}),y=o.getThumbRenderFn({focusValue:!0,getNodeData:ld,ratio:h,label:z(()=>e.labelValue!==void 0?e.labelValue:c.value),thumbColor:z(()=>e.thumbColor||e.color),labelColor:z(()=>e.labelColor),labelTextColor:z(()=>e.labelTextColor)}),P=z(()=>i.editable.value!==!0?{}:n.platform.is.mobile===!0?{onClick:o.onMobileClick}:{onMousedown:o.onActivate,onFocus:K,onBlur:o.onBlur,onKeydown:E,onKeyup:o.onKeyup});function A(O){c.value!==e.modelValue&&t("update:modelValue",c.value),O===!0&&t("change",c.value)}function U(){return s.value.getBoundingClientRect()}function j(O,X=i.dragging.value){const ae=o.getDraggingRatio(O,X);c.value=o.convertRatioToModel(ae),a.value=e.snap!==!0||e.step===0?ae:o.convertModelToRatio(c.value)}function K(){i.focus.value=!0}function E(O){if(ns.includes(O.keyCode)===!1)return;wn(O);const X=([34,33].includes(O.keyCode)?10:1)*i.keyStep.value,ae=([34,37,40].includes(O.keyCode)?-1:1)*(i.isReversed.value===!0?-1:1)*(e.vertical===!0?-1:1)*X;c.value=Ht(i.roundValueFn.value(c.value+ae),i.innerMin.value,i.innerMax.value),A()}return()=>{const O=o.getContent(w,i.tabindex,P,X=>{X.push(y())});return we("div",{ref:s,class:i.classes.value+(e.modelValue===null?" q-slider--no-value":""),...i.attributes.value,"aria-valuenow":e.modelValue},O)}}});const ud=ze({name:"MultinutPaymentDialog",mixins:[windowMixin],components:{},data(){return{multiMeltButtonLoading:!1,selectedMints:[],showMultinutPaymentDialog:!1,mintStates:{},isPaymentInProgress:!1,mintProportions:{}}},computed:{...se(Ne,["payInvoiceData"]),...se(Ae,["multinutExperimentalWarningDismissed"]),...te(ye,["mints","activeUnit","multiMints"]),totalSelectedBalance(){return this.selectedMints.reduce((e,t)=>{const n=this.mintClass(t);return e+n.unitBalance(this.activeUnit)},0)},canExecutePayment(){return this.selectedMints.length>0&&this.totalSelectedBalance>=this.payInvoiceData.meltQuote.response.amount&&this.totalDistributedAmount===this.payInvoiceData.meltQuote.response.amount&&!this.multiMeltButtonLoading},totalDistributedAmount(){if(this.selectedMints.length===0)return 0;const e=this.getPartialAmounts();return Object.values(e).reduce((t,n)=>t+n,0)}},methods:{...oe(Ne,["meltQuote","melt"]),...oe(ye,["activateMintUrl","updateMintMultinutSelection"]),mintClass(e){return new _n(e)},getShortUrl(e){return jt(e)},isSelected(e){return this.selectedMints.some(t=>t.url===e.url)},toggleMint(e){const t=this.selectedMints.findIndex(n=>n.url===e.url);t>=0?(this.selectedMints.splice(t,1),this.updateMintMultinutSelection(e.url,!1),delete this.mintProportions[e.url]):(this.selectedMints.push(e),this.updateMintMultinutSelection(e.url,!0)),this.initializeMintProportions()},initializeMintProportions(){if(this.selectedMints.length===0){this.mintProportions={};return}this.payInvoiceData.meltQuote.response.amount;const{weights:e}=this.multiMintBalance(this.selectedMints,this.activeUnit),t={};this.selectedMints.forEach((i,o)=>{const s=e[o]*100,a=this.getMaxPercentageForMint(i);t[i.url]=Math.min(s,a)});const n=Object.values(t).reduce((i,o)=>i+o,0);if(n<100){const i=100-n,o=this.selectedMints.filter(s=>{const a=this.getMaxPercentageForMint(s);return t[s.url]<a});if(o.length>0){const s=o.reduce((a,c)=>{const l=this.getMaxPercentageForMint(c);return a+(l-t[c.url])},0);s>0&&o.forEach(a=>{const l=this.getMaxPercentageForMint(a)-t[a.url],m=l/s,h=Math.min(l,i*m);t[a.url]+=h})}}this.mintProportions={...t}},getMintProportion(e){return this.mintProportions[e.url]||0},getMaxPercentageForMint(e){const t=this.payInvoiceData.meltQuote.response.amount,n=this.mintClass(e).unitBalance(this.activeUnit);return Math.min(100,n/t*100)},getMintIconUrl(e){if(e.info)return e.info.icon_url?e.info.icon_url:void 0},updateMintProportion(e,t){if(this.selectedMints.length<=1)return;const n=this.payInvoiceData.meltQuote.response.amount,i=this.mintClass(e).unitBalance(this.activeUnit),o=Math.min(100,i/n*100),s=Math.min(t,o),a=this.mintProportions[e.url]||0,c=s-a;this.mintProportions={...this.mintProportions,[e.url]:s};const l=this.selectedMints.filter(h=>h.url!==e.url),m=l.reduce((h,w)=>h+(this.mintProportions[w.url]||0),0);if(m>0&&l.length>0){let h=c;const w=l.map(y=>{const P=this.mintClass(y).unitBalance(this.activeUnit),A=Math.min(100,P/n*100),U=this.mintProportions[y.url]||0,j=A-U;return{mint:y,currentPercentage:U,maxPercentage:A,availableCapacity:j,balance:P}}).sort((y,P)=>P.availableCapacity-y.availableCapacity);for(const y of w){if(Math.abs(h)<.01)break;const P=y.currentPercentage/m;let A=c*P;c>0?A=Math.min(A,y.currentPercentage):A=Math.max(A,-y.availableCapacity);const U=Math.max(0,Math.min(y.maxPercentage,y.currentPercentage-A));this.mintProportions={...this.mintProportions,[y.mint.url]:U},h-=y.currentPercentage-U}}else if(l.length>0){const h=100-s,w=l.map(P=>{const A=this.mintClass(P).unitBalance(this.activeUnit),U=Math.min(100,A/n*100);return{mint:P,maxPercentage:U,balance:A}}),y=w.reduce((P,A)=>P+A.maxPercentage,0);y>0&&w.forEach(P=>{const A=P.maxPercentage/y,U=Math.min(P.maxPercentage,h*A);this.mintProportions={...this.mintProportions,[P.mint.url]:U}})}this.normalizeMintProportions()},normalizeMintProportions(){const e=this.payInvoiceData.meltQuote.response.amount,t=this.selectedMints.reduce((n,i)=>n+(this.mintProportions[i.url]||0),0);if(t>0&&Math.abs(t-100)>.01){const n=100/t,i={};let o=!0;for(const s of this.selectedMints){const c=(this.mintProportions[s.url]||0)*n,l=this.mintClass(s).unitBalance(this.activeUnit),m=Math.min(100,l/e*100);if(c>m){o=!1;break}}o?(this.selectedMints.forEach(s=>{i[s.url]=(this.mintProportions[s.url]||0)*n}),this.mintProportions={...i}):this.redistributeWithConstraints()}},redistributeWithConstraints(){const e=this.payInvoiceData.meltQuote.response.amount,t=this.selectedMints.map(s=>{const a=this.mintClass(s).unitBalance(this.activeUnit),c=Math.min(100,a/e*100),l=this.mintProportions[s.url]||0;return{mint:s,balance:a,maxPercentage:c,currentPercentage:l}});let n=0;const i={};t.forEach(s=>{const a=Math.min(s.maxPercentage,s.currentPercentage);i[s.mint.url]=a,n+=a});let o=100-n;for(;o>.01;){const s=t.filter(c=>i[c.mint.url]<c.maxPercentage);if(s.length===0)break;const a=s.reduce((c,l)=>c+(l.maxPercentage-i[l.mint.url]),0);if(a<=0)break;s.forEach(c=>{const l=c.maxPercentage-i[c.mint.url],m=l/a,h=Math.min(l,o*m);i[c.mint.url]+=h,o-=h})}this.mintProportions={...i}},getPartialAmount(e){return this.getPartialAmounts()[e.url]||0},getPartialAmounts(){const e=this.payInvoiceData.meltQuote.response.amount,t={};let n=0;this.selectedMints.forEach(o=>{const s=this.mintProportions[o.url]||0,a=Math.round(e*(s/100));t[o.url]=a,n+=a});const i=e-n;if(i!==0&&this.selectedMints.length>0){let o=null,s=0;if(this.selectedMints.forEach(a=>{t[a.url]>s&&(s=t[a.url],o=a)}),o){t[o.url]+=i;const a=this.mintClass(o).unitBalance(this.activeUnit);if(t[o.url]>a){t[o.url]=a;const c=i-(a-s),l=this.selectedMints.filter(m=>m.url!==o.url);for(const m of l){const h=this.mintClass(m).unitBalance(this.activeUnit),w=t[m.url],y=Math.min(c,h-w);if(y>0&&(t[m.url]+=y,c-=y,c===0))break}}}}return t},getStateText(e){switch(e){case"requesting":return"Requesting...";case"paying":return"Paying...";case"success":return"Success";case"error":return"Failed";default:return""}},getStateColor(e){switch(e){case"requesting":return"warning";case"paying":return"primary";case"success":return"positive";case"error":return"negative";default:return"grey"}},getStateProgress(e){switch(e){case"requesting":return .3;case"paying":return .7;case"success":return 1;case"error":return .1;default:return 0}},setMintState(e,t){this.mintStates={...this.mintStates,[e]:t}},clearMintStates(){this.mintStates={},this.isPaymentInProgress=!1},openMultinutDialog(){const e=ye(),t=e.multiMints.filter(n=>n.multinutSelected===!0);this.selectedMints=t.length>0?[...t]:[...e.multiMints],this.showMultinutPaymentDialog=!0,this.clearMintStates(),this.initializeMintProportions()},closeMultinutDialog(){this.showMultinutPaymentDialog=!1,this.clearMintStates(),this.$emit("return-to-pay-dialog")},multiMintBalance:function(e,t){const n=e,i=[],o=n.reduce((a,c)=>{const m=new _n(c).unitBalance(t);return i.push(m),a+m},0),s=i.map(a=>a/o);return{overallBalance:o,weights:s}},executeMultinutPayment:async function(){const e=Ae(),t=this.payInvoiceData.meltQuote.response.amount,n=ye().activeUnit;this.selectedMints.forEach(c=>{this.updateMintMultinutSelection(c.url,!0)}),this.clearMintStates(),this.isPaymentInProgress=!0,this.multiMeltButtonLoading=!0;let i=[],o=[],s;try{for(const l of this.selectedMints){const m=this.getPartialAmount(l);console.log(`partialAmount for mint ${l.url}: ${m}`),m>0?o.push([l,m]):this.selectedMints=this.selectedMints.filter(h=>h.url!==l.url)}const c=o.reduce((l,[m,h])=>l+h,0);if(console.log(`Total calculated: ${c}, Expected: ${t}`),c!==t){console.error(`Amount mismatch: calculated ${c}, expected ${t}`),Te(`Amount calculation error: ${c} vs ${t}`);return}i=await Promise.all(o.map(async([l,m],h)=>{if(m<=0)return null;console.log(`Quoting mint: ${l.url}`);const w=Ne().mintWallet(l.url,ye().activeUnit);try{this.setMintState(l.url,"requesting");const y=await this.meltQuote(w,this.payInvoiceData.input.request,m);return console.log(y),[l,y]}catch(y){throw console.error(`Quote failed for mint ${l.url}:`,y),this.setMintState(l.url,"error"),y}})),i=i.filter(l=>l!==null),s=await Promise.all(i.map(async([l,m])=>{try{this.setMintState(l.url,"paying");const h=Ne().mintWallet(l.url,n),y=new _n(l).unitProofs(n),P=await this.melt(y,m,h,!0);return this.setMintState(l.url,"success"),P}catch(h){throw console.error(`Payment failed for mint ${l.url}:`,h),this.setMintState(l.url,"error"),h}}))}catch(c){throw console.error(`${c}`),setTimeout(()=>{this.clearMintStates()},3e3),c}finally{this.multiMeltButtonLoading=!1}e.vibrate();const a=i.reduce((c,l)=>c+l[1].amount+l[1].fee_reserve,0)-s.reduce((c,l)=>c+l.change.reduce((m,h)=>m+h.amount,0),0);st("Paid "+e.formatCurrency(a,n)+" via Lightning"),setTimeout(()=>{this.showMultinutPaymentDialog=!1,this.payInvoiceData.show=!1,this.clearMintStates()},2e3)},dismissExperimentalWarning(){this.multinutExperimentalWarningDismissed=!0}}}),Fi=e=>(Gn("data-v-1ecd16ec"),e=e(),Xn(),e),dd={class:"fullscreen bg-dark"},fd={class:"multinut-content-container q-pa-md"},hd={class:"top-icons q-pt-md q-mb-lg"},md={class:"multinut-header-container q-mb-lg"},gd={class:"multinut-header q-pa-md q-py-lg"},pd=Fi(()=>g("div",{class:"multinut-title q-mb-xs"},"Multinut Payment",-1)),vd={class:"multinut-amount"},yd={key:0,class:"multinut-description q-mt-sm"},_d={key:0,class:"experimental-warning q-mt-lg"},wd={class:"warning-content q-pa-md"},kd=Fi(()=>g("div",{class:"warning-title q-mb-xs"},"Experimental Feature",-1)),bd=Fi(()=>g("div",{class:"warning-text q-mb-md"}," This feature is highly experimental and may not work as expected. Make sure you don't try to pay an invoice that has already been paid before. You could lose funds. ",-1)),Dd={class:"mint-selection-section q-mb-lg"},Cd={key:0,class:"mint-selection-description q-mb-md"},$d={class:"mints-container"},Pd=["onClick"],Md={class:"mint-card-content q-pa-md"},qd={class:"row items-center"},Td={class:"col-auto q-mr-md"},Sd={class:"col"},Id={class:"row items-center"},Ad={class:"mint-info-container"},Ed={key:0,class:"mint-name"},Rd={class:"text-grey-6 mint-url"},Ud={key:0,class:"col-auto state-indicator"},Nd={key:0,class:"payment-progress-section q-mt-md q-px-md"},xd={class:"payment-state-text q-mt-xs"},Bd={key:1,class:"mint-balance-section q-mt-md"},Ld={class:"currency-unit-badge"},Fd={class:"currency-unit-text"},Od={key:2,class:"mint-slider-section q-mt-md"},Vd={class:"row items-center q-gutter-sm no-wrap"},zd={class:"col-auto"},Wd={class:"allocation-badge"},jd={class:"col slider-container"},Qd={class:"col-auto"},Kd={class:"total-balance-badge"},Hd={class:"action-buttons-section"};function Gd(e,t,n,i,o,s){return _(),B(Ye,{modelValue:e.showMultinutPaymentDialog,"onUpdate:modelValue":t[0]||(t[0]=a=>e.showMultinutPaymentDialog=a),position:"top",maximized:!0,"transition-show":"fade","transition-hide":"fade","full-width":"","full-height":"",seamless:"","no-backdrop-dismiss":"",onKeyup:Et(e.closeMultinutDialog,["esc"])},{default:u(()=>[g("div",dd,[g("div",fd,[g("div",hd,[r(J,{name:"close",size:"24px",class:"close-icon cursor-pointer text-white",onClick:e.closeMultinutDialog},null,8,["onClick"])]),g("div",md,[g("div",gd,[pd,g("div",vd,M(e.formatCurrency(e.payInvoiceData.meltQuote.response.amount,e.activeUnit)),1),e.isPaymentInProgress?x("",!0):(_(),F("div",yd," Pay using multiple mints "))]),r(at,{appear:"","enter-active-class":"animated pulse",name:"smooth-slide"},{default:u(()=>[!e.multinutExperimentalWarningDismissed&&!e.isPaymentInProgress?(_(),F("div",_d,[g("div",wd,[kd,bd,r(R,{flat:"",color:"warning",onClick:e.dismissExperimentalWarning,class:"warning-dismiss-btn"},{default:u(()=>[I(" I understand ")]),_:1},8,["onClick"])])])):x("",!0)]),_:1})]),g("div",Dd,[e.multinutExperimentalWarningDismissed&&!e.isPaymentInProgress?(_(),F("div",Cd," Select funds from multiple mints to execute the payment. ")):x("",!0),g("div",$d,[(_(!0),F(Ze,null,At(e.multiMints,a=>Ie((_(),F("div",{key:a.url,class:"mint-item q-mb-md"},[g("div",{class:Vt(["mint-card cursor-pointer",{"mint-card-selected":e.isSelected(a),"cursor-not-allowed":e.isPaymentInProgress,"mint-card-success":e.isPaymentInProgress&&e.isSelected(a)&&e.mintStates[a.url]==="success","mint-card-error":e.isPaymentInProgress&&e.isSelected(a)&&e.mintStates[a.url]==="error"}]),onClick:c=>!e.isPaymentInProgress&&!e.isSelected(a)&&e.toggleMint(a)},[g("div",Md,[g("div",qd,[g("div",Td,[e.isPaymentInProgress?x("",!0):(_(),B(Js,{key:0,"model-value":e.isSelected(a),"onUpdate:modelValue":c=>e.toggleMint(a),color:e.isSelected(a)?"primary":"grey",class:"cursor-pointer"},null,8,["model-value","onUpdate:modelValue","color"]))]),g("div",Sd,[g("div",Id,[e.getMintIconUrl(a)?(_(),B(ln,{key:0,size:"34px",class:"q-mr-sm"},{default:u(()=>[r(Ci,{"spinner-color":"white","spinner-size":"xs",src:e.getMintIconUrl(a),alt:"Mint Icon",style:{height:"34px","max-width":"34px","font-size":"12px"}},null,8,["src"])]),_:2},1024)):x("",!0),g("div",Ad,[a.nickname||a.info?.name?(_(),F("div",Ed,M(a.nickname||a.info?.name),1)):x("",!0),g("div",Rd,M(e.getShortUrl(a.url)),1)])])]),e.isPaymentInProgress&&e.isSelected(a)?(_(),F("div",Ud,[e.mintStates[a.url]==="requesting"||e.mintStates[a.url]==="paying"?(_(),B(Cn,{key:0,color:"primary",size:"24px"})):e.mintStates[a.url]==="success"?(_(),B(J,{key:1,name:"check_circle",color:"positive",size:"24px"})):e.mintStates[a.url]==="error"?(_(),B(J,{key:2,name:"error",color:"negative",size:"24px"})):x("",!0)])):x("",!0)]),e.isPaymentInProgress&&e.isSelected(a)&&e.mintStates[a.url]?(_(),F("div",Nd,[r($i,{value:e.getStateProgress(e.mintStates[a.url]),color:e.getStateColor(e.mintStates[a.url]),size:"4px",rounded:"",class:"payment-progress"},null,8,["value","color"]),g("div",xd,M(e.getStateText(e.mintStates[a.url])),1)])):x("",!0),e.isSelected(a)?x("",!0):(_(),F("div",Bd,[g("div",Ld,[g("span",Fd,M(e.formatCurrency(e.mintClass(a).unitBalance(this.activeUnit),this.activeUnit)),1)])])),e.isSelected(a)&&!e.isPaymentInProgress?(_(),F("div",Od,[g("div",Vd,[g("div",zd,[g("div",Wd,M(e.formatCurrency(e.getPartialAmount(a),e.activeUnit)),1)]),g("div",jd,[r(cd,{"model-value":e.getMintProportion(a),"onUpdate:modelValue":c=>e.updateMintProportion(a,c),min:0,max:e.getMaxPercentageForMint(a),step:1,color:"primary",disable:e.selectedMints.length<=1,class:"mint-slider q-px-md"},null,8,["model-value","onUpdate:modelValue","max","disable"])]),g("div",Qd,[g("div",Kd,M(e.formatCurrency(e.mintClass(a).unitBalance(this.activeUnit),e.activeUnit)),1)])])])):x("",!0)])],10,Pd)])),[[vs,!e.isPaymentInProgress||e.isSelected(a)]])),128))])]),g("div",Hd,[r(R,{unelevated:"",rounded:"",color:"primary",disabled:!e.canExecutePayment,onClick:e.executeMultinutPayment,loading:e.multiMeltButtonLoading,class:"pay-button-fixed",size:"lg"},{loading:u(()=>[r(Pt)]),default:u(()=>[I(" Pay Invoice ")]),_:1},8,["disabled","onClick","loading"])])])])]),_:1},8,["modelValue","onKeyup"])}var Xd=xe(ud,[["render",Gd],["__scopeId","data-v-1ecd16ec"]]);const Zd=ze({name:"PayInvoiceDialog",mixins:[windowMixin],components:{ChooseMint:$n,ToggleUnit:Mi,MultinutPaymentDialog:Xd,ScanIcon:Yt,CoinsIcon:Yn},props:{},data:function(){return{}},watch:{activeMintUrl:async function(){this.payInvoiceData.show&&await this.meltQuoteInvoiceData()},activeUnit:async function(){this.payInvoiceData.show&&await this.meltQuoteInvoiceData()}},computed:{...te(Ae,["tickerShort","globalMutexLock"]),...te(Je,["multinutEnabled"]),...se(et,["camera","hasCamera"]),...te(Ne,["payInvoiceData"]),...se(fn,["showSendTokens","sendData","showLockInput"]),...te(ye,["activeMintUrl","activeProofs","mints","activeUnit","totalUnitBalance","activeBalance","multiMints"]),...te(cn,["bitcoinPrice","bitcoinPrices","currentCurrencyPrice"]),...te(Je,["bitcoinPriceCurrency"]),canPasteFromClipboard:function(){return window.isSecureContext&&navigator.clipboard&&navigator.clipboard.readText},canMakePayments:function(){return!!this.mints.length},enoughtotalUnitBalance:function(){return this.activeBalance>=this.payInvoiceData.meltQuote.response.amount},hasMultinutSupport:function(){const e=this.multiMints.reduce((t,n)=>t+new _n(n).unitBalance(this.activeUnit),0);return this.multiMints.length>1&&this.payInvoiceData.meltQuote.response.amount>0&&e>=this.payInvoiceData.meltQuote.response.amount}},methods:{...oe(Ne,["meltInvoiceData","meltQuoteInvoiceData","decodeRequest","lnurlPaySecond"]),...oe(et,["closeCamera","showCamera"]),canPay:function(){return this.payInvoiceData.invoice?this.payInvoiceData.meltQuote.response.amount+this.payInvoiceData.meltQuote.response.fee_reserve<=this.totalUnitBalance:!1},closeParseDialog:function(){},decodeAndQuote:async function(e){await this.decodeRequest(e)},pasteToParseDialog:async function(){console.log("pasteToParseDialog");const e=await Ae().pasteFromClipboard();e&&(this.payInvoiceData.input.request=e.trim())},handleMeltButton:function(){if(this.payInvoiceData.blocking)throw new Error("already processing an invoice.");this.meltInvoiceData()},openMultinutDialog:function(){this.payInvoiceData.show=!1,this.$refs.multinutDialog.openMultinutDialog()},handleReturnToPayDialog:function(){this.payInvoiceData.show=!0},showSendTokensDialog:function(){if(!this.canMakePayments){kn(this.$i18n.t("SendDialog.actions.ecash.error_no_mints")),this.payInvoiceData.show=!1;return}this.sendData.tokens="",this.sendData.tokensBase64="",this.sendData.amount=null,this.sendData.memo="",this.sendData.p2pkPubkey="",this.sendData.paymentRequest=void 0,this.payInvoiceData.show=!1,this.showSendTokens=!0,this.showLockInput=!1}},created:function(){}}),is=e=>(Gn("data-v-7224fad8"),e=e(),Xn(),e),Yd={key:0},Jd={class:"row items-center no-wrap q-mb-sm"},ef={class:"col-10"},tf={key:0},nf={class:"q-my-none inline-block"},of={key:0,class:"q-ml-xs text-subtitle2 text-grey-6"},sf={key:1,class:"q-my-none"},af={key:2,class:"q-my-none"},rf={class:"col-2"},lf={class:"text-wrap"},cf={key:0},uf=is(()=>g("br",null,null,-1)),df={class:"col-12"},ff={key:0,class:"row q-mt-lg"},hf={key:1,class:"row q-mt-lg"},mf={key:1},gf={key:0,class:"q-my-none text-h6 text-center"},pf={key:1,class:"q-my-none text-h6 text-center"},vf=is(()=>g("br",null,null,-1)),yf={key:2,class:"row"},_f={class:"col text-justify text-italic"},wf={key:0,class:"col-4 q-pl-md"},kf={class:"row"},bf={class:"col"},Df={key:0,class:"col-8 q-pl-md"},Cf={class:"row q-mt-lg"},$f={key:2},Pf={class:"row items-center no-wrap q-mb-xl"},Mf={class:"col-10"},qf={class:"text-h6"},Tf={class:"row q-mt-lg"},Sf={class:"q-pl-sm"},If={class:"text-center"};function Af(e,t,n,i,o,s){const a=G("i18n-t"),c=G("ToggleUnit"),l=G("ChooseMint"),m=G("ScanIcon"),h=G("CoinsIcon"),w=G("MultinutPaymentDialog");return _(),F(Ze,null,[e.camera.show?x("",!0):(_(),B(Ye,{key:0,modelValue:e.payInvoiceData.show,"onUpdate:modelValue":t[6]||(t[6]=y=>e.payInvoiceData.show=y),onHide:e.closeParseDialog,position:"top",maximized:e.$q.screen.lt.sm,"backdrop-filter":"blur(2px) brightness(60%)","transition-show":"fade","transition-hide":"fade","no-backdrop-dismiss":"","full-height":""},{default:u(()=>[r(Qe,{class:"q-pa-lg q-pt-xl qcard"},{default:u(()=>[e.payInvoiceData.invoice?(_(),F("div",Yd,[g("div",Jd,[g("div",ef,[e.payInvoiceData.meltQuote.response&&e.payInvoiceData.meltQuote.response.amount>0?(_(),F("div",tf,[g("h6",nf,[r(a,{keypath:"PayInvoiceDialog.invoice.title"},{value:u(()=>[I(M(e.formatCurrency(e.payInvoiceData.meltQuote.response.amount,e.activeUnit,!0)),1)]),_:1})]),e.bitcoinPrice&&e.activeUnit=="points"?(_(),F("span",of," ("+M(e.formatCurrency(e.currentCurrencyPrice/1e8*e.payInvoiceData.meltQuote.response.amount,e.bitcoinPriceCurrency,!0))+") ",1)):x("",!0)])):e.payInvoiceData.meltQuote.error!=""?(_(),F("h6",sf,M(e.payInvoiceData.meltQuote.error),1)):(_(),F("h6",af,M(e.$t("PayInvoiceDialog.invoice.processing_info_text")),1))]),g("div",rf,[r(c,{class:"q-mt-md"})])]),g("p",lf,[e.payInvoiceData.invoice.description?(_(),F("strong",cf,M(e.$t("PayInvoiceDialog.invoice.memo.label"))+":",1)):x("",!0),I(" "+M(e.payInvoiceData.invoice.description),1),uf]),g("div",df,[r(l)]),e.enoughtotalUnitBalance||e.hasMultinutSupport&&e.multinutEnabled||e.globalMutexLock?(_(),F("div",ff,[r(R,{unelevated:"",rounded:"",color:"primary",disabled:e.payInvoiceData.blocking||!e.enoughtotalUnitBalance||e.payInvoiceData.meltQuote.error!="",onClick:e.handleMeltButton,label:e.payInvoiceData.meltQuote.error!=""?e.$t("PayInvoiceDialog.invoice.actions.pay.error"):e.payInvoiceData.blocking?e.$t("PayInvoiceDialog.invoice.actions.pay.in_progress"):e.$t("PayInvoiceDialog.invoice.actions.pay.label"),loading:e.globalMutexLock&&!e.payInvoiceData.blocking,class:"q-px-lg"},{loading:u(()=>[r(Pt)]),_:1},8,["disabled","onClick","label","loading"]),!e.payInvoiceData.blocking&&e.hasMultinutSupport&&e.multinutEnabled?(_(),B(R,{key:0,unelevated:"",rounded:"",outline:"",disabled:!e.hasMultinutSupport,onClick:e.openMultinutDialog,label:"Multi",class:"q-px-lg q-ml-sm"},null,8,["disabled","onClick"])):x("",!0),Ie((_(),B(R,{flat:"",color:"grey",class:"q-ml-auto"},{default:u(()=>[I(M(e.$t("PayInvoiceDialog.invoice.actions.close.label")),1)]),_:1})),[[Ke]])])):(_(),F("div",hf,[r(R,{unelevated:"",rounded:"",disabled:"",color:"yellow","text-color":"black"},{default:u(()=>[I(M(e.$t("PayInvoiceDialog.invoice.balance_too_low_warning_text")),1)]),_:1}),Ie((_(),B(R,{flat:"",color:"grey",class:"q-ml-auto"},{default:u(()=>[I(M(e.$t("PayInvoiceDialog.invoice.actions.close.label")),1)]),_:1})),[[Ke]])]))])):e.payInvoiceData.lnurlpay?(_(),F("div",mf,[r(uo,{onSubmit:e.lnurlPaySecond,class:"q-gutter-md"},{default:u(()=>[e.payInvoiceData.lnurlpay.maxSendable==e.payInvoiceData.lnurlpay.minSendable?(_(),F("p",gf,[r(a,{keypath:"PayInvoiceDialog.lnurlpay.amount_exact_label"},{payee:u(()=>[g("b",null,M(e.payInvoiceData.lnurlpay.domain),1)]),value:u(()=>[I(M(e.payInvoiceData.lnurlpay.maxSendable/1e3),1)]),ticker:u(()=>[I(M(e.tickerShort),1)]),_:1})])):(_(),F("p",pf,[r(a,{keypath:"PayInvoiceDialog.lnurlpay.amount_range_label"},{payee:u(()=>[g("b",null,M(e.payInvoiceData.lnurlpay.targetUser||e.payInvoiceData.lnurlpay.domain),1)]),br:u(()=>[vf]),min:u(()=>[g("b",null,M(e.payInvoiceData.lnurlpay.minSendable/1e3),1)]),max:u(()=>[g("b",null,M(e.payInvoiceData.lnurlpay.maxSendable/1e3),1)]),ticker:u(()=>[I(M(e.tickerShort),1)]),_:1})])),r(Ls,{class:"q-my-sm"}),e.payInvoiceData.lnurlpay.description?(_(),F("div",yf,[g("p",_f,M(e.payInvoiceData.lnurlpay.description),1),e.payInvoiceData.lnurlpay.image?(_(),F("p",wf,[r(Ci,{src:e.payInvoiceData.lnurlpay.image},null,8,["src"])])):x("",!0)])):x("",!0),g("div",kf,[g("div",bf,[r(ct,{filled:"",dense:"",autofocus:"",modelValue:e.payInvoiceData.input.amount,"onUpdate:modelValue":t[0]||(t[0]=y=>e.payInvoiceData.input.amount=y),modelModifiers:{number:!0},type:"number",label:e.$t("PayInvoiceDialog.lnurlpay.inputs.amount.label",{ticker:e.tickerShort}),min:e.payInvoiceData.lnurlpay.minSendable/1e3,max:e.payInvoiceData.lnurlpay.maxSendable/1e3,readonly:e.payInvoiceData.lnurlpay.maxSendable==e.payInvoiceData.lnurlpay.minSendable},null,8,["modelValue","label","min","max","readonly"])]),e.payInvoiceData.lnurlpay.commentAllowed>0?(_(),F("div",Df,[r(ct,{filled:"",dense:"",modelValue:e.payInvoiceData.input.comment,"onUpdate:modelValue":t[1]||(t[1]=y=>e.payInvoiceData.input.comment=y),_type:"payInvoiceData.lnurlpay.commentAllowed > 64 ? 'textarea' : 'text'",label:e.$t("PayInvoiceDialog.lnurlpay.inputs.comment.label"),maxlength:e.payInvoiceData.lnurlpay.commentAllowed},null,8,["modelValue","label","maxlength"])])):x("",!0)]),g("div",Cf,[r(R,{unelevated:"",color:"primary",type:"submit"},{default:u(()=>[I(M(e.$t("PayInvoiceDialog.lnurlpay.actions.send.label")),1)]),_:1}),Ie((_(),B(R,{flat:"",color:"grey",class:"q-ml-auto"},{default:u(()=>[I(M(e.$t("PayInvoiceDialog.lnurlpay.actions.close.label")),1)]),_:1})),[[Ke]])])]),_:1},8,["onSubmit"])])):(_(),F("div",$f,[g("div",Pf,[g("div",Mf,[g("span",qf,M(e.$t("PayInvoiceDialog.input_data.title")),1)])]),e.camera.show?x("",!0):(_(),B(uo,{key:0,onSubmit:t[5]||(t[5]=y=>e.decodeAndQuote(e.payInvoiceData.input.request)),class:"q-gutter-md relative-container"},{default:u(()=>[r(ct,{ref:"parseDialogInput",round:"",outlined:"",class:"request-input",spellcheck:"false",modelValue:e.payInvoiceData.input.request,"onUpdate:modelValue":t[3]||(t[3]=y=>e.payInvoiceData.input.request=y),modelModifiers:{trim:!0},type:"textarea",label:e.$t("PayInvoiceDialog.input_data.inputs.invoice_data.label"),autofocus:"",onKeyup:t[4]||(t[4]=Et(y=>e.decodeAndQuote(e.payInvoiceData.input.request),["enter"]))},{default:u(()=>[e.payInvoiceData.input.request?(_(),B(J,{key:0,name:"close",color:"dark",class:"cursor-pointer floating-button",onClick:t[2]||(t[2]=y=>e.payInvoiceData.input.request="")})):x("",!0)]),_:1},8,["modelValue","label"]),g("div",Tf,[e.payInvoiceData.input.request!=""?(_(),B(R,{key:0,rounded:"",color:"primary",class:"q-mr-sm",type:"submit"},{default:u(()=>[I(M(e.$t("PayInvoiceDialog.input_data.actions.enter.label")),1)]),_:1})):x("",!0),e.canPasteFromClipboard&&e.payInvoiceData.input.request==""?(_(),B(R,{key:1,unelevated:"",dense:"",onClick:e.pasteToParseDialog},{default:u(()=>[r(J,{name:"content_paste",class:"q-pr-sm"}),I(M(e.$t("PayInvoiceDialog.input_data.actions.paste.label")),1)]),_:1},8,["onClick"])):x("",!0),e.hasCamera&&e.payInvoiceData.input.request==""?(_(),B(R,{key:2,unelevated:"",class:"q-mx-0",onClick:e.showCamera},{default:u(()=>[r(m),g("span",Sf,M(e.$t("PayInvoiceDialog.input_data.actions.scan.label")),1)]),_:1},8,["onClick"])):x("",!0),Ie((_(),B(R,{flat:"",rounded:"",color:"grey",class:"q-ml-auto"},{default:u(()=>[I(M(e.$t("PayInvoiceDialog.input_data.actions.close.label")),1)]),_:1})),[[Ke]])])]),_:1}))])),r(Se,{class:"q-pt-none"},{default:u(()=>[g("div",If,[r(R,{onClick:e.showSendTokensDialog,flat:"",color:"primary",size:"sm"},{default:u(()=>[r(h,{size:"1em",class:"q-mr-xs"}),I(" "+M(e.$t("SendDialog.actions.points.label")),1)]),_:1},8,["onClick"])])]),_:1})]),_:1})]),_:1},8,["modelValue","onHide","maximized"])),r(w,{ref:"multinutDialog",onReturnToPayDialog:e.handleReturnToPayDialog},null,8,["onReturnToPayDialog"])],64)}var Ef=xe(Zd,[["render",Af],["__scopeId","data-v-7224fad8"]]);const Rf=ze({name:"InvoiceDetailDialog",mixins:[windowMixin],components:{ChooseMint:$n,VueQrcode:Pi,NumericKeyboard:ts},props:{},data:function(){return{createInvoiceButtonBlocked:!1}},watch:{showInvoiceDetails:function(e){e&&this.$nextTick(()=>{this.invoiceData.amount?this.showNumericKeyboard=!1:this.showNumericKeyboard=!0})}},computed:{...te(Ne,["invoiceData"]),...te(ye,["activeUnit","activeUnitLabel","activeUnitCurrencyMultiplyer"]),...te(un,["invoiceWorkerRunning"]),...se(Ae,["showInvoiceDetails","tickerShort","globalMutexLock","showNumericKeyboard"]),...te(Je,["useNumericKeyboard","bitcoinPriceCurrency"]),...te(cn,["bitcoinPrice","currentCurrencyPrice"]),displayUnit:function(){return this.formatCurrency(this.invoiceData.amount,this.invoiceData.unit,!0)},shortUrl:function(){return jt(this.invoiceData.mint)},runnerActive:function(){return this.invoiceWorkerRunning},isSmallScreen(){return this.$q.screen.lt.sm}},methods:{...oe(Ne,["requestMint","lnurlPaySecond","mintOnPaid"]),...oe(ye,["toggleUnit"]),requestMintButton:async function(){if(!!this.invoiceData.amount)try{this.showNumericKeyboard=!1;const e=ye();this.invoiceData.amount*=this.activeUnitCurrencyMultiplyer,this.createInvoiceButtonBlocked=!0;const t=Ne().mintWallet(e.activeMintUrl,e.activeUnit),n=await this.requestMint(this.invoiceData.amount,t);await this.mintOnPaid(n.quote)}catch(e){console.log("#### requestMintButton",e)}finally{this.createInvoiceButtonBlocked=!1}}}}),Uf={key:1},Nf={class:"row items-center no-wrap q-mb-sm q-pr-md q-py-lg"},xf={class:"col-10"},Bf={class:"text-h6"},Lf={key:0,class:"q-ml-xs text-subtitle2 text-grey-6"},Ff={class:"row items-center no-wrap q-my-sm q-py-none"},Of={class:"col-12"},Vf={class:"row items-center no-wrap q-my-sm q-py-none"},zf={key:2,class:"text-center q-mt-none q-pt-none"},Wf=["href"],jf={class:"row justify-center"},Qf={class:"row justify-center"},Kf={class:"row justify-center q-py-md"},Hf={key:0,class:"row justify-center q-pt-sm"},Gf={key:1,class:"row justify-center"},Xf={class:"q-mt-lg text-h6"},Zf={class:"row q-mt-lg"};function Yf(e,t,n,i,o,s){const a=G("NumericKeyboard"),c=G("ChooseMint"),l=G("vue-qrcode");return _(),B(Ye,{modelValue:e.showInvoiceDetails,"onUpdate:modelValue":t[4]||(t[4]=m=>e.showInvoiceDetails=m),position:"top",maximized:e.$q.screen.lt.sm,"full-width":e.$q.screen.lt.sm,"full-height":e.$q.screen.lt.sm,"backdrop-filter":"blur(2px) brightness(60%)","transition-show":"fade","transition-hide":"fade","no-backdrop-dismiss":""},{default:u(()=>[r(Qe,{class:"q-pa-lg q-px-sm qcard q-card-top"},{default:u(()=>[e.showNumericKeyboard&&e.useNumericKeyboard?(_(),B(a,{key:0,"model-value":e.invoiceData.amount,"onUpdate:modelValue":t[0]||(t[0]=m=>e.invoiceData.amount=m),onDone:e.requestMintButton},null,8,["model-value","onDone"])):x("",!0),e.invoiceData.bolt11?(_(),F("div",zf,[g("a",{class:"text-secondary",href:"lightning:"+e.invoiceData.bolt11},[r(_i,{ratio:1,class:"q-ma-none q-ma-none"},{default:u(()=>[r(l,{value:"lightning:"+e.invoiceData.bolt11.toUpperCase(),options:{width:340},class:"rounded-borders"},null,8,["value"])]),_:1})],8,Wf),g("div",jf,[r(Se,{class:"q-pa-sm"},{default:u(()=>[g("div",Qf,[r(Ce,{overline:"",class:"q-mb-sm q-pt-md text-white",style:{"font-size":"1rem"}},{default:u(()=>[I(M(e.$t("InvoiceDetailDialog.invoice.caption")),1)]),_:1})]),g("div",Kf,[r(Ce,{style:{"font-size":"28px"},class:"text-weight-bold"},{default:u(()=>[r(J,{name:e.invoiceData.amount>=0?"call_received":"call_made",color:e.invoiceData.status==="paid"?e.invoiceData.amount>=0?"green":"red":"",class:"q-mr-sm",size:"sm"},null,8,["name","color"]),g("strong",null,M(e.displayUnit),1)]),_:1})]),this.invoiceData.mint!=null?(_(),F("div",Hf,[r(rn,{outline:"",class:"q-pa-md",style:{height:"36px","font-family":"monospace"}},{default:u(()=>[r(J,{name:"account_balance",size:"xs",class:"q-mr-sm"}),I(" "+M(e.shortUrl),1)]),_:1})])):x("",!0),e.invoiceData.amount>0&&e.invoiceData.status==="paid"?(_(),F("div",Gf,[r(at,{appear:"","enter-active-class":"animated tada"},{default:u(()=>[g("span",Xf,[r(J,{name:"check_circle",size:"1.5rem",color:"positive",class:"q-mr-sm q-mb-xs"}),I(M(e.$t("InvoiceDetailDialog.invoice.status_paid_text")),1)])]),_:1})])):x("",!0)]),_:1})]),g("div",Zf,[e.invoiceData.bolt11?(_(),B(R,{key:0,class:"q-mx-xs",size:"md",flat:"",onClick:t[3]||(t[3]=m=>e.copyText(e.invoiceData.bolt11))},{default:u(()=>[I(M(e.$t("InvoiceDetailDialog.invoice.actions.copy.label")),1)]),_:1})):x("",!0),Ie((_(),B(R,{flat:"",color:"grey",class:"q-ml-auto"},{default:u(()=>[I(M(e.$t("InvoiceDetailDialog.invoice.actions.close.label")),1)]),_:1})),[[Ke]])])])):(_(),F("div",Uf,[g("div",Nf,[g("div",xf,[g("span",Bf,M(e.$t("InvoiceDetailDialog.title")),1),e.invoiceData.amount&&e.bitcoinPrice&&e.activeUnit=="points"?(_(),F("span",Lf," ("+M(e.formatCurrency(e.currentCurrencyPrice/1e8*e.invoiceData.amount*e.activeUnitCurrencyMultiplyer,e.bitcoinPriceCurrency,!0))+") ",1)):x("",!0)])]),g("div",Ff,[g("div",Of,[r(c)])]),r(ct,{round:"",outlined:"",type:"number",modelValue:e.invoiceData.amount,"onUpdate:modelValue":t[2]||(t[2]=m=>e.invoiceData.amount=m),modelModifiers:{number:!0},label:e.$t("InvoiceDetailDialog.inputs.amount.label",{ticker:e.tickerShort}),mask:"#","fill-mask":"0","reverse-fill-mask":"",autofocus:"",class:"q-mb-lg",onKeyup:Et(e.requestMintButton,["enter"])},{default:u(()=>[r(R,{flat:"",color:"primary",onClick:t[1]||(t[1]=m=>e.toggleUnit()),label:e.activeUnitLabel},null,8,["label"])]),_:1},8,["modelValue","label","onKeyup"]),g("div",Vf,[r(R,{color:"primary",rounded:"",onClick:e.requestMintButton,disable:!(e.invoiceData.amount>0)||e.createInvoiceButtonBlocked,label:e.createInvoiceButtonBlocked?e.$t("InvoiceDetailDialog.actions.create.label_blocked"):e.$t("InvoiceDetailDialog.actions.create.label"),loading:e.globalMutexLock},{loading:u(()=>[r(Pt),I(" "+M(e.$t("InvoiceDetailDialog.actions.create.in_progress")),1)]),_:1},8,["onClick","disable","label","loading"]),Ie((_(),B(R,{rounded:"",flat:"",color:"grey",class:"q-ml-auto"},{default:u(()=>[I(M(e.$t("InvoiceDetailDialog.actions.close.label")),1)]),_:1})),[[Ke]])])]))]),_:1})]),_:1},8,["modelValue","maximized","full-width","full-height"])}var Jf=xe(Rf,[["render",Yf],["__scopeId","data-v-12e6edb7"]]);const eh=ze({name:"SendDialog",components:{XIcon:Zn,CoinsIcon:Yn,ZapIcon:Pn,ScanIcon:Yt},mixins:[windowMixin],props:{},data:function(){return{currentPage:1,pageSize:5}},computed:{...te(ye,["mints"]),...se(Ae,["showInvoiceDetails","tab","showSendDialog","showReceiveDialog"]),...se(Ne,["invoiceHistory","invoiceData","payInvoiceData"]),...se(et,["camera"]),...se(fn,["showSendTokens","sendData","showLockInput"]),canMakePayments:function(){return!!this.mints.length}},methods:{...oe(et,["closeCamera","showCamera"]),showParseDialog:function(){if(!this.canMakePayments){kn(this.$i18n.t("SendDialog.actions.lightning.error_no_mints")),this.showSendDialog=!1;return}this.payInvoiceData.show=!0,this.payInvoiceData.invoice=null,this.payInvoiceData.lnurlpay=null,this.payInvoiceData.domain="",this.payInvoiceData.lnurlauth=null,this.payInvoiceData.input.request="",this.payInvoiceData.input.comment="",this.camera.show=!1,this.showSendDialog=!1},showSendTokensDialog:function(){if(console.log("##### showSendTokensDialog"),!this.canMakePayments){kn(this.$i18n.t("SendDialog.actions.ecash.error_no_mints")),this.showSendDialog=!1;return}this.sendData.tokens="",this.sendData.tokensBase64="",this.sendData.amount=null,this.sendData.memo="",this.sendData.p2pkPubkey="",this.sendData.paymentRequest=void 0,this.showSendDialog=!1,this.showSendTokens=!0,this.showLockInput=!1}},created:function(){}}),th={class:"col text-center"},nh={class:"text-h6"},ih={class:"q-gutter-y-md"},oh={class:"row items-center full-width"},sh={class:"icon-background q-mr-md"},ah={class:"text-left"},rh={class:"text-weight-bold custom-btn-text"},lh={class:"row items-center full-width"},ch={class:"icon-background q-mr-md"},uh={class:"text-left"},dh={class:"text-weight-bold custom-btn-text"};function fh(e,t,n,i,o,s){const a=G("XIcon"),c=G("ScanIcon"),l=G("CoinsIcon"),m=G("ZapIcon");return _(),B(Ye,{modelValue:e.showSendDialog,"onUpdate:modelValue":t[0]||(t[0]=h=>e.showSendDialog=h),position:"bottom",maximized:e.$q.screen.lt.sm,"transition-show":"slide-up","transition-hide":"slide-down","backdrop-filter":"blur(2px) brightness(60%)"},{default:u(()=>[r(Qe,{class:"bg-grey-10 text-white full-width-card q-pb-lg"},{default:u(()=>[r(Se,{class:"row items-center q-pb-sm"},{default:u(()=>[Ie((_(),B(R,{flat:"",round:"",dense:"",class:"q-ml-sm",color:"primary"},{default:u(()=>[r(a)]),_:1})),[[Ke]]),g("div",th,[g("span",nh,M(e.$t("SendDialog.title")),1)]),r(R,{flat:"",round:"",dense:"",class:"q-mr-sm",onClick:e.showCamera,color:"primary"},{default:u(()=>[r(c)]),_:1},8,["onClick"])]),_:1}),r(Se,{class:"q-pa-md"},{default:u(()=>[g("div",ih,[r(R,{class:"full-width custom-btn",onClick:e.showSendTokensDialog},{default:u(()=>[g("div",oh,[g("div",sh,[r(l)]),g("div",ah,[g("div",rh,M(e.$t("SendDialog.actions.points.label")),1)])])]),_:1},8,["onClick"]),r(R,{class:"full-width custom-btn",onClick:e.showParseDialog},{default:u(()=>[g("div",lh,[g("div",ch,[r(m)]),g("div",uh,[g("div",dh,M(e.$t("SendDialog.actions.lightning.label")),1)])])]),_:1},8,["onClick"])])]),_:1})]),_:1})]),_:1},8,["modelValue","maximized"])}var hh=xe(eh,[["render",fh],["__scopeId","data-v-42f49934"]]);const mh=ze({name:"PRDialog",mixins:[windowMixin],components:{VueQrcode:Pi,ToggleUnit:Mi},data(){const e=this.$i18n.t("PaymentRequestDialog.actions.add_amount.label");return{paymentRequestAmount:void 0,isEditingAmount:!1,amountInputValue:"",amountLabelDefault:e,amountLabel:e,defaultAnyMint:this.$i18n.t("PaymentRequestDialog.actions.use_active_mint.label"),chosenMintUrl:void 0,memo:""}},computed:{...te($t,["showPRKData"]),...te(ye,["activeMintUrl","activeUnit","activeUnitCurrencyMultiplyer"]),...se($t,["showPRDialog"])},methods:{...oe($t,["newPaymentRequest"]),toggleUnit(){this.paymentRequestAmount=void 0,this.amountLabel=this.amountLabelDefault,this.newPaymentRequest(this.paymentRequestAmount,this.memo,this.chosenMintUrl)},newRequest(){this.newPaymentRequest(this.paymentRequestAmount,this.memo,this.chosenMintUrl)},getShortUrl(e){return e?jt(e):this.defaultAnyMint},setActiveMintUrl(){this.activeMintUrl!=this.chosenMintUrl&&(this.chosenMintUrl=this.activeMintUrl,this.newPaymentRequest(this.paymentRequestAmount,this.memo,this.chosenMintUrl))},startEditingAmount(){this.isEditingAmount=!0,this.$nextTick(()=>{this.$refs.amountInput&&this.$refs.amountInput.focus()})},finishEditingAmount(){const e=parseFloat(this.amountInputValue);isNaN(e)||e<=0||this.amountInputValue==""?(this.paymentRequestAmount=void 0,this.amountLabel=this.amountLabelDefault):(this.paymentRequestAmount=e*this.activeUnitCurrencyMultiplyer,this.amountLabel=Ae().formatCurrency(e*this.activeUnitCurrencyMultiplyer,this.activeUnit)),this.newPaymentRequest(this.paymentRequestAmount,this.memo,this.chosenMintUrl),this.isEditingAmount=!1,this.amountInputValue=""}}}),gh={class:"text-center q-mb-md q-mt-none q-pt-none"},ph={class:"row justify-center"},vh={class:"row justify-center"},yh={class:"row justify-center q-pt-sm"},_h={class:"row justify-center"},wh={class:"row justify-center q-pt-sm"},kh={class:"row justify-center"},bh={class:"row justify-center q-pt-sm"},Dh={key:0},Ch={key:1},$h={class:"row q-mt-lg"};function Ph(e,t,n,i,o,s){const a=G("vue-qrcode"),c=G("ToggleUnit");return _(),B(Ye,{modelValue:e.showPRDialog,"onUpdate:modelValue":t[3]||(t[3]=l=>e.showPRDialog=l),position:"top","backdrop-filter":"blur(2px) brightness(60%)"},{default:u(()=>[e.showPRKData?(_(),B(Qe,{key:0,class:"q-px-lg q-pt-md q-pb-md qcard"},{default:u(()=>[g("div",gh,[r(_i,{ratio:1,class:"q-mx-md q-mt-none q-pt-none"},{default:u(()=>[r(a,{value:e.showPRKData,options:{width:340},class:"rounded-borders"},null,8,["value"])]),_:1}),g("div",ph,[r(Se,{class:"q-pa-sm"},{default:u(()=>[g("div",vh,[r(Ce,{overline:"",class:"q-mb-sm q-pt-md text-white",style:{"font-size":"1rem"}},{default:u(()=>[I(M(e.$t("PaymentRequestDialog.payment_request.caption")),1)]),_:1})]),g("div",yh,[r(Ce,{caption:"",class:"text-weight-light text-white",style:{"font-size":"14px"}},{default:u(()=>[I(M(e.$t("PaymentRequestDialog.payment_request.description")),1)]),_:1})])]),_:1})]),g("div",_h,[r(Se,{class:"q-pa-sm"},{default:u(()=>[g("div",wh,[r(rn,{outline:"",clickable:"",class:"q-pa-md q-py-md",style:wo(e.chosenMintUrl==null?"":"height: 36px; font-family: monospace"),onClick:e.setActiveMintUrl},{default:u(()=>[r(J,{name:"account_balance",size:"xs",class:"q-mr-sm"}),I(" "+M(e.getShortUrl(e.chosenMintUrl)),1)]),_:1},8,["style","onClick"]),g("div",{onClick:t[0]||(t[0]=(...l)=>e.toggleUnit&&e.toggleUnit(...l)),class:"q-mt-xs q-ml-sm"},[r(c,{class:"q-py-none",color:"white"})])])]),_:1})]),g("div",kh,[r(Se,{class:"q-pa-sm"},{default:u(()=>[g("div",bh,[e.isEditingAmount?(_(),F("div",Ch,[r(ct,{ref:"amountInput",modelValue:e.amountInputValue,"onUpdate:modelValue":t[1]||(t[1]=l=>e.amountInputValue=l),type:"number",placeholder:e.$t("PaymentRequestDialog.inputs.amount.placeholder"),onBlur:e.finishEditingAmount,onKeyup:Et(e.finishEditingAmount,["enter"])},null,8,["modelValue","placeholder","onBlur","onKeyup"])])):(_(),F("div",Dh,[r(R,{color:"primary",rounded:"",onClick:e.startEditingAmount},{default:u(()=>[r(J,{name:"edit_note",size:"xs",class:"q-mr-sm"}),I(" "+M(e.amountLabel),1)]),_:1},8,["onClick"])]))])]),_:1})]),r(R,{class:"q-mx-xs q-px-md q-mt-lg",size:"md",flat:"",rounded:"",dense:"",onClick:e.newRequest},{default:u(()=>[r(J,{name:"refresh",class:"q-pr-sm",size:"xs"}),I(" "+M(e.$t("PaymentRequestDialog.actions.new_request.label")),1)]),_:1},8,["onClick"]),g("div",$h,[r(R,{class:"q-mx-xs",size:"md",flat:"",onClick:t[2]||(t[2]=l=>e.copyText(e.showPRKData))},{default:u(()=>[I(M(e.$t("PaymentRequestDialog.actions.copy.label")),1)]),_:1}),Ie((_(),B(R,{flat:"",color:"grey",class:"q-ml-auto"},{default:u(()=>[I(M(e.$t("PaymentRequestDialog.actions.close.label")),1)]),_:1})),[[Ke]])])])]),_:1})):x("",!0)]),_:1},8,["modelValue"])}var Mh=xe(mh,[["render",Ph]]);const qh=ze({name:"ReceiveTokenDialog",mixins:[windowMixin],components:{P2PKDialog:ws,PRDialog:Mh,ChevronLeftIcon:La,ClipboardIcon:Fa,FileTextIcon:Oa,LockIcon:Va,ScanIcon:Yt,NfcIcon:qi},data:function(){return{showP2PKDialog:!1}},computed:{...se(pt,["showReceiveTokens","receiveData","scanningCard","watchClipboardPaste"]),...te(Ae,["tickerShort","ndefSupported"]),...te(ye,["activeProofs","activeUnit","addMintBlocking"]),...te(Je,["showNfcButtonInDrawer","autoPasteEcashReceive"]),...se(Ae,["showReceiveEcashDrawer"]),...se(ye,["addMintData","showAddMintDialog"]),...se($t,["showPRDialog"]),...te(et,["hasCamera"]),...te(Ct,["p2pkKeys","showP2PkButtonInDrawer"]),...te($t,["enablePaymentRequest"]),...se(Ae,["showReceiveDialog"]),...te(et,["lastScannedResult"])},methods:{...oe(Ne,["redeem"]),...oe(et,["closeCamera","showCamera"]),...oe(lt,["addPendingToken"]),...oe(Ct,["getPrivateKeyForP2PKEncodedToken","generateKeypair","showLastKey"]),...oe(ye,["addMint"]),...oe(pt,["receiveIfDecodes","decodeToken","knowThisMintOfTokenJson","toggleScanner","pasteToParseDialog"]),...se(pt,["showReceiveTokens","receiveData"]),isiOsSafari(){const e=window.navigator.userAgent.toLowerCase(),t=/iphone|ipad|ipod/.test(e)&&/safari/.test(e);return console.log(`User agent: ${e}, is iOS Safari: ${t}`),t},handlePasteBtn:function(){this.receiveData.tokensBase64="",this.showReceiveTokens=!0,this.showReceiveEcashDrawer=!1,this.autoPasteEcashReceive&&(this.watchClipboardPaste=!0)},handleLockBtn:function(){this.showP2PKDialog=!this.showP2PKDialog,(!this.p2pkKeys.length||!this.showP2PKDialog)&&this.generateKeypair(),this.showLastKey(),this.showReceiveEcashDrawer=!1},handlePaymentRequestBtn:function(){const e=$t();this.showPRDialog=!this.showPRDialog,this.showPRDialog&&e.newPaymentRequest(),this.showReceiveEcashDrawer=!1},handleNFCBtn:function(){this.toggleScanner()},handleQrCodeDecode(e){console.log("QR code decoded:",e),this.closeCamera()},goBack:function(){this.showReceiveEcashDrawer=!1,this.showReceiveDialog=!0}}}),Th={class:"col text-center"},Sh={class:"text-h6"},Ih={class:"q-gutter-y-md"},Ah={class:"row items-center full-width"},Eh={class:"icon-background q-mr-md"},Rh={class:"text-left"},Uh={class:"text-weight-bold custom-btn-text"},Nh={class:"row items-center full-width"},xh={class:"icon-background q-mr-md"},Bh={class:"text-left"},Lh={class:"text-weight-bold custom-btn-text"},Fh={class:"row items-center full-width"},Oh={class:"icon-background q-mr-md"},Vh={class:"text-left"},zh={class:"text-weight-bold custom-btn-text"},Wh={class:"row items-center full-width"},jh={class:"icon-background q-mr-md"},Qh={class:"text-left"},Kh={class:"text-weight-bold custom-btn-text"},Hh={class:"row items-center full-width"},Gh={class:"icon-background q-mr-md"},Xh={class:"text-left"},Zh={class:"text-weight-bold custom-btn-text"};function Yh(e,t,n,i,o,s){const a=G("ChevronLeftIcon"),c=G("ScanIcon"),l=G("ClipboardIcon"),m=G("FileTextIcon"),h=G("LockIcon"),w=G("NfcIcon"),y=G("P2PKDialog"),P=G("PRDialog");return _(),F(Ze,null,[r(Ye,{modelValue:e.showReceiveEcashDrawer,"onUpdate:modelValue":t[0]||(t[0]=A=>e.showReceiveEcashDrawer=A),position:"bottom",maximized:e.$q.screen.lt.sm,"transition-show":"slide-up","transition-hide":"slide-down","backdrop-filter":"blur(2px) brightness(60%)"},{default:u(()=>[r(Qe,{class:"bg-grey-10 text-white full-width-card q-pb-lg"},{default:u(()=>[r(Se,{class:"row items-center q-pb-sm"},{default:u(()=>[r(R,{flat:"",round:"",dense:"",onClick:e.goBack,class:"q-ml-sm",color:"primary"},{default:u(()=>[r(a)]),_:1},8,["onClick"]),g("div",Th,[g("span",Sh,M(e.$t("ReceiveEcashDrawer.title")),1)]),r(R,{flat:"",round:"",dense:"",onClick:e.showCamera,class:"q-mr-sm",color:"primary"},{default:u(()=>[r(c)]),_:1},8,["onClick"])]),_:1}),r(Se,{class:"q-pa-md"},{default:u(()=>[g("div",Ih,[r(R,{class:"full-width custom-btn",onClick:e.handlePasteBtn},{default:u(()=>[g("div",Ah,[g("div",Eh,[r(l)]),g("div",Rh,[g("div",Uh,M(e.$t("ReceiveEcashDrawer.actions.paste.label")),1)])])]),_:1},8,["onClick"]),r(R,{class:"full-width custom-btn",onClick:e.showCamera},{default:u(()=>[g("div",Nh,[g("div",xh,[r(c)]),g("div",Bh,[g("div",Lh,M(e.$t("ReceiveEcashDrawer.actions.scan.label")),1)])])]),_:1},8,["onClick"]),e.enablePaymentRequest?(_(),B(R,{key:0,class:"full-width custom-btn",onClick:e.handlePaymentRequestBtn},{default:u(()=>[g("div",Fh,[g("div",Oh,[r(m)]),g("div",Vh,[g("div",zh,M(e.$t("ReceiveEcashDrawer.actions.request.label")),1)])])]),_:1},8,["onClick"])):x("",!0),e.showP2PkButtonInDrawer?(_(),B(R,{key:1,class:"full-width custom-btn",onClick:e.handleLockBtn},{default:u(()=>[g("div",Wh,[g("div",jh,[r(h)]),g("div",Qh,[g("div",Kh,M(e.$t("ReceiveEcashDrawer.actions.lock.label")),1)])])]),_:1},8,["onClick"])):x("",!0),e.ndefSupported&&e.showNfcButtonInDrawer?(_(),B(R,{key:2,class:"full-width custom-btn",onClick:e.handleNFCBtn},{default:u(()=>[g("div",Hh,[g("div",Gh,[e.scanningCard?(_(),B(Cn,{key:0,size:"sm"})):(_(),B(w,{key:1}))]),g("div",Xh,[g("div",Zh,M(e.$t("ReceiveEcashDrawer.actions.nfc.label"))+" "+M(e.scanningCard?e.$t("ReceiveEcashDrawer.actions.nfc.scanning_text"):""),1)])])]),_:1},8,["onClick"])):x("",!0)])]),_:1})]),_:1})]),_:1},8,["modelValue","maximized"]),r(y,{modelValue:e.showP2PKDialog,"onUpdate:modelValue":t[1]||(t[1]=A=>e.showP2PKDialog=A)},null,8,["modelValue"]),r(P,{modelValue:e.showPRDialog,"onUpdate:modelValue":t[2]||(t[2]=A=>e.showPRDialog=A)},null,8,["modelValue"])],64)}var Jh=xe(qh,[["render",Yh],["__scopeId","data-v-270dbfd2"]]);const em=ze({name:"ReceiveDialog",components:{XIcon:Zn,CoinsIcon:Yn,ZapIcon:Pn,ScanIcon:Yt,ReceiveEcashDrawer:Jh},mixins:[windowMixin],props:{},data:function(){return{currentPage:1,pageSize:5}},computed:{...se(Ae,["showInvoiceDetails","showReceiveDialog","showReceiveEcashDrawer"]),...se(pt,["showReceiveTokens","receiveData"]),...se(Ne,["invoiceData"]),...te(ye,["mints"]),canReceivePayments:function(){return!!this.mints.length}},methods:{toggleReceiveEcashDrawer:function(){this.showReceiveDialog=!1,this.showReceiveTokens=!1,this.showReceiveEcashDrawer=!0},showReceiveTokensDialog:function(){this.receiveData.tokensBase64="",this.showReceiveTokens=!0,this.showReceiveDialog=!1},showInvoiceCreateDialog:async function(){if(!this.canReceivePayments){kn(this.$i18n.t("ReceiveDialog.actions.lightning.error_no_mints")),this.showReceiveDialog=!1;return}console.log("##### showInvoiceCreateDialog"),this.invoiceData.amount="",this.invoiceData.bolt11="",this.invoiceData.hash="",this.invoiceData.memo="",this.showInvoiceDetails=!0,this.showReceiveDialog=!1},...oe(et,["closeCamera","showCamera"])},created:function(){}}),tm={class:"col text-center"},nm={class:"text-h6"},im={class:"q-gutter-y-md"},om={class:"row items-center full-width"},sm={class:"icon-background q-mr-md"},am={class:"text-left"},rm={class:"text-weight-bold custom-btn-text"},lm={class:"row items-center full-width"},cm={class:"icon-background q-mr-md"},um={class:"text-left"},dm={class:"text-weight-bold custom-btn-text"};function fm(e,t,n,i,o,s){const a=G("XIcon"),c=G("ScanIcon"),l=G("CoinsIcon"),m=G("ZapIcon"),h=G("ReceiveEcashDrawer");return _(),F(Ze,null,[r(Ye,{modelValue:e.showReceiveDialog,"onUpdate:modelValue":t[0]||(t[0]=w=>e.showReceiveDialog=w),position:"bottom",maximized:e.$q.screen.lt.sm,"transition-show":"slide-up","transition-hide":"slide-down","backdrop-filter":"blur(2px) brightness(60%)"},{default:u(()=>[r(Qe,{class:"bg-grey-10 text-white full-width-card q-pb-lg"},{default:u(()=>[r(Se,{class:"row items-center q-pb-sm"},{default:u(()=>[Ie((_(),B(R,{flat:"",round:"",dense:"",class:"q-ml-sm",color:"primary"},{default:u(()=>[r(a)]),_:1})),[[Ke]]),g("div",tm,[g("span",nm,M(e.$t("ReceiveDialog.title")),1)]),r(R,{flat:"",round:"",dense:"",class:"q-mr-sm",onClick:e.showCamera,color:"primary"},{default:u(()=>[r(c)]),_:1},8,["onClick"])]),_:1}),r(Se,{class:"q-pa-md"},{default:u(()=>[g("div",im,[r(R,{class:"full-width custom-btn",onClick:e.toggleReceiveEcashDrawer},{default:u(()=>[g("div",om,[g("div",sm,[r(l)]),g("div",am,[g("div",rm,M(e.$t("ReceiveDialog.actions.points.label")),1)])])]),_:1},8,["onClick"]),r(R,{class:"full-width custom-btn",onClick:e.showInvoiceCreateDialog},{default:u(()=>[g("div",lm,[g("div",cm,[r(m)]),g("div",um,[g("div",dm,M(e.$t("ReceiveDialog.actions.lightning.label")),1)])])]),_:1},8,["onClick"])])]),_:1})]),_:1})]),_:1},8,["modelValue","maximized"]),r(h)],64)}var hm=xe(em,[["render",fm],["__scopeId","data-v-21059e89"]]);class ve{constructor(t,n,i,o,s){this._legacyCanvasSize=ve.DEFAULT_CANVAS_SIZE,this._preferredCamera="environment",this._maxScansPerSecond=25,this._lastScanTimestamp=-1,this._destroyed=this._flashOn=this._paused=this._active=!1,this.$video=t,this.$canvas=document.createElement("canvas"),i&&typeof i=="object"?this._onDecode=n:(console.warn(i||o||s?"You're using a deprecated version of the QrScanner constructor which will be removed in the future":"Note that the type of the scan result passed to onDecode will change in the future. To already switch to the new api today, you can pass returnDetailedScanResult: true."),this._legacyOnDecode=n),n=typeof i=="object"?i:{},this._onDecodeError=n.onDecodeError||(typeof i=="function"?i:this._onDecodeError),this._calculateScanRegion=n.calculateScanRegion||(typeof o=="function"?o:this._calculateScanRegion),this._preferredCamera=n.preferredCamera||s||this._preferredCamera,this._legacyCanvasSize=typeof i=="number"?i:typeof o=="number"?o:this._legacyCanvasSize,this._maxScansPerSecond=n.maxScansPerSecond||this._maxScansPerSecond,this._onPlay=this._onPlay.bind(this),this._onLoadedMetaData=this._onLoadedMetaData.bind(this),this._onVisibilityChange=this._onVisibilityChange.bind(this),this._updateOverlay=this._updateOverlay.bind(this),t.disablePictureInPicture=!0,t.playsInline=!0,t.muted=!0;let a=!1;if(t.hidden&&(t.hidden=!1,a=!0),document.body.contains(t)||(document.body.appendChild(t),a=!0),i=t.parentElement,n.highlightScanRegion||n.highlightCodeOutline){if(o=!!n.overlay,this.$overlay=n.overlay||document.createElement("div"),s=this.$overlay.style,s.position="absolute",s.display="none",s.pointerEvents="none",this.$overlay.classList.add("scan-region-highlight"),!o&&n.highlightScanRegion){this.$overlay.innerHTML='<svg class="scan-region-highlight-svg" viewBox="0 0 238 238" preserveAspectRatio="none" style="position:absolute;width:100%;height:100%;left:0;top:0;fill:none;stroke:#e9b213;stroke-width:4;stroke-linecap:round;stroke-linejoin:round"><path d="M31 2H10a8 8 0 0 0-8 8v21M207 2h21a8 8 0 0 1 8 8v21m0 176v21a8 8 0 0 1-8 8h-21m-176 0H10a8 8 0 0 1-8-8v-21"/></svg>';try{this.$overlay.firstElementChild.animate({transform:["scale(.98)","scale(1.01)"]},{duration:400,iterations:1/0,direction:"alternate",easing:"ease-in-out"})}catch{}i.insertBefore(this.$overlay,this.$video.nextSibling)}n.highlightCodeOutline&&(this.$overlay.insertAdjacentHTML("beforeend",'<svg class="code-outline-highlight" preserveAspectRatio="none" style="display:none;width:100%;height:100%;fill:none;stroke:#e9b213;stroke-width:5;stroke-dasharray:25;stroke-linecap:round;stroke-linejoin:round"><polygon/></svg>'),this.$codeOutlineHighlight=this.$overlay.lastElementChild)}this._scanRegion=this._calculateScanRegion(t),requestAnimationFrame(()=>{let c=window.getComputedStyle(t);c.display==="none"&&(t.style.setProperty("display","block","important"),a=!0),c.visibility!=="visible"&&(t.style.setProperty("visibility","visible","important"),a=!0),a&&(console.warn("QrScanner has overwritten the video hiding style to avoid Safari stopping the playback."),t.style.opacity="0",t.style.width="0",t.style.height="0",this.$overlay&&this.$overlay.parentElement&&this.$overlay.parentElement.removeChild(this.$overlay),delete this.$overlay,delete this.$codeOutlineHighlight),this.$overlay&&this._updateOverlay()}),t.addEventListener("play",this._onPlay),t.addEventListener("loadedmetadata",this._onLoadedMetaData),document.addEventListener("visibilitychange",this._onVisibilityChange),window.addEventListener("resize",this._updateOverlay),this._qrEnginePromise=ve.createQrEngine()}static set WORKER_PATH(t){console.warn("Setting QrScanner.WORKER_PATH is not required and not supported anymore. Have a look at the README for new setup instructions.")}static async hasCamera(){try{return!!(await ve.listCameras(!1)).length}catch{return!1}}static async listCameras(t=!1){if(!navigator.mediaDevices)return[];let n=async()=>(await navigator.mediaDevices.enumerateDevices()).filter(o=>o.kind==="videoinput"),i;try{t&&(await n()).every(o=>!o.label)&&(i=await navigator.mediaDevices.getUserMedia({audio:!1,video:!0}))}catch{}try{return(await n()).map((o,s)=>({id:o.deviceId,label:o.label||(s===0?"Default Camera":`Camera ${s+1}`)}))}finally{i&&(console.warn("Call listCameras after successfully starting a QR scanner to avoid creating a temporary video stream"),ve._stopVideoStream(i))}}async hasFlash(){let t;try{if(this.$video.srcObject){if(!(this.$video.srcObject instanceof MediaStream))return!1;t=this.$video.srcObject}else t=(await this._getCameraStream()).stream;return"torch"in t.getVideoTracks()[0].getSettings()}catch{return!1}finally{t&&t!==this.$video.srcObject&&(console.warn("Call hasFlash after successfully starting the scanner to avoid creating a temporary video stream"),ve._stopVideoStream(t))}}isFlashOn(){return this._flashOn}async toggleFlash(){this._flashOn?await this.turnFlashOff():await this.turnFlashOn()}async turnFlashOn(){if(!this._flashOn&&!this._destroyed&&(this._flashOn=!0,this._active&&!this._paused))try{if(!await this.hasFlash())throw"No flash available";await this.$video.srcObject.getVideoTracks()[0].applyConstraints({advanced:[{torch:!0}]})}catch(t){throw this._flashOn=!1,t}}async turnFlashOff(){this._flashOn&&(this._flashOn=!1,await this._restartVideoStream())}destroy(){this.$video.removeEventListener("loadedmetadata",this._onLoadedMetaData),this.$video.removeEventListener("play",this._onPlay),document.removeEventListener("visibilitychange",this._onVisibilityChange),window.removeEventListener("resize",this._updateOverlay),this._destroyed=!0,this._flashOn=!1,this.stop(),ve._postWorkerMessage(this._qrEnginePromise,"close")}async start(){if(this._destroyed)throw Error("The QR scanner can not be started as it had been destroyed.");if((!this._active||this._paused)&&(window.location.protocol!=="https:"&&console.warn("The camera stream is only accessible if the page is transferred via https."),this._active=!0,!document.hidden))if(this._paused=!1,this.$video.srcObject)await this.$video.play();else try{let{stream:t,facingMode:n}=await this._getCameraStream();!this._active||this._paused?ve._stopVideoStream(t):(this._setVideoMirror(n),this.$video.srcObject=t,await this.$video.play(),this._flashOn&&(this._flashOn=!1,this.turnFlashOn().catch(()=>{})))}catch(t){if(!this._paused)throw this._active=!1,t}}stop(){this.pause(),this._active=!1}async pause(t=!1){if(this._paused=!0,!this._active)return!0;this.$video.pause(),this.$overlay&&(this.$overlay.style.display="none");let n=()=>{this.$video.srcObject instanceof MediaStream&&(ve._stopVideoStream(this.$video.srcObject),this.$video.srcObject=null)};return t?(n(),!0):(await new Promise(i=>setTimeout(i,300)),this._paused?(n(),!0):!1)}async setCamera(t){t!==this._preferredCamera&&(this._preferredCamera=t,await this._restartVideoStream())}static async scanImage(t,n,i,o,s=!1,a=!1){let c,l=!1;n&&("scanRegion"in n||"qrEngine"in n||"canvas"in n||"disallowCanvasResizing"in n||"alsoTryWithoutScanRegion"in n||"returnDetailedScanResult"in n)?(c=n.scanRegion,i=n.qrEngine,o=n.canvas,s=n.disallowCanvasResizing||!1,a=n.alsoTryWithoutScanRegion||!1,l=!0):console.warn(n||i||o||s||a?"You're using a deprecated api for scanImage which will be removed in the future.":"Note that the return type of scanImage will change in the future. To already switch to the new api today, you can pass returnDetailedScanResult: true."),n=!!i;try{let m,h;[i,m]=await Promise.all([i||ve.createQrEngine(),ve._loadImage(t)]),[o,h]=ve._drawToCanvas(m,c,o,s);let w;if(i instanceof Worker){let y=i;n||ve._postWorkerMessageSync(y,"inversionMode","both"),w=await new Promise((P,A)=>{let U,j,K,E=-1;j=X=>{X.data.id===E&&(y.removeEventListener("message",j),y.removeEventListener("error",K),clearTimeout(U),X.data.data!==null?P({data:X.data.data,cornerPoints:ve._convertPoints(X.data.cornerPoints,c)}):A(ve.NO_QR_CODE_FOUND))},K=X=>{y.removeEventListener("message",j),y.removeEventListener("error",K),clearTimeout(U),A("Scanner error: "+(X?X.message||X:"Unknown Error"))},y.addEventListener("message",j),y.addEventListener("error",K),U=setTimeout(()=>K("timeout"),1e4);let O=h.getImageData(0,0,o.width,o.height);E=ve._postWorkerMessageSync(y,"decode",O,[O.data.buffer])})}else w=await Promise.race([new Promise((y,P)=>window.setTimeout(()=>P("Scanner error: timeout"),1e4)),(async()=>{try{var[y]=await i.detect(o);if(!y)throw ve.NO_QR_CODE_FOUND;return{data:y.rawValue,cornerPoints:ve._convertPoints(y.cornerPoints,c)}}catch(P){if(y=P.message||P,/not implemented|service unavailable/.test(y))return ve._disableBarcodeDetector=!0,ve.scanImage(t,{scanRegion:c,canvas:o,disallowCanvasResizing:s,alsoTryWithoutScanRegion:a});throw`Scanner error: ${y}`}})()]);return l?w:w.data}catch(m){if(!c||!a)throw m;let h=await ve.scanImage(t,{qrEngine:i,canvas:o,disallowCanvasResizing:s});return l?h:h.data}finally{n||ve._postWorkerMessage(i,"close")}}setGrayscaleWeights(t,n,i,o=!0){ve._postWorkerMessage(this._qrEnginePromise,"grayscaleWeights",{red:t,green:n,blue:i,useIntegerApproximation:o})}setInversionMode(t){ve._postWorkerMessage(this._qrEnginePromise,"inversionMode",t)}static async createQrEngine(t){if(t&&console.warn("Specifying a worker path is not required and not supported anymore."),t=()=>bo(()=>import("./qr-scanner-worker.min.56d417f3.js"),[]).then(i=>i.createWorker()),!(!ve._disableBarcodeDetector&&"BarcodeDetector"in window&&BarcodeDetector.getSupportedFormats&&(await BarcodeDetector.getSupportedFormats()).includes("qr_code")))return t();let n=navigator.userAgentData;return n&&n.brands.some(({brand:i})=>/Chromium/i.test(i))&&/mac ?OS/i.test(n.platform)&&await n.getHighEntropyValues(["architecture","platformVersion"]).then(({architecture:i,platformVersion:o})=>/arm/i.test(i||"arm")&&13<=parseInt(o||"13")).catch(()=>!0)?t():new BarcodeDetector({formats:["qr_code"]})}_onPlay(){this._scanRegion=this._calculateScanRegion(this.$video),this._updateOverlay(),this.$overlay&&(this.$overlay.style.display=""),this._scanFrame()}_onLoadedMetaData(){this._scanRegion=this._calculateScanRegion(this.$video),this._updateOverlay()}_onVisibilityChange(){document.hidden?this.pause():this._active&&this.start()}_calculateScanRegion(t){let n=Math.round(.6666666666666666*Math.min(t.videoWidth,t.videoHeight));return{x:Math.round((t.videoWidth-n)/2),y:Math.round((t.videoHeight-n)/2),width:n,height:n,downScaledWidth:this._legacyCanvasSize,downScaledHeight:this._legacyCanvasSize}}_updateOverlay(){requestAnimationFrame(()=>{if(this.$overlay){var t=this.$video,n=t.videoWidth,i=t.videoHeight,o=t.offsetWidth,s=t.offsetHeight,a=t.offsetLeft,c=t.offsetTop,l=window.getComputedStyle(t),m=l.objectFit,h=n/i,w=o/s;switch(m){case"none":var y=n,P=i;break;case"fill":y=o,P=s;break;default:(m==="cover"?h>w:h<w)?(P=s,y=P*h):(y=o,P=y/h),m==="scale-down"&&(y=Math.min(y,n),P=Math.min(P,i))}var[A,U]=l.objectPosition.split(" ").map((K,E)=>{const O=parseFloat(K);return K.endsWith("%")?(E?s-P:o-y)*O/100:O});l=this._scanRegion.width||n,w=this._scanRegion.height||i,m=this._scanRegion.x||0;var j=this._scanRegion.y||0;h=this.$overlay.style,h.width=`${l/n*y}px`,h.height=`${w/i*P}px`,h.top=`${c+U+j/i*P}px`,i=/scaleX\(-1\)/.test(t.style.transform),h.left=`${a+(i?o-A-y:A)+(i?n-m-l:m)/n*y}px`,h.transform=t.style.transform}})}static _convertPoints(t,n){if(!n)return t;let i=n.x||0,o=n.y||0,s=n.width&&n.downScaledWidth?n.width/n.downScaledWidth:1;n=n.height&&n.downScaledHeight?n.height/n.downScaledHeight:1;for(let a of t)a.x=a.x*s+i,a.y=a.y*n+o;return t}_scanFrame(){!this._active||this.$video.paused||this.$video.ended||("requestVideoFrameCallback"in this.$video?this.$video.requestVideoFrameCallback.bind(this.$video):requestAnimationFrame)(async()=>{if(!(1>=this.$video.readyState)){var t=Date.now()-this._lastScanTimestamp,n=1e3/this._maxScansPerSecond;t<n&&await new Promise(o=>setTimeout(o,n-t)),this._lastScanTimestamp=Date.now();try{var i=await ve.scanImage(this.$video,{scanRegion:this._scanRegion,qrEngine:this._qrEnginePromise,canvas:this.$canvas})}catch(o){if(!this._active)return;this._onDecodeError(o)}!ve._disableBarcodeDetector||await this._qrEnginePromise instanceof Worker||(this._qrEnginePromise=ve.createQrEngine()),i?(this._onDecode?this._onDecode(i):this._legacyOnDecode&&this._legacyOnDecode(i.data),this.$codeOutlineHighlight&&(clearTimeout(this._codeOutlineHighlightRemovalTimeout),this._codeOutlineHighlightRemovalTimeout=void 0,this.$codeOutlineHighlight.setAttribute("viewBox",`${this._scanRegion.x||0} ${this._scanRegion.y||0} ${this._scanRegion.width||this.$video.videoWidth} ${this._scanRegion.height||this.$video.videoHeight}`),this.$codeOutlineHighlight.firstElementChild.setAttribute("points",i.cornerPoints.map(({x:o,y:s})=>`${o},${s}`).join(" ")),this.$codeOutlineHighlight.style.display="")):this.$codeOutlineHighlight&&!this._codeOutlineHighlightRemovalTimeout&&(this._codeOutlineHighlightRemovalTimeout=setTimeout(()=>this.$codeOutlineHighlight.style.display="none",100))}this._scanFrame()})}_onDecodeError(t){t!==ve.NO_QR_CODE_FOUND&&console.log(t)}async _getCameraStream(){if(!navigator.mediaDevices)throw"Camera not found.";let t=/^(environment|user)$/.test(this._preferredCamera)?"facingMode":"deviceId",n=[{width:{min:1024}},{width:{min:768}},{}],i=n.map(o=>Object.assign({},o,{[t]:{exact:this._preferredCamera}}));for(let o of[...i,...n])try{let s=await navigator.mediaDevices.getUserMedia({video:o,audio:!1}),a=this._getFacingMode(s)||(o.facingMode?this._preferredCamera:this._preferredCamera==="environment"?"user":"environment");return{stream:s,facingMode:a}}catch{}throw"Camera not found."}async _restartVideoStream(){let t=this._paused;await this.pause(!0)&&!t&&this._active&&await this.start()}static _stopVideoStream(t){for(let n of t.getTracks())n.stop(),t.removeTrack(n)}_setVideoMirror(t){this.$video.style.transform="scaleX("+(t==="user"?-1:1)+")"}_getFacingMode(t){return(t=t.getVideoTracks()[0])?/rear|back|environment/i.test(t.label)?"environment":/front|user|face/i.test(t.label)?"user":null:null}static _drawToCanvas(t,n,i,o=!1){i=i||document.createElement("canvas");let s=n&&n.x?n.x:0,a=n&&n.y?n.y:0,c=n&&n.width?n.width:t.videoWidth||t.width,l=n&&n.height?n.height:t.videoHeight||t.height;return o||(o=n&&n.downScaledWidth?n.downScaledWidth:c,n=n&&n.downScaledHeight?n.downScaledHeight:l,i.width!==o&&(i.width=o),i.height!==n&&(i.height=n)),n=i.getContext("2d",{alpha:!1}),n.imageSmoothingEnabled=!1,n.drawImage(t,s,a,c,l,0,0,i.width,i.height),[i,n]}static async _loadImage(t){if(t instanceof Image)return await ve._awaitImageLoad(t),t;if(t instanceof HTMLVideoElement||t instanceof HTMLCanvasElement||t instanceof SVGImageElement||"OffscreenCanvas"in window&&t instanceof OffscreenCanvas||"ImageBitmap"in window&&t instanceof ImageBitmap)return t;if(t instanceof File||t instanceof Blob||t instanceof URL||typeof t=="string"){let n=new Image;n.src=t instanceof File||t instanceof Blob?URL.createObjectURL(t):t.toString();try{return await ve._awaitImageLoad(n),n}finally{(t instanceof File||t instanceof Blob)&&URL.revokeObjectURL(n.src)}}else throw"Unsupported image type."}static async _awaitImageLoad(t){t.complete&&t.naturalWidth!==0||await new Promise((n,i)=>{let o=s=>{t.removeEventListener("load",o),t.removeEventListener("error",o),s instanceof ErrorEvent?i("Image load error"):n()};t.addEventListener("load",o),t.addEventListener("error",o)})}static async _postWorkerMessage(t,n,i,o){return ve._postWorkerMessageSync(await t,n,i,o)}static _postWorkerMessageSync(t,n,i,o){if(!(t instanceof Worker))return-1;let s=ve._workerMessageId++;return t.postMessage({id:s,type:n,data:i},o),s}}ve.DEFAULT_CANVAS_SIZE=400;ve.NO_QR_CODE_FOUND="No QR code found";ve._disableBarcodeDetector=!1;ve._workerMessageId=0;function mm(){const e=qo("bitpoints.connectedWatches",[]),t=re(!1);function n(m){try{if(m.startsWith("bitpoints://pair?data=")){const h=m.substring(19),w=JSON.parse(h);return{id:w.id,name:w.name||"My Watch",endpoint:w.endpoint,lastSeen:Date.now()}}else if(m.startsWith("https://bitpoints.me/receive/"))return{id:m.substring(30),name:"Wear OS Watch",endpoint:m,lastSeen:Date.now()};return null}catch(h){return console.error("Failed to parse watch QR code:",h),null}}function i(m){const h=e.value.findIndex(w=>w.id===m.id);h>=0?e.value[h]=m:e.value.push(m),console.log("Watch added/updated:",m.name)}function o(m){const h=e.value.findIndex(w=>w.id===m);h>=0&&(e.value.splice(h,1),console.log("Watch removed:",m))}async function s(m,h,w){const y=e.value.find(P=>P.id===m);if(!y)return console.error("Watch not found:",m),!1;try{const P=await fetch(y.endpoint,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:h,sender:"bitpoints_phone",timestamp:Date.now(),memo:w})});return P.ok?(console.log("Token sent to watch successfully"),!0):(console.error("Failed to send token to watch:",P.statusText),!1)}catch(P){return console.error("Error sending token to watch:",P),!1}}async function a(m,h){let w=0,y=0;for(const P of e.value)await s(P.id,m,h)?w++:y++;return{success:w,failed:y}}function c(){return e.value.length>0}function l(m){const h=e.value.find(y=>y.id===m);if(!h)return"unknown";const w=Date.now()-5*60*1e3;return h.lastSeen>w?"connected":"disconnected"}return{connectedWatches:e,isScanningForWatches:t,parseWatchQR:n,addWatch:i,removeWatch:o,sendTokenToWatch:s,sendTokenToAllWatches:a,hasConnectedWatches:c,getWatchStatus:l}}const gm={emits:["decode"],data(){return{qrScanner:null,urDecoder:null,urDecoderProgress:0,cameraWorking:!1}},async mounted(){try{if(!await this.requestCameraPermission()){console.error("Camera permission denied"),this.$q.notify({type:"negative",message:"Camera permission is required to scan QR codes",position:"top"});return}this.qrScanner=new ve(this.$refs.cameraEl,t=>{this.handleResult(t)},{returnDetailedScanResult:!0,highlightScanRegion:!0,highlightCodeOutline:!0,onDecodeError:t=>{console.debug("QR decode error:",t)}}),await this.qrScanner.start(),this.urDecoder=new ru,this.cameraWorking=!0,console.log("\u2705 Camera started successfully")}catch(e){console.error("\u274C Failed to start camera:",e),this.$q.notify({type:"negative",message:`Camera error: ${e}. Please check permissions in Settings.`,position:"top",timeout:5e3})}},setup(){return{watchIntegration:mm()}},computed:{...te(et,["camera","hasCamera"]),canPasteFromClipboard:function(){return window.isSecureContext&&navigator.clipboard&&navigator.clipboard.readText}},methods:{...oe(et,["closeCamera","showCamera"]),async requestCameraPermission(){try{return console.log("\u{1F4F7} Requesting camera permission via getUserMedia..."),(await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment",width:{ideal:1280},height:{ideal:720}}})).getTracks().forEach(t=>t.stop()),console.log("\u2705 Camera permission granted via getUserMedia"),!0}catch(e){console.warn("\u274C getUserMedia failed, trying Capacitor Camera plugin...",e);try{const{Camera:t}=await bo(()=>import("./index.659618f4.js"),["assets/index.659618f4.js","assets/ui.f9c7454a.js","assets/index.51f2b46b.js","assets/index.e49211c5.css","assets/branding.c750d619.js","assets/i18n.79f7761c.js"]),n=await t.checkPermissions();if(console.log("\u{1F4F7} Current camera permissions:",n),n.camera==="granted")return console.log("\u2705 Camera permission already granted via Capacitor"),!0;const i=await t.requestPermissions();return console.log("\u{1F4F7} Camera permission request result:",i),i.camera==="granted"?(console.log("\u2705 Camera permission granted via Capacitor"),!0):(console.error("\u274C Camera permission denied via Capacitor:",i),!1)}catch(t){return console.error("\u274C Capacitor Camera plugin also failed:",t),!1}}},handleResult(e){const t=e.data,n=this.watchIntegration.parseWatchQR(t);if(n){this.watchIntegration.addWatch(n),st(`Watch "${n.name}" paired successfully!`),this.qrScanner?.stop();return}if(t.toLowerCase().startsWith("ur:")){if(this.urDecoder?.receivePart(t),this.urDecoderProgress=this.urDecoder?.estimatedPercentComplete()||0,this.urDecoder?.isComplete()&&this.urDecoder?.isSuccess()){const o=(this.urDecoder?.resultUR()).decodeCBOR();this.$emit("decode",o.toString()),this.qrScanner?.stop(),document.activeElement?.blur(),this.urDecoderProgress=0}}else this.$emit("decode",e.data),this.qrScanner?.stop(),document.activeElement?.blur()},pasteToParseDialog:async function(){const e=await Ae().pasteFromClipboard();e&&this.$emit("decode",e)},async retryCameraPermission(){if(console.log("\u{1F504} Retrying camera permission..."),await this.requestCameraPermission())try{this.qrScanner=new ve(this.$refs.cameraEl,t=>{this.handleResult(t)},{returnDetailedScanResult:!0,highlightScanRegion:!0,highlightCodeOutline:!0,onDecodeError:t=>{console.debug("QR decode error:",t)}}),await this.qrScanner.start(),this.cameraWorking=!0,this.$q.notify({type:"positive",message:"Camera started successfully!",position:"top"})}catch(t){console.error("\u274C Failed to start camera after permission:",t),this.$q.notify({type:"negative",message:`Camera error: ${t}`,position:"top"})}else this.$q.notify({type:"negative",message:"Camera permission denied. Please enable in Settings.",position:"top"})}},unmounted(){try{this.qrScanner&&(this.qrScanner.stop(),this.qrScanner.destroy())}catch(e){console.warn("Error cleaning up camera:",e)}}},pm={class:"text-center"},vm={ref:"cameraEl",style:{width:"100%"}},ym={class:"row q-justify-center"},_m={class:"absolute-full flex flex-center"},wm={class:"row q-my-sm"};function km(e,t,n,i,o,s){return _(),B(Qe,null,{default:u(()=>[g("div",pm,[g("div",null,[g("video",vm,null,512)]),g("div",null,[g("div",ym,[o.urDecoderProgress>0?(_(),B($i,{key:0,rounded:"",size:"30px",value:o.urDecoderProgress,indeterminate:o.urDecoderProgress===0,class:"q-mt-none",color:"secondary"},{default:u(()=>[g("div",_m,[r(Wt,{color:"white","text-color":"secondary",style:{"font-size":"1rem",padding:"5px"},class:"text-weight-bold",label:e.$t("QrcodeReader.progress.text",{percentage:e.$t("QrcodeReader.progress.percentage",{percentage:Math.round(o.urDecoderProgress*100)}),addon:o.urDecoderProgress>.9?e.$t("QrcodeReader.progress.keep_scanning_text"):""})},null,8,["label"])])]),_:1},8,["value","indeterminate"])):x("",!0)])])]),g("div",wm,[s.canPasteFromClipboard?(_(),B(R,{key:0,unelevated:"",onClick:s.pasteToParseDialog},{default:u(()=>[r(J,{name:"content_paste",class:"q-mr-sm"}),I(" "+M(e.$t("QrcodeReader.actions.paste.label")),1)]),_:1},8,["onClick"])):x("",!0),o.cameraWorking?x("",!0):(_(),B(R,{key:1,onClick:s.retryCameraPermission,color:"primary",class:"q-ml-sm"},{default:u(()=>[r(J,{name:"camera_alt",class:"q-mr-sm"}),I(" Grant Camera Permission ")]),_:1},8,["onClick"])),r(R,{flat:"",round:"",icon:"close",color:"grey",onClick:e.closeCamera,class:"q-ml-auto"},{default:u(()=>[r(be,null,{default:u(()=>[I("Close")]),_:1})]),_:1},8,["onClick"])])]),_:1})}var os=xe(gm,[["render",km]]);const bm=ze({name:"EcashClaimNotification",setup(){const e=wi(),t=re(!1),n=re(!1),i=re(new Set),o=z(()=>e.unclaimedTokens.filter(y=>!y.claimed)),s=z(()=>o.value.length),a=z(()=>o.value.filter(y=>y.unit==="sat").reduce((y,P)=>y+P.amount,0));return{bluetoothStore:e,showDetails:t,claiming:n,claimingTokens:i,unclaimedTokens:o,unclaimedCount:s,unclaimedValue:a,formatNpub:y=>y?y.substring(0,12)+"..."+y.substring(y.length-6):"Unknown",formatTimestamp:y=>{const P=new Date(y),U=Date.now()-y;return U<6e4?"Just now":U<36e5?`${Math.floor(U/6e4)}m ago`:U<864e5?`${Math.floor(U/36e5)}h ago`:P.toLocaleDateString()},claimSingle:async y=>{i.value.add(y);try{await e.claimTokenSilently(y)&&st("Token processed successfully!")}catch(P){console.error("Failed to claim token:",P),Te("Failed to claim token")}finally{i.value.delete(y),i.value=new Set(i.value)}},claimAll:async()=>{n.value=!0;try{await e.autoClaimTokensSilently(),st("All tokens processed!"),t.value=!1}catch(y){console.error("Failed to claim tokens:",y),Te("Some tokens could not be claimed")}finally{n.value=!1}},clearAll:()=>{e.clearAllUnclaimedTokens(),t.value=!1}}}}),Dm={key:0,class:"ecash-claim-banner"},Cm={class:"banner-content"},$m={class:"text-h6"},Pm={class:"text-caption"},Mm={key:0,class:"q-mt-sm"};function qm(e,t,n,i,o,s){return e.unclaimedCount>0?(_(),F("div",Dm,[r(Bn,{class:"bg-positive text-white",rounded:""},{avatar:u(()=>[r(J,{name:"bluetooth",size:"md"})]),action:u(()=>[r(R,{flat:"",label:"Claim All",onClick:e.claimAll,loading:e.claiming},null,8,["onClick","loading"]),r(R,{flat:"",label:"Clear All",onClick:e.clearAll,color:"negative"},null,8,["onClick"]),r(R,{flat:"",icon:"expand_more",onClick:t[0]||(t[0]=a=>e.showDetails=!e.showDetails)})]),default:u(()=>[g("div",Cm,[g("div",$m,M(e.unclaimedCount)+" Ecash Token"+M(e.unclaimedCount!==1?"s":"")+" Received ",1),g("div",Pm," Total: "+M(e.unclaimedValue)+" sats via Bluetooth ",1)])]),_:1}),r(Fs,null,{default:u(()=>[e.showDetails?(_(),F("div",Mm,[r(Qe,null,{default:u(()=>[r(dn,{separator:""},{default:u(()=>[(_(!0),F(Ze,null,At(e.unclaimedTokens,a=>(_(),B(bt,{key:a.id},{default:u(()=>[r(Ue,{avatar:""},{default:u(()=>[r(ln,{color:"primary","text-color":"white"},{default:u(()=>[I(M(a.amount),1)]),_:2},1024)]),_:2},1024),r(Ue,null,{default:u(()=>[r(Ce,null,{default:u(()=>[I(M(a.amount)+" "+M(a.unit),1)]),_:2},1024),r(Ce,{caption:""},{default:u(()=>[I(" From: "+M(e.formatNpub(a.sender)),1)]),_:2},1024),a.memo?(_(),B(Ce,{key:0,caption:""},{default:u(()=>[I(' "'+M(a.memo)+'" ',1)]),_:2},1024)):x("",!0),r(Ce,{caption:"",class:"text-grey-6"},{default:u(()=>[I(M(e.formatTimestamp(a.timestamp)),1)]),_:2},1024)]),_:2},1024),r(Ue,{side:""},{default:u(()=>[r(R,{round:"",dense:"",flat:"",icon:"download",color:"primary",onClick:c=>e.claimSingle(a.id),loading:e.claimingTokens.has(a.id)},{default:u(()=>[r(be,null,{default:u(()=>[I("Claim Token")]),_:1})]),_:2},1032,["onClick","loading"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])):x("",!0)]),_:1})])):x("",!0)}var Tm=xe(bm,[["render",qm],["__scopeId","data-v-3aad4629"]]);const Sm=ze({name:"ContactsDialog",props:{modelValue:{type:Boolean,default:!1}},emits:["update:modelValue"],mixins:[window.windowMixin],components:{ChooseMint:$n,VueQrcode:Pi,QrcodeReader:os,XIcon:Zn},setup(e,{emit:t}){const n=wi(),i=$o(),o=Ne(),s=ye(),a=Di(),c=lt(),l=Vn(),m=re(null),h=re(!1),w=re(null),y=re(!1),P=re(null),A=re(""),U=re(!1),j=re(!1),K=re(!1),E=re(null),O=re(!1),X=re(""),ae=re([]),ce=re([]),he=re(null),d=z(()=>s.activeUnit),p=z(()=>Qs.isNativePlatform()),v=async()=>{if(!p.value){ae.value=[];return}try{const V=await Wi.getAvailablePeers();ae.value=V.peers||[]}catch(V){console.error("Failed to fetch connected peers:",V),ae.value=[]}},T=async()=>{let V=[];if(p.value)try{V=(await Wi.getOfflineFavorites()).favorites||[]}catch(Y){console.error("Failed to fetch offline favorites from Bluetooth:",Y)}try{const Y=i.mutualFavorites.filter(Re=>Re.peerNostrNpub!==null).map(Re=>V.some(dt=>dt.peerID===Re.peerNoisePublicKey)?null:{peerID:Re.peerNoisePublicKey,nickname:Re.peerNickname,isMutual:Re.isFavorite&&Re.theyFavoritedUs,hasNostr:Re.peerNostrNpub!==null,npub:Re.peerNostrNpub||void 0}).filter(Re=>Re!==null),ge=[...V,...Y],je=new Map;ge.forEach(Re=>{je.has(Re.peerID)||je.set(Re.peerID,Re)}),ce.value=Array.from(je.values())}catch(Y){console.error("Failed to fetch offline favorites:",Y),ce.value=i.mutualFavorites.filter(ge=>ge.peerNostrNpub!==null).map(ge=>({peerID:ge.peerNoisePublicKey,nickname:ge.peerNickname,isMutual:ge.isFavorite&&ge.theyFavoritedUs,hasNostr:ge.peerNostrNpub!==null,npub:ge.peerNostrNpub||void 0}))}},D=()=>{he.value&&clearInterval(he.value),he.value=window.setInterval(async()=>{n.isActive&&(await v(),await T())},5e3)},k=()=>{he.value&&(clearInterval(he.value),he.value=null)};Hn(async()=>{await ko();try{await T()}catch(V){console.error("Error fetching offline favorites:",V),ce.value=[]}if(p.value)try{await v(),n.isActive&&D()}catch(V){console.error("Error fetching connected peers:",V),ae.value=[]}}),ys(()=>{k()});const $=V=>{const Y=Math.floor((Date.now()-V)/1e3);return Y<60?"Just now":Y<3600?`${Math.floor(Y/60)}m ago`:Y<86400?`${Math.floor(Y/3600)}h ago`:`${Math.floor(Y/86400)}d ago`},b=V=>V?V.length>16?`${V.substring(0,16)}...`:V:"No Nostr key",C=V=>i.isFavorite(V),S=V=>i.isMutualFavorite(V),q=async V=>{if(C(V.peerID)){i.removeFavorite(V.peerID);try{l.seedSignerPublicKey||await l.walletSeedGenerateKeyPair();const ge=l.seedSignerPublicKey||l.pubkey;if(ge){const je=ge.startsWith("npub")?ge:li.npubEncode(ge);await n.sendTextMessage(V.peerID,`[UNFAVORITED]:${je}`),console.log(`\u{1F4E4} Sent unfavorite notification to ${V.nickname} with npub: ${je.substring(0,16)}...`)}}catch(ge){console.error("Failed to send unfavorite notification:",ge)}st(`Removed ${V.nickname} from favorites`)}else{i.addFavorite(V.peerID,V.nickname||"Unknown",V.nostrNpub||null);try{l.seedSignerPublicKey||await l.walletSeedGenerateKeyPair();const ge=l.seedSignerPublicKey||l.pubkey;if(ge){const je=ge.startsWith("npub")?ge:li.npubEncode(ge);await n.sendTextMessage(V.peerID,`[FAVORITE_REQUEST]:${je}`),console.log(`\u{1F4E4} Sent favorite request to ${V.nickname} with npub: ${je.substring(0,16)}...`)}}catch(ge){console.error("Failed to send favorite request:",ge)}st(`Sent favorite request to ${V.nickname}`)}await T()},N=V=>{i.removeFavorite(V),st("Removed from favorites"),T()},ee=V=>{m.value=V.peerID},Z=V=>{m.value=V.peerID},ue=V=>{w.value=V,P.value=null,A.value="",y.value=V.canSendViaNostr||!1,h.value=!0},qe=V=>{w.value={peerID:V.peerID,nickname:V.nickname,canSendViaNostr:V.hasNostr&&V.isMutual},P.value=null,A.value="",y.value=V.hasNostr&&V.isMutual,h.value=!0},Ee=()=>{h.value=!1,w.value=null,P.value=null,A.value="",y.value=!1},me=async()=>{if(!w.value){Te("No target selected");return}if(!P.value||P.value<=0){Te("Please enter a valid amount");return}const V=Math.floor(P.value*s.activeUnitCurrencyMultiplyer);if(V>s.activeBalance){Te(`Insufficient balance. Available: ${He(s.activeBalance,s.activeUnit)}`);return}U.value=!0;try{const Y=o.mintWallet(s.activeMintUrl,s.activeUnit),ge=s.activeProofs||[];if(ge.length===0){Te("No tokens available. Please receive tokens first."),U.value=!1;return}const{sendProofs:je}=await o.send(ge,Y,V,!0,!1),Re=a.serializeProofs(je);if(c.addPendingToken({amount:V,token:Re,mint:s.activeMintUrl,unit:d.value,label:A.value?`${y.value?"\u{1F310}":"\u{1F4E1}"} ${y.value?"Nostr":"Bluetooth"}: ${A.value}`:`${y.value?"\u{1F310}":"\u{1F4E1}"} Sent to ${w.value.nickname} via ${y.value?"Nostr":"Bluetooth"}`}),y.value){if(!w.value.canSendViaNostr){Te("Contact does not have Nostr key"),U.value=!1;return}if(!l.pubkey){Te("Nostr not configured. Please set up your Nostr key first."),U.value=!1;return}let tt=null;if(w.value.peerID&&!w.value.npub?tt=ce.value.find(Q=>Q.peerID===w.value.peerID)?.npub||null:tt=w.value.npub||null,!tt){Te("Could not resolve recipient Nostr key"),U.value=!1;return}let dt=Re;A.value&&(dt+=`
---
Memo: ${A.value}
Amount: ${P.value} ${d.value}
From: ${l.pubkey.substring(0,16)}...`),console.log(`\u{1F4E4} Sending to npub: ${tt.substring(0,20)}...`),await l.sendNip04DirectMessage(tt,dt),st(`Sent ${P.value} ${d.value} to ${w.value.nickname} via Nostr!`)}else if(await n.sendToken({token:Re,amount:V,unit:d.value,mint:s.activeMintUrl,peerID:w.value.peerID,memo:A.value||void 0,senderNpub:l.pubkey||""}))st(`Sent ${P.value} ${d.value} to ${w.value.nickname} via Bluetooth!`);else{Te("Failed to send token via Bluetooth"),U.value=!1;return}Ee()}catch(Y){console.error("Failed to send token:",Y),Te(`Failed to send: ${Y}`)}finally{U.value=!1}},fe=async()=>{if(!p.value){Te("Bluetooth is not available in this environment");return}await n.startService(),n.isActive&&(D(),await v(),await T())},We=()=>{X.value=n.nickname,O.value=!0},Mt=async()=>{if(!X.value||X.value.trim()===""){Te("Username cannot be empty");return}if(X.value.length<3){Te("Username must be at least 3 characters");return}if(X.value.length>32){Te("Username must be less than 32 characters");return}try{if(await n.updateNickname(X.value.trim()),st("Username updated!"),O.value=!1,j.value){const V=await ut();E.value=V}}catch(V){console.error("Failed to update username:",V),Te("Failed to update username")}},qt=()=>{O.value=!1,X.value=""},ut=async()=>{try{l.seedSignerPublicKey||await l.walletSeedGenerateKeyPair();const V=l.seedSignerPublicKey||l.pubkey;if(!V)return Te("Nostr key not available. Please configure Nostr first."),null;const Y=V.startsWith("npub")?V:li.npubEncode(V),ge={type:"contact",npub:Y,nickname:n.nickname};return JSON.stringify(ge)}catch(V){return console.error("Failed to generate QR code data:",V),Te("Failed to generate QR code"),null}},Ge=async()=>{j.value=!0,E.value=null;const V=await ut();E.value=V},yt=async V=>{try{K.value=!1;let Y;try{Y=JSON.parse(V)}catch{Te("Invalid QR code format. Expected contact QR code.");return}if(Y.type!=="contact"){Te("Invalid QR code type. This is not a contact QR code.");return}if(!Y.npub){Te("Invalid QR code. Missing Nostr public key.");return}if(!Y.nickname||Y.nickname.trim()===""){Te("Invalid QR code. Missing nickname.");return}const ge=Y.npub,je=Y.nickname.trim(),tt=Object.values(i.favorites).find(ne=>ne.peerNostrNpub===ge);if(tt){tt.isFavorite&&tt.theyFavoritedUs?st(`${je} is already your mutual favorite!`):(i.updatePeerFavoritedUs(tt.peerNoisePublicKey,!0),st(`\u{1F495} You and ${je} are now mutual favorites!`));return}const dt=await crypto.subtle.digest("SHA-256",new TextEncoder().encode(ge)),Q=Array.from(new Uint8Array(dt)).slice(0,16).map(ne=>ne.toString(16).padStart(2,"0")).join("");i.addFavorite(Q,je,ge),i.updatePeerFavoritedUs(Q,!0),st(`\u{1F495} Added ${je} as mutual favorite! You can now send messages via Nostr.`),await T()}catch(Y){console.error("Failed to process scanned QR code:",Y),Te("Failed to add contact. Please try again.")}},He=(V,Y)=>V?`${(V/s.activeUnitCurrencyMultiplyer).toFixed(2)} ${Y}`:`0 ${Y}`;return Ft(()=>n.nickname,()=>{j.value&&E.value&&ut().then(V=>{E.value=V})}),{bluetoothStore:n,mintsStore:s,connectedPeers:ae,offlineFavorites:ce,selectedPeerID:m,showSendDialog:h,sendTarget:w,sendViaNostr:y,sendAmount:P,sendMemo:A,sending:U,unit:d,isFavorite:C,isMutualFavorite:S,toggleFavorite:q,removeFavorite:N,handlePeerClick:ee,handleOfflineFavoriteClick:Z,openSendDialog:ue,openSendDialogForOffline:qe,closeSendDialog:Ee,sendToken:me,enableBluetooth:fe,formatLastSeen:$,formatNpub:b,formatCurrency:He,showQRCodeDialog:j,showQRCodeDialogHandler:Ge,qrCodeData:E,showScanDialog:K,handleQRCodeScanned:yt,isBluetoothEcashAvailable:p,isEditingUsername:O,localUsername:X,startEditingUsername:We,saveUsername:Mt,cancelEditingUsername:qt}}}),Ut=e=>(Gn("data-v-38e82a72"),e=e(),Xn(),e),Im=Ut(()=>g("div",{class:"col text-center"},[g("span",{class:"text-h6"},"Contacts")],-1)),Am=Ut(()=>g("div",{class:"q-mr-sm",style:{width:"40px"}},null,-1)),Em={class:"contacts-dialog"},Rm={class:"q-mb-md"},Um={class:"row items-center q-gutter-sm"},Nm={class:"col"},xm=Ut(()=>g("div",{class:"text-caption text-grey-6 q-mb-xs"},"Username",-1)),Bm={key:0,class:"row items-center"},Lm={class:"col"},Fm={class:"text-h6"},Om={class:"col-auto"},Vm={class:"col-auto"},zm={class:"col-auto"},Wm={key:1,class:"row items-center q-gutter-xs"},jm={class:"col"},Qm={class:"col-auto"},Km={class:"col-auto"},Hm={class:"q-mb-md"},Gm={class:"q-mb-md"},Xm={key:2,class:"text-center q-py-xl"},Zm=Ut(()=>g("div",{class:"q-mt-md text-grey-7"},"Scanning for contacts...",-1)),Ym={key:3,class:"text-center q-py-xl"},Jm=Ut(()=>g("div",{class:"q-mt-md text-grey-7"},"Use QR codes to add contacts",-1)),eg={class:"row items-center q-gutter-xs"},tg={key:0,class:"text-positive"},ng={key:1,class:"text-grey-6"},ig={class:"row items-center q-gutter-xs"},og=Ut(()=>g("div",{class:"text-h6 q-mb-md"},"My Contact QR Code",-1)),sg={key:0,class:"q-mb-md"},ag={class:"q-mt-md text-body2"},rg=Ut(()=>g("div",{class:"q-mt-xs text-caption text-grey-6"}," Share this QR code to add each other as contacts ",-1)),lg={key:1,class:"q-pa-lg"},cg=Ut(()=>g("div",{class:"q-mt-md"},"Generating QR code...",-1)),ug=Ut(()=>g("div",{class:"text-h6 q-mb-md"},"Scan Contact QR Code",-1)),dg={class:"text-h6"};function fg(e,t,n,i,o,s){const a=G("XIcon"),c=G("ChooseMint"),l=G("vue-qrcode"),m=G("QrcodeReader");return _(),B(Ye,{"model-value":e.modelValue,"onUpdate:modelValue":t[9]||(t[9]=h=>e.$emit("update:modelValue",h)),position:"bottom",maximized:e.$q.screen.lt.sm,"transition-show":"slide-up","transition-hide":"slide-down","backdrop-filter":"blur(2px) brightness(60%)"},{default:u(()=>[r(Qe,{class:"bg-grey-10 text-white full-width-card q-pb-lg",style:{"max-height":"80vh",display:"flex","flex-direction":"column"}},{default:u(()=>[r(Se,{class:"row items-center q-pb-sm",style:{"flex-shrink":"0"}},{default:u(()=>[Ie((_(),B(R,{flat:"",round:"",dense:"",class:"q-ml-sm",color:"primary"},{default:u(()=>[r(a)]),_:1})),[[Ke]]),Im,Am]),_:1}),r(Se,{style:{flex:"1","overflow-y":"auto","min-height":"0"},class:"q-pa-md"},{default:u(()=>[g("div",Em,[e.isBluetoothEcashAvailable&&!e.bluetoothStore.isActive?(_(),B(Bn,{key:0,class:"bg-warning text-dark q-mb-md",rounded:""},{avatar:u(()=>[r(J,{name:"bluetooth_disabled"})]),action:u(()=>[r(R,{flat:"",label:"Enable",onClick:e.enableBluetooth},null,8,["onClick"])]),default:u(()=>[I(" Bluetooth is off. Turn it on to discover nearby contacts. ")]),_:1})):x("",!0),e.isBluetoothEcashAvailable?x("",!0):(_(),B(Bn,{key:1,class:"bg-info text-white q-mb-md",rounded:""},{avatar:u(()=>[r(J,{name:"qr_code"})]),default:u(()=>[I(" Use QR codes to add contacts without Bluetooth. ")]),_:1})),g("div",Rm,[g("div",Um,[g("div",Nm,[xm,e.isEditingUsername?(_(),F("div",Wm,[g("div",jm,[r(ct,{modelValue:e.localUsername,"onUpdate:modelValue":t[1]||(t[1]=h=>e.localUsername=h),dense:"",outlined:"",placeholder:"Enter username",rules:[h=>h&&h.length>=3||"Minimum 3 characters",h=>h&&h.length<=32||"Maximum 32 characters"],onKeyup:Et(e.saveUsername,["enter"]),autofocus:""},null,8,["modelValue","rules","onKeyup"])]),g("div",Qm,[r(R,{flat:"",dense:"",round:"",size:"sm",icon:"check",color:"positive",onClick:e.saveUsername},{default:u(()=>[r(be,null,{default:u(()=>[I("Save")]),_:1})]),_:1},8,["onClick"])]),g("div",Km,[r(R,{flat:"",dense:"",round:"",size:"sm",icon:"close",color:"negative",onClick:e.cancelEditingUsername},{default:u(()=>[r(be,null,{default:u(()=>[I("Cancel")]),_:1})]),_:1},8,["onClick"])])])):(_(),F("div",Bm,[g("div",Lm,[g("span",Fm,M(e.bluetoothStore.nickname),1)]),g("div",Om,[r(R,{flat:"",dense:"",round:"",size:"sm",icon:"edit",color:"primary",onClick:e.startEditingUsername},{default:u(()=>[r(be,null,{default:u(()=>[I("Edit username")]),_:1})]),_:1},8,["onClick"])]),g("div",Vm,[r(R,{flat:"",dense:"",round:"",size:"sm",icon:"qr_code",color:"secondary",onClick:e.showQRCodeDialogHandler},{default:u(()=>[r(be,null,{default:u(()=>[I("Show QR code")]),_:1})]),_:1},8,["onClick"])]),g("div",zm,[r(R,{flat:"",dense:"",round:"",size:"sm",icon:"camera_alt",color:"accent",onClick:t[0]||(t[0]=h=>e.showScanDialog=!0)},{default:u(()=>[r(be,null,{default:u(()=>[I("Scan QR code")]),_:1})]),_:1})])]))])])]),g("div",Hm,[r(c)]),g("div",Gm,[r(Wt,{color:"primary",class:"text-weight-bold q-pa-sm"},{default:u(()=>[I(" Available: "+M(e.formatCurrency(e.mintsStore.activeBalance,e.mintsStore.activeUnit)),1)]),_:1})]),e.isBluetoothEcashAvailable&&e.bluetoothStore.isActive&&e.connectedPeers.length===0&&e.offlineFavorites.length===0?(_(),F("div",Xm,[r(Vi,{size:"3em",color:"primary"}),Zm])):x("",!0),!e.isBluetoothEcashAvailable&&e.offlineFavorites.length===0?(_(),F("div",Ym,[r(J,{name:"qr_code",size:"3em",color:"primary"}),Jm])):x("",!0),e.offlineFavorites.length>0||e.isBluetoothEcashAvailable&&e.bluetoothStore.isActive&&e.connectedPeers.length>0?(_(),B(dn,{key:4,bordered:"",separator:"",class:"rounded-borders"},{default:u(()=>[e.connectedPeers.length>0?(_(),F(Ze,{key:0},[r(Ce,{header:"",class:"text-grey-6 q-pa-sm text-uppercase text-caption"},{default:u(()=>[I(" Nearby ("+M(e.connectedPeers.length)+") ",1)]),_:1}),(_(!0),F(Ze,null,At(e.connectedPeers,h=>Ie((_(),B(bt,{key:h.peerID,clickable:"",onClick:w=>e.handlePeerClick(h),class:Vt({"bg-blue-1":e.selectedPeerID===h.peerID})},{default:u(()=>[r(Ue,{avatar:""},{default:u(()=>[r(ln,{color:h.isDirect?"green":"orange","text-color":"white"},{default:u(()=>[r(J,{name:h.isDirect?"bluetooth_connected":"device_hub"},null,8,["name"])]),_:2},1032,["color"])]),_:2},1024),r(Ue,null,{default:u(()=>[r(Ce,null,{default:u(()=>[I(M(h.nickname||h.nostrNpub?.substring(0,16)||h.peerID.substring(0,8))+"... ",1),e.isMutualFavorite(h.peerID)?(_(),B(J,{key:0,name:"favorite",color:"pink",size:"xs",class:"q-ml-xs"},{default:u(()=>[r(be,null,{default:u(()=>[I("Mutual favorite")]),_:1})]),_:1})):x("",!0),h.canSendViaNostr?(_(),B(J,{key:1,name:"public",color:"primary",size:"xs",class:"q-ml-xs"},{default:u(()=>[r(be,null,{default:u(()=>[I("Send via Nostr available")]),_:1})]),_:1})):x("",!0)]),_:2},1024),r(Ce,{caption:""},{default:u(()=>[I(M(h.isDirect?"Direct":"Via mesh")+" \u2022 "+M(e.formatLastSeen(h.lastSeen)),1)]),_:2},1024)]),_:2},1024),r(Ue,{side:""},{default:u(()=>[g("div",eg,[r(R,{flat:"",dense:"",round:"",size:"sm",icon:e.isFavorite(h.peerID)?"favorite":"favorite_border",color:e.isFavorite(h.peerID)?"pink":"grey",onClick:sn(w=>e.toggleFavorite(h),["stop"])},{default:u(()=>[r(be,null,{default:u(()=>[I(M(e.isFavorite(h.peerID)?"Remove from favorites":"Add to favorites"),1)]),_:2},1024)]),_:2},1032,["icon","color","onClick"]),r(R,{flat:"",dense:"",round:"",icon:"send",color:h.canSendViaNostr||h.isConnected?"primary":"grey",disable:!h.canSendViaNostr&&!h.isConnected,onClick:sn(w=>e.openSendDialog(h),["stop"])},{default:u(()=>[r(be,null,{default:u(()=>[I(M(h.canSendViaNostr?"Send via Nostr":h.isConnected?"Send via Bluetooth":"Not available"),1)]),_:2},1024)]),_:2},1032,["color","disable","onClick"])])]),_:2},1024)]),_:2},1032,["onClick","class"])),[[Gt]])),128))],64)):x("",!0),e.offlineFavorites.length>0?(_(),F(Ze,{key:1},[e.connectedPeers.length>0?(_(),B(Ce,{key:0,header:"",class:"text-grey-6 q-pa-sm text-uppercase text-caption q-mt-md"},{default:u(()=>[I(" Offline Favorites ("+M(e.offlineFavorites.length)+") ",1)]),_:1})):x("",!0),(_(!0),F(Ze,null,At(e.offlineFavorites,h=>Ie((_(),B(bt,{key:h.peerID,clickable:"",onClick:w=>e.handleOfflineFavoriteClick(h),class:Vt({"bg-blue-1":e.selectedPeerID===h.peerID})},{default:u(()=>[r(Ue,{avatar:""},{default:u(()=>[r(ln,{color:"primary","text-color":"white"},{default:u(()=>[r(J,{name:h.isMutual?"favorite":"person"},null,8,["name"])]),_:2},1024)]),_:2},1024),r(Ue,null,{default:u(()=>[r(Ce,null,{default:u(()=>[I(M(h.nickname)+" ",1),h.isMutual?(_(),B(J,{key:0,name:"favorite",color:"pink",size:"xs",class:"q-ml-xs"},{default:u(()=>[r(be,null,{default:u(()=>[I("Mutual favorite")]),_:1})]),_:1})):x("",!0),h.hasNostr&&h.isMutual?(_(),B(J,{key:1,name:"public",color:"primary",size:"xs",class:"q-ml-xs"},{default:u(()=>[r(be,null,{default:u(()=>[I("Send via Nostr available")]),_:1})]),_:1})):x("",!0)]),_:2},1024),r(Ce,{caption:""},{default:u(()=>[h.npub?(_(),F("span",tg,[r(J,{name:"check_circle",size:"xs"}),I(" Nostr messaging available ")])):(_(),F("span",ng,[r(J,{name:"info",size:"xs"}),I(" Bluetooth only ")]))]),_:2},1024)]),_:2},1024),r(Ue,{side:""},{default:u(()=>[g("div",ig,[r(R,{flat:"",dense:"",round:"",size:"sm",icon:"delete",color:"grey",onClick:sn(w=>e.removeFavorite(h.peerID),["stop"])},{default:u(()=>[r(be,null,{default:u(()=>[I("Remove from favorites")]),_:1})]),_:2},1032,["onClick"]),r(R,{flat:"",dense:"",round:"",icon:"send",color:h.hasNostr&&h.isMutual?"primary":"grey",disable:!(h.hasNostr&&h.isMutual),onClick:sn(w=>e.openSendDialogForOffline(h),["stop"])},{default:u(()=>[r(be,null,{default:u(()=>[I(M(h.hasNostr&&h.isMutual?"Send via Nostr":"Nostr key required"),1)]),_:2},1024)]),_:2},1032,["color","disable","onClick"])])]),_:2},1024)]),_:2},1032,["onClick","class"])),[[Gt]])),128))],64)):x("",!0)]),_:1})):x("",!0),r(Ye,{modelValue:e.showQRCodeDialog,"onUpdate:modelValue":t[3]||(t[3]=h=>e.showQRCodeDialog=h)},{default:u(()=>[r(Qe,{style:{"min-width":"350px"}},{default:u(()=>[r(Se,{class:"text-center"},{default:u(()=>[og,e.qrCodeData?(_(),F("div",sg,[r(l,{value:e.qrCodeData,options:{width:300},class:"rounded-borders"},null,8,["value"]),g("div",ag,[g("strong",null,M(e.bluetoothStore.nickname),1)]),rg])):(_(),F("div",lg,[r(Vi,{size:"3em",color:"primary"}),cg]))]),_:1}),r(an,{align:"right"},{default:u(()=>[r(R,{flat:"",round:"",icon:"close",color:"grey",onClick:t[2]||(t[2]=h=>e.showQRCodeDialog=!1)},{default:u(()=>[r(be,null,{default:u(()=>[I("Close")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),r(Ye,{modelValue:e.showScanDialog,"onUpdate:modelValue":t[5]||(t[5]=h=>e.showScanDialog=h),persistent:""},{default:u(()=>[r(Qe,{style:{width:"100%","max-width":"600px"}},{default:u(()=>[r(Se,{class:"text-center"},{default:u(()=>[ug,r(m,{onDecode:e.handleQRCodeScanned},null,8,["onDecode"])]),_:1}),r(an,{align:"right"},{default:u(()=>[r(R,{flat:"",round:"",icon:"close",color:"grey",onClick:t[4]||(t[4]=h=>e.showScanDialog=!1)},{default:u(()=>[r(be,null,{default:u(()=>[I("Close")]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),r(Ye,{modelValue:e.showSendDialog,"onUpdate:modelValue":t[8]||(t[8]=h=>e.showSendDialog=h),persistent:""},{default:u(()=>[r(Qe,{style:{"min-width":"400px"}},{default:u(()=>[r(Se,{class:"row items-center"},{default:u(()=>[r(J,{name:"send",color:"primary",size:"md",class:"q-mr-sm"}),g("span",dg,"Send to "+M(e.sendTarget?.nickname),1)]),_:1}),r(Se,null,{default:u(()=>[r(ct,{modelValue:e.sendAmount,"onUpdate:modelValue":t[6]||(t[6]=h=>e.sendAmount=h),modelModifiers:{number:!0},type:"number",label:"Amount",outlined:"",dense:"",suffix:e.unit,class:"q-mb-md",autofocus:"",placeholder:"Enter amount"},{prepend:u(()=>[r(J,{name:"payments"})]),_:1},8,["modelValue","suffix"]),r(ct,{modelValue:e.sendMemo,"onUpdate:modelValue":t[7]||(t[7]=h=>e.sendMemo=h),label:"Memo (optional)",outlined:"",dense:"",class:"q-mb-md",placeholder:"What's this for?"},{prepend:u(()=>[r(J,{name:"note"})]),_:1},8,["modelValue"]),r(Bn,{dense:"",class:Vt(["q-mb-md",e.sendViaNostr?"bg-info text-white":"bg-blue-1"]),rounded:""},{avatar:u(()=>[r(J,{name:e.sendViaNostr?"public":"bluetooth"},null,8,["name"])]),default:u(()=>[I(" "+M(e.sendViaNostr?"Sending via Nostr - no Bluetooth connection needed":"Sending via Bluetooth mesh"),1)]),_:1},8,["class"])]),_:1}),r(an,{align:"right",class:"q-pa-md"},{default:u(()=>[r(R,{flat:"",round:"",icon:"close",color:"grey",onClick:e.closeSendDialog},{default:u(()=>[r(be,null,{default:u(()=>[I("Close")]),_:1})]),_:1},8,["onClick"]),r(R,{color:"primary",label:"Send",onClick:e.sendToken,loading:e.sending,disable:!e.sendAmount||e.sendAmount<=0},null,8,["onClick","loading","disable"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])]),_:1})]),_:1})]),_:1},8,["model-value","maximized"])}var hg=xe(Sm,[["render",fg],["__scopeId","data-v-38e82a72"]]);const mg=ze({name:"ActivityOrb",mixins:[windowMixin],components:{},props:{},data:function(){return{enableSpinner:!1}},mounted(){},computed:{...se(Ae,["activityOrb"]),...te(Ne,["activeWebsocketConnections"]),...te(pt,["scanningCard"])},watch:{activityOrb:function(){this.activityOrb?(this.enableSpinner=!0,setTimeout(()=>{this.activityOrb=!1,this.enableSpinner=!1},2e3)):this.enableSpinner=!1},scanningCard:function(){this.scanningCard?this.enableSpinner=!0:this.enableSpinner=!1}},methods:{}}),gg={class:"row justify-center q-mb-none",style:{position:"absolute",top:"60px",left:"0",width:"100%"}};function pg(e,t,n,i,o,s){return _(),F("div",gg,[g("div",null,[r(at,{appear:"","enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut"},{default:u(()=>[e.enableSpinner?(_(),B(J,{key:0,name:"adjust",color:"primary",size:"1.5em"})):x("",!0)]),_:1})])])}var vg=xe(mg,[["render",pg],["__scopeId","data-v-16d0a55d"]]);const yg=ze({name:"ReceiveTokenDialog",mixins:[windowMixin],components:{TokenInformation:Io,NfcIcon:qi,ScanIcon:Yt,ChooseMint:$n},data:function(){return{showP2PKDialog:!1,swapSelected:!1}},watch:{watchClipboardPaste(e){e&&this.$nextTick(()=>{this.pasteToParseDialog(),this.watchClipboardPaste=!1})},"receiveData.tokensBase64":{handler(e){e&&this.tokenDecodesCorrectly&&this.$nextTick(()=>{this.autoReceiveIfValid()})},immediate:!1}},computed:{...se(pt,["showReceiveTokens","watchClipboardPaste","receiveData","scanningCard"]),...te(Ae,["tickerShort","ndefSupported"]),...te(cn,["bitcoinPrice","bitcoinPrices","currentCurrencyPrice"]),...te(Je,["bitcoinPriceCurrency"]),...te(ye,["activeMintUrl","activeProofs","activeUnit","addMintBlocking","mints"]),...te(Je,["enableReceiveSwaps"]),...se(ye,["addMintData","showAddMintDialog"]),...se($t,["showPRDialog"]),...te(et,["hasCamera"]),...te(Ct,["p2pkKeys"]),...te($t,["enablePaymentRequest"]),...te(Gi,["swapBlocking"]),...se(Ae,["showReceiveDialog"]),...te(et,["lastScannedResult"]),canPasteFromClipboard:function(){return window.isSecureContext&&navigator.clipboard&&navigator.clipboard.readText},tokenDecodesCorrectly:function(){return this.decodeToken(this.receiveData.tokensBase64)!==void 0?!0:this.decodePeanut(this.receiveData.tokensBase64)!==void 0},knowThisMint:function(){const e=this.decodeToken(this.receiveData.tokensBase64);return e==null?!1:this.knowThisMintOfTokenJson(e)},tokenAmount:function(){if(!this.tokenDecodesCorrectly)return 0;const e=this.decodeToken(this.receiveData.tokensBase64);return this.getProofs(e).reduce((t,n)=>t+=n.amount,0)},tokenUnit:function(){if(!this.tokenDecodesCorrectly)return"";const e=this.decodeToken(this.receiveData.tokensBase64);return De.getUnit(e)},tokenMint:function(){if(!this.tokenDecodesCorrectly)return"";const e=this.decodeToken(this.receiveData.tokensBase64);return this.getMint(e)},swapToMintAmount:function(){const e=this.decodeToken(this.receiveData.tokensBase64);return this.tokenAmount-Gi().meltToMintFees(e)}},methods:{...oe(Ne,["redeem"]),...oe(et,["closeCamera","showCamera"]),...oe(lt,["addPendingToken"]),...oe(Ct,["getPrivateKeyForP2PKEncodedToken","generateKeypair","showLastKey"]),...oe(ye,["addMint"]),...oe(pt,["receiveIfDecodes","decodeToken","knowThisMintOfTokenJson","toggleScanner","pasteToParseDialog"]),decodePeanut:function(e){try{let t=[];const n=Array.from(e);if(!n.length)return;const i=function(o){const s=o.codePointAt(0);if(s>=65024&&s<=65039){const a=s-65024;return String.fromCharCode(a)}if(s>=917760&&s<=917999){const a=s-917760+16;return String.fromCharCode(a)}return null};for(const o of n){let s=i(o);if(s===null&&t.length>0)break;if(s===null)continue;t.push(s)}return t=t.join(""),t&&(this.receiveData.tokensBase64=t),this.decodeToken(t)}catch{return}},getProofs:function(e){return De.getProofs(e)},getMint:function(e){return De.getMint(e)},tokenAlreadyInHistory:function(e){return lt().historyTokens.find(n=>n.token===e)!==void 0},addPendingTokenToHistory:function(e){if(this.tokenAlreadyInHistory(e)){this.notifySuccess(this.$i18n.t("ReceiveTokenDialog.actions.later.already_in_history_success_text")),this.showReceiveTokens=!1;return}const t=lt(),n=this.decodeToken(e),i=this.getMint(n),o=De.getUnit(n),s=this.getProofs(n).reduce((a,c)=>a+=c.amount,0);t.addPendingToken({amount:s,token:e,mintInToken:i,unitInToken:o}),this.showReceiveTokens=!1,this.notifySuccess(this.$i18n.t("ReceiveTokenDialog.actions.later.added_to_history_success_text"))},handleSwapToTrustedMint:async function(){const e=ye().activeMint().mint;await pt().meltTokenToMint(this.receiveData.tokensBase64,e),this.swapSelected=!1},autoReceiveIfValid:async function(){const e=Ct();if(e.getPrivateKeyForP2PKEncodedToken(this.receiveData.tokensBase64)===null&&e.isP2PKEncodedToken(this.receiveData.tokensBase64))return;const i=lt().tokenAlreadyInHistory(this.receiveData.tokensBase64);if(i&&i.amount<0){console.log("\u2139\uFE0F Token already claimed, skipping auto-receive");return}try{await this.receiveIfDecodes()}catch(o){const s=o?.message||o?.toString()||"";if(s.includes("Token already spent")||s.includes("already spent")||s.includes("Outputs have already been signed")){console.log("\u2139\uFE0F Token already spent, marking as claimed");const a=lt(),c=a.tokenAlreadyInHistory(this.receiveData.tokensBase64);c&&c.amount>0&&a.setTokenPaid(this.receiveData.tokensBase64);return}console.error("Auto-receive failed:",o)}}}}),_g={class:"row items-center no-wrap q-mb-sm q-mb-sm q-py-lg"},wg={class:"col-9"},kg={class:"text-h6"},bg={key:0,class:"q-ml-xs text-subtitle2 text-grey-6"},Dg={class:"relative-container"},Cg={class:"row"},$g={key:1},Pg={class:"q-pl-sm"},Mg={key:2,class:"q-mr-xl"},qg={class:"row"},Tg={key:0,class:"row q-pt-md"},Sg={key:1,class:"row q-pl-md q-pt-sm"},Ig={key:2,class:"row q-pt-xs"},Ag={key:3,class:"row q-pt-sm"};function Eg(e,t,n,i,o,s){const a=G("ScanIcon"),c=G("NfcIcon"),l=G("TokenInformation"),m=G("i18n-t"),h=G("ChooseMint");return _(),B(Ye,{modelValue:e.showReceiveTokens,"onUpdate:modelValue":t[7]||(t[7]=w=>e.showReceiveTokens=w),position:"top",maximized:e.$q.screen.lt.sm,"transition-show":"fade","transition-hide":"fade","no-backdrop-dismiss":""},{default:u(()=>[r(Qe,{modelValue:e.showReceiveTokens,"onUpdate:modelValue":t[6]||(t[6]=w=>e.showReceiveTokens=w),class:"q-pa-lg qcard q-card-top"},{default:u(()=>[Ie((_(),B(R,{rounded:"",flat:"",color:"grey",class:"close-btn-position"},{default:u(()=>[I(M(e.$t("ReceiveTokenDialog.actions.close.label")),1)]),_:1})),[[Ke]]),g("div",null,[g("div",_g,[g("div",wg,[g("span",kg,M(e.$t("ReceiveTokenDialog.title",{value:e.tokenAmount&&e.tokenUnit?e.formatCurrency(e.tokenAmount,e.tokenUnit):e.$t("ReceiveTokenDialog.title_ecash_text")})),1),e.tokenAmount&&e.tokenUnit&&e.tokenUnit=="points"&&e.bitcoinPrice?(_(),F("span",bg," ("+M(e.formatCurrency(e.currentCurrencyPrice/1e8*e.tokenAmount,e.bitcoinPriceCurrency,!0))+") ",1)):x("",!0)])]),g("div",Dg,[r(ct,{round:"",outlined:"",spellcheck:"false",modelValue:e.receiveData.tokensBase64,"onUpdate:modelValue":t[1]||(t[1]=w=>e.receiveData.tokensBase64=w),label:e.$t("ReceiveTokenDialog.inputs.tokens_base64.label"),type:"textarea",readonly:"",class:"q-mb-lg cashub-nowrap",onKeyup:Et(e.receiveIfDecodes,["enter"])},{default:u(()=>[e.receiveData.tokensBase64?(_(),B(J,{key:0,color:"dark",name:"close",class:"floating-button cursor-pointer",onClick:t[0]||(t[0]=w=>e.receiveData.tokensBase64="")})):x("",!0)]),_:1},8,["modelValue","label","onKeyup"])])]),g("div",Cg,[e.receiveData.tokensBase64.length&&!e.tokenDecodesCorrectly?(_(),B(R,{key:0,disabled:"",color:"yellow","text-color":"black",rounded:"",unelevated:"",class:"q-ml-xs q-mr-sm",label:e.$t("ReceiveTokenDialog.errors.invalid_token.label")},null,8,["label"])):x("",!0),e.receiveData.tokensBase64.length?x("",!0):(_(),F("div",$g,[e.canPasteFromClipboard?(_(),B(R,{key:0,unelevated:"",dense:"",class:"q-mr-sm",onClick:t[2]||(t[2]=w=>e.pasteToParseDialog(!0))},{default:u(()=>[r(J,{name:"content_paste",class:"q-pr-sm"}),I(M(e.$t("ReceiveTokenDialog.actions.paste.label")),1)]),_:1})):x("",!0),e.hasCamera?(_(),B(R,{key:1,unelevated:"",dense:"",class:"q-mx-sm",onClick:e.showCamera},{default:u(()=>[r(a,{size:"1.5em"}),g("span",Pg,M(e.$t("ReceiveTokenDialog.actions.scan.label")),1)]),_:1},8,["onClick"])):x("",!0),e.ndefSupported?(_(),B(R,{key:2,unelevated:"",dense:"",class:"q-mx-sm",loading:e.scanningCard,disabled:e.scanningCard,onClick:e.toggleScanner},{loading:u(()=>[r(Cn,{onClick:e.toggleScanner},null,8,["onClick"])]),default:u(()=>[r(c,{class:"q-pr-xs"}),r(be,null,{default:u(()=>[I(M(e.ndefSupported?e.$t("ReceiveTokenDialog.actions.nfc.tooltips.ndef_supported_text"):e.$t("ReceiveTokenDialog.actions.nfc.tooltips.ndef_unsupported_text")),1)]),_:1}),I(" "+M(e.$t("ReceiveTokenDialog.actions.nfc.label")),1)]),_:1},8,["loading","disabled","onClick"])):x("",!0)])),e.tokenDecodesCorrectly?(_(),F("div",Mg,[g("div",qg,[r(l,{encodedToken:e.receiveData.tokensBase64,showAmount:!0,showMintCheck:!0,showP2PKCheck:!0},null,8,["encodedToken"])]),e.swapSelected?x("",!0):(_(),F("div",Tg,[r(R,{onClick:e.receiveIfDecodes,color:"primary",rounded:"",class:"q-ml-xs q-mr-sm",disabled:e.addMintBlocking,loading:e.swapBlocking,label:e.knowThisMint?e.addMintBlocking?e.$t("ReceiveTokenDialog.actions.receive.label_adding_mint"):e.$t("ReceiveTokenDialog.actions.receive.label_known_mint"):e.$t("ReceiveTokenDialog.actions.receive.label")},{loading:u(()=>[r(Pt)]),_:1},8,["onClick","disabled","loading","label"]),e.enableReceiveSwaps&&e.activeMintUrl&&e.mints.length?(_(),B(R,{key:0,onClick:t[3]||(t[3]=w=>e.swapSelected=!0),color:"primary",rounded:"",flat:"",class:"q-mr-none"},{default:u(()=>[r(J,{name:"swap_horiz",class:"q-pr-sm"}),I(" "+M(e.$t("ReceiveTokenDialog.actions.swap.label"))+" ",1),r(be,null,{default:u(()=>[I(M(e.$t("ReceiveTokenDialog.actions.swap.tooltip_text")),1)]),_:1})]),_:1})):x("",!0),r(R,{onClick:t[4]||(t[4]=w=>e.addPendingTokenToHistory(e.receiveData.tokensBase64)),color:"primary",rounded:"",flat:"",class:"q-mr-none"},{default:u(()=>[I(M(e.$t("ReceiveTokenDialog.actions.later.label"))+" ",1),r(be,null,{default:u(()=>[I(M(e.$t("ReceiveTokenDialog.actions.later.tooltip_text")),1)]),_:1})]),_:1})])),e.swapSelected?(_(),F("div",Sg,[g("div",null,[r(J,{name:"arrow_downward",class:"q-mr-xs",color:"positive"}),r(m,{keypath:"ReceiveTokenDialog.actions.swap.caption",tag:"span"},{value:u(()=>[g("strong",null,M(e.formatCurrency(e.swapToMintAmount,e.tokenUnit)),1)]),_:1})])])):x("",!0),e.swapSelected?(_(),F("div",Ig,[r(h,{rounded:!0,title:"",style:"font-family: monospace; font-size: 12px;"})])):x("",!0),e.swapSelected?(_(),F("div",Ag,[r(R,{onClick:e.handleSwapToTrustedMint,color:"primary",rounded:"",class:"q-pr-md",loading:e.swapBlocking,disabled:e.activeMintUrl==e.tokenMint},{loading:u(()=>[r(Pt,{size:"xs"}),I(" "+M(e.$t("ReceiveTokenDialog.actions.confirm_swap.in_progress")),1)]),default:u(()=>[r(J,{name:"swap_horiz",class:"q-pr-sm"}),I(" "+M(e.$t("ReceiveTokenDialog.actions.confirm_swap.label"))+" ",1),r(be,null,{default:u(()=>[I(M(e.$t("ReceiveTokenDialog.actions.confirm_swap.tooltip_text")),1)]),_:1})]),_:1},8,["onClick","loading","disabled"]),e.swapBlocking?x("",!0):(_(),B(R,{key:0,onClick:t[5]||(t[5]=w=>e.swapSelected=!1),color:"grey",rounded:"",flat:"",class:"q-mr-none q-pr-sm"},{default:u(()=>[r(J,{name:"close",class:"q-pr-sm"}),I(" "+M(e.$t("ReceiveTokenDialog.actions.cancel_swap.label"))+" ",1),r(be,null,{default:u(()=>[I(M(e.$t("ReceiveTokenDialog.actions.cancel_swap.tooltip_text")),1)]),_:1})]),_:1}))])):x("",!0)])):x("",!0)])]),_:1},8,["modelValue"])]),_:1},8,["modelValue","maximized"])}var Rg=xe(yg,[["render",Eg],["__scopeId","data-v-889c80fc"]]);const Ug=_o("migrations",{state:()=>({currentVersion:qo("cashu.migrations.version",0),migrations:[]}),actions:{registerMigration(e){this.migrations.some(t=>t.version===e.version)||(this.migrations.push(e),this.migrations.sort((t,n)=>t.version-n.version))},async runMigrations(){const e=this.migrations.filter(n=>n.version>this.currentVersion);if(e.length===0){console.log("No migrations to run");return}console.log(`Running ${e.length} migrations...`);const t=Ae();await t.lockMutex();try{for(const n of e){console.log(`Running migration ${n.version}: ${n.name}`);try{await n.execute(),this.currentVersion=n.version,console.log(`Migration ${n.version} completed successfully`)}catch(i){console.error(`Migration ${n.version} failed:`,i);break}}}finally{await t.unlockMutex()}},async migrateStablenutsToCash(){const e=ye();let t=!1;for(let n=0;n<e.mints.length;n++)e.mints[n].url==="https://stablenut.umint.cash"&&(console.log("Updating mint URL from stablenuts.cash to umint.cash"),e.mints[n].url="https://stablenut.cashu.network",e.activeMintUrl==="https://stablenut.umint.cash"&&(e.activeMintUrl="https://stablenut.cashu.network"),t=!0);console.log(t?"Successfully updated mint URL":"No stablenuts.cash mint found to update")},initMigrations(){this.registerMigration({version:1,name:"Migrate stablenuts.cash to umint.cash",description:"Updates mint URL from https://stablenut.umint.cash to https://stablenut.cashu.network",execute:async()=>await this.migrateStablenutsToCash()})}}});const Ng={mixins:[windowMixin],components:{BalanceView:Ta,MintSettings:kr,HistoryTable:el,NoMintWarnBanner:ul,SendTokenDialog:nd,ReceiveTokenDialog:Rg,PayInvoiceDialog:Ef,InvoiceDetailDialog:Jf,QrcodeReader:os,SendDialog:hh,ReceiveDialog:hm,iOSPWAPrompt:xs,AndroidPWAPrompt:Bs,ScanIcon:Yt,XIcon:Zn,ZapIcon:Pn,ActivityOrb:vg,EcashClaimNotification:Tm,ContactsDialog:hg,FavoriteRequestsDialog:ks},data:function(){return{name:"",mintId:"",mintName:"",deferredPWAInstallPrompt:null,showContactsDialog:!1,showRequestsDialog:!1,action:"main",parse:{show:!1,invoice:null,lnurlpay:null,lnurlauth:null,data:{request:"",amount:0,comment:""},camera:{show:!1,camera:"auto"}},payments:[],paymentsChart:{show:!1},baseHost:location.protocol+"//"+location.host,baseURL:location.protocol+"//"+location.host+location.pathname,credit:0,newName:""}},computed:{...te(Ae,["tickerShort"]),favoritesStore(){return $o()},isNativeApp:function(){if(window?.Capacitor&&typeof window.Capacitor.getPlatform=="function"){const e=window.Capacitor.getPlatform();return e==="android"||e==="ios"}return!1},webBluetoothSupported:function(){try{return typeof navigator<"u"&&!!navigator.bluetooth&&window.isSecureContext===!0}catch{return!1}},isContextSecure:function(){try{return window.isSecureContext===!0}catch{return!1}},...se(Ae,["showInvoiceDetails","tab","showSendDialog","showReceiveDialog"]),...se(Ae,["expandHistory"]),...se(pt,["showReceiveTokens","receiveData"]),...se(fn,["showSendTokens","sendData"]),...te(ye,["activeMintUrl","activeProofs","keys","mints","activeMint"]),...se(Ne,["invoiceHistory","invoiceData","payInvoiceData"]),...se(ye,["addMintData","showAddMintDialog"]),...se(un,["invoiceCheckListener","tokensCheckSpendableListener"]),...te(lt,["historyTokens"]),...te($t,["enablePaymentRequest"]),...se(et,["camera","hasCamera"]),...se(Ct,["showP2PKDialog"]),...se(ji,["showNWCDialog","nwcEnabled"]),pendingPaymentsExist:function(){return this.payments.findIndex(e=>e.pending)!==-1},balance:function(){return this.activeProofs.map(e=>e).flat().reduce((e,t)=>e+=t.amount,0)}},filters:{},methods:{...oe(Di,["serializeProofs","getProofsMint","serializeProofsV2","sumProofs","deleteProofs"]),...oe(ye,["activateMintUrl","addMint","assertMintError","getBalance","setActiveProofs","setProofs","getKeysForKeyset"]),...oe(un,["clearAllWorkers","invoiceCheckWorker","lightningAddressCheckWorker"]),...oe(lt,["setTokenPaid"]),...oe(Ne,["setInvoicePaid","mint","checkPendingTokens","decodeRequest","initializeMnemonic"]),...oe(et,["closeCamera","showCamera"]),...oe(ji,["listenToNWCCommands"]),...oe(Ks,["generateNPCConnection","claimAllTokens"]),...oe(bs,["generateNPCV2Connection","getLatestQuotes"]),...oe(Vn,["sendNip04DirectMessage","sendNip17DirectMessage","subscribeToNip04DirectMessages","subscribeToNip17DirectMessages","sendNip17DirectMessageToNprofile","initSigner"]),...oe(Hs,["migrateToDexie"]),...oe(Gs,["checkLocalStorage"]),...oe($t,["createPaymentRequest"]),...oe(Xs,["startInvoiceCheckerWorker","checkPendingInvoices"]),decodeToken:function(e){try{return De.decode(e)}catch{return null}},getProofs:function(e){return De.getProofs(e)},getMint:function(e){return De.getMint(e)},autoClaimPendingNostrTokens:async function(){const e=lt(),t=pt();if(!e.history||!Array.isArray(e.history))return;const n=e.history.filter(i=>i.amount>0&&i.token&&i.token.length>0);for(const i of n)try{t.receiveData.tokensBase64=i.token,await t.receiveIfDecodes()&&notifySuccess(`\u{1F4B0} Auto-claimed ${i.amount} ${i.unit} from Nostr!`)}catch(o){console.warn("\u26A0\uFE0F Failed to auto-claim token:",o)}},shortenString:function(e){return To(e,20,10)},getTokenList:function(){const e=this.activeProofs.map(n=>n.amount),t={};for(const n of e)t[n]=t[n]?t[n]+1:1;return Object.keys(t).map(n=>({value:parseInt(n),count:parseInt(t[n]),sum:n*t[n]}))},paymentTableRowKey:function(e){return e.payment_hash+e.amount},showChart:function(){this.paymentsChart.show=!0,this.$nextTick(()=>{generateChart(this.$refs.canvas,this.payments)})},focusInput(e){},showParseDialog:function(){this.payInvoiceData.show=!0,this.payInvoiceData.invoice=null,this.payInvoiceData.lnurlpay=null,this.payInvoiceData.domain="",this.payInvoiceData.lnurlauth=null,this.payInvoiceData.input.request="",this.payInvoiceData.input.comment="",this.camera.show=!1,this.focusInput("parseDialogInput")},showWelcomePage:function(){const e=Os();if(!e.termsAccepted||e.showWelcome){const t=window.location.search,n=window.location.hash;this.$router.push("/welcome"+t+n)}},setTab:function(e){this.tab=e},decodeQR:function(e){this.camera.data=e,this.camera.show=!1,this.decodeRequest(e)},showInvoiceCreateDialog:async function(){this.invoiceData.amount="",this.invoiceData.bolt11="",this.invoiceData.hash="",this.invoiceData.memo="",this.showInvoiceDetails=!0,this.camera.show=!1},showSendTokensDialog:function(){this.sendData.tokens="",this.sendData.tokensBase64="",this.sendData.amount=null,this.sendData.memo="",this.showSendTokens=!0},hideSendTokensDialog:function(){this.showSendTokens=!1},showReceiveTokensDialog:function(){this.receiveData.tokensBase64="",this.showReceiveTokens=!0},registerPWAEventHook:function(){window.addEventListener("beforeinstallprompt",e=>{this.deferredPWAInstallPrompt=e,console.log("'beforeinstallprompt' event was fired.",this.getPwaDisplayMode())})},getPwaDisplayMode:function(){const e=window.matchMedia("(display-mode: standalone)").matches;return document.referrer.startsWith("android-app://")?"twa":navigator.standalone||e?"standalone":"browser"},triggerPwaInstall:function(){this.deferredPWAInstallPrompt.prompt(),this.deferredPWAInstallPrompt.userChoice.then(e=>{e.outcome})},registerBroadcastChannel:async function(){sessionStorage.getItem("tabId")||sessionStorage.setItem("tabId",Math.random().toString(36).substring(2)+new Date().getTime().toString(36));const e=sessionStorage.getItem("tabId"),t=new BroadcastChannel("app_channel");t.postMessage({type:"new_tab_opened",senderId:e}),t.onmessage=async n=>{n.data.senderId!==e&&(n.data.type=="new_tab_opened"?t.postMessage({type:"already_running",senderId:e}):n.data.type=="already_running"&&this.$router.push("/already-running"))}},initializeBluetooth:async function(){try{const e=wi();await e.initialize(),this.isNativeApp&&await e.startService()}catch(e){console.error("Failed to initialize Bluetooth:",e)}},equalizeButtonWidths:function(){this.$nextTick(()=>{const e=document.querySelectorAll(".wallet-action-btn");if(e.length>=2){e.forEach(n=>{n.style.width="auto"});let t=0;e.forEach(n=>{t=Math.max(t,n.offsetWidth)}),e.forEach(n=>{n.style.width=`${t}px`})}})}},watch:{},mounted:function(){this.generateNPCConnection(),this.claimAllTokens(),this.generateNPCV2Connection(),this.getLatestQuotes(),this.lightningAddressCheckWorker(),this.initializeBluetooth(),this.$nextTick(this.equalizeButtonWidths),window.addEventListener("resize",this.equalizeButtonWidths)},beforeUnmount:function(){window.removeEventListener("resize",this.equalizeButtonWidths)},created:async function(){const e=Ug();e.initMigrations(),await e.runMigrations(),this.registerBroadcastChannel();let t=new URL(document.location).searchParams,n=new URL(document.location).hash;if(t.get("mint")){let s=t.get("mint");await this.setTab("mints"),this.showAddMintDialog=!0,this.addMintData={url:s}}try{if(!localStorage.getItem("cashu.activeMintUrl")||localStorage.getItem("cashu.activeMintUrl")==="")await this.activateMintUrl("https://mint.minibits.cash/Bitcoin",!1,!0);else{const s=ye(),a=s.mints.find(c=>c.url==="https://mint.minibits.cash/Bitcoin");if(a)!a.keys||a.keys.length===0||!a.keysets||a.keysets.length===0?await this.activateMintUrl("https://mint.minibits.cash/Bitcoin",!1,!0):s.activeMintUrl!=="https://mint.minibits.cash/Bitcoin"&&await this.activateMintUrl("https://mint.minibits.cash/Bitcoin",!1,!0);else{const c=await s.addMint({url:"https://mint.minibits.cash/Bitcoin",nickname:"MiniBits"},!1);s.activeMintUrl!=="https://mint.minibits.cash/Bitcoin"&&await this.activateMintUrl("https://mint.minibits.cash/Bitcoin",!1,!0)}}}catch(s){console.error("Error initializing MiniBits mint:",s),console.error("Error details:",s.message),console.error("Error stack:",s.stack)}if(t.get("token")||n.includes("token")){let s=t.get("token")||n.split("token=")[1],a=!1;for(var i=0;i<this.historyTokens.length;i++){var o=this.historyTokens[i].token;o==s&&this.historyTokens[i].amount>0&&(a=!0)}a||(this.receiveData.tokensBase64=s,this.showReceiveTokens=!0)}t.get("lightning")&&(this.showParseDialog(),this.payInvoiceData.input.request=t.get("lightning")),Ae().enableDebugConsole(),await this.migrateToDexie(),this.checkLocalStorage(),this.registerPWAEventHook(),this.initializeMnemonic(),this.initSigner(),this.showWelcomePage(),this.nwcEnabled&&this.listenToNWCCommands(),this.enablePaymentRequest&&this.subscribeToNip17DirectMessages(),this.subscribeToNip04DirectMessages(),this.autoClaimPendingNostrTokens(),this.startInvoiceCheckerWorker(),this.checkPendingInvoices()}},xg={class:"wallet-container"},Bg={class:"row q-col-gutter-y-sm justify-center q-pt-sm q-pb-sm"},Lg={class:"col-12 col-sm-11 col-md-8 text-center q-gutter-y-sm"},Fg={class:"row items-center justify-center no-wrap q-mb-sm q-mx-none q-px-none q-pt-sm q-pb-sm position-relative"},Og={class:"col-6 q-mb-sm flex justify-center items-center"},Vg={class:"button-content"},zg={class:"scan-button-container"},Wg={class:"col-6 q-mb-sm flex justify-center items-center"},jg={class:"button-content"},Qg={class:"row justify-center q-gutter-sm q-mt-sm q-mb-md"},Kg=g("span",null,"Contacts",-1),Hg=g("span",null,"Requests",-1),Gg={style:{"margin-bottom":"0rem","margin-top":"0rem"}},Xg={class:"row q-pt-none"},Zg={class:"col-12 q-pt-xs"},Yg={class:"footer-section"},Jg={class:"row justify-center"},ep={class:"col-12 col-sm-11 col-md-8 text-center"},tp={class:"credits-footer"},np={class:"q-mb-xs text-caption text-grey-5"},ip=g("a",{href:"https://github.com/cashubtc/cashu.me",target:"_blank",class:"text-primary"}," cashu.me ",-1),op=g("p",{class:"q-mb-none text-caption text-grey-6"},[I(" Support digital cash development: "),g("a",{href:"https://cashu.space",target:"_blank",class:"text-primary"},"cashu.space"),I(" \u2022 "),g("a",{href:"https://opencash.dev/",target:"_blank",class:"text-primary"},"OpenCash.dev")],-1),sp={class:"col text-center"},ap={class:"text-h6"},rp=g("div",{class:"q-mr-sm"},null,-1),lp={class:"q-pt-md text-center"};function cp(e,t,n,i,o,s){const a=G("ActivityOrb"),c=G("NoMintWarnBanner"),l=G("EcashClaimNotification"),m=G("BalanceView"),h=G("ScanIcon"),w=G("ReceiveDialog"),y=G("SendDialog"),P=G("ContactsDialog"),A=G("FavoriteRequestsDialog"),U=G("HistoryTable"),j=G("MintSettings"),K=G("iOSPWAPrompt"),E=G("AndroidPWAPrompt"),O=G("PayInvoiceDialog"),X=G("XIcon"),ae=G("QrcodeReader"),ce=G("ZapIcon"),he=G("InvoiceDetailDialog"),d=G("SendTokenDialog"),p=G("ReceiveTokenDialog");return _(),F(Ze,null,[g("div",xg,[g("div",Bg,[g("div",Lg,[r(a),e.mints.length==0?(_(),B(c,{key:0})):x("",!0),s.isNativeApp?(_(),B(l,{key:1})):x("",!0),e.mints.length>0?(_(),B(m,{key:2,"set-tab":s.setTab},null,8,["set-tab"])):x("",!0),g("div",Fg,[g("div",Og,[r(R,{rounded:"",dense:"",class:"q-px-md q-mr-md wallet-action-btn",color:"primary",onClick:e.showCamera},{default:u(()=>[g("div",Vg,[r(J,{name:"south_west",size:"1.2rem",class:"q-mr-xs"}),g("span",null,M(e.$t("WalletPage.actions.receive.label")),1)])]),_:1},8,["onClick"])]),r(at,{appear:"","enter-active-class":"animated pulse"},{default:u(()=>[g("div",zg,[r(R,{size:"lg",outline:"",color:"primary",flat:"",onClick:e.showCamera},{default:u(()=>[r(h,{size:"2em"})]),_:1},8,["onClick"])])]),_:1}),g("div",Wg,[r(R,{rounded:"",dense:"",class:"q-px-md q-ml-md wallet-action-btn",color:"primary",onClick:s.showSendTokensDialog},{default:u(()=>[g("div",jg,[r(J,{name:"north_east",size:"1.2rem",class:"q-mr-xs"}),g("span",null,M(e.$t("WalletPage.actions.send.label")),1)])]),_:1},8,["onClick"])]),r(w,{modelValue:e.showReceiveDialog,"onUpdate:modelValue":t[0]||(t[0]=v=>e.showReceiveDialog=v)},null,8,["modelValue"]),r(y,{modelValue:e.showSendDialog,"onUpdate:modelValue":t[1]||(t[1]=v=>e.showSendDialog=v)},null,8,["modelValue"])]),g("div",Qg,[r(R,{rounded:"",outline:"",color:"primary",class:"q-px-lg",onClick:t[2]||(t[2]=v=>e.showContactsDialog=!0)},{default:u(()=>[r(J,{name:"contacts",size:"1.2rem",class:"q-mr-sm"}),Kg,s.favoritesStore.pendingCount>0?(_(),B(Wt,{key:0,color:"red",floating:""},{default:u(()=>[I(M(s.favoritesStore.pendingCount),1)]),_:1})):x("",!0)]),_:1}),s.favoritesStore.pendingCount>0?(_(),B(R,{key:0,rounded:"",outline:"",color:"orange",class:"q-px-lg",onClick:t[3]||(t[3]=v=>e.showRequestsDialog=!0)},{default:u(()=>[r(J,{name:"inbox",size:"1.2rem",class:"q-mr-sm"}),Hg,r(Wt,{color:"red",floating:""},{default:u(()=>[I(M(s.favoritesStore.pendingCount),1)]),_:1})]),_:1})):x("",!0)]),r(P,{modelValue:e.showContactsDialog,"onUpdate:modelValue":t[4]||(t[4]=v=>e.showContactsDialog=v)},null,8,["modelValue"]),r(Ye,{modelValue:e.showRequestsDialog,"onUpdate:modelValue":t[5]||(t[5]=v=>e.showRequestsDialog=v),position:"bottom"},{default:u(()=>[r(Qe,{style:{width:"100%","max-width":"600px"}},{default:u(()=>[r(A),r(an,{align:"right"},{default:u(()=>[Ie((_(),B(R,{flat:"",round:"",icon:"close",color:"grey"},{default:u(()=>[r(be,null,{default:u(()=>[I("Close")]),_:1})]),_:1})),[[Ke]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),r(Po,{"expand-icon-class":"hidden",modelValue:e.expandHistory,"onUpdate:modelValue":t[8]||(t[8]=v=>e.expandHistory=v)},{header:u(({expanded:v})=>[r(Ue,{class:"item-center text-center"},{default:u(()=>[g("span",null,[r(J,{color:"primary",name:v?"keyboard_arrow_up":"keyboard_arrow_down"},null,8,["name"])])]),_:2},1024)]),default:u(()=>[r(ra,{modelValue:e.tab,"onUpdate:modelValue":t[6]||(t[6]=v=>e.tab=v),"no-caps":"",class:Vt(e.$q.dark.isActive?"bg-dark":"bg-white")},{default:u(()=>[r(Xi,{name:"history",class:"text-secondary",label:e.$t("WalletPage.tabs.history.label")},null,8,["label"]),r(Xi,{name:"mints",class:"text-secondary",label:e.$t("WalletPage.tabs.mints.label")},null,8,["label"])]),_:1},8,["modelValue","class"]),r(la,{class:Vt(e.$q.dark.isActive?"bg-dark":"bg-white"),modelValue:e.tab,"onUpdate:modelValue":t[7]||(t[7]=v=>e.tab=v),animated:""},{default:u(()=>[r(Zi,{name:"history"},{default:u(()=>[r(U)]),_:1}),r(Zi,{name:"mints",class:"q-px-sm"},{default:u(()=>[r(j)]),_:1})]),_:1},8,["class","modelValue"])]),_:1},8,["modelValue"]),g("div",Gg,[g("div",Xg,[g("div",Zg,[!s.isNativeApp&&s.getPwaDisplayMode()=="browser"&&e.deferredPWAInstallPrompt!=null?(_(),B(R,{key:0,class:"q-mx-xs q-px-sm q-my-sm",outline:"",size:"0.6rem",color:"primary",onClick:t[9]||(t[9]=v=>s.triggerPwaInstall())},{default:u(()=>[g("b",null,M(e.$t("WalletPage.install.text")),1),r(be,null,{default:u(()=>[I(M(e.$t("WalletPage.install.tooltip")),1)]),_:1})]),_:1})):x("",!0)])])]),s.isNativeApp?x("",!0):(_(),B(K,{key:3})),s.isNativeApp?x("",!0):(_(),B(E,{key:4}))])]),g("div",Yg,[g("div",Jg,[g("div",ep,[g("div",tp,[g("p",np,[I(" Built with "),r(J,{name:"favorite",color:"red",size:"xs"}),I(" using the open-source "),ip,I(" wallet ")]),op])])])])]),r(O,{modelValue:e.payInvoiceData.show,"onUpdate:modelValue":t[10]||(t[10]=v=>e.payInvoiceData.show=v)},null,8,["modelValue"]),r(Ye,{modelValue:e.camera.show,"onUpdate:modelValue":t[11]||(t[11]=v=>e.camera.show=v),"backdrop-filter":"blur(2px) brightness(60%)"},{default:u(()=>[r(Qe,{class:"bg-grey-10 text-white full-width-card q-pb-lg"},{default:u(()=>[r(Se,{class:"row items-center q-pb-sm"},{default:u(()=>[Ie((_(),B(R,{flat:"",round:"",dense:"",class:"q-ml-sm",color:"primary"},{default:u(()=>[r(X)]),_:1})),[[Ke]]),g("div",sp,[g("span",ap,M(e.$t("ReceiveDialog.title")),1)]),rp]),_:1}),r(Se,{class:"q-pa-md"},{default:u(()=>[r(ae,{onDecode:s.decodeQR},null,8,["onDecode"]),g("div",lp,[r(R,{onClick:s.showInvoiceCreateDialog,flat:"",color:"primary",size:"sm"},{default:u(()=>[r(ce,{size:"1em",class:"q-mr-xs"}),I(" "+M(e.$t("ReceiveDialog.actions.lightning.label")),1)]),_:1},8,["onClick"])])]),_:1})]),_:1})]),_:1},8,["modelValue"]),r(he,{modelValue:e.showInvoiceDetails,"onUpdate:modelValue":t[12]||(t[12]=v=>e.showInvoiceDetails=v)},null,8,["modelValue"]),r(d,{modelValue:e.showSendTokens,"onUpdate:modelValue":t[13]||(t[13]=v=>e.showSendTokens=v)},null,8,["modelValue"]),r(p,{modelValue:e.showReceiveTokens,"onUpdate:modelValue":t[14]||(t[14]=v=>e.showReceiveTokens=v)},null,8,["modelValue"])],64)}var Fp=xe(Ng,[["render",cp]]);export{Fp as default};
