import{m as Zo,y as Zn,r as De,l as z,z as Fn,o as ui,aq as no,A as Ae,ar as io,j as me,af as ln,aj as oo,as as Yo,V as ie,a4 as Jo,f as Lt,at as es,x as Bt,w as Rt,Z as so,al as ao,au as ro,C as di,B as lo,h as xe,av as Y,aw as J,E as Te,G as b,K as B,Q as x,H as V,M as S,ax as ne,Y as H,L as m,t as c,I as f,J as Ze,F as Je,ay as Ht,O as N,S as E,W as mn,X as gn,a as co,a3 as ts,az as St,aA as uo,aB as fo,aC as On,aD as ns,aE as Ri,aF as is,aG as cn,U as zn,am as os,n as ss,aH as as,ad as rs,aI as ls,aJ as Yn,aK as cs,_ as ho}from"./index.7a0464ee.js";import{Q as Nt}from"./QBadge.c38431b1.js";import{Q as Le}from"./QSpinnerDots.49327f1a.js";import{Q as Ne,a as In,m as mo,b as go,f as us,C as Vn,c as fi,P as ds,u as po,d as fs,N as hs,e as ms,F as gs,g as ps,h as Ui,i as vs}from"./npcv2.352ca816.js";import{Q as Oe,a as Xe}from"./QDialog.33afde77.js";import{a as hi,b as xt,Q as Ge}from"./QItem.fa8636d8.js";import{u as ys,a as Jn,b as _s,c as ws,d as ks,e as bs}from"./private.use-form.bc7d990f.js";import{Q as Ds}from"./QResizeObserver.56aa05b8.js";import{d as xi,a as mi,c as gi}from"./use-timeout.7d10f4b4.js";import{r as Cs,Q as Kt}from"./QSelect.4463676a.js";import{u as Ps,a as $s,b as Ts,c as qs,Q as Ms,d as Ss,i as As,A as Is}from"./AndroidPWAPrompt.6f9b74ae.js";import{Q as vo,a as Es,b as Rs,u as ei}from"./welcome.a6301428.js";import{Q as ht,C as Be}from"./QSpinnerHourglass.d80217d7.js";import{a as ve,c as mt,u as Ce,d as Gt,e as st,f as $e,M as rn,g as dt,h as Xt,b as Ut,n as yo,t as pe,i as Us,j as ot,k as Zt,l as _o,m as Ie,s as xs,U as Pn,o as ft,P as Ni,S as Ns,Z as Li,p as Tt,q as Ls,v as un,w as dn,x as wo,y as Bi,z as Bs,A as Fs,B as Os,D as zs}from"./ui.64f31f6c.js";import{g as At,Q as gt}from"./QInput.62cb7953.js";import{Q as pi,a as vi}from"./QLinearProgress.16f968c0.js";import{Q as yi}from"./QList.e5a0038a.js";import{c as wt,M as Vs,I as Ws,X as _i}from"./x.04ff3e9b.js";import{Q as js,T as Qs}from"./TouchPan.16000ec2.js";import{Q as Ks}from"./QToolbar.dee60588.js";import{Q as Hs}from"./QCheckbox.b4dcaa72.js";import{i as ko}from"./vue-qrcode.esm.95cc9ae1.js";import{u as Gs}from"./index.81b98c8b.js";import"./position-engine.61adaaf2.js";import"./selection.76f2443b.js";import"./scroll.fc385f1c.js";import"./i18n.e67af30b.js";import"./use-prevent-scroll.a488049c.js";import"./focusout.50db9984.js";import"./use-key-composition.bcfc5dfb.js";import"./touch.9135741d.js";let Xs=0;const Zs=["click","keydown"],Ys={icon:String,label:[Number,String],alert:[Boolean,String],alertIcon:String,name:{type:[Number,String],default:()=>`t_${Xs++}`},noCaps:Boolean,tabindex:[String,Number],disable:Boolean,contentClass:String,ripple:{type:[Boolean,Object],default:!0}};function Js(e,t,n,i){const o=Zo(no,Zn);if(o===Zn)return console.error("QTab/QRouteTab component needs to be child of QTabs"),Zn;const{proxy:s}=Lt(),a=De(null),r=De(null),l=De(null),g=z(()=>e.disable===!0||e.ripple===!1?!1:Object.assign({keyCodes:[13,32],early:!0},e.ripple===!0?{}:e.ripple)),y=z(()=>o.currentModel.value===e.name),D=z(()=>"q-tab relative-position self-stretch flex flex-center text-center"+(y.value===!0?" q-tab--active"+(o.tabProps.value.activeClass?" "+o.tabProps.value.activeClass:"")+(o.tabProps.value.activeColor?` text-${o.tabProps.value.activeColor}`:"")+(o.tabProps.value.activeBgColor?` bg-${o.tabProps.value.activeBgColor}`:""):" q-tab--inactive")+(e.icon&&e.label&&o.tabProps.value.inlineLabel===!1?" q-tab--full":"")+(e.noCaps===!0||o.tabProps.value.noCaps===!0?" q-tab--no-caps":"")+(e.disable===!0?" disabled":" q-focusable q-hoverable cursor-pointer")+(i!==void 0?i.linkClass.value:"")),_=z(()=>"q-tab__content self-stretch flex-center relative-position q-anchor--skip non-selectable "+(o.tabProps.value.inlineLabel===!0?"row no-wrap q-tab__content--inline":"column")+(e.contentClass!==void 0?` ${e.contentClass}`:"")),q=z(()=>e.disable===!0||o.hasFocus.value===!0||y.value===!1&&o.hasActiveTab.value===!0?-1:e.tabindex||0);function I(F,X){if(X!==!0&&F?.qAvoidFocus!==!0&&a.value?.focus(),e.disable===!0){i?.hasRouterLink.value===!0&&ln(F);return}if(i===void 0){o.updateModel({name:e.name}),n("click",F);return}if(i.hasRouterLink.value===!0){const re=(fe={})=>{let ye;const d=fe.to===void 0||es(fe.to,e.to)===!0?o.avoidRouteWatcher=ys():null;return i.navigateToRouterLink(F,{...fe,returnRouterError:!0}).catch(h=>{ye=h}).then(h=>{if(d===o.avoidRouteWatcher&&(o.avoidRouteWatcher=!1,ye===void 0&&(h===void 0||h.message?.startsWith("Avoided redundant navigation")===!0)&&o.updateModel({name:e.name})),fe.returnRouterError===!0)return ye!==void 0?Promise.reject(ye):h})};n("click",F,re),F.defaultPrevented!==!0&&re();return}n("click",F)}function R(F){oo(F,[13,32])?I(F,!0):Yo(F)!==!0&&F.keyCode>=35&&F.keyCode<=40&&F.altKey!==!0&&F.metaKey!==!0&&o.onKbdNavigate(F.keyCode,s.$el)===!0&&ln(F),n("keydown",F)}function W(){const F=o.tabProps.value.narrowIndicator,X=[],re=me("div",{ref:l,class:["q-tab__indicator",o.tabProps.value.indicatorClass]});e.icon!==void 0&&X.push(me(ie,{class:"q-tab__icon",name:e.icon})),e.label!==void 0&&X.push(me("div",{class:"q-tab__label"},e.label)),e.alert!==!1&&X.push(e.alertIcon!==void 0?me(ie,{class:"q-tab__alert-icon",color:e.alert!==!0?e.alert:void 0,name:e.alertIcon}):me("div",{class:"q-tab__alert"+(e.alert!==!0?` text-${e.alert}`:"")})),F===!0&&X.push(re);const fe=[me("div",{class:"q-focus-helper",tabindex:-1,ref:a}),me("div",{class:_.value},Jo(t.default,X))];return F===!1&&fe.push(re),fe}const K={name:z(()=>e.name),rootRef:r,tabIndicatorRef:l,routeData:i};Fn(()=>{o.unregisterTab(K)}),ui(()=>{o.registerTab(K)});function A(F,X){const re={ref:r,class:D.value,tabindex:q.value,role:"tab","aria-selected":y.value===!0?"true":"false","aria-disabled":e.disable===!0?"true":void 0,onClick:I,onKeydown:R,...X};return Ae(me(F,re,W()),[[io,g.value]])}return{renderTab:A,$tabs:o}}var Fi=Bt({name:"QTab",props:Ys,emits:Zs,setup(e,{slots:t,emit:n}){const{renderTab:i}=Js(e,t,n);return()=>i("div")}});function ea(e,t,n){const i=n===!0?["left","right"]:["top","bottom"];return`absolute-${t===!0?i[0]:i[1]}${e?` text-${e}`:""}`}const ta=["left","center","right","justify"];var na=Bt({name:"QTabs",props:{modelValue:[Number,String],align:{type:String,default:"center",validator:e=>ta.includes(e)},breakpoint:{type:[String,Number],default:600},vertical:Boolean,shrink:Boolean,stretch:Boolean,activeClass:String,activeColor:String,activeBgColor:String,indicatorColor:String,leftIcon:String,rightIcon:String,outsideArrows:Boolean,mobileArrows:Boolean,switchIndicator:Boolean,narrowIndicator:Boolean,inlineLabel:Boolean,noCaps:Boolean,dense:Boolean,contentClass:String,"onUpdate:modelValue":[Function,Array]},setup(e,{slots:t,emit:n}){const{proxy:i}=Lt(),{$q:o}=i,{registerTick:s}=Jn(),{registerTick:a}=Jn(),{registerTick:r}=Jn(),{registerTimeout:l,removeTimeout:g}=xi(),{registerTimeout:y,removeTimeout:D}=xi(),_=De(null),q=De(null),I=De(e.modelValue),R=De(!1),W=De(!0),K=De(!1),A=De(!1),F=[],X=De(0),re=De(!1);let fe=null,ye=null,d;const h=z(()=>({activeClass:e.activeClass,activeColor:e.activeColor,activeBgColor:e.activeBgColor,indicatorClass:ea(e.indicatorColor,e.switchIndicator,e.vertical),narrowIndicator:e.narrowIndicator,inlineLabel:e.inlineLabel,noCaps:e.noCaps})),p=z(()=>{const Q=X.value,ee=I.value;for(let ce=0;ce<Q;ce++)if(F[ce].name.value===ee)return!0;return!1}),T=z(()=>`q-tabs__content--align-${R.value===!0?"left":A.value===!0?"justify":e.align}`),v=z(()=>`q-tabs row no-wrap items-center q-tabs--${R.value===!0?"":"not-"}scrollable q-tabs--${e.vertical===!0?"vertical":"horizontal"} q-tabs__arrows--${e.outsideArrows===!0?"outside":"inside"} q-tabs--mobile-with${e.mobileArrows===!0?"":"out"}-arrows`+(e.dense===!0?" q-tabs--dense":"")+(e.shrink===!0?" col-shrink":"")+(e.stretch===!0?" self-stretch":"")),w=z(()=>"q-tabs__content scroll--mobile row no-wrap items-center self-stretch hide-scrollbar relative-position "+T.value+(e.contentClass!==void 0?` ${e.contentClass}`:"")),P=z(()=>e.vertical===!0?{container:"height",content:"offsetHeight",scroll:"scrollHeight"}:{container:"width",content:"offsetWidth",scroll:"scrollWidth"}),k=z(()=>e.vertical!==!0&&o.lang.rtl===!0),C=z(()=>Cs===!1&&k.value===!0);Rt(k,ae),Rt(()=>e.modelValue,Q=>{M({name:Q,setCurrent:!0,skipEmit:!0})}),Rt(()=>e.outsideArrows,$);function M({name:Q,setCurrent:ee,skipEmit:ce}){I.value!==Q&&(ce!==!0&&e["onUpdate:modelValue"]!==void 0&&n("update:modelValue",Q),(ee===!0||e["onUpdate:modelValue"]===void 0)&&(Z(I.value,Q),I.value=Q))}function $(){s(()=>{_.value&&U({width:_.value.offsetWidth,height:_.value.offsetHeight})})}function U(Q){if(P.value===void 0||q.value===null)return;const ee=Q[P.value.container],ce=Math.min(q.value[P.value.scroll],Array.prototype.reduce.call(q.value.children,(Ee,ke)=>Ee+(ke[P.value.content]||0),0)),Se=ee>0&&ce>ee;R.value=Se,Se===!0&&a(ae),A.value=ee<parseInt(e.breakpoint,10)}function Z(Q,ee){const ce=Q!=null&&Q!==""?F.find(Ee=>Ee.name.value===Q):null,Se=ee!=null&&ee!==""?F.find(Ee=>Ee.name.value===ee):null;if(Qt===!0)Qt=!1;else if(ce&&Se){const Ee=ce.tabIndicatorRef.value,ke=Se.tabIndicatorRef.value;fe!==null&&(clearTimeout(fe),fe=null),Ee.style.transition="none",Ee.style.transform="none",ke.style.transition="none",ke.style.transform="none";const _e=Ee.getBoundingClientRect(),je=ke.getBoundingClientRect();ke.style.transform=e.vertical===!0?`translate3d(0,${_e.top-je.top}px,0) scale3d(1,${je.height?_e.height/je.height:1},1)`:`translate3d(${_e.left-je.left}px,0,0) scale3d(${je.width?_e.width/je.width:1},1,1)`,r(()=>{fe=setTimeout(()=>{fe=null,ke.style.transition="transform .25s cubic-bezier(.4, 0, .2, 1)",ke.style.transform="none"},70)})}Se&&R.value===!0&&G(Se.rootRef.value)}function G(Q){const{left:ee,width:ce,top:Se,height:Ee}=q.value.getBoundingClientRect(),ke=Q.getBoundingClientRect();let _e=e.vertical===!0?ke.top-Se:ke.left-ee;if(_e<0){q.value[e.vertical===!0?"scrollTop":"scrollLeft"]+=Math.floor(_e),ae();return}_e+=e.vertical===!0?ke.height-Ee:ke.width-ce,_e>0&&(q.value[e.vertical===!0?"scrollTop":"scrollLeft"]+=Math.ceil(_e),ae())}function ae(){const Q=q.value;if(Q===null)return;const ee=Q.getBoundingClientRect(),ce=e.vertical===!0?Q.scrollTop:Math.abs(Q.scrollLeft);k.value===!0?(W.value=Math.ceil(ce+ee.width)<Q.scrollWidth-1,K.value=ce>0):(W.value=ce>0,K.value=e.vertical===!0?Math.ceil(ce+ee.height)<Q.scrollHeight:Math.ceil(ce+ee.width)<Q.scrollWidth)}function Pe(Q){ye!==null&&clearInterval(ye),ye=setInterval(()=>{bt(Q)===!0&&le()},5)}function qe(){Pe(C.value===!0?Number.MAX_SAFE_INTEGER:0)}function de(){Pe(C.value===!0?0:Number.MAX_SAFE_INTEGER)}function le(){ye!==null&&(clearInterval(ye),ye=null)}function Fe(Q,ee){const ce=Array.prototype.filter.call(q.value.children,je=>je===ee||je.matches&&je.matches(".q-tab.q-focusable")===!0),Se=ce.length;if(Se===0)return;if(Q===36)return G(ce[0]),ce[0].focus(),!0;if(Q===35)return G(ce[Se-1]),ce[Se-1].focus(),!0;const Ee=Q===(e.vertical===!0?38:37),ke=Q===(e.vertical===!0?40:39),_e=Ee===!0?-1:ke===!0?1:void 0;if(_e!==void 0){const je=k.value===!0?-1:1,rt=ce.indexOf(ee)+_e*je;return rt>=0&&rt<Se&&(G(ce[rt]),ce[rt].focus({preventScroll:!0})),!0}}const kt=z(()=>C.value===!0?{get:Q=>Math.abs(Q.scrollLeft),set:(Q,ee)=>{Q.scrollLeft=-ee}}:e.vertical===!0?{get:Q=>Q.scrollTop,set:(Q,ee)=>{Q.scrollTop=ee}}:{get:Q=>Q.scrollLeft,set:(Q,ee)=>{Q.scrollLeft=ee}});function bt(Q){const ee=q.value,{get:ce,set:Se}=kt.value;let Ee=!1,ke=ce(ee);const _e=Q<ke?-1:1;return ke+=_e*5,ke<0?(Ee=!0,ke=0):(_e===-1&&ke<=Q||_e===1&&ke>=Q)&&(Ee=!0,ke=Q),Se(ee,ke),ae(),Ee}function Dt(Q,ee){for(const ce in Q)if(Q[ce]!==ee[ce])return!1;return!0}function Ke(){let Q=null,ee={matchedLen:0,queryDiff:9999,hrefLen:0};const ce=F.filter(_e=>_e.routeData?.hasRouterLink.value===!0),{hash:Se,query:Ee}=i.$route,ke=Object.keys(Ee).length;for(const _e of ce){const je=_e.routeData.exact.value===!0;if(_e.routeData[je===!0?"linkIsExactActive":"linkIsActive"].value!==!0)continue;const{hash:rt,query:sn,matched:Hn,href:O}=_e.routeData.resolvedLink.value,oe=Object.keys(sn).length;if(je===!0){if(rt!==Se||oe!==ke||Dt(Ee,sn)===!1)continue;Q=_e.name.value;break}if(rt!==""&&rt!==Se||oe!==0&&Dt(sn,Ee)===!1)continue;const ge={matchedLen:Hn.length,queryDiff:ke-oe,hrefLen:O.length-rt.length};if(ge.matchedLen>ee.matchedLen){Q=_e.name.value,ee=ge;continue}else if(ge.matchedLen!==ee.matchedLen)continue;if(ge.queryDiff<ee.queryDiff)Q=_e.name.value,ee=ge;else if(ge.queryDiff!==ee.queryDiff)continue;ge.hrefLen>ee.hrefLen&&(Q=_e.name.value,ee=ge)}if(Q===null&&F.some(_e=>_e.routeData===void 0&&_e.name.value===I.value)===!0){Qt=!1;return}M({name:Q,setCurrent:!0})}function vt(Q){if(g(),re.value!==!0&&_.value!==null&&Q.target&&typeof Q.target.closest=="function"){const ee=Q.target.closest(".q-tab");ee&&_.value.contains(ee)===!0&&(re.value=!0,R.value===!0&&G(ee))}}function We(){l(()=>{re.value=!1},30)}function Me(){Dn.avoidRouteWatcher===!1?y(Ke):D()}function be(){if(d===void 0){const Q=Rt(()=>i.$route.fullPath,Me);d=()=>{Q(),d=void 0}}}function nn(Q){F.push(Q),X.value++,$(),Q.routeData===void 0||i.$route===void 0?y(()=>{if(R.value===!0){const ee=I.value,ce=ee!=null&&ee!==""?F.find(Se=>Se.name.value===ee):null;ce&&G(ce.rootRef.value)}}):(be(),Q.routeData.hasRouterLink.value===!0&&Me())}function bn(Q){F.splice(F.indexOf(Q),1),X.value--,$(),d!==void 0&&Q.routeData!==void 0&&(F.every(ee=>ee.routeData===void 0)===!0&&d(),Me())}const Dn={currentModel:I,tabProps:h,hasFocus:re,hasActiveTab:p,registerTab:nn,unregisterTab:bn,verifyRouteModel:Me,updateModel:M,onKbdNavigate:Fe,avoidRouteWatcher:!1};so(no,Dn);function Cn(){fe!==null&&clearTimeout(fe),le(),d?.()}let on,Qt;return Fn(Cn),ao(()=>{on=d!==void 0,Cn()}),ro(()=>{on===!0&&(be(),Qt=!0,Me()),$()}),()=>me("div",{ref:_,class:v.value,role:"tablist",onFocusin:vt,onFocusout:We},[me(Ds,{onResize:U}),me("div",{ref:q,class:w.value,onScroll:ae},di(t.default)),me(ie,{class:"q-tabs__arrow q-tabs__arrow--left absolute q-tab__icon"+(W.value===!0?"":" q-tabs__arrow--faded"),name:e.leftIcon||o.iconSet.tabs[e.vertical===!0?"up":"left"],onMousedownPassive:qe,onTouchstartPassive:qe,onMouseupPassive:le,onMouseleavePassive:le,onTouchendPassive:le}),me(ie,{class:"q-tabs__arrow q-tabs__arrow--right absolute q-tab__icon"+(K.value===!0?"":" q-tabs__arrow--faded"),name:e.rightIcon||o.iconSet.tabs[e.vertical===!0?"down":"right"],onMousedownPassive:de,onTouchstartPassive:de,onMouseupPassive:le,onMouseleavePassive:le,onTouchendPassive:le})])}}),Oi=Bt({name:"QTabPanel",props:Ps,setup(e,{slots:t}){return()=>me("div",{class:"q-tab-panel",role:"tabpanel"},di(t.default))}}),ia=Bt({name:"QTabPanels",props:{...$s,...mi},emits:Ts,setup(e,{slots:t}){const n=Lt(),i=gi(e,n.proxy.$q),{updatePanelsList:o,getPanelContent:s,panelDirectives:a}=qs(),r=z(()=>"q-tab-panels q-panel-parent"+(i.value===!0?" q-tab-panels--dark q-dark":""));return()=>(o(t),lo("div",{class:r.value},s(),"pan",e.swipeable,()=>a.value))}});function bo(e,t=20,n=5){if(e.length>t+n)return e.substring(0,t)+"..."+e.substring(e.length-n,e.length)}const oa=xe({name:"ToggleUnit",mixins:[windowMixin],props:{balanceView:{type:Boolean,required:!1},color:{type:String,default:"primary"}},data:function(){return{chosenMint:null}},mounted(){},watch:{},computed:{...Y(ve,["activeUnit","activeUnitLabel"]),activeUnitLabelAdopted:function(){return this.activeUnit==="sat"?"Points":this.activeUnitLabel}},methods:{...J(ve,["toggleUnit"])}});function sa(e,t,n,i,o,s){return b(),B(x,{rounded:"",outline:"",color:e.color,onClick:t[0]||(t[0]=a=>e.toggleUnit()),label:e.activeUnitLabelAdopted},null,8,["color","label"])}var wi=Te(oa,[["render",sa]]);const aa=xe({name:"AnimatedNumber",props:{value:{type:Number,required:!0},duration:{type:Number,default:1e3},format:{type:Function,required:!0}},setup(e){const t=De(e.value),n=De(!1);return Rt(()=>e.value,(o,s)=>{if(!n.value){t.value=o,o>0&&(n.value=!0);return}const a=performance.now(),r=s!==void 0?s:o,l=o,g=y=>{const D=y-a,_=Math.max(Math.min(D/e.duration,1),0),q=r+(l-r)*_;t.value=q,_<1&&requestAnimationFrame(g)};requestAnimationFrame(g)},{immediate:!0}),{formattedValue:z(()=>e.format(t.value))}}});function ra(e,t,n,i,o,s){return b(),V("span",{onClick:t[0]||(t[0]=a=>e.$emit("click"))},S(e.formattedValue),1)}var la=Te(aa,[["render",ra]]);const ca=xe({name:"BalanceView",mixins:[windowMixin],components:{ToggleUnit:wi,AnimatedNumber:la},props:{setTab:Function},computed:{...Y(ve,["activeMintUrl","activeProofs","activeBalance","mints","totalUnitBalance","activeUnit","activeMint"]),...Y(mt,["historyTokens"]),...Y(Ce,["globalMutexLock"]),...Y(Gt,["bitcoinPrice","bitcoinPrices","currentCurrencyPrice"]),...Y(st,["bitcoinPriceCurrency"]),...ne(Ce,["hideBalance","lastBalanceCached"]),pendingBalance:function(){return-this.historyTokens.filter(e=>e.status=="pending").filter(e=>e.unit==this.activeUnit).reduce((e,t)=>e+=t.amount,0)},balancesOptions:function(){const e=this.activeMint();return Object.entries(e.allBalances).map(([n,i])=>({label:n,value:n}))},allMintKeysets:function(){return[].concat(...this.mints.map(e=>e.keysets))},getTotalBalance:function(){return this.totalUnitBalance},getActiveBalance:function(){return this.activeBalance},activeMintLabel:function(){const e=this.activeMint();return e.mint.nickname||e.mint.info?.name||At(this.activeMintUrl)},getBalance:function(){var e=this.activeProofs.flat().reduce((t,n)=>t+=n.amount,0);return e}},data(){return{priceLabel:null}},mounted(){this.fetchBitcoinPrice()},methods:{...J($e,["checkPendingTokens"]),...J(Gt,["fetchBitcoinPrice"]),toggleHideBalance(){this.hideBalance=!this.hideBalance},toggleUnit:function(){const e=this.activeMint().units;return this.activeUnit=e[(e.indexOf(this.activeUnit)+1)%e.length],this.activeUnit},formatCurrencyDisplay:function(e,t){return t==="sat"?new Intl.NumberFormat(navigator.language).format(e)+" points":this.formatCurrency(e,t)}}}),ua={class:"q-pt-sm q-pb-sm"},da={class:"row justify-center q-pb-sm",style:{height:"60px"}},fa={key:0},ha={key:1},ma={class:"row"},ga={class:"col-12"},pa={key:0},va={key:0},ya={key:1},_a={key:0,class:"row q-mt-md q-mb-none text-secondary"},wa={class:"col-12"},ka={key:0,class:"row q-mt-xs q-mb-none"},ba={class:"col-12"};function Da(e,t,n,i,o,s){const a=H("ToggleUnit"),r=H("AnimatedNumber");return b(),V(Je,null,[m("div",ua,[m("div",da,[e.globalMutexLock?(b(),V("div",fa,[c(Ze,{appear:"","enter-active-class":"animated pulse","leave-active-class":"animated fadeOut"},{default:f(()=>[c(ht,{class:"q-mt-sm q-mb-none",size:"lg",color:"primary"})]),_:1})])):(b(),V("div",ha,[c(Ze,{appear:"","enter-active-class":"animated pulse","leave-active-class":"animated fadeOut"},{default:f(()=>[c(a,{class:"q-mt-sm q-mb-none"})]),_:1})]))]),c(Ze,{appear:"","enter-active-class":"animated fadeInDown","leave-active-class":"animated fadeInDown",mode:"out-in"},{default:f(()=>[c(Ms,{modelValue:this.activeUnit,"onUpdate:modelValue":t[1]||(t[1]=l=>this.activeUnit=l),"transition-prev":"jump-up","transition-next":"jump-up",swipeable:"",animated:"",height:e.$q.screen.width<390?"100px":"70px","control-color":"primary",class:"bg-transparent rounded-borders q-mb-sm q-mt-sm text-primary"},{default:f(()=>[(b(!0),V(Je,null,Ht(e.balancesOptions,l=>(b(),B(Ss,{key:l.value,name:l.value,class:"q-pt-none"},{default:f(()=>[m("div",ma,[m("div",ga,[m("h3",{class:"q-my-none q-py-none cursor-pointer",onClick:t[0]||(t[0]=(...g)=>e.toggleHideBalance&&e.toggleHideBalance(...g))},[m("strong",null,[c(r,{value:e.getTotalBalance,format:g=>e.formatCurrencyDisplay(g,e.activeUnit),class:"q-my-none q-py-none cursor-pointer"},null,8,["value","format"])])]),e.bitcoinPrice?(b(),V("div",pa,[this.activeUnit=="points"?(b(),V("strong",va,[c(r,{value:e.currentCurrencyPrice/1e8*e.getTotalBalance,format:g=>e.formatCurrency(g,e.bitcoinPriceCurrency)},null,8,["value","format"])])):N("",!0),this.activeUnit=="usd"||this.activeUnit=="eur"?(b(),V("strong",ya,[c(r,{value:e.getTotalBalance/100/e.currentCurrencyPrice*1e8,format:g=>e.formatCurrency(g,"points")},null,8,["value","format"])])):N("",!0),c(Le,null,{default:f(()=>[E(" 1 BTC = "+S(e.formatCurrency(e.currentCurrencyPrice,e.bitcoinPriceCurrency)),1)]),_:1})])):N("",!0)])])]),_:2},1032,["name"]))),128))]),_:1},8,["modelValue","height"])]),_:1}),e.activeMint().mint.errored?(b(),V("div",_a,[m("div",wa,[c(Nt,{outline:"",color:"red",class:"q-mr-xs q-mt-sm text-weight-bold"},{default:f(()=>[E(S(e.$t("BalanceView.mintError.label"))+" ",1),c(ie,{name:"error",class:"q-ml-xs"})]),_:1})])])):N("",!0)]),e.pendingBalance>0?(b(),V("div",ka,[m("div",ba,[c(x,{name:"history",size:"sm",align:"between",color:"secondary",dense:"",outline:"",class:"q-mx-none q-mt-xs q-pr-sm cursor-pointer",onClick:t[2]||(t[2]=l=>e.checkPendingTokens())},{default:f(()=>[c(ie,{name:"history",size:"1rem",class:"q-mx-xs"}),E(" "+S(e.$t("BalanceView.pending.label"))+": "+S(e.formatCurrencyDisplay(e.pendingBalance,this.activeUnit))+" ",1),c(Le,null,{default:f(()=>[E(S(e.$t("BalanceView.pending.tooltip")),1)]),_:1})]),_:1})])])):N("",!0)],64)}var Ca=Te(ca,[["render",Da],["__scopeId","data-v-72c5b7de"]]);const Pa=xe({name:"AdvancedFeatures"}),$a=e=>(mn("data-v-0af0e35d"),e=e(),gn(),e),Ta={style:{"max-width":"800px",margin:"0 auto"}},qa=$a(()=>m("div",{class:"q-pa-md"},[m("div",{class:"text-h6 q-mb-md"},"Advanced Features"),m("div",{class:"text-body2 q-mb-lg"}," Advanced features are temporarily disabled. This section will be restored in a future update. ")],-1)),Ma=[qa];function Sa(e,t,n,i,o,s){return b(),V("div",Ta,Ma)}var Aa=Te(Pa,[["render",Sa],["__scopeId","data-v-0af0e35d"]]);const Ve=co("camera",{state:()=>({camera:{data:null,show:!1,camera:"auto"},hasCamera:function(){navigator.permissions.query({name:"camera"}).then(e=>e.state=="granted")}}),actions:{closeCamera:function(){this.camera.show=!1},showCamera:function(){this.camera.show=!0}}}),li=ts({events:{},on(e,t){this.events[e]||(this.events[e]=[]),this.events[e].push(t)},off(e,t){!this.events[e]||(this.events[e]=this.events[e].filter(n=>n!==t))},emit(e,t){console.log("eventBus emit",e,t),this.events[e]&&this.events[e].forEach(n=>n(t))}});/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ia=wt("ChevronLeftIcon",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ea=wt("ClipboardIcon",[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wn=wt("CoinsIcon",[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ra=wt("FileTextIcon",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ua=wt("LockIcon",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ki=wt("NfcIcon",[["path",{d:"M6 8.32a7.43 7.43 0 0 1 0 7.36",key:"9iaqei"}],["path",{d:"M9.46 6.21a11.76 11.76 0 0 1 0 11.58",key:"1yha7l"}],["path",{d:"M12.91 4.1a15.91 15.91 0 0 1 .01 15.8",key:"4iu2gk"}],["path",{d:"M16.37 2a20.16 20.16 0 0 1 0 20",key:"sap9u2"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ft=wt("ScanIcon",[["path",{d:"M3 7V5a2 2 0 0 1 2-2h2",key:"aa7l1z"}],["path",{d:"M17 3h2a2 2 0 0 1 2 2v2",key:"4qcy5o"}],["path",{d:"M21 17v2a2 2 0 0 1-2 2h-2",key:"6vwrx8"}],["path",{d:"M7 21H5a2 2 0 0 1-2-2v-2",key:"ioqczr"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xa=wt("ShareIcon",[["path",{d:"M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8",key:"1b2hhj"}],["polyline",{points:"16 6 12 2 8 6",key:"m901s6"}],["line",{x1:"12",x2:"12",y1:"2",y2:"15",key:"1p0rca"}]]);/**
 * @license lucide-vue-next v0.453.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pn=wt("ZapIcon",[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]]);const Na=xe({name:"AddMintDialog",components:{MintAuditInfo:Vs,InfoIcon:Ws},props:{addMintData:{type:Object,required:!0},showAddMintDialog:{type:Boolean,required:!0},addMintBlocking:{type:Boolean,required:!0}},emits:["add","update:showAddMintDialog"],setup(e,{emit:t}){const n=st(),i=De(!1),o=z({get:()=>e.showAddMintDialog,set:r=>t("update:showAddMintDialog",r)}),s=()=>{t("add",e.addMintData,!0)},a=z(()=>e.addMintData.url);return{addMintLocal:s,showAddMintDialogLocal:o,mintUrl:a,settings:n,showAuditInfo:i}}}),La={class:"add-mint-title-row"},Ba={class:"add-mint-title q-my-none"},Fa={class:"add-mint-description q-mb-lg"},Oa={class:"q-mb-lg"},za={class:"input-label"},Va={key:0,class:"q-mb-lg"},Wa={class:"audit-info-section"};function ja(e,t,n,i,o,s){const a=H("info-icon"),r=H("MintAuditInfo"),l=H("q-spacer");return b(),B(Xe,{modelValue:e.showAddMintDialogLocal,"onUpdate:modelValue":t[1]||(t[1]=g=>e.showAddMintDialogLocal=g),onKeydown:St(uo(e.addMintLocal,["prevent"]),["enter"]),"backdrop-filter":"blur(4px) brightness(50%)","transition-show":"fade","transition-hide":"fade",scrollable:""},{default:f(()=>[c(Oe,{class:"add-mint-dialog"},{default:f(()=>[c(Ne,{class:"add-mint-header q-pa-md"},{default:f(()=>[m("div",La,[m("h4",Ba,S(e.$t("AddMintDialog.title")),1)])]),_:1}),c(Ne,{class:"add-mint-content q-px-md scroll",style:{"max-height":"60vh"}},{default:f(()=>[m("p",Fa,S(e.$t("AddMintDialog.description")),1),m("div",Oa,[m("label",za,S(e.$t("AddMintDialog.inputs.mint_url.label")),1),c(gt,{outlined:"",readonly:"","model-value":e.mintUrl,dense:"",class:"mint-input",filled:"",type:"textarea",autogrow:"",style:{"font-family":"monospace","font-size":"0.9em"}},null,8,["model-value"])]),e.mintUrl?(b(),V("div",Va,[m("div",Wa,[c(x,{flat:"",class:"audit-info-btn",onClick:t[0]||(t[0]=g=>e.showAuditInfo=!e.showAuditInfo)},{default:f(()=>[c(a,{size:"16",class:"q-mr-xs"}),E(" "+S(e.showAuditInfo?"Hide Mint Audit Info":"View Mint Audit Info"),1)]),_:1}),c(Ze,{"enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut"},{default:f(()=>[e.showAuditInfo?(b(),B(r,{key:0,mintUrl:e.mintUrl,class:"q-mt-md"},null,8,["mintUrl"])):N("",!0)]),_:1})])])):N("",!0)]),_:1}),c(In,{class:"action-buttons flex q-pa-md"},{default:f(()=>[Ae((b(),B(x,{flat:"",class:"cancel-btn"},{default:f(()=>[E(S(e.$t("AddMintDialog.actions.cancel.label")),1)]),_:1})),[[Be]]),c(l),Ae((b(),B(x,{color:"primary",class:"add-btn",onClick:e.addMintLocal,loading:e.addMintBlocking,icon:"check"},{loading:f(()=>[c(ht),E(" "+S(e.$t("AddMintDialog.actions.add_mint.in_progress")),1)]),default:f(()=>[E(S(e.$t("AddMintDialog.actions.add_mint.label"))+" ",1)]),_:1},8,["onClick","loading"])),[[Be]])]),_:1})]),_:1})]),_:1},8,["modelValue","onKeydown"])}var Qa=Te(Na,[["render",ja],["__scopeId","data-v-4b276508"]]);const Ka=xe({name:"MintSettings",mixins:[windowMixin],components:{AddMintDialog:Qa,AdvancedFeatures:Aa},props:{},setup(){const e=De(null),t=()=>{if(e.value){const n=e.value.getBoundingClientRect();window.scrollTo({top:window.scrollY+n.top,behavior:"smooth"})}};return ui(()=>{li.on("scrollToAddMintDiv",t)}),Fn(()=>{li.off("scrollToAddMintDiv",t)}),{addMintDiv:e}},data:function(){return{activatingMintUrl:""}},computed:{...ne(st,["getBitcoinPrice"]),...Y(dt,["p2pkKeys"]),...Y(ve,["activeMintUrl","activeUnit","mints","activeProofs"])},methods:{...J(dt,["generateKeypair","showKeyDetails"]),...J(ve,["removeMint","activateMintUrl","updateMint","triggerMintInfoMotdChanged","fetchMintInfo"]),...J($e,["decodeRequest","mintOnPaid"]),...J(Xt,["clearAllWorkers"]),...J(Ve,["closeCamera","showCamera"]),activateMintUrlInternal:async function(e){this.activatingMintUrl=e,console.log(`Activating mint ${this.activatingMintUrl}`);try{await this.activateMintUrl(e,!1,!0)}catch(t){console.log("#### Error activating mint:",t)}finally{this.activatingMintUrl=""}},mintClass(e){return new rn(e)},showMintInfo:async function(e){this.activatingMintUrl=e.url;try{const t=await this.fetchMintInfo(e);this.triggerMintInfoMotdChanged(t,e),this.mints.filter(n=>n.url===e.url)[0].info=t}catch(t){console.log("Failed to fetch mint info:",t)}finally{this.activatingMintUrl=""}this.$router.push({path:"/mintdetails",query:{mintUrl:e.url}})},getMintIconUrl:function(e){if(e.info)return e.info.icon_url?e.info.icon_url:void 0}},created:function(){}}),Ha={style:{"max-width":"800px",margin:"0 auto"}},Ga={class:"q-py-md q-px-xs text-left","on-left":""},Xa={key:0,class:"error-badge"},Za={class:"full-width",style:{position:"relative"}},Ya={class:"row items-center q-pa-md"},Ja={class:"col"},er={class:"row items-center"},tr={class:"mint-info-container"},nr={key:0,class:"mint-name"},ir={class:"text-grey-6 mint-url"},or={class:"row justify-between q-pb-md q-pl-lg q-pr-md"},sr={class:"col"},ar={class:"row q-gutter-x-sm"},rr={class:"currency-unit-text"},lr={class:"col-auto"},cr={class:"section-divider q-mb-md"},ur=m("div",{class:"divider-line"},null,-1),dr={class:"divider-text"},fr=m("div",{class:"divider-line"},null,-1);function hr(e,t,n,i,o,s){const a=H("AddMintDialog"),r=H("AdvancedFeatures");return b(),V(Je,null,[c(a,{addMintData:e.addMintData,showAddMintDialog:e.showAddMintDialog,"onUpdate:showAddMintDialog":t[0]||(t[0]=l=>e.showAddMintDialog=l),addMintBlocking:e.addMintBlocking,onAdd:e.addMintInternal},null,8,["addMintData","showAddMintDialog","addMintBlocking","onAdd"]),m("div",Ha,[m("div",Ga,[c(yi,{padding:""},{default:f(()=>[(b(!0),V(Je,null,Ht(e.mints,l=>(b(),V("div",{key:l.url,class:"q-px-md"},[c(hi,{active:l.url==e.activeMintUrl,"active-class":"text-weight-bold text-primary",clickable:"",onClick:g=>e.activateMintUrlInternal(l.url),class:"mint-card q-mb-md cursor-pointer",style:fo({"border-radius":"10px",border:l.url==e.activeMintUrl?"1px solid var(--q-primary) !important":"1px solid rgba(128, 128, 128, 0.2) !important",padding:"0px",position:"relative"}),loading:l.url==e.activatingMintUrl},{default:f(()=>[c(Ze,{appear:"","enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut",name:"fade"},{default:f(()=>[l.url==e.activatingMintUrl?(b(),B(ht,{key:0,color:"white",size:"1.3rem",class:"mint-loading-spinner"})):N("",!0)]),_:2},1024),c(Ze,{appear:"","enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut",name:"fade"},{default:f(()=>[l.url!=e.activatingMintUrl&&l.errored?(b(),V("div",Xa,[c(Nt,{color:"red",outline:"",class:"q-mr-xs q-mt-sm text-weight-bold"},{default:f(()=>[E(" Error "),c(ie,{name:"error",class:"q-ml-xs",size:"xs"})]),_:1})])):N("",!0)]),_:2},1024),m("div",Za,[m("div",Ya,[m("div",Ja,[m("div",er,[e.getMintIconUrl(l)?(b(),B(On,{key:0,size:"34px",class:"q-mr-sm"},{default:f(()=>[c(pi,{"spinner-color":"white","spinner-size":"xs",src:e.getMintIconUrl(l),alt:"Mint Icon",style:{height:"34px","max-width":"34px","font-size":"12px"}},null,8,["src"])]),_:2},1024)):N("",!0),m("div",tr,[l.nickname||l.info?.name?(b(),V("div",nr,S(l.nickname||l.info?.name),1)):N("",!0),m("div",ir,S(l.url),1)])])])]),m("div",or,[m("div",sr,[m("div",ar,[(b(!0),V(Je,null,Ht(e.mintClass(l).units,g=>(b(),V("div",{key:g,class:"currency-unit-badge"},[m("span",rr,S(e.formatCurrency(e.mintClass(l).unitBalance(g),g)),1)]))),128))])]),m("div",lr,[c(ie,{name:"more_vert",onClick:uo(g=>e.showMintInfo(l),["stop"]),color:"white",class:"cursor-pointer q-mr-sm",size:"1.3rem"},null,8,["onClick"])])])])]),_:2},1032,["active","onClick","style","loading"])]))),128))]),_:1})]),m("div",cr,[ur,m("div",dr,S(e.$t("MintSettings.advanced.title")),1),fr]),c(vo,{dense:"","dense-toggle":"",class:"text-left q-mb-md",label:e.$t("MintSettings.advanced.actions.show_advanced.label"),caption:e.$t("MintSettings.advanced.actions.show_advanced.description")},{default:f(()=>[c(r)]),_:1},8,["label","caption"])])],64)}var mr=Te(Ka,[["render",hr]]);function $n(e,t){return[!0,!1].includes(e)?e:t}var gr=Bt({name:"QPagination",props:{...mi,modelValue:{type:Number,required:!0},min:{type:[Number,String],default:1},max:{type:[Number,String],required:!0},maxPages:{type:[Number,String],default:0,validator:e=>(typeof e=="string"?parseInt(e,10):e)>=0},inputStyle:[Array,String,Object],inputClass:[Array,String,Object],size:String,disable:Boolean,input:Boolean,iconPrev:String,iconNext:String,iconFirst:String,iconLast:String,toFn:Function,boundaryLinks:{type:Boolean,default:null},boundaryNumbers:{type:Boolean,default:null},directionLinks:{type:Boolean,default:null},ellipses:{type:Boolean,default:null},ripple:{type:[Boolean,Object],default:null},round:Boolean,rounded:Boolean,flat:Boolean,outline:Boolean,unelevated:Boolean,push:Boolean,glossy:Boolean,color:{type:String,default:"primary"},textColor:String,activeDesign:{type:String,default:"",values:e=>e===""||ns.includes(e)},activeColor:String,activeTextColor:String,gutter:String,padding:{type:String,default:"3px 2px"}},emits:["update:modelValue"],setup(e,{emit:t}){const{proxy:n}=Lt(),{$q:i}=n,o=gi(e,i),s=z(()=>parseInt(e.min,10)),a=z(()=>parseInt(e.max,10)),r=z(()=>parseInt(e.maxPages,10)),l=z(()=>I.value+" / "+a.value),g=z(()=>$n(e.boundaryLinks,e.input)),y=z(()=>$n(e.boundaryNumbers,!e.input)),D=z(()=>$n(e.directionLinks,e.input)),_=z(()=>$n(e.ellipses,!e.input)),q=De(null),I=z({get:()=>e.modelValue,set:w=>{if(w=parseInt(w,10),e.disable||isNaN(w))return;const P=Ut(w,s.value,a.value);e.modelValue!==P&&t("update:modelValue",P)}});Rt(()=>`${s.value}|${a.value}`,()=>{I.value=e.modelValue});const R=z(()=>"q-pagination row no-wrap items-center"+(e.disable===!0?" disabled":"")),W=z(()=>e.gutter in Ri?`${Ri[e.gutter]}px`:e.gutter||null),K=z(()=>W.value!==null?`--q-pagination-gutter-parent:-${W.value};--q-pagination-gutter-child:${W.value}`:null),A=z(()=>{const w=[e.iconFirst||i.iconSet.pagination.first,e.iconPrev||i.iconSet.pagination.prev,e.iconNext||i.iconSet.pagination.next,e.iconLast||i.iconSet.pagination.last];return i.lang.rtl===!0?w.reverse():w}),F=z(()=>({"aria-disabled":e.disable===!0?"true":"false",role:"navigation"})),X=z(()=>is(e,"flat")),re=z(()=>({[X.value]:!0,round:e.round,rounded:e.rounded,padding:e.padding,color:e.color,textColor:e.textColor,size:e.size,ripple:e.ripple!==null?e.ripple:!0})),fe=z(()=>{const w={[X.value]:!1};return e.activeDesign!==""&&(w[e.activeDesign]=!0),w}),ye=z(()=>({...fe.value,color:e.activeColor||e.color,textColor:e.activeTextColor||e.textColor})),d=z(()=>{let w=Math.max(r.value,1+(_.value?2:0)+(y.value?2:0));const P={pgFrom:s.value,pgTo:a.value,ellipsesStart:!1,ellipsesEnd:!1,boundaryStart:!1,boundaryEnd:!1,marginalStyle:{minWidth:`${Math.max(2,String(a.value).length)}em`}};return r.value&&w<a.value-s.value+1&&(w=1+Math.floor(w/2)*2,P.pgFrom=Math.max(s.value,Math.min(a.value-w+1,e.modelValue-Math.floor(w/2))),P.pgTo=Math.min(a.value,P.pgFrom+w-1),y.value&&(P.boundaryStart=!0,P.pgFrom++),_.value&&P.pgFrom>s.value+(y.value?1:0)&&(P.ellipsesStart=!0,P.pgFrom++),y.value&&(P.boundaryEnd=!0,P.pgTo--),_.value&&P.pgTo<a.value-(y.value?1:0)&&(P.ellipsesEnd=!0,P.pgTo--)),P});function h(w){I.value=w}function p(w){I.value=I.value+w}const T=z(()=>{function w(){I.value=q.value,q.value=null}return{"onUpdate:modelValue":P=>{q.value=P},onKeyup:P=>{oo(P,13)===!0&&w()},onBlur:w}});function v(w,P,k){const C={"aria-label":P,"aria-current":"false",...re.value,...w};return k===!0&&Object.assign(C,{"aria-current":"true",...ye.value}),P!==void 0&&(e.toFn!==void 0?C.to=e.toFn(P):C.onClick=()=>{h(P)}),me(x,C)}return Object.assign(n,{set:h,setByOffset:p}),()=>{const w=[],P=[];let k;if(g.value===!0&&(w.push(v({key:"bls",disable:e.disable||e.modelValue<=s.value,icon:A.value[0],"aria-label":i.lang.pagination.first},s.value)),P.unshift(v({key:"ble",disable:e.disable||e.modelValue>=a.value,icon:A.value[3],"aria-label":i.lang.pagination.last},a.value))),D.value===!0&&(w.push(v({key:"bdp",disable:e.disable||e.modelValue<=s.value,icon:A.value[1],"aria-label":i.lang.pagination.prev},e.modelValue-1)),P.unshift(v({key:"bdn",disable:e.disable||e.modelValue>=a.value,icon:A.value[2],"aria-label":i.lang.pagination.next},e.modelValue+1))),e.input!==!0){k=[];const{pgFrom:C,pgTo:M,marginalStyle:$}=d.value;if(d.value.boundaryStart===!0){const U=s.value===e.modelValue;w.push(v({key:"bns",style:$,disable:e.disable,label:s.value},s.value,U))}if(d.value.boundaryEnd===!0){const U=a.value===e.modelValue;P.unshift(v({key:"bne",style:$,disable:e.disable,label:a.value},a.value,U))}d.value.ellipsesStart===!0&&w.push(v({key:"bes",style:$,disable:e.disable,label:"\u2026",ripple:!1},C-1)),d.value.ellipsesEnd===!0&&P.unshift(v({key:"bee",style:$,disable:e.disable,label:"\u2026",ripple:!1},M+1));for(let U=C;U<=M;U++)k.push(v({key:`bpg${U}`,style:$,disable:e.disable,label:U},U,U===e.modelValue))}return me("div",{class:R.value,...F.value},[me("div",{class:"q-pagination__content row no-wrap items-center",style:K.value},[...w,e.input===!0?me(gt,{class:"inline",style:{width:`${l.value.length/1.5}em`},type:"number",dense:!0,value:q.value,disable:e.disable,dark:o.value,borderless:!0,inputClass:e.inputClass,inputStyle:e.inputStyle,placeholder:l.value,min:s.value,max:a.value,...T.value}):me("div",{class:"q-pagination__middle row justify-center"},k),...P])])}}});function pr(e,t){const n=t?.additionalDigits??2,i=wr(e);let o;if(i.date){const l=kr(i.date,n);o=br(l.restDateString,l.year)}if(!o||isNaN(o.getTime()))return new Date(NaN);const s=o.getTime();let a=0,r;if(i.time&&(a=Dr(i.time),isNaN(a)))return new Date(NaN);if(i.timezone){if(r=Cr(i.timezone),isNaN(r))return new Date(NaN)}else{const l=new Date(s+a),g=new Date(0);return g.setFullYear(l.getUTCFullYear(),l.getUTCMonth(),l.getUTCDate()),g.setHours(l.getUTCHours(),l.getUTCMinutes(),l.getUTCSeconds(),l.getUTCMilliseconds()),g}return new Date(s+a+r)}const Tn={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},vr=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,yr=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,_r=/^([+-])(\d{2})(?::?(\d{2}))?$/;function wr(e){const t={},n=e.split(Tn.dateTimeDelimiter);let i;if(n.length>2)return t;if(/:/.test(n[0])?i=n[0]:(t.date=n[0],i=n[1],Tn.timeZoneDelimiter.test(t.date)&&(t.date=e.split(Tn.timeZoneDelimiter)[0],i=e.substr(t.date.length,e.length))),i){const o=Tn.timezone.exec(i);o?(t.time=i.replace(o[1],""),t.timezone=o[1]):t.time=i}return t}function kr(e,t){const n=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),i=e.match(n);if(!i)return{year:NaN,restDateString:""};const o=i[1]?parseInt(i[1]):null,s=i[2]?parseInt(i[2]):null;return{year:s===null?o:s*100,restDateString:e.slice((i[1]||i[2]).length)}}function br(e,t){if(t===null)return new Date(NaN);const n=e.match(vr);if(!n)return new Date(NaN);const i=!!n[4],o=an(n[1]),s=an(n[2])-1,a=an(n[3]),r=an(n[4]),l=an(n[5])-1;if(i)return Mr(t,r,l)?Pr(t,r,l):new Date(NaN);{const g=new Date(0);return!Tr(t,s,a)||!qr(t,o)?new Date(NaN):(g.setUTCFullYear(t,s,Math.max(o,a)),g)}}function an(e){return e?parseInt(e):1}function Dr(e){const t=e.match(yr);if(!t)return NaN;const n=ti(t[1]),i=ti(t[2]),o=ti(t[3]);return Sr(n,i,o)?n*mo+i*go+o*1e3:NaN}function ti(e){return e&&parseFloat(e.replace(",","."))||0}function Cr(e){if(e==="Z")return 0;const t=e.match(_r);if(!t)return 0;const n=t[1]==="+"?-1:1,i=parseInt(t[2]),o=t[3]&&parseInt(t[3])||0;return Ar(i,o)?n*(i*mo+o*go):NaN}function Pr(e,t,n){const i=new Date(0);i.setUTCFullYear(e,0,4);const o=i.getUTCDay()||7,s=(t-1)*7+n+1-o;return i.setUTCDate(i.getUTCDate()+s),i}const $r=[31,null,31,30,31,30,31,31,30,31,30,31];function Do(e){return e%400===0||e%4===0&&e%100!==0}function Tr(e,t,n){return t>=0&&t<=11&&n>=1&&n<=($r[t]||(Do(e)?29:28))}function qr(e,t){return t>=1&&t<=(Do(e)?366:365)}function Mr(e,t,n){return t>=1&&t<=53&&n>=0&&n<=6}function Sr(e,t,n){return e===24?t===0&&n===0:n>=0&&n<60&&t>=0&&t<60&&e>=0&&e<25}function Ar(e,t){return t>=0&&t<=59}const Ir=xe({name:"HistoryTable",components:{CoinsIcon:Wn,ZapIcon:pn},mixins:[windowMixin],props:{},data:function(){return{currentPage:1,pageSize:5,filterPending:!1,filterPendingEcash:!1,cachedUnifiedTransactions:[]}},watch:{filterPending:function(){this.currentPage=1,this.filterPending||(this.filterPendingEcash=!1)},filterPendingEcash:function(){this.currentPage=1},historyTokens:{handler:function(){this.updateUnifiedTransactions()},deep:!0,immediate:!0},invoiceHistory:{handler:function(){this.updateUnifiedTransactions()},deep:!0,immediate:!0}},computed:{...Y(mt,["historyTokens"]),...Y($e,["invoiceHistory"]),...ne(ot,["showReceiveTokens","receiveData"]),...ne(Zt,["showSendTokens","sendData","showLockInput"]),...ne(Ce,["showInvoiceDetails"]),...ne($e,["invoiceData","payInvoiceData"]),unifiedTransactions(){return this.cachedUnifiedTransactions},filteredTransactions(){return this.filterPendingEcash?this.unifiedTransactions.filter(e=>e.status==="pending"&&e.type==="ecash"):this.filterPending?this.unifiedTransactions.filter(e=>e.status==="pending"):this.unifiedTransactions},maxPages(){return Math.ceil(this.filteredTransactions.length/this.pageSize)},paginatedTransactions(){const e=(this.currentPage-1)*this.pageSize,t=e+this.pageSize;return this.filteredTransactions.slice(e,t)}},methods:{...J($e,["checkTokenSpendable","checkInvoice","checkOutgoingInvoice"]),handleLongPress(e){console.debug("### handleLongPress called"),this.isEcashTransaction(e)&&(e.longPressActive=!1,this.receiveToken(e.token))},startLongPress(e){this.isEcashTransaction(e)&&(e.longPressActive=!1,this.longPressTimeout=setTimeout(()=>{e.longPressActive=!0},1e3))},endLongPress(e){console.debug("### endLongPress called"),clearTimeout(this.longPressTimeout)},endLongTap(e){console.debug("### endLongTap called"),clearTimeout(this.longPressTimeout),e.longPressActive&&this.handleLongPress(e)},formattedDate(e){const t=pr(e);return us(t,{addSuffix:!1})},shortenString:function(e){return bo(e,20,10)},handlePageChange(e){this.currentPage=e},receiveToken(e){this.receiveData.tokensBase64=e,this.showReceiveTokens=!0},getTransactionKey(e){return e.id},isEcashTransaction(e){return e.type==="ecash"},isLightningTransaction(e){return e.type==="lightning"},getTransactionIcon(e){return e.type==="lightning"?"flash_on":"account_balance_wallet"},getTransactionIconColor(e){return e.type==="lightning"?"orange":"blue"},getDefaultLabel(e){return e.type==="lightning"?"Lightning":"Ecash"},getTransactionLabel(e){return e.label||this.getDefaultLabel(e)},checkTransactionStatus(e){e.type==="ecash"?this.checkTokenSpendable(e):e.type==="lightning"&&(e.amount>0?this.checkInvoice(e.quote,!0):this.checkOutgoingInvoice(e.quote,!0))},showTransactionDialog(e){e.type==="ecash"?this.showTokenDialog(e):e.type==="lightning"&&this.showInvoiceDialog(e)},showTokenDialog:function(e){if(e.token===void 0){yo(this.$i18n.t("HistoryTable.old_token_not_found_error_text"));return}const t=e.token;console.log("##### showTokenDialog");const n=pe.decode(t);this.sendData.tokens=pe.getProofs(n),this.sendData.tokensBase64=Us(t),this.sendData.paymentRequest=e.paymentRequest,this.sendData.historyAmount=e.amount,this.sendData.historyToken=e,this.showSendTokens=!0},showInvoiceDialog:async function(e){if(this.invoiceData=e,this.showInvoiceDetails=!0,e.status==="pending")if(e.amount>0)try{await this.checkInvoice(e.quote,!1,!1)}catch{}else this.checkOutgoingInvoice(e.quote,!0)},updateUnifiedTransactions(){const e=[];this.historyTokens.forEach(t=>{e.push({...t,type:"ecash",id:`token-${t.token}`,label:t.label})}),this.invoiceHistory.forEach(t=>{e.push({...t,type:"lightning",id:`invoice-${t.quote}`,label:t.label})}),this.cachedUnifiedTransactions=e.sort((t,n)=>new Date(n.date)-new Date(t.date))}},created:function(){}}),Er={class:"q-pa-xs",style:{"max-width":"500px",margin:"0 auto"}},Rr={class:"col text-left"},Ur={class:"transaction-label text-weight-medium"},xr={class:"text-right"},Nr={key:0},Lr={class:"text-grey-6"},Br={class:"text-grey-6 text-caption"},Fr={key:0},Or={key:1},zr={class:"text-center q-mt-lg"},Vr={key:0,class:"text-center q-mt-lg"},Wr={key:1,class:"text-center q-mt-lg"},jr={style:{display:"flex","justify-content":"center"}};function Qr(e,t,n,i,o,s){const a=H("CoinsIcon"),r=H("ZapIcon");return b(),V("div",Er,[c(yi,null,{default:f(()=>[(b(!0),V(Je,null,Ht(e.paginatedTransactions,l=>Ae((b(),B(hi,{key:e.getTransactionKey(l),clickable:"",class:"q-px-md q-py-md"},{default:f(()=>[c(xt,{avatar:"",class:"q-pr-md",style:{"min-width":"40px"}},{default:f(()=>[c(On,{size:"32px"},{default:f(()=>[e.isEcashTransaction(l)?(b(),B(a,{key:0,class:"transaction-icon"})):(b(),B(r,{key:1,class:"transaction-icon"}))]),_:2},1024)]),_:2},1024),c(xt,{onClick:g=>e.showTransactionDialog(l)},{default:f(()=>[c(Ge,{class:"row items-center justify-between"},{default:f(()=>[m("div",Rr,[m("span",Ur,S(e.getTransactionLabel(l)),1)]),m("div",xr,[m("div",{class:cn(["amount-text text-weight-bold",{"text-amount-positive":l.amount>=0&&l.status!=="pending","text-grey-6":l.status==="pending"}])},[l.amount>=0?(b(),V("span",Nr,"+")):N("",!0),E(S(e.formatCurrency(l.amount,l.unit)),1)],2)])]),_:2},1024),c(Ge,{caption:"",class:"q-mt-none row items-center justify-between"},{default:f(()=>[m("div",Lr,S(e.$t("HistoryTable.row.date_label",{value:e.formattedDate(l.date)})),1),m("div",Br,[l.status==="pending"?(b(),V("span",Fr,"Pending")):(b(),V("span",Or,"\xA0"))])]),_:2},1024)]),_:2},1032,["onClick"]),c(xt,{side:"",top:"",style:{"min-width":"40px"}},{default:f(()=>[l.status==="pending"?(b(),B(x,{key:0,flat:"",dense:"",round:"",icon:l.longPressActive?"arrow_circle_down":"sync",onClick:g=>l.longPressActive?e.handleLongPress(l):e.checkTransactionStatus(l),onMousedown:g=>e.startLongPress(l),onMouseup:g=>e.endLongPress(l),onTouchstart:g=>e.startLongPress(l),onTouchend:g=>e.endLongTap(l),class:"cursor-pointer",size:"sm"},{default:f(()=>[c(Le,null,{default:f(()=>[E(S(l.longPressActive?e.$t("HistoryTable.actions.receive.tooltip_text"):e.$t("HistoryTable.actions.check_status.tooltip_text")),1)]),_:2},1024)]),_:2},1032,["icon","onClick","onMousedown","onMouseup","onTouchstart","onTouchend"])):N("",!0)]),_:2},1024)]),_:2},1024)),[[io]])),128))]),_:1}),m("div",zr,[c(x,{rounded:"",outline:"",dense:"",onClick:t[0]||(t[0]=l=>e.filterPending=!e.filterPending),color:e.filterPending?"primary":"grey",label:e.$t(e.filterPending?"HistoryTable.actions.show_all.label":"HistoryTable.actions.filter_pending.label"),class:"q-ml-sm q-px-md",size:"sm"},null,8,["color","label"]),e.filterPending?(b(),B(x,{key:0,rounded:"",outline:"",dense:"",onClick:t[1]||(t[1]=l=>e.filterPendingEcash=!e.filterPendingEcash),color:e.filterPendingEcash?"primary":"grey",label:"Ecash Only",class:"q-ml-sm q-px-md",size:"sm"},null,8,["color"])):N("",!0)]),e.paginatedTransactions.length===0?(b(),V("div",Vr,[c(Ge,{caption:"",class:"text-primary"},{default:f(()=>[E(S(e.$t("HistoryTable.empty_text")),1)]),_:1})])):e.maxPages>1?(b(),V("div",Wr,[m("div",jr,[c(gr,{modelValue:e.currentPage,"onUpdate:modelValue":t[2]||(t[2]=l=>e.currentPage=l),max:e.maxPages,"max-pages":5,"direction-links":"","boundary-links":"",onInput:e.handlePageChange},null,8,["modelValue","max","onInput"])])])):N("",!0)])}var Kr=Te(Ir,[["render",Qr],["__scopeId","data-v-57042c18"]]);const Hr=xe({name:"NoMintWarnBanner",mixins:[windowMixin],props:{proofs:Array,activeProofs:Array,mints:Array,tickerShort:String,activeMintUrl:String},computed:{...ne(Ce,["tab","expandHistory","showReceiveEcashDrawer"]),...ne(ot,["showReceiveTokens","receiveData"]),balance:function(){return this.activeProofs.map(e=>e).flat().reduce((e,t)=>e+=t.amount,0)},getActiveMintUrlShort:function(){return At(this.activeMintUrl)},getBalance:function(){var e=this.activeProofs.map(t=>t).flat().reduce((t,n)=>t+=n.amount,0);return e}},methods:{handleReceiveEcash:function(){this.showReceiveEcashDrawer=!0},handleAddMintClick:function(){this.expandHistory=!0,this.tab="mints",li.emit("scrollToAddMintDiv")}}}),Gr={class:"row items-center justify-center"},Xr={class:"row items-center justify-center"},Zr={class:"text-h6"},Yr={class:"row items-center justify-center"},Jr={class:"text-subtitle2"},el={class:"row items-center justify-center q-pt-lg"},tl={class:"row items-center justify-center q-pt-md"};function nl(e,t,n,i,o,s){return b(),B(Oe,{class:"q-ma-lg bg-dark q-pa-md"},{default:f(()=>[c(Ne,null,{default:f(()=>[m("div",Gr,[c(ie,{color:"primary",class:"q-pb-md",name:"account_balance",size:"50px"})]),m("div",Xr,[m("div",Zr,S(e.$t("NoMintWarnBanner.title")),1)]),m("div",Yr,[m("div",Jr,S(e.$t("NoMintWarnBanner.subtitle")),1)]),m("div",el,[c(x,{rounded:"",color:"primary",class:"q-px-md",label:e.$t("NoMintWarnBanner.actions.add_mint.label"),onClick:e.handleAddMintClick},null,8,["label","onClick"])]),m("div",tl,[c(x,{outline:"",rounded:"",color:"primary",class:"q-px-md",label:e.$t("NoMintWarnBanner.actions.receive.label"),onClick:e.handleReceiveEcash},null,8,["label","onClick"])])]),_:1})]),_:1})}var il=Te(Hr,[["render",nl],["__scopeId","data-v-297aa444"]]);const ol=xe({name:"WelcomeDialog",mixins:[windowMixin],props:{welcomeDialog:Object,triggerPwaInstall:Function,setTab:Function,getPwaDisplayMode:Function,setWelcomeDialogSeen:Function},data:function(){return{}},watch:{},computed:{...Y($e,["mnemonic"])},methods:{...J(_o,["restoreFromBackup"]),readFile(e){let t=new FileReader;t.onload=n=>{let i=n.target.result,o=JSON.parse(i);this.restoreFromBackup(o)},t.readAsText(e)},dragFile(e){e.preventDefault();let n=e.dataTransfer.files[0];this.readFile(n)},allowDrop(e){e.preventDefault()},onChangeFileUpload(){let e=this.$refs.fileUpload.files[0];this.readFile(e)},browseBackupFile(){this.$refs.fileUpload.click()}}}),vn=e=>(mn("data-v-4a08bab0"),e=e(),gn(),e),sl=vn(()=>m("span",{class:"text-weight-bold"},"Cashu",-1)),al=vn(()=>m("p",null,"Please take a moment to read the following information.",-1)),rl=vn(()=>m("p",null,[m("strong",null,"Install and add to home screen."),E(" For the best experience, use this wallet with your device's native web browser (Safari on iOS, Chrome on Android). In Chrome click the hamburger menu at the upper right. In Safari click the share button and press the Add to Home screen button. ")],-1)),ll=vn(()=>m("p",null,[m("strong",null,"Back up your seed phrase."),E(" This wallet stores ecash tokens in its database. If you delete your browser data without backing up, you will lose your tokens. Make sure to back up your wallet seed phrase in the settings. ")],-1)),cl=vn(()=>m("p",null,[m("strong",null,"This software is in BETA!"),E(" We hold no responsibility for people losing access to funds. Use at your own risk! This wallet is not affiliated with any mint. This code is open-source and licensed under the MIT license. ")],-1)),ul={class:"row q-mt-lg"};function dl(e,t,n,i,o,s){return b(),B(Xe,{class:"z-top",persistent:"",position:"top",onDrop:e.dragFile,onDragover:e.allowDrop,"backdrop-filter":"blur(2px) brightness(60%)"},{default:f(()=>[c(Oe,{class:"q-pa-lg z-top"},{default:f(()=>[c(Ks,null,{default:f(()=>[c(js,null,{default:f(()=>[sl,E(" ecash wallet")]),_:1})]),_:1}),c(Ne,null,{default:f(()=>[al,rl,ll,cl,m("input",{type:"file",id:"fileUpload",ref:"fileUpload",onChange:t[0]||(t[0]=a=>e.onChangeFileUpload())},null,544),m("div",ul,[e.getPwaDisplayMode()=="browser"&&e.deferredPWAInstallPrompt!=null?(b(),B(x,{key:0,outline:"",class:"q-mx-sm",color:"primary",onClick:t[1]||(t[1]=a=>e.triggerPwaInstall())},{default:f(()=>[E("Install Cashu")]),_:1})):N("",!0),c(x,{flat:"",size:"0.6rem",class:"q-mx-xs q-px-none",onClick:t[2]||(t[2]=a=>e.copyText(e.baseURL))},{default:f(()=>[E("Copy URL")]),_:1}),c(x,{flat:"",size:"0.6rem",class:"q-mx-xs q-px-none",color:"warning",icon:"upload_for_offline",onClick:e.browseBackupFile},{default:f(()=>[E("Restore"),c(Le,null,{default:f(()=>[E("You can drag & drop the wallet backup here!")]),_:1})]),_:1},8,["onClick"]),Ae((b(),B(x,{outline:"",size:"0.8rem",class:"q-ml-auto",onClick:t[3]||(t[3]=a=>e.setWelcomeDialogSeen())},{default:f(()=>[E("Continue")]),_:1})),[[Be]])])]),_:1})]),_:1})]),_:1},8,["onDrop","onDragover"])}var fl=Te(ol,[["render",dl],["__scopeId","data-v-4a08bab0"]]);const hl=xe({name:"TokenInformation",mixins:[windowMixin],props:{encodedToken:String,showAmount:Boolean,showMintCheck:Boolean,showP2PKCheck:Boolean},data:function(){return{}},watch:{},computed:{...Y(ve,["activeMintUrl","activeProofs","mints","activeUnit","addMintBlocking"]),proofsToShow:function(){return pe.getProofs(pe.decode(this.encodedToken))},sumProofs:function(){return pe.getProofs(pe.decode(this.encodedToken)).flat().reduce((t,n)=>t+=n.amount,0)},displayUnit:function(){return this.formatCurrency(this.sumProofs,this.tokenUnit)},tokenUnit:function(){return pe.getUnit(pe.decode(this.encodedToken))},tokenMintUrl:function(){let e=pe.getMint(pe.decode(this.encodedToken));return At(e)},displayMemo:function(){return pe.getMemo(pe.decode(this.encodedToken))}},methods:{...J(dt,["isLocked","isLockedToUs"]),getProofsMint:function(e){let t=[...new Set(e.map(o=>o.id))],i=this.mints.filter(o=>o.keysets.some(s=>t.indexOf(s)>=0)).map(o=>[{url:o.url,ids:o.keysets}][0]);return i.length==0?"":At(i[0].url)},mintKnownToUs:function(e){let t=[...new Set(e.map(n=>n.id))];return this.mints.filter(n=>n.keysets.some(i=>t.indexOf(i.id)>=0)).length>0}}}),ml={class:"row text-left q-py-none q-my-none"},gl={class:"col-12 q-px-none"},pl={key:2,class:"q-my-md"};function vl(e,t,n,i,o,s){return b(),V("div",ml,[m("div",gl,[e.showAmount?(b(),B(Kt,{key:0,outline:"",class:"q-pa-md",style:{"border-width":"2px"}},{default:f(()=>[c(ie,{name:"toll",size:"xs",class:"q-mr-sm"}),m("strong",null,S(e.displayUnit),1)]),_:1})):N("",!0),c(Kt,{outline:"",class:"q-pa-md",style:{height:"36px","font-family":"monospace"}},{default:f(()=>[c(ie,{name:"account_balance",size:"xs",class:"q-mr-xs"}),E(" "+S(e.tokenMintUrl)+" ",1),e.addMintBlocking?(b(),B(ht,{key:0,size:"sm",class:"q-ml-sm"})):N("",!0),e.showMintCheck&&e.mintKnownToUs(e.proofsToShow)&&!e.addMintBlocking?(b(),B(ie,{key:1,name:"check",size:"sm",color:"green",class:"q-ml-xs"})):N("",!0)]),_:1}),e.isLocked(e.proofsToShow)?(b(),B(Kt,{key:1,outline:"",icon:"lock",class:"q-pa-md"},{default:f(()=>[E(" P2PK "),e.showP2PKCheck||e.isLockedToUs(e.proofsToShow)?(b(),B(ie,{key:0,name:e.isLockedToUs(e.proofsToShow)?"check":"close",size:"sm",color:e.isLockedToUs(e.proofsToShow)?"green":"red",class:"q-ml-xs"},null,8,["name","color"])):N("",!0)]),_:1})):N("",!0),e.displayMemo?(b(),V("div",pl,[c(ie,{name:"chat",size:"xs",color:"grey",class:"q-mr-sm"}),m("span",null,S(e.displayMemo),1)])):N("",!0)])])}var Co=Te(hl,[["render",vl]]),yn=globalThis&&globalThis.__extends||function(){var e=function(t,n){return e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(i,o){i.__proto__=o}||function(i,o){for(var s in o)Object.prototype.hasOwnProperty.call(o,s)&&(i[s]=o[s])},e(t,n)};return function(t,n){e(t,n);function i(){this.constructor=t}t.prototype=n===null?Object.create(n):(i.prototype=n.prototype,new i)}}(),zi=function(e){yn(t,e);function t(){var n=e.call(this,"Invalid Scheme")||this;return n.name="InvalidSchemeError",n}return t}(Error),ni=function(e){yn(t,e);function t(){var n=e.call(this,"Invalid Path")||this;return n.name="InvalidPathLengthError",n}return t}(Error),Po=function(e){yn(t,e);function t(){var n=e.call(this,"Invalid Type")||this;return n.name="InvalidTypeError",n}return t}(Error),Vi=function(e){yn(t,e);function t(){var n=e.call(this,"Invalid Sequence Component")||this;return n.name="InvalidSequenceComponentError",n}return t}(Error),yl=function(e){yn(t,e);function t(){var n=e.call(this,"Invalid Checksum")||this;return n.name="InvalidChecksumError",n}return t}(Error),_l=function(){for(var e,t=[],n=0;n<256;n++){e=n;for(var i=0;i<8;i++)e=e&1?3988292384^e>>>1:e>>>1;t[n]=e}return t}(),$o=function(e){for(var t=-1,n=0;n<e.length;n++)t=t>>>8^_l[(t^e[n])&255];return(t^-1)>>>0},wl=function(e){return Ie.Buffer.from(xs(e))},kl=function(e,t){return e.match(new RegExp(".{1,"+t+"}","g"))||[e]},To=function(e,t){return[e.slice(0,-t),e.slice(-t)]},qo=function(e){return $o(e)},Mo=function(e){return $o(e).toString(16).padStart(8,"0")},ci=function(e){return e>>>0},Wi=function(e){var t=new ArrayBuffer(4),n=new DataView(t);return n.setUint32(0,e,!1),Ie.Buffer.from(t)},En=function(e){return e.split("").every(function(t,n){var i=e.charCodeAt(n);return"a".charCodeAt(0)<=i&&i<="z".charCodeAt(0)||"0".charCodeAt(0)<=i&&i<="9".charCodeAt(0)||i==="-".charCodeAt(0)})},ji=function(e,t){return e.length!==t.length?!1:e.every(function(n){return t.includes(n)})},bl=function(e,t){return t.every(function(n){return e.includes(n)})},Dl=function(e,t){return e.filter(function(n){return t.indexOf(n)<0})},So=function(e,t){for(var n=Math.max(e.length,t.length),i=Ie.Buffer.allocUnsafe(n),o=0;o<n;++o)i[o]=e[o]^t[o];return i};const Cl=["string","number","bigint","symbol"],Pl=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function $l(e){if(e===null)return"null";if(e===void 0)return"undefined";if(e===!0||e===!1)return"boolean";const t=typeof e;if(Cl.includes(t))return t;if(t==="function")return"Function";if(Array.isArray(e))return"Array";if(Tl(e))return"Buffer";const n=ql(e);return n||"Object"}function Tl(e){return e&&e.constructor&&e.constructor.isBuffer&&e.constructor.isBuffer.call(null,e)}function ql(e){const t=Object.prototype.toString.call(e).slice(8,-1);if(Pl.includes(t))return t}class L{constructor(t,n,i){this.major=t,this.majorEncoded=t<<5,this.name=n,this.terminal=i}toString(){return`Type[${this.major}].${this.name}`}compare(t){return this.major<t.major?-1:this.major>t.major?1:0}}L.uint=new L(0,"uint",!0);L.negint=new L(1,"negint",!0);L.bytes=new L(2,"bytes",!0);L.string=new L(3,"string",!0);L.array=new L(4,"array",!1);L.map=new L(5,"map",!1);L.tag=new L(6,"tag",!1);L.float=new L(7,"float",!0);L.false=new L(7,"false",!0);L.true=new L(7,"true",!0);L.null=new L(7,"null",!0);L.undefined=new L(7,"undefined",!0);L.break=new L(7,"break",!0);class te{constructor(t,n,i){this.type=t,this.value=n,this.encodedLength=i,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}}const Yt=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&typeof globalThis.Buffer.isBuffer=="function",Ml=new TextDecoder,Sl=new TextEncoder;function xn(e){return Yt&&globalThis.Buffer.isBuffer(e)}function Ao(e){return e instanceof Uint8Array?xn(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):e:Uint8Array.from(e)}const Al=Yt?(e,t,n)=>n-t>64?globalThis.Buffer.from(e.subarray(t,n)).toString("utf8"):Ki(e,t,n):(e,t,n)=>n-t>64?Ml.decode(e.subarray(t,n)):Ki(e,t,n),Il=Yt?e=>e.length>64?globalThis.Buffer.from(e):Qi(e):e=>e.length>64?Sl.encode(e):Qi(e),yt=e=>Uint8Array.from(e),bi=Yt?(e,t,n)=>xn(e)?new Uint8Array(e.subarray(t,n)):e.slice(t,n):(e,t,n)=>e.slice(t,n),El=Yt?(e,t)=>(e=e.map(n=>n instanceof Uint8Array?n:globalThis.Buffer.from(n)),Ao(globalThis.Buffer.concat(e,t))):(e,t)=>{const n=new Uint8Array(t);let i=0;for(let o of e)i+o.length>n.length&&(o=o.subarray(0,n.length-i)),n.set(o,i),i+=o.length;return n},Rl=Yt?e=>globalThis.Buffer.allocUnsafe(e):e=>new Uint8Array(e);function Ul(e,t){if(xn(e)&&xn(t))return e.compare(t);for(let n=0;n<e.length;n++)if(e[n]!==t[n])return e[n]<t[n]?-1:1;return 0}function Qi(e){const t=[];let n=0;for(let i=0;i<e.length;i++){let o=e.charCodeAt(i);o<128?t[n++]=o:o<2048?(t[n++]=o>>6|192,t[n++]=o&63|128):(o&64512)===55296&&i+1<e.length&&(e.charCodeAt(i+1)&64512)===56320?(o=65536+((o&1023)<<10)+(e.charCodeAt(++i)&1023),t[n++]=o>>18|240,t[n++]=o>>12&63|128,t[n++]=o>>6&63|128,t[n++]=o&63|128):(t[n++]=o>>12|224,t[n++]=o>>6&63|128,t[n++]=o&63|128)}return t}function Ki(e,t,n){const i=[];for(;t<n;){const o=e[t];let s=null,a=o>239?4:o>223?3:o>191?2:1;if(t+a<=n){let r,l,g,y;switch(a){case 1:o<128&&(s=o);break;case 2:r=e[t+1],(r&192)===128&&(y=(o&31)<<6|r&63,y>127&&(s=y));break;case 3:r=e[t+1],l=e[t+2],(r&192)===128&&(l&192)===128&&(y=(o&15)<<12|(r&63)<<6|l&63,y>2047&&(y<55296||y>57343)&&(s=y));break;case 4:r=e[t+1],l=e[t+2],g=e[t+3],(r&192)===128&&(l&192)===128&&(g&192)===128&&(y=(o&15)<<18|(r&63)<<12|(l&63)<<6|g&63,y>65535&&y<1114112&&(s=y))}}s===null?(s=65533,a=1):s>65535&&(s-=65536,i.push(s>>>10&1023|55296),s=56320|s&1023),i.push(s),t+=a}return xl(i)}const Hi=4096;function xl(e){const t=e.length;if(t<=Hi)return String.fromCharCode.apply(String,e);let n="",i=0;for(;i<t;)n+=String.fromCharCode.apply(String,e.slice(i,i+=Hi));return n}const Nl=256;class Io{constructor(t=Nl){this.chunkSize=t,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),this._initReuseChunk!==null&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(t){let n=this.chunks[this.chunks.length-1];if(this.cursor+t.length<=this.maxCursor+1){const o=n.length-(this.maxCursor-this.cursor)-1;n.set(t,o)}else{if(n){const o=n.length-(this.maxCursor-this.cursor)-1;o<n.length&&(this.chunks[this.chunks.length-1]=n.subarray(0,o),this.maxCursor=this.cursor-1)}t.length<64&&t.length<this.chunkSize?(n=Rl(this.chunkSize),this.chunks.push(n),this.maxCursor+=n.length,this._initReuseChunk===null&&(this._initReuseChunk=n),n.set(t,0)):(this.chunks.push(t),this.maxCursor+=t.length)}this.cursor+=t.length}toBytes(t=!1){let n;if(this.chunks.length===1){const i=this.chunks[0];t&&this.cursor>i.length/2?(n=this.cursor===i.length?i:i.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):n=bi(i,0,this.cursor)}else n=El(this.chunks,this.cursor);return t&&this.reset(),n}}const he="CBOR decode error:",Eo="CBOR encode error:";function Jt(e,t,n){if(e.length-t<n)throw new Error(`${he} not enough data for type`)}const Qe=[24,256,65536,4294967296,BigInt("18446744073709551616")];function Ot(e,t,n){Jt(e,t,1);const i=e[t];if(n.strict===!0&&i<Qe[0])throw new Error(`${he} integer encoded in more bytes than necessary (strict decode)`);return i}function zt(e,t,n){Jt(e,t,2);const i=e[t]<<8|e[t+1];if(n.strict===!0&&i<Qe[1])throw new Error(`${he} integer encoded in more bytes than necessary (strict decode)`);return i}function Vt(e,t,n){Jt(e,t,4);const i=e[t]*16777216+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3];if(n.strict===!0&&i<Qe[2])throw new Error(`${he} integer encoded in more bytes than necessary (strict decode)`);return i}function Wt(e,t,n){Jt(e,t,8);const i=e[t]*16777216+(e[t+1]<<16)+(e[t+2]<<8)+e[t+3],o=e[t+4]*16777216+(e[t+5]<<16)+(e[t+6]<<8)+e[t+7],s=(BigInt(i)<<BigInt(32))+BigInt(o);if(n.strict===!0&&s<Qe[3])throw new Error(`${he} integer encoded in more bytes than necessary (strict decode)`);if(s<=Number.MAX_SAFE_INTEGER)return Number(s);if(n.allowBigInt===!0)return s;throw new Error(`${he} integers outside of the safe integer range are not supported`)}function Ll(e,t,n,i){return new te(L.uint,Ot(e,t+1,i),2)}function Bl(e,t,n,i){return new te(L.uint,zt(e,t+1,i),3)}function Fl(e,t,n,i){return new te(L.uint,Vt(e,t+1,i),5)}function Ol(e,t,n,i){return new te(L.uint,Wt(e,t+1,i),9)}function jt(e,t){return at(e,0,t.value)}function at(e,t,n){if(n<Qe[0]){const i=Number(n);e.push([t|i])}else if(n<Qe[1]){const i=Number(n);e.push([t|24,i])}else if(n<Qe[2]){const i=Number(n);e.push([t|25,i>>>8,i&255])}else if(n<Qe[3]){const i=Number(n);e.push([t|26,i>>>24&255,i>>>16&255,i>>>8&255,i&255])}else{const i=BigInt(n);if(i<Qe[4]){const o=[t|27,0,0,0,0,0,0,0];let s=Number(i&BigInt(4294967295)),a=Number(i>>BigInt(32)&BigInt(4294967295));o[8]=s&255,s=s>>8,o[7]=s&255,s=s>>8,o[6]=s&255,s=s>>8,o[5]=s&255,o[4]=a&255,a=a>>8,o[3]=a&255,a=a>>8,o[2]=a&255,a=a>>8,o[1]=a&255,e.push(o)}else throw new Error(`${he} encountered BigInt larger than allowable range`)}}jt.encodedSize=function(t){return at.encodedSize(t.value)};at.encodedSize=function(t){return t<Qe[0]?1:t<Qe[1]?2:t<Qe[2]?3:t<Qe[3]?5:9};jt.compareTokens=function(t,n){return t.value<n.value?-1:t.value>n.value?1:0};function zl(e,t,n,i){return new te(L.negint,-1-Ot(e,t+1,i),2)}function Vl(e,t,n,i){return new te(L.negint,-1-zt(e,t+1,i),3)}function Wl(e,t,n,i){return new te(L.negint,-1-Vt(e,t+1,i),5)}const Di=BigInt(-1),Ro=BigInt(1);function jl(e,t,n,i){const o=Wt(e,t+1,i);if(typeof o!="bigint"){const s=-1-o;if(s>=Number.MIN_SAFE_INTEGER)return new te(L.negint,s,9)}if(i.allowBigInt!==!0)throw new Error(`${he} integers outside of the safe integer range are not supported`);return new te(L.negint,Di-BigInt(o),9)}function Ci(e,t){const n=t.value,i=typeof n=="bigint"?n*Di-Ro:n*-1-1;at(e,t.type.majorEncoded,i)}Ci.encodedSize=function(t){const n=t.value,i=typeof n=="bigint"?n*Di-Ro:n*-1-1;return i<Qe[0]?1:i<Qe[1]?2:i<Qe[2]?3:i<Qe[3]?5:9};Ci.compareTokens=function(t,n){return t.value<n.value?1:t.value>n.value?-1:0};function _n(e,t,n,i){Jt(e,t,n+i);const o=bi(e,t+n,t+n+i);return new te(L.bytes,o,n+i)}function Ql(e,t,n,i){return _n(e,t,1,n)}function Kl(e,t,n,i){return _n(e,t,2,Ot(e,t+1,i))}function Hl(e,t,n,i){return _n(e,t,3,zt(e,t+1,i))}function Gl(e,t,n,i){return _n(e,t,5,Vt(e,t+1,i))}function Xl(e,t,n,i){const o=Wt(e,t+1,i);if(typeof o=="bigint")throw new Error(`${he} 64-bit integer bytes lengths not supported`);return _n(e,t,9,o)}function Nn(e){return e.encodedBytes===void 0&&(e.encodedBytes=e.type===L.string?Il(e.value):e.value),e.encodedBytes}function jn(e,t){const n=Nn(t);at(e,t.type.majorEncoded,n.length),e.push(n)}jn.encodedSize=function(t){const n=Nn(t);return at.encodedSize(n.length)+n.length};jn.compareTokens=function(t,n){return Zl(Nn(t),Nn(n))};function Zl(e,t){return e.length<t.length?-1:e.length>t.length?1:Ul(e,t)}function wn(e,t,n,i,o){const s=n+i;Jt(e,t,s);const a=new te(L.string,Al(e,t+n,t+s),s);return o.retainStringBytes===!0&&(a.byteValue=bi(e,t+n,t+s)),a}function Yl(e,t,n,i){return wn(e,t,1,n,i)}function Jl(e,t,n,i){return wn(e,t,2,Ot(e,t+1,i),i)}function ec(e,t,n,i){return wn(e,t,3,zt(e,t+1,i),i)}function tc(e,t,n,i){return wn(e,t,5,Vt(e,t+1,i),i)}function nc(e,t,n,i){const o=Wt(e,t+1,i);if(typeof o=="bigint")throw new Error(`${he} 64-bit integer string lengths not supported`);return wn(e,t,9,o,i)}const ic=jn;function en(e,t,n,i){return new te(L.array,i,n)}function oc(e,t,n,i){return en(e,t,1,n)}function sc(e,t,n,i){return en(e,t,2,Ot(e,t+1,i))}function ac(e,t,n,i){return en(e,t,3,zt(e,t+1,i))}function rc(e,t,n,i){return en(e,t,5,Vt(e,t+1,i))}function lc(e,t,n,i){const o=Wt(e,t+1,i);if(typeof o=="bigint")throw new Error(`${he} 64-bit integer array lengths not supported`);return en(e,t,9,o)}function cc(e,t,n,i){if(i.allowIndefinite===!1)throw new Error(`${he} indefinite length items not allowed`);return en(e,t,1,1/0)}function Pi(e,t){at(e,L.array.majorEncoded,t.value)}Pi.compareTokens=jt.compareTokens;Pi.encodedSize=function(t){return at.encodedSize(t.value)};function tn(e,t,n,i){return new te(L.map,i,n)}function uc(e,t,n,i){return tn(e,t,1,n)}function dc(e,t,n,i){return tn(e,t,2,Ot(e,t+1,i))}function fc(e,t,n,i){return tn(e,t,3,zt(e,t+1,i))}function hc(e,t,n,i){return tn(e,t,5,Vt(e,t+1,i))}function mc(e,t,n,i){const o=Wt(e,t+1,i);if(typeof o=="bigint")throw new Error(`${he} 64-bit integer map lengths not supported`);return tn(e,t,9,o)}function gc(e,t,n,i){if(i.allowIndefinite===!1)throw new Error(`${he} indefinite length items not allowed`);return tn(e,t,1,1/0)}function $i(e,t){at(e,L.map.majorEncoded,t.value)}$i.compareTokens=jt.compareTokens;$i.encodedSize=function(t){return at.encodedSize(t.value)};function pc(e,t,n,i){return new te(L.tag,n,1)}function vc(e,t,n,i){return new te(L.tag,Ot(e,t+1,i),2)}function yc(e,t,n,i){return new te(L.tag,zt(e,t+1,i),3)}function _c(e,t,n,i){return new te(L.tag,Vt(e,t+1,i),5)}function wc(e,t,n,i){return new te(L.tag,Wt(e,t+1,i),9)}function Ti(e,t){at(e,L.tag.majorEncoded,t.value)}Ti.compareTokens=jt.compareTokens;Ti.encodedSize=function(t){return at.encodedSize(t.value)};const kc=20,bc=21,Dc=22,Cc=23;function Pc(e,t,n,i){if(i.allowUndefined===!1)throw new Error(`${he} undefined values are not supported`);return i.coerceUndefinedToNull===!0?new te(L.null,null,1):new te(L.undefined,void 0,1)}function $c(e,t,n,i){if(i.allowIndefinite===!1)throw new Error(`${he} indefinite length items not allowed`);return new te(L.break,void 0,1)}function qi(e,t,n){if(n){if(n.allowNaN===!1&&Number.isNaN(e))throw new Error(`${he} NaN values are not supported`);if(n.allowInfinity===!1&&(e===1/0||e===-1/0))throw new Error(`${he} Infinity values are not supported`)}return new te(L.float,e,t)}function Tc(e,t,n,i){return qi(Si(e,t+1),3,i)}function qc(e,t,n,i){return qi(Ai(e,t+1),5,i)}function Mc(e,t,n,i){return qi(Lo(e,t+1),9,i)}function Mi(e,t,n){const i=t.value;if(i===!1)e.push([L.float.majorEncoded|kc]);else if(i===!0)e.push([L.float.majorEncoded|bc]);else if(i===null)e.push([L.float.majorEncoded|Dc]);else if(i===void 0)e.push([L.float.majorEncoded|Cc]);else{let o,s=!1;(!n||n.float64!==!0)&&(xo(i),o=Si(ct,1),i===o||Number.isNaN(i)?(ct[0]=249,e.push(ct.slice(0,3)),s=!0):(No(i),o=Ai(ct,1),i===o&&(ct[0]=250,e.push(ct.slice(0,5)),s=!0))),s||(Sc(i),o=Lo(ct,1),ct[0]=251,e.push(ct.slice(0,9)))}}Mi.encodedSize=function(t,n){const i=t.value;if(i===!1||i===!0||i===null||i===void 0)return 1;if(!n||n.float64!==!0){xo(i);let o=Si(ct,1);if(i===o||Number.isNaN(i))return 3;if(No(i),o=Ai(ct,1),i===o)return 5}return 9};const Uo=new ArrayBuffer(9),it=new DataView(Uo,1),ct=new Uint8Array(Uo,0);function xo(e){if(e===1/0)it.setUint16(0,31744,!1);else if(e===-1/0)it.setUint16(0,64512,!1);else if(Number.isNaN(e))it.setUint16(0,32256,!1);else{it.setFloat32(0,e);const t=it.getUint32(0),n=(t&2139095040)>>23,i=t&8388607;if(n===255)it.setUint16(0,31744,!1);else if(n===0)it.setUint16(0,(e&2147483648)>>16|i>>13,!1);else{const o=n-127;o<-24?it.setUint16(0,0):o<-14?it.setUint16(0,(t&2147483648)>>16|1<<24+o,!1):it.setUint16(0,(t&2147483648)>>16|o+15<<10|i>>13,!1)}}}function Si(e,t){if(e.length-t<2)throw new Error(`${he} not enough data for float16`);const n=(e[t]<<8)+e[t+1];if(n===31744)return 1/0;if(n===64512)return-1/0;if(n===32256)return NaN;const i=n>>10&31,o=n&1023;let s;return i===0?s=o*2**-24:i!==31?s=(o+1024)*2**(i-25):s=o===0?1/0:NaN,n&32768?-s:s}function No(e){it.setFloat32(0,e,!1)}function Ai(e,t){if(e.length-t<4)throw new Error(`${he} not enough data for float32`);const n=(e.byteOffset||0)+t;return new DataView(e.buffer,n,4).getFloat32(0,!1)}function Sc(e){it.setFloat64(0,e,!1)}function Lo(e,t){if(e.length-t<8)throw new Error(`${he} not enough data for float64`);const n=(e.byteOffset||0)+t;return new DataView(e.buffer,n,8).getFloat64(0,!1)}Mi.compareTokens=jt.compareTokens;function we(e,t,n){throw new Error(`${he} encountered invalid minor (${n}) for major ${e[t]>>>5}`)}function Qn(e){return()=>{throw new Error(`${he} ${e}`)}}const j=[];for(let e=0;e<=23;e++)j[e]=we;j[24]=Ll;j[25]=Bl;j[26]=Fl;j[27]=Ol;j[28]=we;j[29]=we;j[30]=we;j[31]=we;for(let e=32;e<=55;e++)j[e]=we;j[56]=zl;j[57]=Vl;j[58]=Wl;j[59]=jl;j[60]=we;j[61]=we;j[62]=we;j[63]=we;for(let e=64;e<=87;e++)j[e]=Ql;j[88]=Kl;j[89]=Hl;j[90]=Gl;j[91]=Xl;j[92]=we;j[93]=we;j[94]=we;j[95]=Qn("indefinite length bytes/strings are not supported");for(let e=96;e<=119;e++)j[e]=Yl;j[120]=Jl;j[121]=ec;j[122]=tc;j[123]=nc;j[124]=we;j[125]=we;j[126]=we;j[127]=Qn("indefinite length bytes/strings are not supported");for(let e=128;e<=151;e++)j[e]=oc;j[152]=sc;j[153]=ac;j[154]=rc;j[155]=lc;j[156]=we;j[157]=we;j[158]=we;j[159]=cc;for(let e=160;e<=183;e++)j[e]=uc;j[184]=dc;j[185]=fc;j[186]=hc;j[187]=mc;j[188]=we;j[189]=we;j[190]=we;j[191]=gc;for(let e=192;e<=215;e++)j[e]=pc;j[216]=vc;j[217]=yc;j[218]=_c;j[219]=wc;j[220]=we;j[221]=we;j[222]=we;j[223]=we;for(let e=224;e<=243;e++)j[e]=Qn("simple values are not supported");j[244]=we;j[245]=we;j[246]=we;j[247]=Pc;j[248]=Qn("simple values are not supported");j[249]=Tc;j[250]=qc;j[251]=Mc;j[252]=we;j[253]=we;j[254]=we;j[255]=$c;const pt=[];for(let e=0;e<24;e++)pt[e]=new te(L.uint,e,1);for(let e=-1;e>=-24;e--)pt[31-e]=new te(L.negint,e,1);pt[64]=new te(L.bytes,new Uint8Array(0),1);pt[96]=new te(L.string,"",1);pt[128]=new te(L.array,0,1);pt[160]=new te(L.map,0,1);pt[244]=new te(L.false,!1,1);pt[245]=new te(L.true,!0,1);pt[246]=new te(L.null,null,1);function Ac(e){switch(e.type){case L.false:return yt([244]);case L.true:return yt([245]);case L.null:return yt([246]);case L.bytes:return e.value.length?void 0:yt([64]);case L.string:return e.value===""?yt([96]):void 0;case L.array:return e.value===0?yt([128]):void 0;case L.map:return e.value===0?yt([160]):void 0;case L.uint:return e.value<24?yt([Number(e.value)]):void 0;case L.negint:if(e.value>=-24)return yt([31-Number(e.value)])}}const Ic={float64:!1,mapSorter:Uc,quickEncodeToken:Ac};function Ec(){const e=[];return e[L.uint.major]=jt,e[L.negint.major]=Ci,e[L.bytes.major]=jn,e[L.string.major]=ic,e[L.array.major]=Pi,e[L.map.major]=$i,e[L.tag.major]=Ti,e[L.float.major]=Mi,e}const Bo=Ec(),ii=new Io;class Ln{constructor(t,n){this.obj=t,this.parent=n}includes(t){let n=this;do if(n.obj===t)return!0;while(n=n.parent);return!1}static createCheck(t,n){if(t&&t.includes(n))throw new Error(`${Eo} object contains circular references`);return new Ln(n,t)}}const Pt={null:new te(L.null,null),undefined:new te(L.undefined,void 0),true:new te(L.true,!0),false:new te(L.false,!1),emptyArray:new te(L.array,0),emptyMap:new te(L.map,0)},It={number(e,t,n,i){return!Number.isInteger(e)||!Number.isSafeInteger(e)?new te(L.float,e):e>=0?new te(L.uint,e):new te(L.negint,e)},bigint(e,t,n,i){return e>=BigInt(0)?new te(L.uint,e):new te(L.negint,e)},Uint8Array(e,t,n,i){return new te(L.bytes,e)},string(e,t,n,i){return new te(L.string,e)},boolean(e,t,n,i){return e?Pt.true:Pt.false},null(e,t,n,i){return Pt.null},undefined(e,t,n,i){return Pt.undefined},ArrayBuffer(e,t,n,i){return new te(L.bytes,new Uint8Array(e))},DataView(e,t,n,i){return new te(L.bytes,new Uint8Array(e.buffer,e.byteOffset,e.byteLength))},Array(e,t,n,i){if(!e.length)return n.addBreakTokens===!0?[Pt.emptyArray,new te(L.break)]:Pt.emptyArray;i=Ln.createCheck(i,e);const o=[];let s=0;for(const a of e)o[s++]=Rn(a,n,i);return n.addBreakTokens?[new te(L.array,e.length),o,new te(L.break)]:[new te(L.array,e.length),o]},Object(e,t,n,i){const o=t!=="Object",s=o?e.keys():Object.keys(e),a=o?e.size:s.length;if(!a)return n.addBreakTokens===!0?[Pt.emptyMap,new te(L.break)]:Pt.emptyMap;i=Ln.createCheck(i,e);const r=[];let l=0;for(const g of s)r[l++]=[Rn(g,n,i),Rn(o?e.get(g):e[g],n,i)];return Rc(r,n),n.addBreakTokens?[new te(L.map,a),r,new te(L.break)]:[new te(L.map,a),r]}};It.Map=It.Object;It.Buffer=It.Uint8Array;for(const e of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))It[`${e}Array`]=It.DataView;function Rn(e,t={},n){const i=$l(e),o=t&&t.typeEncoders&&t.typeEncoders[i]||It[i];if(typeof o=="function"){const a=o(e,i,t,n);if(a!=null)return a}const s=It[i];if(!s)throw new Error(`${Eo} unsupported type: ${i}`);return s(e,i,t,n)}function Rc(e,t){t.mapSorter&&e.sort(t.mapSorter)}function Uc(e,t){const n=Array.isArray(e[0])?e[0][0]:e[0],i=Array.isArray(t[0])?t[0][0]:t[0];if(n.type!==i.type)return n.type.compare(i.type);const o=n.type.major,s=Bo[o].compareTokens(n,i);return s===0&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone"),s}function Fo(e,t,n,i){if(Array.isArray(t))for(const o of t)Fo(e,o,n,i);else n[t.type.major](e,t,i)}function xc(e,t,n){const i=Rn(e,n);if(!Array.isArray(i)&&n.quickEncodeToken){const o=n.quickEncodeToken(i);if(o)return o;const s=t[i.type.major];if(s.encodedSize){const a=s.encodedSize(i,n),r=new Io(a);if(s(r,i,n),r.chunks.length!==1)throw new Error(`Unexpected error: pre-calculated length for ${i} was wrong`);return Ao(r.chunks[0])}}return ii.reset(),Fo(ii,i,t,n),ii.toBytes(!0)}function Nc(e,t){return t=Object.assign({},Ic,t),xc(e,Bo,t)}const Lc={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0};class Bc{constructor(t,n={}){this._pos=0,this.data=t,this.options=n}pos(){return this._pos}done(){return this._pos>=this.data.length}next(){const t=this.data[this._pos];let n=pt[t];if(n===void 0){const i=j[t];if(!i)throw new Error(`${he} no decoder for major type ${t>>>5} (byte 0x${t.toString(16).padStart(2,"0")})`);const o=t&31;n=i(this.data,this._pos,o,this.options)}return this._pos+=n.encodedLength,n}}const fn=Symbol.for("DONE"),Kn=Symbol.for("BREAK");function Fc(e,t,n){const i=[];for(let o=0;o<e.value;o++){const s=hn(t,n);if(s===Kn){if(e.value===1/0)break;throw new Error(`${he} got unexpected break to lengthed array`)}if(s===fn)throw new Error(`${he} found array but not enough entries (got ${o}, expected ${e.value})`);i[o]=s}return i}function Oc(e,t,n){const i=n.useMaps===!0,o=i?void 0:{},s=i?new Map:void 0;for(let a=0;a<e.value;a++){const r=hn(t,n);if(r===Kn){if(e.value===1/0)break;throw new Error(`${he} got unexpected break to lengthed map`)}if(r===fn)throw new Error(`${he} found map but not enough entries (got ${a} [no key], expected ${e.value})`);if(i!==!0&&typeof r!="string")throw new Error(`${he} non-string keys not supported (got ${typeof r})`);if(n.rejectDuplicateMapKeys===!0&&(i&&s.has(r)||!i&&r in o))throw new Error(`${he} found repeat map key "${r}"`);const l=hn(t,n);if(l===fn)throw new Error(`${he} found map but not enough entries (got ${a} [no value], expected ${e.value})`);i?s.set(r,l):o[r]=l}return i?s:o}function hn(e,t){if(e.done())return fn;const n=e.next();if(n.type===L.break)return Kn;if(n.type.terminal)return n.value;if(n.type===L.array)return Fc(n,e,t);if(n.type===L.map)return Oc(n,e,t);if(n.type===L.tag){if(t.tags&&typeof t.tags[n.value]=="function"){const i=hn(e,t);return t.tags[n.value](i)}throw new Error(`${he} tag not supported (${n.value})`)}throw new Error("unsupported")}function zc(e,t){if(!(e instanceof Uint8Array))throw new Error(`${he} data to decode must be a Uint8Array`);t=Object.assign({},Lc,t);const n=t.tokenizer||new Bc(e,t),i=hn(n,t);if(i===fn)throw new Error(`${he} did not find any content to decode`);if(i===Kn)throw new Error(`${he} got unexpected break`);return[i,e.subarray(n.pos())]}function Vc(e,t){const[n,i]=zc(e,t);if(i.length>0)throw new Error(`${he} too many terminals, data makes no sense`);return n}var Oo=function(e){return Ie.Buffer.from(Nc(e))},zo=function(e){return Vc(Ie.Buffer.isBuffer(e)?e:Ie.Buffer.from(e,"hex"))},Un=function(){function e(t,n){if(n===void 0&&(n="bytes"),this._cborPayload=t,this._type=n,!En(this._type))throw new Po}return e.fromBuffer=function(t){return new e(Oo(t))},e.from=function(t){return e.fromBuffer(Ie.Buffer.from(t))},e.prototype.decodeCBOR=function(){return zo(this._cborPayload)},Object.defineProperty(e.prototype,"type",{get:function(){return this._type},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cbor",{get:function(){return this._cborPayload},enumerable:!1,configurable:!0}),e.prototype.equals=function(t){return this.type===t.type&&this.cbor.equals(t.cbor)},e}(),Wc=/^-?(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?$/i,oi=Math.ceil,tt=Math.floor,Ye="[BigNumber Error] ",Gi=Ye+"Number primitive has more than 15 significant digits: ",lt=1e14,se=14,si=9007199254740991,ai=[1,10,100,1e3,1e4,1e5,1e6,1e7,1e8,1e9,1e10,1e11,1e12,1e13],$t=1e7,ze=1e9;function Vo(e){var t,n,i,o=A.prototype={constructor:A,toString:null,valueOf:null},s=new A(1),a=20,r=4,l=-7,g=21,y=-1e7,D=1e7,_=!1,q=1,I=0,R={prefix:"",groupSize:3,secondaryGroupSize:0,groupSeparator:",",decimalSeparator:".",fractionGroupSize:0,fractionGroupSeparator:"\xA0",suffix:""},W="0123456789abcdefghijklmnopqrstuvwxyz",K=!0;function A(d,h){var p,T,v,w,P,k,C,M,$=this;if(!($ instanceof A))return new A(d,h);if(h==null){if(d&&d._isBigNumber===!0){$.s=d.s,!d.c||d.e>D?$.c=$.e=null:d.e<y?$.c=[$.e=0]:($.e=d.e,$.c=d.c.slice());return}if((k=typeof d=="number")&&d*0==0){if($.s=1/d<0?(d=-d,-1):1,d===~~d){for(w=0,P=d;P>=10;P/=10,w++);w>D?$.c=$.e=null:($.e=w,$.c=[d]);return}M=String(d)}else{if(!Wc.test(M=String(d)))return i($,M,k);$.s=M.charCodeAt(0)==45?(M=M.slice(1),-1):1}(w=M.indexOf("."))>-1&&(M=M.replace(".","")),(P=M.search(/e/i))>0?(w<0&&(w=P),w+=+M.slice(P+1),M=M.substring(0,P)):w<0&&(w=M.length)}else{if(Ue(h,2,W.length,"Base"),h==10&&K)return $=new A(d),fe($,a+$.e+1,r);if(M=String(d),k=typeof d=="number"){if(d*0!=0)return i($,M,k,h);if($.s=1/d<0?(M=M.slice(1),-1):1,A.DEBUG&&M.replace(/^0\.0*|\./,"").length>15)throw Error(Gi+d)}else $.s=M.charCodeAt(0)===45?(M=M.slice(1),-1):1;for(p=W.slice(0,h),w=P=0,C=M.length;P<C;P++)if(p.indexOf(T=M.charAt(P))<0){if(T=="."){if(P>w){w=C;continue}}else if(!v&&(M==M.toUpperCase()&&(M=M.toLowerCase())||M==M.toLowerCase()&&(M=M.toUpperCase()))){v=!0,P=-1,w=0;continue}return i($,String(d),k,h)}k=!1,M=n(M,h,10,$.s),(w=M.indexOf("."))>-1?M=M.replace(".",""):w=M.length}for(P=0;M.charCodeAt(P)===48;P++);for(C=M.length;M.charCodeAt(--C)===48;);if(M=M.slice(P,++C)){if(C-=P,k&&A.DEBUG&&C>15&&(d>si||d!==tt(d)))throw Error(Gi+$.s*d);if((w=w-P-1)>D)$.c=$.e=null;else if(w<y)$.c=[$.e=0];else{if($.e=w,$.c=[],P=(w+1)%se,w<0&&(P+=se),P<C){for(P&&$.c.push(+M.slice(0,P)),C-=se;P<C;)$.c.push(+M.slice(P,P+=se));P=se-(M=M.slice(P)).length}else P-=C;for(;P--;M+="0");$.c.push(+M)}}else $.c=[$.e=0]}A.clone=Vo,A.ROUND_UP=0,A.ROUND_DOWN=1,A.ROUND_CEIL=2,A.ROUND_FLOOR=3,A.ROUND_HALF_UP=4,A.ROUND_HALF_DOWN=5,A.ROUND_HALF_EVEN=6,A.ROUND_HALF_CEIL=7,A.ROUND_HALF_FLOOR=8,A.EUCLID=9,A.config=A.set=function(d){var h,p;if(d!=null)if(typeof d=="object"){if(d.hasOwnProperty(h="DECIMAL_PLACES")&&(p=d[h],Ue(p,0,ze,h),a=p),d.hasOwnProperty(h="ROUNDING_MODE")&&(p=d[h],Ue(p,0,8,h),r=p),d.hasOwnProperty(h="EXPONENTIAL_AT")&&(p=d[h],p&&p.pop?(Ue(p[0],-ze,0,h),Ue(p[1],0,ze,h),l=p[0],g=p[1]):(Ue(p,-ze,ze,h),l=-(g=p<0?-p:p))),d.hasOwnProperty(h="RANGE"))if(p=d[h],p&&p.pop)Ue(p[0],-ze,-1,h),Ue(p[1],1,ze,h),y=p[0],D=p[1];else if(Ue(p,-ze,ze,h),p)y=-(D=p<0?-p:p);else throw Error(Ye+h+" cannot be zero: "+p);if(d.hasOwnProperty(h="CRYPTO"))if(p=d[h],p===!!p)if(p)if(typeof crypto<"u"&&crypto&&(crypto.getRandomValues||crypto.randomBytes))_=p;else throw _=!p,Error(Ye+"crypto unavailable");else _=p;else throw Error(Ye+h+" not true or false: "+p);if(d.hasOwnProperty(h="MODULO_MODE")&&(p=d[h],Ue(p,0,9,h),q=p),d.hasOwnProperty(h="POW_PRECISION")&&(p=d[h],Ue(p,0,ze,h),I=p),d.hasOwnProperty(h="FORMAT"))if(p=d[h],typeof p=="object")R=p;else throw Error(Ye+h+" not an object: "+p);if(d.hasOwnProperty(h="ALPHABET"))if(p=d[h],typeof p=="string"&&!/^.?$|[+\-.\s]|(.).*\1/.test(p))K=p.slice(0,10)=="0123456789",W=p;else throw Error(Ye+h+" invalid: "+p)}else throw Error(Ye+"Object expected: "+d);return{DECIMAL_PLACES:a,ROUNDING_MODE:r,EXPONENTIAL_AT:[l,g],RANGE:[y,D],CRYPTO:_,MODULO_MODE:q,POW_PRECISION:I,FORMAT:R,ALPHABET:W}},A.isBigNumber=function(d){if(!d||d._isBigNumber!==!0)return!1;if(!A.DEBUG)return!0;var h,p,T=d.c,v=d.e,w=d.s;e:if({}.toString.call(T)=="[object Array]"){if((w===1||w===-1)&&v>=-ze&&v<=ze&&v===tt(v)){if(T[0]===0){if(v===0&&T.length===1)return!0;break e}if(h=(v+1)%se,h<1&&(h+=se),String(T[0]).length==h){for(h=0;h<T.length;h++)if(p=T[h],p<0||p>=lt||p!==tt(p))break e;if(p!==0)return!0}}}else if(T===null&&v===null&&(w===null||w===1||w===-1))return!0;throw Error(Ye+"Invalid BigNumber: "+d)},A.maximum=A.max=function(){return X(arguments,-1)},A.minimum=A.min=function(){return X(arguments,1)},A.random=function(){var d=9007199254740992,h=Math.random()*d&2097151?function(){return tt(Math.random()*d)}:function(){return(Math.random()*1073741824|0)*8388608+(Math.random()*8388608|0)};return function(p){var T,v,w,P,k,C=0,M=[],$=new A(s);if(p==null?p=a:Ue(p,0,ze),P=oi(p/se),_)if(crypto.getRandomValues){for(T=crypto.getRandomValues(new Uint32Array(P*=2));C<P;)k=T[C]*131072+(T[C+1]>>>11),k>=9e15?(v=crypto.getRandomValues(new Uint32Array(2)),T[C]=v[0],T[C+1]=v[1]):(M.push(k%1e14),C+=2);C=P/2}else if(crypto.randomBytes){for(T=crypto.randomBytes(P*=7);C<P;)k=(T[C]&31)*281474976710656+T[C+1]*1099511627776+T[C+2]*4294967296+T[C+3]*16777216+(T[C+4]<<16)+(T[C+5]<<8)+T[C+6],k>=9e15?crypto.randomBytes(7).copy(T,C):(M.push(k%1e14),C+=7);C=P/7}else throw _=!1,Error(Ye+"crypto unavailable");if(!_)for(;C<P;)k=h(),k<9e15&&(M[C++]=k%1e14);for(P=M[--C],p%=se,P&&p&&(k=ai[se-p],M[C]=tt(P/k)*k);M[C]===0;M.pop(),C--);if(C<0)M=[w=0];else{for(w=-1;M[0]===0;M.splice(0,1),w-=se);for(C=1,k=M[0];k>=10;k/=10,C++);C<se&&(w-=se-C)}return $.e=w,$.c=M,$}}(),A.sum=function(){for(var d=1,h=arguments,p=new A(h[0]);d<h.length;)p=p.plus(h[d++]);return p},n=function(){var d="0123456789";function h(p,T,v,w){for(var P,k=[0],C,M=0,$=p.length;M<$;){for(C=k.length;C--;k[C]*=T);for(k[0]+=w.indexOf(p.charAt(M++)),P=0;P<k.length;P++)k[P]>v-1&&(k[P+1]==null&&(k[P+1]=0),k[P+1]+=k[P]/v|0,k[P]%=v)}return k.reverse()}return function(p,T,v,w,P){var k,C,M,$,U,Z,G,ae,Pe=p.indexOf("."),qe=a,de=r;for(Pe>=0&&($=I,I=0,p=p.replace(".",""),ae=new A(T),Z=ae.pow(p.length-Pe),I=$,ae.c=h(_t(et(Z.c),Z.e,"0"),10,v,d),ae.e=ae.c.length),G=h(p,T,v,P?(k=W,d):(k=d,W)),M=$=G.length;G[--$]==0;G.pop());if(!G[0])return k.charAt(0);if(Pe<0?--M:(Z.c=G,Z.e=M,Z.s=w,Z=t(Z,ae,qe,de,v),G=Z.c,U=Z.r,M=Z.e),C=M+qe+1,Pe=G[C],$=v/2,U=U||C<0||G[C+1]!=null,U=de<4?(Pe!=null||U)&&(de==0||de==(Z.s<0?3:2)):Pe>$||Pe==$&&(de==4||U||de==6&&G[C-1]&1||de==(Z.s<0?8:7)),C<1||!G[0])p=U?_t(k.charAt(1),-qe,k.charAt(0)):k.charAt(0);else{if(G.length=C,U)for(--v;++G[--C]>v;)G[C]=0,C||(++M,G=[1].concat(G));for($=G.length;!G[--$];);for(Pe=0,p="";Pe<=$;p+=k.charAt(G[Pe++]));p=_t(p,M,k.charAt(0))}return p}}(),t=function(){function d(T,v,w){var P,k,C,M,$=0,U=T.length,Z=v%$t,G=v/$t|0;for(T=T.slice();U--;)C=T[U]%$t,M=T[U]/$t|0,P=G*C+M*Z,k=Z*C+P%$t*$t+$,$=(k/w|0)+(P/$t|0)+G*M,T[U]=k%w;return $&&(T=[$].concat(T)),T}function h(T,v,w,P){var k,C;if(w!=P)C=w>P?1:-1;else for(k=C=0;k<w;k++)if(T[k]!=v[k]){C=T[k]>v[k]?1:-1;break}return C}function p(T,v,w,P){for(var k=0;w--;)T[w]-=k,k=T[w]<v[w]?1:0,T[w]=k*P+T[w]-v[w];for(;!T[0]&&T.length>1;T.splice(0,1));}return function(T,v,w,P,k){var C,M,$,U,Z,G,ae,Pe,qe,de,le,Fe,kt,bt,Dt,Ke,vt,We=T.s==v.s?1:-1,Me=T.c,be=v.c;if(!Me||!Me[0]||!be||!be[0])return new A(!T.s||!v.s||(Me?be&&Me[0]==be[0]:!be)?NaN:Me&&Me[0]==0||!be?We*0:We/0);for(Pe=new A(We),qe=Pe.c=[],M=T.e-v.e,We=w+M+1,k||(k=lt,M=nt(T.e/se)-nt(v.e/se),We=We/se|0),$=0;be[$]==(Me[$]||0);$++);if(be[$]>(Me[$]||0)&&M--,We<0)qe.push(1),U=!0;else{for(bt=Me.length,Ke=be.length,$=0,We+=2,Z=tt(k/(be[0]+1)),Z>1&&(be=d(be,Z,k),Me=d(Me,Z,k),Ke=be.length,bt=Me.length),kt=Ke,de=Me.slice(0,Ke),le=de.length;le<Ke;de[le++]=0);vt=be.slice(),vt=[0].concat(vt),Dt=be[0],be[1]>=k/2&&Dt++;do{if(Z=0,C=h(be,de,Ke,le),C<0){if(Fe=de[0],Ke!=le&&(Fe=Fe*k+(de[1]||0)),Z=tt(Fe/Dt),Z>1)for(Z>=k&&(Z=k-1),G=d(be,Z,k),ae=G.length,le=de.length;h(G,de,ae,le)==1;)Z--,p(G,Ke<ae?vt:be,ae,k),ae=G.length,C=1;else Z==0&&(C=Z=1),G=be.slice(),ae=G.length;if(ae<le&&(G=[0].concat(G)),p(de,G,le,k),le=de.length,C==-1)for(;h(be,de,Ke,le)<1;)Z++,p(de,Ke<le?vt:be,le,k),le=de.length}else C===0&&(Z++,de=[0]);qe[$++]=Z,de[0]?de[le++]=Me[kt]||0:(de=[Me[kt]],le=1)}while((kt++<bt||de[0]!=null)&&We--);U=de[0]!=null,qe[0]||qe.splice(0,1)}if(k==lt){for($=1,We=qe[0];We>=10;We/=10,$++);fe(Pe,w+(Pe.e=$+M*se-1)+1,P,U)}else Pe.e=M,Pe.r=+U;return Pe}}();function F(d,h,p,T){var v,w,P,k,C;if(p==null?p=r:Ue(p,0,8),!d.c)return d.toString();if(v=d.c[0],P=d.e,h==null)C=et(d.c),C=T==1||T==2&&(P<=l||P>=g)?Mn(C,P):_t(C,P,"0");else if(d=fe(new A(d),h,p),w=d.e,C=et(d.c),k=C.length,T==1||T==2&&(h<=w||w<=l)){for(;k<h;C+="0",k++);C=Mn(C,w)}else if(h-=P,C=_t(C,w,"0"),w+1>k){if(--h>0)for(C+=".";h--;C+="0");}else if(h+=w-k,h>0)for(w+1==k&&(C+=".");h--;C+="0");return d.s<0&&v?"-"+C:C}function X(d,h){for(var p,T,v=1,w=new A(d[0]);v<d.length;v++)T=new A(d[v]),(!T.s||(p=Et(w,T))===h||p===0&&w.s===h)&&(w=T);return w}function re(d,h,p){for(var T=1,v=h.length;!h[--v];h.pop());for(v=h[0];v>=10;v/=10,T++);return(p=T+p*se-1)>D?d.c=d.e=null:p<y?d.c=[d.e=0]:(d.e=p,d.c=h),d}i=function(){var d=/^(-?)0([xbo])(?=\w[\w.]*$)/i,h=/^([^.]+)\.$/,p=/^\.([^.]+)$/,T=/^-?(Infinity|NaN)$/,v=/^\s*\+(?=[\w.])|^\s+|\s+$/g;return function(w,P,k,C){var M,$=k?P:P.replace(v,"");if(T.test($))w.s=isNaN($)?null:$<0?-1:1;else{if(!k&&($=$.replace(d,function(U,Z,G){return M=(G=G.toLowerCase())=="x"?16:G=="b"?2:8,!C||C==M?Z:U}),C&&(M=C,$=$.replace(h,"$1").replace(p,"0.$1")),P!=$))return new A($,M);if(A.DEBUG)throw Error(Ye+"Not a"+(C?" base "+C:"")+" number: "+P);w.s=null}w.c=w.e=null}}();function fe(d,h,p,T){var v,w,P,k,C,M,$,U=d.c,Z=ai;if(U){e:{for(v=1,k=U[0];k>=10;k/=10,v++);if(w=h-v,w<0)w+=se,P=h,C=U[M=0],$=tt(C/Z[v-P-1]%10);else if(M=oi((w+1)/se),M>=U.length)if(T){for(;U.length<=M;U.push(0));C=$=0,v=1,w%=se,P=w-se+1}else break e;else{for(C=k=U[M],v=1;k>=10;k/=10,v++);w%=se,P=w-se+v,$=P<0?0:tt(C/Z[v-P-1]%10)}if(T=T||h<0||U[M+1]!=null||(P<0?C:C%Z[v-P-1]),T=p<4?($||T)&&(p==0||p==(d.s<0?3:2)):$>5||$==5&&(p==4||T||p==6&&(w>0?P>0?C/Z[v-P]:0:U[M-1])%10&1||p==(d.s<0?8:7)),h<1||!U[0])return U.length=0,T?(h-=d.e+1,U[0]=Z[(se-h%se)%se],d.e=-h||0):U[0]=d.e=0,d;if(w==0?(U.length=M,k=1,M--):(U.length=M+1,k=Z[se-w],U[M]=P>0?tt(C/Z[v-P]%Z[P])*k:0),T)for(;;)if(M==0){for(w=1,P=U[0];P>=10;P/=10,w++);for(P=U[0]+=k,k=1;P>=10;P/=10,k++);w!=k&&(d.e++,U[0]==lt&&(U[0]=1));break}else{if(U[M]+=k,U[M]!=lt)break;U[M--]=0,k=1}for(w=U.length;U[--w]===0;U.pop());}d.e>D?d.c=d.e=null:d.e<y&&(d.c=[d.e=0])}return d}function ye(d){var h,p=d.e;return p===null?d.toString():(h=et(d.c),h=p<=l||p>=g?Mn(h,p):_t(h,p,"0"),d.s<0?"-"+h:h)}return o.absoluteValue=o.abs=function(){var d=new A(this);return d.s<0&&(d.s=1),d},o.comparedTo=function(d,h){return Et(this,new A(d,h))},o.decimalPlaces=o.dp=function(d,h){var p,T,v,w=this;if(d!=null)return Ue(d,0,ze),h==null?h=r:Ue(h,0,8),fe(new A(w),d+w.e+1,h);if(!(p=w.c))return null;if(T=((v=p.length-1)-nt(this.e/se))*se,v=p[v])for(;v%10==0;v/=10,T--);return T<0&&(T=0),T},o.dividedBy=o.div=function(d,h){return t(this,new A(d,h),a,r)},o.dividedToIntegerBy=o.idiv=function(d,h){return t(this,new A(d,h),0,1)},o.exponentiatedBy=o.pow=function(d,h){var p,T,v,w,P,k,C,M,$,U=this;if(d=new A(d),d.c&&!d.isInteger())throw Error(Ye+"Exponent not an integer: "+ye(d));if(h!=null&&(h=new A(h)),k=d.e>14,!U.c||!U.c[0]||U.c[0]==1&&!U.e&&U.c.length==1||!d.c||!d.c[0])return $=new A(Math.pow(+ye(U),k?d.s*(2-qn(d)):+ye(d))),h?$.mod(h):$;if(C=d.s<0,h){if(h.c?!h.c[0]:!h.s)return new A(NaN);T=!C&&U.isInteger()&&h.isInteger(),T&&(U=U.mod(h))}else{if(d.e>9&&(U.e>0||U.e<-1||(U.e==0?U.c[0]>1||k&&U.c[1]>=24e7:U.c[0]<8e13||k&&U.c[0]<=9999975e7)))return w=U.s<0&&qn(d)?-0:0,U.e>-1&&(w=1/w),new A(C?1/w:w);I&&(w=oi(I/se+2))}for(k?(p=new A(.5),C&&(d.s=1),M=qn(d)):(v=Math.abs(+ye(d)),M=v%2),$=new A(s);;){if(M){if($=$.times(U),!$.c)break;w?$.c.length>w&&($.c.length=w):T&&($=$.mod(h))}if(v){if(v=tt(v/2),v===0)break;M=v%2}else if(d=d.times(p),fe(d,d.e+1,1),d.e>14)M=qn(d);else{if(v=+ye(d),v===0)break;M=v%2}U=U.times(U),w?U.c&&U.c.length>w&&(U.c.length=w):T&&(U=U.mod(h))}return T?$:(C&&($=s.div($)),h?$.mod(h):w?fe($,I,r,P):$)},o.integerValue=function(d){var h=new A(this);return d==null?d=r:Ue(d,0,8),fe(h,h.e+1,d)},o.isEqualTo=o.eq=function(d,h){return Et(this,new A(d,h))===0},o.isFinite=function(){return!!this.c},o.isGreaterThan=o.gt=function(d,h){return Et(this,new A(d,h))>0},o.isGreaterThanOrEqualTo=o.gte=function(d,h){return(h=Et(this,new A(d,h)))===1||h===0},o.isInteger=function(){return!!this.c&&nt(this.e/se)>this.c.length-2},o.isLessThan=o.lt=function(d,h){return Et(this,new A(d,h))<0},o.isLessThanOrEqualTo=o.lte=function(d,h){return(h=Et(this,new A(d,h)))===-1||h===0},o.isNaN=function(){return!this.s},o.isNegative=function(){return this.s<0},o.isPositive=function(){return this.s>0},o.isZero=function(){return!!this.c&&this.c[0]==0},o.minus=function(d,h){var p,T,v,w,P=this,k=P.s;if(d=new A(d,h),h=d.s,!k||!h)return new A(NaN);if(k!=h)return d.s=-h,P.plus(d);var C=P.e/se,M=d.e/se,$=P.c,U=d.c;if(!C||!M){if(!$||!U)return $?(d.s=-h,d):new A(U?P:NaN);if(!$[0]||!U[0])return U[0]?(d.s=-h,d):new A($[0]?P:r==3?-0:0)}if(C=nt(C),M=nt(M),$=$.slice(),k=C-M){for((w=k<0)?(k=-k,v=$):(M=C,v=U),v.reverse(),h=k;h--;v.push(0));v.reverse()}else for(T=(w=(k=$.length)<(h=U.length))?k:h,k=h=0;h<T;h++)if($[h]!=U[h]){w=$[h]<U[h];break}if(w&&(v=$,$=U,U=v,d.s=-d.s),h=(T=U.length)-(p=$.length),h>0)for(;h--;$[p++]=0);for(h=lt-1;T>k;){if($[--T]<U[T]){for(p=T;p&&!$[--p];$[p]=h);--$[p],$[T]+=lt}$[T]-=U[T]}for(;$[0]==0;$.splice(0,1),--M);return $[0]?re(d,$,M):(d.s=r==3?-1:1,d.c=[d.e=0],d)},o.modulo=o.mod=function(d,h){var p,T,v=this;return d=new A(d,h),!v.c||!d.s||d.c&&!d.c[0]?new A(NaN):!d.c||v.c&&!v.c[0]?new A(v):(q==9?(T=d.s,d.s=1,p=t(v,d,0,3),d.s=T,p.s*=T):p=t(v,d,0,q),d=v.minus(p.times(d)),!d.c[0]&&q==1&&(d.s=v.s),d)},o.multipliedBy=o.times=function(d,h){var p,T,v,w,P,k,C,M,$,U,Z,G,ae,Pe,qe,de=this,le=de.c,Fe=(d=new A(d,h)).c;if(!le||!Fe||!le[0]||!Fe[0])return!de.s||!d.s||le&&!le[0]&&!Fe||Fe&&!Fe[0]&&!le?d.c=d.e=d.s=null:(d.s*=de.s,!le||!Fe?d.c=d.e=null:(d.c=[0],d.e=0)),d;for(T=nt(de.e/se)+nt(d.e/se),d.s*=de.s,C=le.length,U=Fe.length,C<U&&(ae=le,le=Fe,Fe=ae,v=C,C=U,U=v),v=C+U,ae=[];v--;ae.push(0));for(Pe=lt,qe=$t,v=U;--v>=0;){for(p=0,Z=Fe[v]%qe,G=Fe[v]/qe|0,P=C,w=v+P;w>v;)M=le[--P]%qe,$=le[P]/qe|0,k=G*M+$*Z,M=Z*M+k%qe*qe+ae[w]+p,p=(M/Pe|0)+(k/qe|0)+G*$,ae[w--]=M%Pe;ae[w]=p}return p?++T:ae.splice(0,1),re(d,ae,T)},o.negated=function(){var d=new A(this);return d.s=-d.s||null,d},o.plus=function(d,h){var p,T=this,v=T.s;if(d=new A(d,h),h=d.s,!v||!h)return new A(NaN);if(v!=h)return d.s=-h,T.minus(d);var w=T.e/se,P=d.e/se,k=T.c,C=d.c;if(!w||!P){if(!k||!C)return new A(v/0);if(!k[0]||!C[0])return C[0]?d:new A(k[0]?T:v*0)}if(w=nt(w),P=nt(P),k=k.slice(),v=w-P){for(v>0?(P=w,p=C):(v=-v,p=k),p.reverse();v--;p.push(0));p.reverse()}for(v=k.length,h=C.length,v-h<0&&(p=C,C=k,k=p,h=v),v=0;h;)v=(k[--h]=k[h]+C[h]+v)/lt|0,k[h]=lt===k[h]?0:k[h]%lt;return v&&(k=[v].concat(k),++P),re(d,k,P)},o.precision=o.sd=function(d,h){var p,T,v,w=this;if(d!=null&&d!==!!d)return Ue(d,1,ze),h==null?h=r:Ue(h,0,8),fe(new A(w),d,h);if(!(p=w.c))return null;if(v=p.length-1,T=v*se+1,v=p[v]){for(;v%10==0;v/=10,T--);for(v=p[0];v>=10;v/=10,T++);}return d&&w.e+1>T&&(T=w.e+1),T},o.shiftedBy=function(d){return Ue(d,-si,si),this.times("1e"+d)},o.squareRoot=o.sqrt=function(){var d,h,p,T,v,w=this,P=w.c,k=w.s,C=w.e,M=a+4,$=new A("0.5");if(k!==1||!P||!P[0])return new A(!k||k<0&&(!P||P[0])?NaN:P?w:1/0);if(k=Math.sqrt(+ye(w)),k==0||k==1/0?(h=et(P),(h.length+C)%2==0&&(h+="0"),k=Math.sqrt(+h),C=nt((C+1)/2)-(C<0||C%2),k==1/0?h="5e"+C:(h=k.toExponential(),h=h.slice(0,h.indexOf("e")+1)+C),p=new A(h)):p=new A(k+""),p.c[0]){for(C=p.e,k=C+M,k<3&&(k=0);;)if(v=p,p=$.times(v.plus(t(w,v,M,1))),et(v.c).slice(0,k)===(h=et(p.c)).slice(0,k))if(p.e<C&&--k,h=h.slice(k-3,k+1),h=="9999"||!T&&h=="4999"){if(!T&&(fe(v,v.e+a+2,0),v.times(v).eq(w))){p=v;break}M+=4,k+=4,T=1}else{(!+h||!+h.slice(1)&&h.charAt(0)=="5")&&(fe(p,p.e+a+2,1),d=!p.times(p).eq(w));break}}return fe(p,p.e+a+1,r,d)},o.toExponential=function(d,h){return d!=null&&(Ue(d,0,ze),d++),F(this,d,h,1)},o.toFixed=function(d,h){return d!=null&&(Ue(d,0,ze),d=d+this.e+1),F(this,d,h)},o.toFormat=function(d,h,p){var T,v=this;if(p==null)d!=null&&h&&typeof h=="object"?(p=h,h=null):d&&typeof d=="object"?(p=d,d=h=null):p=R;else if(typeof p!="object")throw Error(Ye+"Argument not an object: "+p);if(T=v.toFixed(d,h),v.c){var w,P=T.split("."),k=+p.groupSize,C=+p.secondaryGroupSize,M=p.groupSeparator||"",$=P[0],U=P[1],Z=v.s<0,G=Z?$.slice(1):$,ae=G.length;if(C&&(w=k,k=C,C=w,ae-=w),k>0&&ae>0){for(w=ae%k||k,$=G.substr(0,w);w<ae;w+=k)$+=M+G.substr(w,k);C>0&&($+=M+G.slice(w)),Z&&($="-"+$)}T=U?$+(p.decimalSeparator||"")+((C=+p.fractionGroupSize)?U.replace(new RegExp("\\d{"+C+"}\\B","g"),"$&"+(p.fractionGroupSeparator||"")):U):$}return(p.prefix||"")+T+(p.suffix||"")},o.toFraction=function(d){var h,p,T,v,w,P,k,C,M,$,U,Z,G=this,ae=G.c;if(d!=null&&(k=new A(d),!k.isInteger()&&(k.c||k.s!==1)||k.lt(s)))throw Error(Ye+"Argument "+(k.isInteger()?"out of range: ":"not an integer: ")+ye(k));if(!ae)return new A(G);for(h=new A(s),M=p=new A(s),T=C=new A(s),Z=et(ae),w=h.e=Z.length-G.e-1,h.c[0]=ai[(P=w%se)<0?se+P:P],d=!d||k.comparedTo(h)>0?w>0?h:M:k,P=D,D=1/0,k=new A(Z),C.c[0]=0;$=t(k,h,0,1),v=p.plus($.times(T)),v.comparedTo(d)!=1;)p=T,T=v,M=C.plus($.times(v=M)),C=v,h=k.minus($.times(v=h)),k=v;return v=t(d.minus(p),T,0,1),C=C.plus(v.times(M)),p=p.plus(v.times(T)),C.s=M.s=G.s,w=w*2,U=t(M,T,w,r).minus(G).abs().comparedTo(t(C,p,w,r).minus(G).abs())<1?[M,T]:[C,p],D=P,U},o.toNumber=function(){return+ye(this)},o.toPrecision=function(d,h){return d!=null&&Ue(d,1,ze),F(this,d,h,2)},o.toString=function(d){var h,p=this,T=p.s,v=p.e;return v===null?T?(h="Infinity",T<0&&(h="-"+h)):h="NaN":(d==null?h=v<=l||v>=g?Mn(et(p.c),v):_t(et(p.c),v,"0"):d===10&&K?(p=fe(new A(p),a+v+1,r),h=_t(et(p.c),p.e,"0")):(Ue(d,2,W.length,"Base"),h=n(_t(et(p.c),v,"0"),10,d,T,!0)),T<0&&p.c[0]&&(h="-"+h)),h},o.valueOf=o.toJSON=function(){return ye(this)},o._isBigNumber=!0,o[Symbol.toStringTag]="BigNumber",o[Symbol.for("nodejs.util.inspect.custom")]=o.valueOf,e!=null&&A.set(e),A}function nt(e){var t=e|0;return e>0||e===t?t:t-1}function et(e){for(var t,n,i=1,o=e.length,s=e[0]+"";i<o;){for(t=e[i++]+"",n=se-t.length;n--;t="0"+t);s+=t}for(o=s.length;s.charCodeAt(--o)===48;);return s.slice(0,o+1||1)}function Et(e,t){var n,i,o=e.c,s=t.c,a=e.s,r=t.s,l=e.e,g=t.e;if(!a||!r)return null;if(n=o&&!o[0],i=s&&!s[0],n||i)return n?i?0:-r:a;if(a!=r)return a;if(n=a<0,i=l==g,!o||!s)return i?0:!o^n?1:-1;if(!i)return l>g^n?1:-1;for(r=(l=o.length)<(g=s.length)?l:g,a=0;a<r;a++)if(o[a]!=s[a])return o[a]>s[a]^n?1:-1;return l==g?0:l>g^n?1:-1}function Ue(e,t,n,i){if(e<t||e>n||e!==tt(e))throw Error(Ye+(i||"Argument")+(typeof e=="number"?e<t||e>n?" out of range: ":" not an integer: ":" not a primitive number: ")+String(e))}function qn(e){var t=e.c.length-1;return nt(e.e/se)==t&&e.c[t]%2!=0}function Mn(e,t){return(e.length>1?e.charAt(0)+"."+e.slice(1):e)+(t<0?"e":"e+")+t}function _t(e,t,n){var i,o;if(t<0){for(o=n+".";++t;o+=n);e=o+e}else if(i=e.length,++t>i){for(o=n,t-=i;--t;o+=n);e+=o}else t<i&&(e=e.slice(0,t)+"."+e.slice(t));return e}var Xi=Vo();class u extends Array{constructor(t,n){if(t>u.__kMaxLength)throw new RangeError("Maximum BigInt size exceeded");super(t),this.sign=n}static BigInt(t){var n=Math.floor,i=Number.isFinite;if(typeof t=="number"){if(t===0)return u.__zero();if((0|t)===t)return 0>t?u.__oneDigit(-t,!0):u.__oneDigit(t,!1);if(!i(t)||n(t)!==t)throw new RangeError("The number "+t+" cannot be converted to BigInt because it is not an integer");return u.__fromDouble(t)}if(typeof t=="string"){const o=u.__fromString(t);if(o===null)throw new SyntaxError("Cannot convert "+t+" to a BigInt");return o}if(typeof t=="boolean")return t===!0?u.__oneDigit(1,!1):u.__zero();if(typeof t=="object"){if(t.constructor===u)return t;const o=u.__toPrimitive(t);return u.BigInt(o)}throw new TypeError("Cannot convert "+t+" to a BigInt")}toDebugString(){const t=["BigInt["];for(const n of this)t.push((n&&(n>>>0).toString(16))+", ");return t.push("]"),t.join("")}toString(t=10){if(2>t||36<t)throw new RangeError("toString() radix argument must be between 2 and 36");return this.length===0?"0":(t&t-1)==0?u.__toStringBasePowerOfTwo(this,t):u.__toStringGeneric(this,t,!1)}static toNumber(t){const n=t.length;if(n===0)return 0;if(n===1){const W=t.__unsignedDigit(0);return t.sign?-W:W}const i=t.__digit(n-1),o=u.__clz32(i),s=32*n-o;if(1024<s)return t.sign?-1/0:1/0;let a=s-1,r=i,l=n-1;const g=o+1;let y=g===32?0:r<<g;y>>>=12;const D=g-12;let _=12<=g?0:r<<20+g,q=20+g;0<D&&0<l&&(l--,r=t.__digit(l),y|=r>>>32-D,_=r<<D,q=D),0<q&&0<l&&(l--,r=t.__digit(l),_|=r>>>32-q,q-=32);const I=u.__decideRounding(t,q,l,r);if((I===1||I===0&&(1&_)==1)&&(_=_+1>>>0,_===0&&(y++,y>>>20!=0&&(y=0,a++,1023<a))))return t.sign?-1/0:1/0;const R=t.sign?-2147483648:0;return a=a+1023<<20,u.__kBitConversionInts[1]=R|a|y,u.__kBitConversionInts[0]=_,u.__kBitConversionDouble[0]}static unaryMinus(t){if(t.length===0)return t;const n=t.__copy();return n.sign=!t.sign,n}static bitwiseNot(t){return t.sign?u.__absoluteSubOne(t).__trim():u.__absoluteAddOne(t,!0)}static exponentiate(t,n){if(n.sign)throw new RangeError("Exponent must be positive");if(n.length===0)return u.__oneDigit(1,!1);if(t.length===0)return t;if(t.length===1&&t.__digit(0)===1)return t.sign&&(1&n.__digit(0))==0?u.unaryMinus(t):t;if(1<n.length)throw new RangeError("BigInt too big");let i=n.__unsignedDigit(0);if(i===1)return t;if(i>=u.__kMaxLengthBits)throw new RangeError("BigInt too big");if(t.length===1&&t.__digit(0)===2){const a=1+(i>>>5),r=t.sign&&(1&i)!=0,l=new u(a,r);l.__initializeDigits();const g=1<<(31&i);return l.__setDigit(a-1,g),l}let o=null,s=t;for((1&i)!=0&&(o=t),i>>=1;i!==0;i>>=1)s=u.multiply(s,s),(1&i)!=0&&(o===null?o=s:o=u.multiply(o,s));return o}static multiply(t,n){if(t.length===0)return t;if(n.length===0)return n;let i=t.length+n.length;32<=t.__clzmsd()+n.__clzmsd()&&i--;const o=new u(i,t.sign!==n.sign);o.__initializeDigits();for(let s=0;s<t.length;s++)u.__multiplyAccumulate(n,t.__digit(s),o,s);return o.__trim()}static divide(t,n){if(n.length===0)throw new RangeError("Division by zero");if(0>u.__absoluteCompare(t,n))return u.__zero();const i=t.sign!==n.sign,o=n.__unsignedDigit(0);let s;if(n.length===1&&65535>=o){if(o===1)return i===t.sign?t:u.unaryMinus(t);s=u.__absoluteDivSmall(t,o,null)}else s=u.__absoluteDivLarge(t,n,!0,!1);return s.sign=i,s.__trim()}static remainder(t,n){if(n.length===0)throw new RangeError("Division by zero");if(0>u.__absoluteCompare(t,n))return t;const i=n.__unsignedDigit(0);if(n.length===1&&65535>=i){if(i===1)return u.__zero();const s=u.__absoluteModSmall(t,i);return s===0?u.__zero():u.__oneDigit(s,t.sign)}const o=u.__absoluteDivLarge(t,n,!1,!0);return o.sign=t.sign,o.__trim()}static add(t,n){const i=t.sign;return i===n.sign?u.__absoluteAdd(t,n,i):0<=u.__absoluteCompare(t,n)?u.__absoluteSub(t,n,i):u.__absoluteSub(n,t,!i)}static subtract(t,n){const i=t.sign;return i===n.sign?0<=u.__absoluteCompare(t,n)?u.__absoluteSub(t,n,i):u.__absoluteSub(n,t,!i):u.__absoluteAdd(t,n,i)}static leftShift(t,n){return n.length===0||t.length===0?t:n.sign?u.__rightShiftByAbsolute(t,n):u.__leftShiftByAbsolute(t,n)}static signedRightShift(t,n){return n.length===0||t.length===0?t:n.sign?u.__leftShiftByAbsolute(t,n):u.__rightShiftByAbsolute(t,n)}static unsignedRightShift(){throw new TypeError("BigInts have no unsigned right shift; use >> instead")}static lessThan(t,n){return 0>u.__compareToBigInt(t,n)}static lessThanOrEqual(t,n){return 0>=u.__compareToBigInt(t,n)}static greaterThan(t,n){return 0<u.__compareToBigInt(t,n)}static greaterThanOrEqual(t,n){return 0<=u.__compareToBigInt(t,n)}static equal(t,n){if(t.sign!==n.sign||t.length!==n.length)return!1;for(let i=0;i<t.length;i++)if(t.__digit(i)!==n.__digit(i))return!1;return!0}static notEqual(t,n){return!u.equal(t,n)}static bitwiseAnd(t,n){var i=Math.max;if(!t.sign&&!n.sign)return u.__absoluteAnd(t,n).__trim();if(t.sign&&n.sign){const o=i(t.length,n.length)+1;let s=u.__absoluteSubOne(t,o);const a=u.__absoluteSubOne(n);return s=u.__absoluteOr(s,a,s),u.__absoluteAddOne(s,!0,s).__trim()}return t.sign&&([t,n]=[n,t]),u.__absoluteAndNot(t,u.__absoluteSubOne(n)).__trim()}static bitwiseXor(t,n){var i=Math.max;if(!t.sign&&!n.sign)return u.__absoluteXor(t,n).__trim();if(t.sign&&n.sign){const a=i(t.length,n.length),r=u.__absoluteSubOne(t,a),l=u.__absoluteSubOne(n);return u.__absoluteXor(r,l,r).__trim()}const o=i(t.length,n.length)+1;t.sign&&([t,n]=[n,t]);let s=u.__absoluteSubOne(n,o);return s=u.__absoluteXor(s,t,s),u.__absoluteAddOne(s,!0,s).__trim()}static bitwiseOr(t,n){var i=Math.max;const o=i(t.length,n.length);if(!t.sign&&!n.sign)return u.__absoluteOr(t,n).__trim();if(t.sign&&n.sign){let a=u.__absoluteSubOne(t,o);const r=u.__absoluteSubOne(n);return a=u.__absoluteAnd(a,r,a),u.__absoluteAddOne(a,!0,a).__trim()}t.sign&&([t,n]=[n,t]);let s=u.__absoluteSubOne(n,o);return s=u.__absoluteAndNot(s,t,s),u.__absoluteAddOne(s,!0,s).__trim()}static asIntN(t,n){if(n.length===0)return n;if(t===0)return u.__zero();if(t>=u.__kMaxLengthBits)return n;const i=t+31>>>5;if(n.length<i)return n;const o=n.__unsignedDigit(i-1),s=1<<(31&t-1);if(n.length===i&&o<s)return n;if((o&s)!==s)return u.__truncateToNBits(t,n);if(!n.sign)return u.__truncateAndSubFromPowerOfTwo(t,n,!0);if((o&s-1)==0){for(let a=i-2;0<=a;a--)if(n.__digit(a)!==0)return u.__truncateAndSubFromPowerOfTwo(t,n,!1);return n.length===i&&o===s?n:u.__truncateToNBits(t,n)}return u.__truncateAndSubFromPowerOfTwo(t,n,!1)}static asUintN(t,n){if(n.length===0)return n;if(t===0)return u.__zero();if(n.sign){if(t>u.__kMaxLengthBits)throw new RangeError("BigInt too big");return u.__truncateAndSubFromPowerOfTwo(t,n,!1)}if(t>=u.__kMaxLengthBits)return n;const i=t+31>>>5;if(n.length<i)return n;const o=31&t;return n.length==i&&(o===0||n.__digit(i-1)>>>o==0)?n:u.__truncateToNBits(t,n)}static ADD(t,n){if(t=u.__toPrimitive(t),n=u.__toPrimitive(n),typeof t=="string")return typeof n!="string"&&(n=n.toString()),t+n;if(typeof n=="string")return t.toString()+n;if(t=u.__toNumeric(t),n=u.__toNumeric(n),u.__isBigInt(t)&&u.__isBigInt(n))return u.add(t,n);if(typeof t=="number"&&typeof n=="number")return t+n;throw new TypeError("Cannot mix BigInt and other types, use explicit conversions")}static LT(t,n){return u.__compare(t,n,0)}static LE(t,n){return u.__compare(t,n,1)}static GT(t,n){return u.__compare(t,n,2)}static GE(t,n){return u.__compare(t,n,3)}static EQ(t,n){for(;;){if(u.__isBigInt(t))return u.__isBigInt(n)?u.equal(t,n):u.EQ(n,t);if(typeof t=="number"){if(u.__isBigInt(n))return u.__equalToNumber(n,t);if(typeof n!="object")return t==n;n=u.__toPrimitive(n)}else if(typeof t=="string"){if(u.__isBigInt(n))return t=u.__fromString(t),t!==null&&u.equal(t,n);if(typeof n!="object")return t==n;n=u.__toPrimitive(n)}else if(typeof t=="boolean"){if(u.__isBigInt(n))return u.__equalToNumber(n,+t);if(typeof n!="object")return t==n;n=u.__toPrimitive(n)}else if(typeof t=="symbol"){if(u.__isBigInt(n))return!1;if(typeof n!="object")return t==n;n=u.__toPrimitive(n)}else if(typeof t=="object"){if(typeof n=="object"&&n.constructor!==u)return t==n;t=u.__toPrimitive(t)}else return t==n}}static NE(t,n){return!u.EQ(t,n)}static __zero(){return new u(0,!1)}static __oneDigit(t,n){const i=new u(1,n);return i.__setDigit(0,t),i}__copy(){const t=new u(this.length,this.sign);for(let n=0;n<this.length;n++)t[n]=this[n];return t}__trim(){let t=this.length,n=this[t-1];for(;n===0;)t--,n=this[t-1],this.pop();return t===0&&(this.sign=!1),this}__initializeDigits(){for(let t=0;t<this.length;t++)this[t]=0}static __decideRounding(t,n,i,o){if(0<n)return-1;let s;if(0>n)s=-n-1;else{if(i===0)return-1;i--,o=t.__digit(i),s=31}let a=1<<s;if((o&a)==0)return-1;if(a-=1,(o&a)!=0)return 1;for(;0<i;)if(i--,t.__digit(i)!==0)return 1;return 0}static __fromDouble(t){u.__kBitConversionDouble[0]=t;const n=2047&u.__kBitConversionInts[1]>>>20,i=n-1023,o=(i>>>5)+1,s=new u(o,0>t);let a=1048575&u.__kBitConversionInts[1]|1048576,r=u.__kBitConversionInts[0];const l=20,g=31&i;let y,D=0;if(g<20){const _=l-g;D=_+32,y=a>>>_,a=a<<32-_|r>>>_,r<<=32-_}else if(g===20)D=32,y=a,a=r;else{const _=g-l;D=32-_,y=a<<_|r>>>32-_,a=r<<_}s.__setDigit(o-1,y);for(let _=o-2;0<=_;_--)0<D?(D-=32,y=a,a=r):y=0,s.__setDigit(_,y);return s.__trim()}static __isWhitespace(t){return 13>=t&&9<=t||(159>=t?t==32:131071>=t?t==160||t==5760:196607>=t?(t&=131071,10>=t||t==40||t==41||t==47||t==95||t==4096):t==65279)}static __fromString(t,n=0){let i=0;const o=t.length;let s=0;if(s===o)return u.__zero();let a=t.charCodeAt(s);for(;u.__isWhitespace(a);){if(++s===o)return u.__zero();a=t.charCodeAt(s)}if(a===43){if(++s===o)return null;a=t.charCodeAt(s),i=1}else if(a===45){if(++s===o)return null;a=t.charCodeAt(s),i=-1}if(n===0){if(n=10,a===48){if(++s===o)return u.__zero();if(a=t.charCodeAt(s),a===88||a===120){if(n=16,++s===o)return null;a=t.charCodeAt(s)}else if(a===79||a===111){if(n=8,++s===o)return null;a=t.charCodeAt(s)}else if(a===66||a===98){if(n=2,++s===o)return null;a=t.charCodeAt(s)}}}else if(n===16&&a===48){if(++s===o)return u.__zero();if(a=t.charCodeAt(s),a===88||a===120){if(++s===o)return null;a=t.charCodeAt(s)}}for(;a===48;){if(++s===o)return u.__zero();a=t.charCodeAt(s)}const r=o-s;let l=u.__kMaxBitsPerChar[n],g=u.__kBitsPerCharTableMultiplier-1;if(r>1073741824/l)return null;const y=l*r+g>>>u.__kBitsPerCharTableShift,D=new u(y+31>>>5,!1),_=10>n?n:10,q=10<n?n-10:0;if((n&n-1)==0){l>>=u.__kBitsPerCharTableShift;const I=[],R=[];let W=!1;do{let K=0,A=0;for(;;){let F;if(a-48>>>0<_)F=a-48;else if((32|a)-97>>>0<q)F=(32|a)-87;else{W=!0;break}if(A+=l,K=K<<l|F,++s===o){W=!0;break}if(a=t.charCodeAt(s),32<A+l)break}I.push(K),R.push(A)}while(!W);u.__fillFromParts(D,I,R)}else{D.__initializeDigits();let I=!1,R=0;do{let W=0,K=1;for(;;){let F;if(a-48>>>0<_)F=a-48;else if((32|a)-97>>>0<q)F=(32|a)-87;else{I=!0;break}const X=K*n;if(4294967295<X)break;if(K=X,W=W*n+F,R++,++s===o){I=!0;break}a=t.charCodeAt(s)}g=32*u.__kBitsPerCharTableMultiplier-1;const A=l*R+g>>>u.__kBitsPerCharTableShift+5;D.__inplaceMultiplyAdd(K,W,A)}while(!I)}if(s!==o){if(!u.__isWhitespace(a))return null;for(s++;s<o;s++)if(a=t.charCodeAt(s),!u.__isWhitespace(a))return null}return i!=0&&n!==10?null:(D.sign=i==-1,D.__trim())}static __fillFromParts(t,n,i){let o=0,s=0,a=0;for(let r=n.length-1;0<=r;r--){const l=n[r],g=i[r];s|=l<<a,a+=g,a===32?(t.__setDigit(o++,s),a=0,s=0):32<a&&(t.__setDigit(o++,s),a-=32,s=l>>>g-a)}if(s!==0){if(o>=t.length)throw new Error("implementation bug");t.__setDigit(o++,s)}for(;o<t.length;o++)t.__setDigit(o,0)}static __toStringBasePowerOfTwo(t,n){const i=t.length;let o=n-1;o=(85&o>>>1)+(85&o),o=(51&o>>>2)+(51&o),o=(15&o>>>4)+(15&o);const s=o,a=n-1,r=t.__digit(i-1),l=u.__clz32(r);let g=0|(32*i-l+s-1)/s;if(t.sign&&g++,268435456<g)throw new Error("string too long");const y=Array(g);let D=g-1,_=0,q=0;for(let R=0;R<i-1;R++){const W=t.__digit(R),K=(_|W<<q)&a;y[D--]=u.__kConversionChars[K];const A=s-q;for(_=W>>>A,q=32-A;q>=s;)y[D--]=u.__kConversionChars[_&a],_>>>=s,q-=s}const I=(_|r<<q)&a;for(y[D--]=u.__kConversionChars[I],_=r>>>s-q;_!==0;)y[D--]=u.__kConversionChars[_&a],_>>>=s;if(t.sign&&(y[D--]="-"),D!=-1)throw new Error("implementation bug");return y.join("")}static __toStringGeneric(t,n,i){const o=t.length;if(o===0)return"";if(o===1){let R=t.__unsignedDigit(0).toString(n);return i===!1&&t.sign&&(R="-"+R),R}const s=32*o-u.__clz32(t.__digit(o-1)),a=u.__kMaxBitsPerChar[n],r=a-1;let l=s*u.__kBitsPerCharTableMultiplier;l+=r-1,l=0|l/r;const g=l+1>>1,y=u.exponentiate(u.__oneDigit(n,!1),u.__oneDigit(g,!1));let D,_;const q=y.__unsignedDigit(0);if(y.length===1&&65535>=q){D=new u(t.length,!1),D.__initializeDigits();let R=0;for(let W=2*t.length-1;0<=W;W--){const K=R<<16|t.__halfDigit(W);D.__setHalfDigit(W,0|K/q),R=0|K%q}_=R.toString(n)}else{const R=u.__absoluteDivLarge(t,y,!0,!0);D=R.quotient;const W=R.remainder.__trim();_=u.__toStringGeneric(W,n,!0)}D.__trim();let I=u.__toStringGeneric(D,n,!0);for(;_.length<g;)_="0"+_;return i===!1&&t.sign&&(I="-"+I),I+_}static __unequalSign(t){return t?-1:1}static __absoluteGreater(t){return t?-1:1}static __absoluteLess(t){return t?1:-1}static __compareToBigInt(t,n){const i=t.sign;if(i!==n.sign)return u.__unequalSign(i);const o=u.__absoluteCompare(t,n);return 0<o?u.__absoluteGreater(i):0>o?u.__absoluteLess(i):0}static __compareToNumber(t,n){if(n|!0){const i=t.sign,o=0>n;if(i!==o)return u.__unequalSign(i);if(t.length===0){if(o)throw new Error("implementation bug");return n===0?0:-1}if(1<t.length)return u.__absoluteGreater(i);const s=Math.abs(n),a=t.__unsignedDigit(0);return a>s?u.__absoluteGreater(i):a<s?u.__absoluteLess(i):0}return u.__compareToDouble(t,n)}static __compareToDouble(t,n){if(n!==n)return n;if(n===1/0)return-1;if(n===-1/0)return 1;const i=t.sign;if(i!==0>n)return u.__unequalSign(i);if(n===0)throw new Error("implementation bug: should be handled elsewhere");if(t.length===0)return-1;u.__kBitConversionDouble[0]=n;const o=2047&u.__kBitConversionInts[1]>>>20;if(o==2047)throw new Error("implementation bug: handled elsewhere");const s=o-1023;if(0>s)return u.__absoluteGreater(i);const a=t.length;let r=t.__digit(a-1);const l=u.__clz32(r),g=32*a-l,y=s+1;if(g<y)return u.__absoluteLess(i);if(g>y)return u.__absoluteGreater(i);let D=1048576|1048575&u.__kBitConversionInts[1],_=u.__kBitConversionInts[0];const q=20,I=31-l;if(I!==(g-1)%31)throw new Error("implementation bug");let R,W=0;if(20>I){const K=q-I;W=K+32,R=D>>>K,D=D<<32-K|_>>>K,_<<=32-K}else if(I===20)W=32,R=D,D=_;else{const K=I-q;W=32-K,R=D<<K|_>>>32-K,D=_<<K}if(r>>>=0,R>>>=0,r>R)return u.__absoluteGreater(i);if(r<R)return u.__absoluteLess(i);for(let K=a-2;0<=K;K--){0<W?(W-=32,R=D>>>0,D=_,_=0):R=0;const A=t.__unsignedDigit(K);if(A>R)return u.__absoluteGreater(i);if(A<R)return u.__absoluteLess(i)}if(D!==0||_!==0){if(W===0)throw new Error("implementation bug");return u.__absoluteLess(i)}return 0}static __equalToNumber(t,n){var i=Math.abs;return n|n===0?n===0?t.length===0:t.length===1&&t.sign===0>n&&t.__unsignedDigit(0)===i(n):u.__compareToDouble(t,n)===0}static __comparisonResultToBool(t,n){switch(n){case 0:return 0>t;case 1:return 0>=t;case 2:return 0<t;case 3:return 0<=t}throw new Error("unreachable")}static __compare(t,n,i){if(t=u.__toPrimitive(t),n=u.__toPrimitive(n),typeof t=="string"&&typeof n=="string")switch(i){case 0:return t<n;case 1:return t<=n;case 2:return t>n;case 3:return t>=n}if(u.__isBigInt(t)&&typeof n=="string")return n=u.__fromString(n),n!==null&&u.__comparisonResultToBool(u.__compareToBigInt(t,n),i);if(typeof t=="string"&&u.__isBigInt(n))return t=u.__fromString(t),t!==null&&u.__comparisonResultToBool(u.__compareToBigInt(t,n),i);if(t=u.__toNumeric(t),n=u.__toNumeric(n),u.__isBigInt(t)){if(u.__isBigInt(n))return u.__comparisonResultToBool(u.__compareToBigInt(t,n),i);if(typeof n!="number")throw new Error("implementation bug");return u.__comparisonResultToBool(u.__compareToNumber(t,n),i)}if(typeof t!="number")throw new Error("implementation bug");if(u.__isBigInt(n))return u.__comparisonResultToBool(u.__compareToNumber(n,t),2^i);if(typeof n!="number")throw new Error("implementation bug");return i===0?t<n:i===1?t<=n:i===2?t>n:i===3?t>=n:void 0}__clzmsd(){return u.__clz32(this[this.length-1])}static __absoluteAdd(t,n,i){if(t.length<n.length)return u.__absoluteAdd(n,t,i);if(t.length===0)return t;if(n.length===0)return t.sign===i?t:u.unaryMinus(t);let o=t.length;(t.__clzmsd()===0||n.length===t.length&&n.__clzmsd()===0)&&o++;const s=new u(o,i);let a=0,r=0;for(;r<n.length;r++){const l=n.__digit(r),g=t.__digit(r),y=(65535&g)+(65535&l)+a,D=(g>>>16)+(l>>>16)+(y>>>16);a=D>>>16,s.__setDigit(r,65535&y|D<<16)}for(;r<t.length;r++){const l=t.__digit(r),g=(65535&l)+a,y=(l>>>16)+(g>>>16);a=y>>>16,s.__setDigit(r,65535&g|y<<16)}return r<s.length&&s.__setDigit(r,a),s.__trim()}static __absoluteSub(t,n,i){if(t.length===0)return t;if(n.length===0)return t.sign===i?t:u.unaryMinus(t);const o=new u(t.length,i);let s=0,a=0;for(;a<n.length;a++){const r=t.__digit(a),l=n.__digit(a),g=(65535&r)-(65535&l)-s;s=1&g>>>16;const y=(r>>>16)-(l>>>16)-s;s=1&y>>>16,o.__setDigit(a,65535&g|y<<16)}for(;a<t.length;a++){const r=t.__digit(a),l=(65535&r)-s;s=1&l>>>16;const g=(r>>>16)-s;s=1&g>>>16,o.__setDigit(a,65535&l|g<<16)}return o.__trim()}static __absoluteAddOne(t,n,i=null){const o=t.length;i===null?i=new u(o,n):i.sign=n;let s=!0;for(let a,r=0;r<o;r++){if(a=t.__digit(r),s){const l=a===-1;a=0|a+1,s=l}i.__setDigit(r,a)}return s&&i.__setDigitGrow(o,1),i}static __absoluteSubOne(t,n){const i=t.length;n=n||i;const o=new u(n,!1);let s=!0;for(let a,r=0;r<i;r++){if(a=t.__digit(r),s){const l=a===0;a=0|a-1,s=l}o.__setDigit(r,a)}if(s)throw new Error("implementation bug");for(let a=i;a<n;a++)o.__setDigit(a,0);return o}static __absoluteAnd(t,n,i=null){let o=t.length,s=n.length,a=s;if(o<s){a=o;const g=t,y=o;t=n,o=s,n=g,s=y}let r=a;i===null?i=new u(r,!1):r=i.length;let l=0;for(;l<a;l++)i.__setDigit(l,t.__digit(l)&n.__digit(l));for(;l<r;l++)i.__setDigit(l,0);return i}static __absoluteAndNot(t,n,i=null){const o=t.length,s=n.length;let a=s;o<s&&(a=o);let r=o;i===null?i=new u(r,!1):r=i.length;let l=0;for(;l<a;l++)i.__setDigit(l,t.__digit(l)&~n.__digit(l));for(;l<o;l++)i.__setDigit(l,t.__digit(l));for(;l<r;l++)i.__setDigit(l,0);return i}static __absoluteOr(t,n,i=null){let o=t.length,s=n.length,a=s;if(o<s){a=o;const g=t,y=o;t=n,o=s,n=g,s=y}let r=o;i===null?i=new u(r,!1):r=i.length;let l=0;for(;l<a;l++)i.__setDigit(l,t.__digit(l)|n.__digit(l));for(;l<o;l++)i.__setDigit(l,t.__digit(l));for(;l<r;l++)i.__setDigit(l,0);return i}static __absoluteXor(t,n,i=null){let o=t.length,s=n.length,a=s;if(o<s){a=o;const g=t,y=o;t=n,o=s,n=g,s=y}let r=o;i===null?i=new u(r,!1):r=i.length;let l=0;for(;l<a;l++)i.__setDigit(l,t.__digit(l)^n.__digit(l));for(;l<o;l++)i.__setDigit(l,t.__digit(l));for(;l<r;l++)i.__setDigit(l,0);return i}static __absoluteCompare(t,n){const i=t.length-n.length;if(i!=0)return i;let o=t.length-1;for(;0<=o&&t.__digit(o)===n.__digit(o);)o--;return 0>o?0:t.__unsignedDigit(o)>n.__unsignedDigit(o)?1:-1}static __multiplyAccumulate(t,n,i,o){if(n===0)return;const s=65535&n,a=n>>>16;let r=0,l=0,g=0;for(let y=0;y<t.length;y++,o++){let D=i.__digit(o),_=65535&D,q=D>>>16;const I=t.__digit(y),R=65535&I,W=I>>>16,K=u.__imul(R,s),A=u.__imul(R,a),F=u.__imul(W,s),X=u.__imul(W,a);_+=l+(65535&K),q+=g+r+(_>>>16)+(K>>>16)+(65535&A)+(65535&F),r=q>>>16,l=(A>>>16)+(F>>>16)+(65535&X)+r,r=l>>>16,l&=65535,g=X>>>16,D=65535&_|q<<16,i.__setDigit(o,D)}for(;r!=0||l!==0||g!==0;o++){let y=i.__digit(o);const D=(65535&y)+l,_=(y>>>16)+(D>>>16)+g+r;l=0,g=0,r=_>>>16,y=65535&D|_<<16,i.__setDigit(o,y)}}static __internalMultiplyAdd(t,n,i,o,s){let a=i,r=0;for(let l=0;l<o;l++){const g=t.__digit(l),y=u.__imul(65535&g,n),D=(65535&y)+r+a;a=D>>>16;const _=u.__imul(g>>>16,n),q=(65535&_)+(y>>>16)+a;a=q>>>16,r=_>>>16,s.__setDigit(l,q<<16|65535&D)}if(s.length>o)for(s.__setDigit(o++,a+r);o<s.length;)s.__setDigit(o++,0);else if(a+r!==0)throw new Error("implementation bug")}__inplaceMultiplyAdd(t,n,i){i>this.length&&(i=this.length);const o=65535&t,s=t>>>16;let a=0,r=65535&n,l=n>>>16;for(let g=0;g<i;g++){const y=this.__digit(g),D=65535&y,_=y>>>16,q=u.__imul(D,o),I=u.__imul(D,s),R=u.__imul(_,o),W=u.__imul(_,s),K=r+(65535&q),A=l+a+(K>>>16)+(q>>>16)+(65535&I)+(65535&R);r=(I>>>16)+(R>>>16)+(65535&W)+(A>>>16),a=r>>>16,r&=65535,l=W>>>16,this.__setDigit(g,65535&K|A<<16)}if(a!=0||r!==0||l!==0)throw new Error("implementation bug")}static __absoluteDivSmall(t,n,i){i===null&&(i=new u(t.length,!1));let o=0;for(let s,a=2*t.length-1;0<=a;a-=2){s=(o<<16|t.__halfDigit(a))>>>0;const r=0|s/n;o=0|s%n,s=(o<<16|t.__halfDigit(a-1))>>>0;const l=0|s/n;o=0|s%n,i.__setDigit(a>>>1,r<<16|l)}return i}static __absoluteModSmall(t,n){let i=0;for(let o=2*t.length-1;0<=o;o--){const s=(i<<16|t.__halfDigit(o))>>>0;i=0|s%n}return i}static __absoluteDivLarge(t,n,i,o){const s=n.__halfDigitLength(),a=n.length,r=t.__halfDigitLength()-s;let l=null;i&&(l=new u(r+2>>>1,!1),l.__initializeDigits());const g=new u(s+2>>>1,!1);g.__initializeDigits();const y=u.__clz16(n.__halfDigit(s-1));0<y&&(n=u.__specialLeftShift(n,y,0));const D=u.__specialLeftShift(t,y,1),_=n.__halfDigit(s-1);let q=0;for(let I,R=r;0<=R;R--){I=65535;const W=D.__halfDigit(R+s);if(W!==_){const A=(W<<16|D.__halfDigit(R+s-1))>>>0;I=0|A/_;let F=0|A%_;const X=n.__halfDigit(s-2),re=D.__halfDigit(R+s-2);for(;u.__imul(I,X)>>>0>(F<<16|re)>>>0&&(I--,F+=_,!(65535<F)););}u.__internalMultiplyAdd(n,I,0,a,g);let K=D.__inplaceSub(g,R,s+1);K!==0&&(K=D.__inplaceAdd(n,R,s),D.__setHalfDigit(R+s,D.__halfDigit(R+s)+K),I--),i&&(1&R?q=I<<16:l.__setDigit(R>>>1,q|I))}return o?(D.__inplaceRightShift(y),i?{quotient:l,remainder:D}:D):i?l:void 0}static __clz16(t){return u.__clz32(t)-16}__inplaceAdd(t,n,i){let o=0;for(let s=0;s<i;s++){const a=this.__halfDigit(n+s)+t.__halfDigit(s)+o;o=a>>>16,this.__setHalfDigit(n+s,a)}return o}__inplaceSub(t,n,i){let o=0;if(1&n){n>>=1;let s=this.__digit(n),a=65535&s,r=0;for(;r<i-1>>>1;r++){const y=t.__digit(r),D=(s>>>16)-(65535&y)-o;o=1&D>>>16,this.__setDigit(n+r,D<<16|65535&a),s=this.__digit(n+r+1),a=(65535&s)-(y>>>16)-o,o=1&a>>>16}const l=t.__digit(r),g=(s>>>16)-(65535&l)-o;if(o=1&g>>>16,this.__setDigit(n+r,g<<16|65535&a),n+r+1>=this.length)throw new RangeError("out of bounds");(1&i)==0&&(s=this.__digit(n+r+1),a=(65535&s)-(l>>>16)-o,o=1&a>>>16,this.__setDigit(n+t.length,4294901760&s|65535&a))}else{n>>=1;let s=0;for(;s<t.length-1;s++){const y=this.__digit(n+s),D=t.__digit(s),_=(65535&y)-(65535&D)-o;o=1&_>>>16;const q=(y>>>16)-(D>>>16)-o;o=1&q>>>16,this.__setDigit(n+s,q<<16|65535&_)}const a=this.__digit(n+s),r=t.__digit(s),l=(65535&a)-(65535&r)-o;o=1&l>>>16;let g=0;(1&i)==0&&(g=(a>>>16)-(r>>>16)-o,o=1&g>>>16),this.__setDigit(n+s,g<<16|65535&l)}return o}__inplaceRightShift(t){if(t===0)return;let n=this.__digit(0)>>>t;const i=this.length-1;for(let o=0;o<i;o++){const s=this.__digit(o+1);this.__setDigit(o,s<<32-t|n),n=s>>>t}this.__setDigit(i,n)}static __specialLeftShift(t,n,i){const o=t.length,s=new u(o+i,!1);if(n===0){for(let r=0;r<o;r++)s.__setDigit(r,t.__digit(r));return 0<i&&s.__setDigit(o,0),s}let a=0;for(let r=0;r<o;r++){const l=t.__digit(r);s.__setDigit(r,l<<n|a),a=l>>>32-n}return 0<i&&s.__setDigit(o,a),s}static __leftShiftByAbsolute(t,n){const i=u.__toShiftAmount(n);if(0>i)throw new RangeError("BigInt too big");const o=i>>>5,s=31&i,a=t.length,r=s!==0&&t.__digit(a-1)>>>32-s!=0,l=a+o+(r?1:0),g=new u(l,t.sign);if(s===0){let y=0;for(;y<o;y++)g.__setDigit(y,0);for(;y<l;y++)g.__setDigit(y,t.__digit(y-o))}else{let y=0;for(let D=0;D<o;D++)g.__setDigit(D,0);for(let D=0;D<a;D++){const _=t.__digit(D);g.__setDigit(D+o,_<<s|y),y=_>>>32-s}if(r)g.__setDigit(a+o,y);else if(y!==0)throw new Error("implementation bug")}return g.__trim()}static __rightShiftByAbsolute(t,n){const i=t.length,o=t.sign,s=u.__toShiftAmount(n);if(0>s)return u.__rightShiftByMaximum(o);const a=s>>>5,r=31&s;let l=i-a;if(0>=l)return u.__rightShiftByMaximum(o);let g=!1;if(o){if((t.__digit(a)&(1<<r)-1)!=0)g=!0;else for(let D=0;D<a;D++)if(t.__digit(D)!==0){g=!0;break}}g&&r===0&&~t.__digit(i-1)==0&&l++;let y=new u(l,o);if(r===0)for(let D=a;D<i;D++)y.__setDigit(D-a,t.__digit(D));else{let D=t.__digit(a)>>>r;const _=i-a-1;for(let q=0;q<_;q++){const I=t.__digit(q+a+1);y.__setDigit(q,I<<32-r|D),D=I>>>r}y.__setDigit(_,D)}return g&&(y=u.__absoluteAddOne(y,!0,y)),y.__trim()}static __rightShiftByMaximum(t){return t?u.__oneDigit(1,!0):u.__zero()}static __toShiftAmount(t){if(1<t.length)return-1;const n=t.__unsignedDigit(0);return n>u.__kMaxLengthBits?-1:n}static __toPrimitive(t,n="default"){if(typeof t!="object"||t.constructor===u)return t;const i=t[Symbol.toPrimitive];if(i){const a=i(n);if(typeof a!="object")return a;throw new TypeError("Cannot convert object to primitive value")}const o=t.valueOf;if(o){const a=o.call(t);if(typeof a!="object")return a}const s=t.toString;if(s){const a=s.call(t);if(typeof a!="object")return a}throw new TypeError("Cannot convert object to primitive value")}static __toNumeric(t){return u.__isBigInt(t)?t:+t}static __isBigInt(t){return typeof t=="object"&&t!==null&&t.constructor===u}static __truncateToNBits(t,n){const i=t+31>>>5,o=new u(i,n.sign),s=i-1;for(let r=0;r<s;r++)o.__setDigit(r,n.__digit(r));let a=n.__digit(s);if((31&t)!=0){const r=32-(31&t);a=a<<r>>>r}return o.__setDigit(s,a),o.__trim()}static __truncateAndSubFromPowerOfTwo(t,n,i){var o=Math.min;const s=t+31>>>5,a=new u(s,i);let r=0;const l=s-1;let g=0;for(const q=o(l,n.length);r<q;r++){const I=n.__digit(r),R=0-(65535&I)-g;g=1&R>>>16;const W=0-(I>>>16)-g;g=1&W>>>16,a.__setDigit(r,65535&R|W<<16)}for(;r<l;r++)a.__setDigit(r,0|-g);let y=l<n.length?n.__digit(l):0;const D=31&t;let _;if(D==0){const q=0-(65535&y)-g;g=1&q>>>16;const I=0-(y>>>16)-g;_=65535&q|I<<16}else{const q=32-D;y=y<<q>>>q;const I=1<<32-q,R=(65535&I)-(65535&y)-g;g=1&R>>>16;const W=(I>>>16)-(y>>>16)-g;_=65535&R|W<<16,_&=I-1}return a.__setDigit(l,_),a.__trim()}__digit(t){return this[t]}__unsignedDigit(t){return this[t]>>>0}__setDigit(t,n){this[t]=0|n}__setDigitGrow(t,n){this[t]=0|n}__halfDigitLength(){const t=this.length;return 65535>=this.__unsignedDigit(t-1)?2*t-1:2*t}__halfDigit(t){return 65535&this[t>>>1]>>>((1&t)<<4)}__setHalfDigit(t,n){const i=t>>>1,o=this.__digit(i),s=1&t?65535&o|n<<16:4294901760&o|65535&n;this.__setDigit(i,s)}static __digitPow(t,n){let i=1;for(;0<n;)1&n&&(i*=t),n>>>=1,t*=t;return i}}u.__kMaxLength=33554432,u.__kMaxLengthBits=u.__kMaxLength<<5,u.__kMaxBitsPerChar=[0,0,32,51,64,75,83,90,96,102,107,111,115,119,122,126,128,131,134,136,139,141,143,145,147,149,151,153,154,156,158,159,160,162,163,165,166],u.__kBitsPerCharTableShift=5,u.__kBitsPerCharTableMultiplier=1<<u.__kBitsPerCharTableShift,u.__kConversionChars=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],u.__kBitConversionBuffer=new ArrayBuffer(8),u.__kBitConversionDouble=new Float64Array(u.__kBitConversionBuffer),u.__kBitConversionInts=new Int32Array(u.__kBitConversionBuffer),u.__clz32=Math.clz32||function(e){return e===0?32:0|31-(0|Math.log(e>>>0)/Math.LN2)},u.__imul=Math.imul||function(e,t){return 0|e*t};var jc=globalThis&&globalThis.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var i=Array(e),o=0,t=0;t<n;t++)for(var s=arguments[t],a=0,r=s.length;a<r;a++,o++)i[o]=s[a];return i},Qc=18446744073709552e3,Zi=function(e,t){return u.bitwiseXor(u.asUintN(64,u.leftShift(e,u.BigInt(t))),u.BigInt(u.asUintN(64,u.signedRightShift(e,u.subtract(u.BigInt(64),u.BigInt(t))))))},Kc=function(){function e(t){var n=this;this.next=function(){return new Xi(n.roll().toString())},this.nextDouble=function(){return new Xi(n.roll().toString()).div(Qc+1)},this.nextInt=function(o,s){return Math.floor(n.nextDouble().toNumber()*(s-o+1)+o)},this.nextByte=function(){return n.nextInt(0,255)},this.nextData=function(o){return jc(new Array(o)).map(function(){return n.nextByte()})};var i=wl(t);this.s=[u.BigInt(0),u.BigInt(0),u.BigInt(0),u.BigInt(0)],this.setS(i)}return e.prototype.setS=function(t){for(var n=0;n<4;n++){for(var i=n*8,o=u.BigInt(0),s=0;s<8;s++)o=u.asUintN(64,u.leftShift(o,u.BigInt(8))),o=u.asUintN(64,u.bitwiseOr(o,u.BigInt(t[i+s])));this.s[n]=u.asUintN(64,o)}},e.prototype.roll=function(){var t=u.asUintN(64,u.multiply(Zi(u.asUintN(64,u.multiply(this.s[1],u.BigInt(5))),7),u.BigInt(9))),n=u.asUintN(64,u.leftShift(this.s[1],u.BigInt(17)));return this.s[2]=u.asUintN(64,u.bitwiseXor(this.s[2],u.BigInt(this.s[0]))),this.s[3]=u.asUintN(64,u.bitwiseXor(this.s[3],u.BigInt(this.s[1]))),this.s[1]=u.asUintN(64,u.bitwiseXor(this.s[1],u.BigInt(this.s[2]))),this.s[0]=u.asUintN(64,u.bitwiseXor(this.s[0],u.BigInt(this.s[3]))),this.s[2]=u.asUintN(64,u.bitwiseXor(this.s[2],u.BigInt(n))),this.s[3]=u.asUintN(64,Zi(this.s[3],45)),t},e}();function kn(e,t,n){this.alias=[],this.prob=[],this.outcomes=t||this.indexedOutcomes(e.length),this.rng=n||Math.random,this.precomputeAlias(e)}kn.prototype.next=function(e){var t=e||1,n=[],i=0;do{var o=Math.floor(this.rng()*this.prob.length);n[i]=this.outcomes[this.rng()<this.prob[o]?o:this.alias[o]]}while(++i<t);return t>1?n:n[0]};kn.prototype.precomputeAlias=function(e){var t=e.length,n=0,i=0,o=0,s=[],a=[],r=[],l,g,y;for(g=0;g<t;++g){if(e[g]<0)throw"Probability must be a positive: p["+g+"]="+e[g];n+=e[g]}if(n===0)throw"Probability cannot be zero.";for(g=0;g<t;++g)s[g]=e[g]*t/n;for(g=t-1;g>=0;--g)s[g]<1?a[i++]=g:r[o++]=g;for(;i&&o;)y=a[--i],l=r[--o],this.prob[y]=s[y],this.alias[y]=l,s[l]=s[l]+s[y]-1,s[l]<1?a[i++]=l:r[o++]=l;for(;o;)this.prob[r[--o]]=1;for(;i;)this.prob[a[--i]]=1};kn.prototype.indexedOutcomes=function(e){for(var t=[],n=0;n<e;n++)t[n]=n;return t};kn.prototype.randomInt=function(e,t){return Math.floor(this.rng()*(t-e))+e};var Hc=function(e,t,n){return new kn(e,t,n)},Ii=globalThis&&globalThis.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var i=Array(e),o=0,t=0;t<n;t++)for(var s=arguments[t],a=0,r=s.length;a<r;a++,o++)i[o]=s[a];return i},Gc=function(e,t){var n=Ii(new Array(e)).map(function(o,s){return 1/(s+1)}),i=Hc(n,null,t.nextDouble);return i.next()+1},Xc=function(e,t){for(var n=Ii(e),i=[];n.length>0;){var o=t.nextInt(0,n.length-1),s=n[o];n.splice(o,1),i.push(s)}return i},Wo=function(e,t,n){if(e<=t)return[e-1];var i=Ie.Buffer.concat([Wi(e),Wi(n)]),o=new Kc(i),s=Gc(t,o),a=Ii(new Array(t)).map(function(l,g){return g}),r=Xc(a,o);return r.slice(0,s)},jo=function(){function e(t,n,i,o,s){this._seqNum=t,this._seqLength=n,this._messageLength=i,this._checksum=o,this._fragment=s}return Object.defineProperty(e.prototype,"messageLength",{get:function(){return this._messageLength},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fragment",{get:function(){return this._fragment},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"seqNum",{get:function(){return this._seqNum},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"seqLength",{get:function(){return this._seqLength},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"checksum",{get:function(){return this._checksum},enumerable:!1,configurable:!0}),e.prototype.cbor=function(){var t=Oo([this._seqNum,this._seqLength,this._messageLength,this._checksum,this._fragment]);return Ie.Buffer.from(t)},e.prototype.description=function(){return"seqNum:"+this._seqNum+", seqLen:"+this._seqLength+", messageLen:"+this._messageLength+", checksum:"+this._checksum+", data:"+this._fragment.toString("hex")},e.fromCBOR=function(t){var n=zo(t),i=n[0],o=n[1],s=n[2],a=n[3],r=n[4];if(typeof i!="number"||typeof o!="number"||typeof s!="number"||typeof a!="number"||Ie.Buffer.isBuffer(r)&&r.length<=0)throw new Error("type error");return new e(i,o,s,a,Ie.Buffer.from(r))},e}(),Zc=function(){function e(t,n,i,o){n===void 0&&(n=100),i===void 0&&(i=0),o===void 0&&(o=10);var s=e.findNominalFragmentLength(t.length,o,n);this._messageLength=t.length,this._fragments=e.partitionMessage(t,s),this.fragmentLength=s,this.seqNum=ci(i),this.checksum=qo(t)}return Object.defineProperty(e.prototype,"fragmentsLength",{get:function(){return this._fragments.length},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fragments",{get:function(){return this._fragments},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"messageLength",{get:function(){return this._messageLength},enumerable:!1,configurable:!0}),e.prototype.isComplete=function(){return this.seqNum>=this._fragments.length},e.prototype.isSinglePart=function(){return this._fragments.length===1},e.prototype.seqLength=function(){return this._fragments.length},e.prototype.mix=function(t){var n=this;return t.reduce(function(i,o){return So(n._fragments[o],i)},Ie.Buffer.alloc(this.fragmentLength,0))},e.prototype.nextPart=function(){this.seqNum=ci(this.seqNum+1);var t=Wo(this.seqNum,this._fragments.length,this.checksum),n=this.mix(t);return new jo(this.seqNum,this._fragments.length,this._messageLength,this.checksum,n)},e.findNominalFragmentLength=function(t,n,i){if(t<=0||n<=0||i<n)throw new Error("invalid fragment or message length");for(var o=Math.ceil(t/n),s=0,a=1;a<=o&&(s=Math.ceil(t/a),!(s<=i));a++);return s},e.partitionMessage=function(t,n){for(var i,o=Ie.Buffer.from(t),s,a=[];o.length>0;)i=To(o,-n),s=i[0],o=i[1],s=Ie.Buffer.alloc(n,0).fill(s,0,s.length),a.push(s);return a},e}(),Qo=globalThis&&globalThis.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var i=Array(e),o=0,t=0;t<n;t++)for(var s=arguments[t],a=0,r=s.length;a<r;a++,o++)i[o]=s[a];return i},Yc="ableacidalsoapexaquaarchatomauntawayaxisbackbaldbarnbeltbetabiasbluebodybragbrewbulbbuzzcalmcashcatschefcityclawcodecolacookcostcruxcurlcuspcyandarkdatadaysdelidicedietdoordowndrawdropdrumdulldutyeacheasyechoedgeepicevenexamexiteyesfactfairfernfigsfilmfishfizzflapflewfluxfoxyfreefrogfuelfundgalagamegeargemsgiftgirlglowgoodgraygrimgurugushgyrohalfhanghardhawkheathelphighhillholyhopehornhutsicedideaidleinchinkyintoirisironitemjadejazzjoinjoltjowljudojugsjumpjunkjurykeepkenokeptkeyskickkilnkingkitekiwiknoblamblavalazyleaflegsliarlimplionlistlogoloudloveluaulucklungmainmanymathmazememomenumeowmildmintmissmonknailnavyneednewsnextnoonnotenumbobeyoboeomitonyxopenovalowlspaidpartpeckplaypluspoempoolposepuffpumapurrquadquizraceramprealredorichroadrockroofrubyruinrunsrustsafesagascarsetssilkskewslotsoapsolosongstubsurfswantacotasktaxitenttiedtimetinytoiltombtoystriptunatwinuglyundouniturgeuservastveryvetovialvibeviewvisavoidvowswallwandwarmwaspwavewaxywebswhatwhenwhizwolfworkyankyawnyellyogayurtzapszerozestzinczonezoom",Sn=[],Jc=256,Mt=4,eu=2,ut;(function(e){e.STANDARD="standard",e.URI="uri",e.MINIMAL="minimal"})(ut||(ut={}));var Bn=function(e){return Yc.slice(e*Mt,e*Mt+Mt)},tu=function(e){var t=Bn(e);return""+t[0]+t[Mt-1]},Ko=function(e){var t=Mo(Ie.Buffer.from(e,"hex"));return""+e+t},Yi=function(e,t){var n=Ko(e),i=Ie.Buffer.from(n,"hex"),o=i.reduce(function(s,a){return Qo(s,[Bn(a)])},[]);return o.join(t)},nu=function(e){var t=Ko(e),n=Ie.Buffer.from(t,"hex"),i=n.reduce(function(o,s){return o+tu(s)},"");return i},iu=function(e,t){if(e.length!==t)throw new Error("'Invalid Bytewords: word.length does not match wordLength provided'");var n=26;if(Sn.length===0){var i=n*n;Sn=Qo(new Array(i)).map(function(){return-1});for(var o=0;o<Jc;o++){var s=Bn(o),a=s[0].charCodeAt(0)-"a".charCodeAt(0),r=s[3].charCodeAt(0)-"a".charCodeAt(0),l=r*n+a;Sn[l]=o}}var g=e[0].toLowerCase().charCodeAt(0)-"a".charCodeAt(0),y=e[t==4?3:1].toLowerCase().charCodeAt(0)-"a".charCodeAt(0);if(!(0<=g&&g<n&&0<=y&&y<n))throw new Error("Invalid Bytewords: invalid word");var D=y*n+g,_=Sn[D];if(_===-1)throw new Error("Invalid Bytewords: value not in lookup table");if(t==Mt){var s=Bn(_),q=e[1].toLowerCase(),I=e[2].toLowerCase();if(!(q===s[1]&&I===s[2]))throw new Error("Invalid Bytewords: invalid middle letters of word")}return Ie.Buffer.from([_]).toString("hex")},ri=function(e,t,n){var i=n==Mt?e.split(t):kl(e,2),o=i.map(function(g){return iu(g,n)}).join("");if(o.length<5)throw new Error("Invalid Bytewords: invalid decoded string length");var s=To(Ie.Buffer.from(o,"hex"),4),a=s[0],r=s[1],l=Mo(a);if(l!==r.toString("hex"))throw new Error("Invalid Checksum");return a.toString("hex")},ou=function(e,t){switch(t===void 0&&(t=ut.MINIMAL),t){case ut.STANDARD:return ri(e," ",Mt);case ut.URI:return ri(e,"-",Mt);case ut.MINIMAL:return ri(e,"",eu);default:throw new Error("Invalid style "+t)}},su=function(e,t){switch(t===void 0&&(t=ut.MINIMAL),t){case ut.STANDARD:return Yi(e," ");case ut.URI:return Yi(e,"-");case ut.MINIMAL:return nu(e);default:throw new Error("Invalid style "+t)}},qt={decode:ou,encode:su,STYLES:ut},au=globalThis&&globalThis.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var i=Array(e),o=0,t=0;t<n;t++)for(var s=arguments[t],a=0,r=s.length;a<r;a++,o++)i[o]=s[a];return i},ru=function(){function e(t,n,i,o){this.ur=t,this.fountainEncoder=new Zc(t.cbor,n,i,o)}return Object.defineProperty(e.prototype,"fragmentsLength",{get:function(){return this.fountainEncoder.fragmentsLength},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fragments",{get:function(){return this.fountainEncoder.fragments},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"messageLength",{get:function(){return this.fountainEncoder.messageLength},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"cbor",{get:function(){return this.ur.cbor},enumerable:!1,configurable:!0}),e.prototype.encodeWhole=function(){var t=this;return au(new Array(this.fragmentsLength)).map(function(){return t.nextPart()})},e.prototype.nextPart=function(){var t=this.fountainEncoder.nextPart();return this.fountainEncoder.isSinglePart()?e.encodeSinglePart(this.ur):e.encodePart(this.ur.type,t)},e.encodeUri=function(t,n){var i=n.join("/");return[t,i].join(":")},e.encodeUR=function(t){return e.encodeUri("ur",t)},e.encodePart=function(t,n){var i=n.seqNum+"-"+n.seqLength,o=qt.encode(n.cbor().toString("hex"),qt.STYLES.MINIMAL);return e.encodeUR([t,i,o])},e.encodeSinglePart=function(t){var n=qt.encode(t.cbor.toString("hex"),qt.STYLES.MINIMAL);return e.encodeUR([t.type,n])},e}(),An=globalThis&&globalThis.__spreadArrays||function(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;for(var i=Array(e),o=0,t=0;t<n;t++)for(var s=arguments[t],a=0,r=s.length;a<r;a++,o++)i[o]=s[a];return i},Ji=function(){function e(t,n){this._indexes=t,this._fragment=n}return Object.defineProperty(e.prototype,"indexes",{get:function(){return this._indexes},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"fragment",{get:function(){return this._fragment},enumerable:!1,configurable:!0}),e.fromEncoderPart=function(t){var n=Wo(t.seqNum,t.seqLength,t.checksum),i=t.fragment;return new e(n,i)},e.prototype.isSimple=function(){return this.indexes.length===1},e}(),lu=function(){function e(){this.result=void 0,this.expectedMessageLength=0,this.expectedChecksum=0,this.expectedFragmentLength=0,this.processedPartsCount=0,this.expectedPartIndexes=[],this.lastPartIndexes=[],this.queuedParts=[],this.receivedPartIndexes=[],this.mixedParts=[],this.simpleParts=[]}return e.prototype.validatePart=function(t){var n=this;if(this.expectedPartIndexes.length===0)An(new Array(t.seqLength)).forEach(function(i,o){return n.expectedPartIndexes.push(o)}),this.expectedMessageLength=t.messageLength,this.expectedChecksum=t.checksum,this.expectedFragmentLength=t.fragment.length;else if(this.expectedPartIndexes.length!==t.seqLength||this.expectedMessageLength!==t.messageLength||this.expectedChecksum!==t.checksum||this.expectedFragmentLength!==t.fragment.length)return!1;return!0},e.prototype.reducePartByPart=function(t,n){if(bl(t.indexes,n.indexes)){var i=Dl(t.indexes,n.indexes),o=So(t.fragment,n.fragment);return new Ji(i,o)}else return t},e.prototype.reduceMixedBy=function(t){var n=this,i=[];this.mixedParts.map(function(o){var s=o.value;return n.reducePartByPart(s,t)}).forEach(function(o){o.isSimple()?n.queuedParts.push(o):i.push({key:o.indexes,value:o})}),this.mixedParts=i},e.prototype.processSimplePart=function(t){var n=t.indexes[0];if(!this.receivedPartIndexes.includes(n))if(this.simpleParts.push({key:t.indexes,value:t}),this.receivedPartIndexes.push(n),ji(this.receivedPartIndexes,this.expectedPartIndexes)){var i=this.simpleParts.map(function(a){var r=a.value;return r}).sort(function(a,r){return a.indexes[0]-r.indexes[0]}),o=e.joinFragments(i.map(function(a){return a.fragment}),this.expectedMessageLength),s=qo(o);s===this.expectedChecksum?this.result=o:this.error=new yl}else this.reduceMixedBy(t)},e.prototype.processMixedPart=function(t){var n=this;if(!this.mixedParts.some(function(o){var s=o.key;return ji(s,t.indexes)})){var i=this.simpleParts.reduce(function(o,s){var a=s.value;return n.reducePartByPart(o,a)},t);i=this.mixedParts.reduce(function(o,s){var a=s.value;return n.reducePartByPart(o,a)},i),i.isSimple()?this.queuedParts.push(i):(this.reduceMixedBy(i),this.mixedParts.push({key:i.indexes,value:i}))}},e.prototype.processQueuedItem=function(){if(this.queuedParts.length!==0){var t=this.queuedParts.shift();t.isSimple()?this.processSimplePart(t):this.processMixedPart(t)}},e.prototype.receivePart=function(t){if(this.isComplete()||!this.validatePart(t))return!1;var n=Ji.fromEncoderPart(t);for(this.lastPartIndexes=n.indexes,this.queuedParts.push(n);!this.isComplete()&&this.queuedParts.length>0;)this.processQueuedItem();return this.processedPartsCount+=1,!0},e.prototype.isComplete=function(){return Boolean(this.result!==void 0&&this.result.length>0)},e.prototype.isSuccess=function(){return Boolean(this.error===void 0&&this.isComplete())},e.prototype.resultMessage=function(){return this.isSuccess()?this.result:Ie.Buffer.from([])},e.prototype.isFailure=function(){return this.error!==void 0},e.prototype.resultError=function(){return this.error?this.error.message:""},e.prototype.expectedPartCount=function(){return this.expectedPartIndexes.length},e.prototype.getExpectedPartIndexes=function(){return An(this.expectedPartIndexes)},e.prototype.getReceivedPartIndexes=function(){return An(this.receivedPartIndexes)},e.prototype.getLastPartIndexes=function(){return An(this.lastPartIndexes)},e.prototype.estimatedPercentComplete=function(){if(this.isComplete())return 1;var t=this.expectedPartCount();return t===0?0:Math.min(.99,this.processedPartsCount/(t*1.75))},e.prototype.getProgress=function(){if(this.isComplete())return 1;var t=this.expectedPartCount();return t===0?0:this.receivedPartIndexes.length/t},e.joinFragments=function(t,n){return Ie.Buffer.concat(t).slice(0,n)},e}(),cu=function(){function e(t,n){if(t===void 0&&(t=new lu),n===void 0&&(n="bytes"),this.fountainDecoder=t,this.type=n,!En(n))throw new Error("Invalid UR type");this.expected_type=""}return e.decodeBody=function(t,n){var i=qt.decode(n,qt.STYLES.MINIMAL);return new Un(Ie.Buffer.from(i,"hex"),t)},e.prototype.validatePart=function(t){return this.expected_type?this.expected_type===t:En(t)?(this.expected_type=t,!0):!1},e.decode=function(t){var n=this.parse(t),i=n[0],o=n[1];if(o.length===0)throw new ni;var s=o[0];return e.decodeBody(i,s)},e.parse=function(t){var n=t.toLowerCase(),i=n.slice(0,3);if(i!=="ur:")throw new zi;var o=n.slice(3).split("/"),s=o[0];if(o.length<2)throw new ni;if(!En(s))throw new Po;return[s,o.slice(1)]},e.parseSequenceComponent=function(t){var n=t.split("-");if(n.length!==2)throw new Vi;var i=ci(Number(n[0])),o=Number(n[1]);if(i<1||o<1)throw new Vi;return[i,o]},e.prototype.receivePart=function(t){if(this.result!==void 0)return!1;var n=e.parse(t),i=n[0],o=n[1];if(!this.validatePart(i))return!1;if(o.length===1)return this.result=e.decodeBody(i,o[0]),!0;if(o.length!==2)throw new ni;var s=o[0],a=o[1],r=e.parseSequenceComponent(s),l=r[0],g=r[1],y=qt.decode(a,qt.STYLES.MINIMAL),D=jo.fromCBOR(y);return l!==D.seqNum||g!==D.seqLength||!this.fountainDecoder.receivePart(D)?!1:(this.fountainDecoder.isSuccess()?this.result=new Un(this.fountainDecoder.resultMessage(),i):this.fountainDecoder.isFailure()&&(this.error=new zi),!0)},e.prototype.resultUR=function(){return this.result?this.result:new Un(Ie.Buffer.from([]))},e.prototype.isComplete=function(){return!!(this.result&&this.result.cbor.length>0)},e.prototype.isSuccess=function(){return!this.error&&this.isComplete()},e.prototype.isError=function(){return this.error!==void 0},e.prototype.resultError=function(){return this.error?this.error.message:""},e.prototype.expectedPartCount=function(){return this.fountainDecoder.expectedPartCount()},e.prototype.expectedPartIndexes=function(){return this.fountainDecoder.getExpectedPartIndexes()},e.prototype.receivedPartIndexes=function(){return this.fountainDecoder.getReceivedPartIndexes()},e.prototype.lastPartIndexes=function(){return this.fountainDecoder.getLastPartIndexes()},e.prototype.estimatedPercentComplete=function(){return this.fountainDecoder.estimatedPercentComplete()},e.prototype.getProgress=function(){return this.fountainDecoder.getProgress()},e}();const uu=xe({name:"SendPaymentRequest",mixins:[windowMixin],props:{},data:function(){return{loading:!1}},watch:{},computed:{...ne(Zt,["showSendTokens","showLockInput","sendData"]),...Y(ve,["activeMintUrl","mints"])},methods:{...J(dt,["isLocked","isLockedToUs"]),...J(ft,["parseAndPayPaymentRequest"]),clickPaymentRequest:async function(){this.loading=!0;try{await this.parseAndPayPaymentRequest(this.sendData.paymentRequest,this.sendData.tokensBase64)}catch(e){console.error("Error paying payment request:",e),notifyError(`${e.message}`,"Could not pay request")}finally{this.loading=!1}},getPaymentRequestTransportType:function(e){if(!e||!e.transport)return"Unknown";console.log(`### getPaymentRequestTransportType: ${e}`);const t=e.transport;for(const n of t){if(n.type==Pn.NOSTR)return"Nostr";if(n.type==Pn.POST)return"HTTP"}},getPaymentRequestTarget:function(e){if(!e||!e.transport)return"Unknown";console.log(`### getPaymentRequestDestination: ${e}`);const t=e.transport;for(const n of t){if(n.type==Pn.NOSTR)return`${n.target.slice(0,20)}..${n.target.slice(-10)}`;if(n.type==Pn.POST)try{return new URL(n.target).hostname}catch(i){return console.error(`Invalid URL in transport.target: ${n.target}`,i),"Invalid URL"}}}}}),du={key:0,class:"q-pa-none q-ma-none q-mt-sm"},fu={class:"q-mb-md text-center"},hu={class:"text-center"},mu={class:"q-mt-md q-mb-md text-center",style:{display:"block","font-family":"monospace","white-space":"pre-wrap","word-wrap":"break-word","max-width":"350px",margin:"0 auto","font-size":"13px"}};function gu(e,t,n,i,o,s){return e.sendData.paymentRequest?(b(),V("div",du,[m("div",fu,[c(x,{rounded:"",dense:"",color:"primary",class:"q-px-md",onClick:e.clickPaymentRequest},{default:f(()=>[e.loading?(b(),B(ht,{key:1,size:"1em",class:"q-mr-md"})):(b(),B(ie,{key:0,name:"send",class:"q-pr-xs"})),E(" Pay via "+S(e.getPaymentRequestTransportType(e.sendData.paymentRequest)),1)]),_:1},8,["onClick"])]),m("div",hu,[m("span",mu," Pay to "+S(e.getPaymentRequestTarget(e.sendData.paymentRequest)),1)])])):N("",!0)}var pu=Te(uu,[["render",gu]]);const vu=xe({name:"NumericKeyboard",props:{modelValue:{type:String,default:"0"}},emits:["update:modelValue","done"],computed:{...ne(Ce,["showNumericKeyboard"]),...ne(st,["useNumericKeyboard"])},methods:{addDigit(e){const t=this.modelValue||"0",n=t==="0"?e:t+e;this.$emit("update:modelValue",n)},backspace(){const e=this.modelValue||"0",t=e.length>1?e.slice(0,-1):"0";this.$emit("update:modelValue",t)},addComma(){const e=this.modelValue||"0";e.includes(".")||this.$emit("update:modelValue",e+".")},closeKeyboard(){this.useNumericKeyboard=!1,this.showNumericKeyboard=!1,yo(this.$i18n.t("NumericKeyboard.actions.close.closed_info_text"),"bottom")},emitDone(){this.$emit("done")}}}),yu=e=>(mn("data-v-2da46958"),e=e(),gn(),e),_u={class:"keyboard-grid"},wu=yu(()=>m("br",null,null,-1));function ku(e,t,n,i,o,s){return b(),B(Ze,{name:"slide-up-fade"},{default:f(()=>[e.showNumericKeyboard?(b(),B(Oe,{key:0,class:"numeric-keyboard q-pa-md q-pb-xl q-pt-lg",style:{position:"fixed",bottom:"0",left:"50%",transform:"translateX(-50%)",width:"100%","max-width":"650px"}},{default:f(()=>[m("div",_u,[c(x,{flat:"",dense:"",class:"text-h5",onClick:t[0]||(t[0]=a=>e.addDigit("1"))},{default:f(()=>[E("1")]),_:1}),c(x,{flat:"",dense:"",class:"text-h5",onClick:t[1]||(t[1]=a=>e.addDigit("2"))},{default:f(()=>[E("2")]),_:1}),c(x,{flat:"",dense:"",class:"text-h5",onClick:t[2]||(t[2]=a=>e.addDigit("3"))},{default:f(()=>[E("3")]),_:1}),c(x,{flat:"",dense:"",class:"text-h5",onClick:t[3]||(t[3]=a=>e.addDigit("4"))},{default:f(()=>[E("4")]),_:1}),c(x,{flat:"",dense:"",class:"text-h5",onClick:t[4]||(t[4]=a=>e.addDigit("5"))},{default:f(()=>[E("5")]),_:1}),c(x,{flat:"",dense:"",class:"text-h5",onClick:t[5]||(t[5]=a=>e.addDigit("6"))},{default:f(()=>[E("6")]),_:1}),c(x,{flat:"",dense:"",class:"text-h5",onClick:t[6]||(t[6]=a=>e.addDigit("7"))},{default:f(()=>[E("7")]),_:1}),c(x,{flat:"",dense:"",class:"text-h5",onClick:t[7]||(t[7]=a=>e.addDigit("8"))},{default:f(()=>[E("8")]),_:1}),c(x,{flat:"",dense:"",class:"text-h5",onClick:t[8]||(t[8]=a=>e.addDigit("9"))},{default:f(()=>[E("9")]),_:1}),c(x,{flat:"",dense:"",class:"text-h5",onClick:e.addComma},{default:f(()=>[E(".")]),_:1},8,["onClick"]),c(x,{flat:"",dense:"",class:"text-h5",onClick:t[9]||(t[9]=a=>e.addDigit("0"))},{default:f(()=>[E("0")]),_:1}),c(x,{flat:"",dense:"",class:"text-h5",onClick:e.backspace},{default:f(()=>[c(ie,{name:"backspace",size:"sm"})]),_:1},8,["onClick"]),c(x,{flat:"",dense:"",onClick:e.closeKeyboard},{default:f(()=>[E(S(e.$t("NumericKeyboard.actions.close.label")),1)]),_:1},8,["onClick"]),wu,c(x,{flat:"",dense:"",onClick:e.emitDone},{default:f(()=>[E(S(e.$t("NumericKeyboard.actions.enter.label")),1)]),_:1},8,["onClick"])])]),_:1})):N("",!0)]),_:1})}var Ho=Te(vu,[["render",ku],["__scopeId","data-v-2da46958"]]);const bu=xe({name:"SendTokenDialog",mixins:[windowMixin],components:{ChooseMint:Vn,TokenInformation:Co,SendPaymentRequest:pu,NumericKeyboard:Ho,ScanIcon:Ft,NfcIcon:ki,ShareIcon:xa,ZapIcon:pn},props:{},data:function(){return{baseURL:location.protocol+"//"+location.host+location.pathname,showAnimatedQR:!1,qrCodeFragment:"",qrInterval:null,encoder:null,showDeleteDialog:!1,p2pkInput:"",currentFragmentLength:150,fragmentLengthMedium:100,fragmentLengthShort:50,fragmentLengthLong:150,fragmentLengthLabel:"L",currentFragmentInterval:150,fragmentIntervalMedium:250,fragmentIntervalFast:150,framentInervalSlow:500,fragmentSpeedLabel:"F",isV4Token:!1,scanningCard:!1,showExpandedButtons:!1}},computed:{...ne(Zt,["showSendTokens","showLockInput","sendData"]),...ne(Ve,["camera","hasCamera"]),...Y(Ce,["tickerShort","canPasteFromClipboard","globalMutexLock","ndefSupported","webShareSupported"]),...ne(Ce,["showNumericKeyboard"]),...Y(ve,["mints","activeProofs","activeUnit","activeUnitLabel","activeUnitCurrencyMultiplyer","activeMintUrl","activeBalance"]),...Y(st,["checkSentTokens","includeFeesInSendAmount","nfcEncoding","useNumericKeyboard"]),...Y(Gt,["bitcoinPrice","bitcoinPrices","currentCurrencyPrice"]),...Y(st,["bitcoinPriceCurrency"]),...Y(Xt,["tokenWorkerRunning"]),...ne($e,["payInvoiceData"]),canMakePayments:function(){return!!this.mints.length},sumProofs:function(){return pe.getProofs(pe.decode(this.sendData.tokensBase64)).flat().reduce((t,n)=>t+=n.amount,0)},displayUnit:function(){return this.formatCurrency(this.sumProofs,this.tokenUnit)},tokenUnit:function(){return pe.getUnit(pe.decode(this.sendData.tokensBase64))},tokenMintUrl:function(){return pe.getMint(pe.decode(this.sendData.tokensBase64))},paidFees:function(){return this.sumProofs-Math.abs(this.sendData.historyAmount)},displayMemo:function(){return pe.getMemo(pe.decode(this.sendData.tokensBase64))},shortUrl:function(){return At(this.tokenMintUrl)},decodedToken:function(){return pe.decode(this.sendData.tokensBase64)},runnerActive:function(){return this.tokenWorkerRunning},canSpendOffline:function(){if(!this.sendData.amount)return!1;let e=this.spendableProofs(this.activeProofs);const t=$e().wallet;let n=this.coinSelect(e,t,this.sendData.amount*this.activeUnitCurrencyMultiplyer,this.includeFeesInSendAmount);const i=this.includeFeesInSendAmount?this.getFeesForProofs(n):0;return n.flat().reduce((s,a)=>s+=a.amount,0)==this.sendData.amount*this.activeUnitCurrencyMultiplyer+i}},watch:{"sendData.tokensBase64":function(e){if(this.showAnimatedQR=!1,!e.length)return;const n=pe.decode(e).proofs;if(n.length)n.length<=2?this.qrCodeFragment=e:(this.showAnimatedQR=!0,this.qrCodeFragment="",this.startQrCodeLoop());else return;this.isV4Token=e.startsWith("cashuB")},showSendTokens:function(e){if(e){if(this.$nextTick(()=>{this.sendData.tokensBase64.length?this.showNumericKeyboard=!1:this.showNumericKeyboard=!0}),this.sendData.historyToken&&this.sendData.historyToken.amount<0&&this.sendData.historyToken.status==="pending"){if(!this.checkSentTokens){console.log("settingsStore.checkSentTokens is disabled, skipping token check");return}this.checkTokenSpendable(this.sendData.historyToken,!1)||(this.sendData.historyToken.status="paid")}}else clearInterval(this.qrInterval),this.sendData.data="",this.sendData.tokensBase64="",this.sendData.historyToken=null,this.sendData.paymentRequest=null}},methods:{...J(Xt,["clearAllWorkers"]),...J($e,["send","sendToLock","coinSelect","spendableProofs","getFeesForProofs","onTokenPaid","mintWallet","checkTokenSpendable"]),...J(wo,["serializeProofs"]),...J(mt,["addPendingToken","setTokenPaid","deleteToken"]),...J(dt,["isValidPubkey","maybeConvertNpub"]),...J(Ve,["closeCamera","showCamera"]),...J(ve,["toggleUnit"]),encodeToPeanut:function(e){return"\u{1F95C}"+Array.from(e).map(t=>{const n=t.charCodeAt(0);if(n>=0&&n<=15)return String.fromCodePoint(65024+n);if(n>=16&&n<=255)return String.fromCodePoint(917760+(n-16))}).join("")},decodeToken:function(e){return pe.decode(e)},getProofs:function(e){return pe.getProofs(e)},getAmount:function(e){return pe.getAmount(e)},getUnit:function(e){return pe.getUnit(e)},getMint:function(e){return pe.getMint(e)},toggleExpandButtons(){this.showExpandedButtons=!this.showExpandedButtons},startQrCodeLoop:async function(){if(this.sendData.tokensBase64.length==0)return;const e=Ie.Buffer.from(this.sendData.tokensBase64),t=Un.fromBuffer(e),n=0;this.encoder=new ru(t,this.currentFragmentLength,n),clearInterval(this.qrInterval),this.qrInterval=setInterval(()=>{this.qrCodeFragment=this.encoder.nextPart()},this.currentFragmentInterval)},updateQrCode:function(){this.qrCodeFragment=this.encoder.nextPart()},changeSpeed:function(){this.currentFragmentInterval==this.fragmentIntervalMedium?(this.currentFragmentInterval=this.framentInervalSlow,this.fragmentSpeedLabel="S"):this.currentFragmentInterval==this.framentInervalSlow?(this.currentFragmentInterval=this.fragmentIntervalFast,this.fragmentSpeedLabel="F"):(this.currentFragmentInterval=this.fragmentIntervalMedium,this.fragmentSpeedLabel="M"),console.log("### this.currentFragmentInterval",this.currentFragmentInterval),this.startQrCodeLoop()},changeSize:function(){this.currentFragmentLength==this.fragmentLengthMedium?(this.currentFragmentLength=this.fragmentLengthShort,this.fragmentLengthLabel="S"):this.currentFragmentLength==this.fragmentLengthShort?(this.currentFragmentLength=this.fragmentLengthLong,this.fragmentLengthLabel="L"):(this.currentFragmentLength=this.fragmentLengthMedium,this.fragmentLengthLabel="M"),console.log("### this.currentFragmentLength",this.currentFragmentLength),this.startQrCodeLoop()},toggleTokenEncoding:function(){const e=Ni(this.sendData.tokensBase64);if(this.sendData.tokensBase64.startsWith("cashuA"))try{this.sendData.tokensBase64=Ns(e)}catch{console.log("### Could not encode token to V4"),this.sendData.tokensBase64=Li(e,{version:3})}else this.sendData.tokensBase64=Li(e,{version:3})},deleteThisToken:function(){this.deleteToken(this.sendData.tokensBase64),this.showSendTokens=!1,this.showDeleteDialog=!1,this.clearAllWorkers()},writeTokensToCard:function(){if(!this.scanningCard)try{this.ndef=new NDEFReader,this.controller=new AbortController;const e=this.controller.signal;this.ndef.scan({signal:e}).then(()=>{console.log("> Scan started"),this.ndef.onreadingerror=t=>{console.error(`NFC read failed: ${t}`),Tt(`${err.message}`,"NFC read failed"),this.controller.abort(),this.scanningCard=!1},this.ndef.onreading=({message:t,serialNumber:n})=>{console.log(`Read card ${n}`),this.controller.abort(),this.scanningCard=!1;try{let i=[];switch(this.nfcEncoding){case"text":i=[{recordType:"text",data:`${this.sendData.tokensBase64}`,lang:"en"}];break;case"weburl":i=[{recordType:"url",data:`${window.location}#token=${this.sendData.tokensBase64}`}];break;case"binary":const o=Ni(this.sendData.tokensBase64),s=Ls(o);i=[{recordType:"mime",mediaType:"application/octet-stream",data:s}];break;default:throw new Error(`Unknown NFC encoding: ${this.nfcEncoding}`)}un("Writing to NFC card..."),this.ndef.write({records:i},{overwrite:!0}).then(()=>{console.log("Successfully flashed token to card!"),un("Successfully flashed token to card!")}).catch(o=>{console.error(`NFC write failed: The card may not have enough capacity (needed ${i[0].data.length} bytes).`),Tt(`The card may not have enough capacity (needed ${i[0].data.length} bytes).`,"NFC write failed")})}catch(i){console.error(`NFC error: ${i.message}`),Tt(`${i.message}`,"NFC error")}},this.scanningCard=!0}).catch(t=>{console.error(`NFC error: ${t.message}`),Tt(`${err.message}`,"NFC error"),this.scanningCard=!1})}catch(e){console.error(`NFC error: ${e.message}`),Tt(`${err.message}`,"NFC error"),this.scanningCard=!1}},closeCardScanner:function(){this.controller.abort(),this.scanningCard=!1},lockTokens:async function(){let e=Math.floor(this.sendData.amount*this.activeUnitCurrencyMultiplyer);try{const t=this.mintWallet(this.activeMintUrl,this.activeUnit);let{_:n,sendProofs:i}=await this.sendToLock(this.activeProofs,t,e,this.sendData.p2pkPubkey);this.sendData.tokens=i,this.sendData.tokensBase64=this.serializeProofs(i);const o={amount:-this.sendData.amount,token:this.sendData.tokensBase64,unit:this.activeUnit,mint:this.activeMintUrl};this.addPendingToken(o),this.sendData.historyToken=o,this.g.offline||this.onTokenPaid(o)}catch(t){console.error(t)}},sendTokens:async function(){if(this.showNumericKeyboard=!1,this.sendData.p2pkPubkey=this.maybeConvertNpub(this.sendData.p2pkPubkey),this.sendData.p2pkPubkey&&this.isValidPubkey(this.sendData.p2pkPubkey)){await this.lockTokens();return}try{let e=Math.floor(this.sendData.amount*this.activeUnitCurrencyMultiplyer);const t=this.mintWallet(this.activeMintUrl,this.activeUnit);let{_:n,sendProofs:i}=await this.send(this.activeProofs,t,e,!0,this.includeFeesInSendAmount);this.sendData.tokens=i,this.sendData.tokensBase64=this.serializeProofs(i),this.sendData.historyAmount=-this.sendData.amount*this.activeUnitCurrencyMultiplyer;const o={amount:-e,token:this.sendData.tokensBase64,unit:this.activeUnit,mint:this.activeMintUrl,paymentRequest:this.sendData.paymentRequest,status:"pending"};this.addPendingToken(o),this.sendData.historyToken=o,this.g.offline||this.onTokenPaid(o)}catch(e){console.error(e)}},pasteToP2PKField:async function(){console.log("pasteToParseDialog");const e=await Ce().pasteFromClipboard();this.sendData.p2pkPubkey=e.trim()},shareToken:async function(){if(!this.webShareSupported){console.log("Web Share API not supported");return}const e={text:`cashu:${this.sendData.tokensBase64}`};try{await navigator.share(e),console.log("Token shared successfully")}catch(t){t.name!=="AbortError"&&console.error("Error sharing token:",t)}},showParseDialog:function(){if(!this.canMakePayments){dn(this.$i18n.t("SendDialog.actions.lightning.error_no_mints")),this.showSendTokens=!1;return}this.payInvoiceData.show=!0,this.payInvoiceData.invoice=null,this.payInvoiceData.lnurlpay=null,this.payInvoiceData.domain="",this.payInvoiceData.lnurlauth=null,this.payInvoiceData.input.request="",this.payInvoiceData.input.comment="",this.showSendTokens=!1}}}),Du={key:1},Cu={class:"row items-center no-wrap q-mb-sm q-py-lg"},Pu={class:"col-8"},$u={key:0,class:"text-h6"},Tu={key:1,class:"text-h6"},qu={key:0,class:"text-primary text-weight-bold"},Mu={key:2,class:"q-ml-xs text-subtitle2 text-grey-6"},Su={class:"col-4 text-right",style:{height:"30px"}},Au={class:"text-subtitle2 text-weight-medium"},Iu={class:"row items-center no-wrap q-my-sm q-py-none"},Eu={class:"col-12"},Ru={key:0,class:"row items-center no-wrap"},Uu={class:"col-4 q-mx-md"},xu={key:0,class:"row q-mt-lg"},Nu={key:1,class:"row"},Lu={key:1,class:"row q-mt-lg"},Bu={class:"text-center"},Fu={key:2,class:"text-center q-mb-xs"},Ou={key:0,class:"text-center q-mb-md"},zu={style:{height:"2px"}},Vu={class:"q-pb-xs q-ba-none q-gutter-sm"},Wu={class:"row justify-center"},ju={class:"row justify-center q-pt-sm"},Qu={key:0,class:"row justify-center q-pt-sm"},Ku={key:1,class:"row justify-center"},Hu={class:"row justify-center q-pt-md"},Gu={key:2,class:"row justify-center q-pt-sm"},Xu={class:"row items-center justify-between q-mt-lg"},Zu={class:"row items-center"},Yu={key:0,class:"row q-gutter-sm"},Ju=m("div",{class:"row items-center no-wrap q-mb-sm"},[m("div",{class:"col-12"},[m("span",{class:"text-h6"},"Delete Ecash")])],-1),ed={class:"row items-center no-wrap q-my-sm q-py-none"},td={class:"col-12"},nd={class:"row q-mt-lg"};function id(e,t,n,i,o,s){const a=H("NumericKeyboard"),r=H("ChooseMint"),l=H("ScanIcon"),g=H("ZapIcon"),y=H("vue-qrcode"),D=H("TokenInformation"),_=H("SendPaymentRequest"),q=H("ShareIcon"),I=H("NfcIcon");return b(),V(Je,null,[c(Xe,{modelValue:e.showSendTokens,"onUpdate:modelValue":t[10]||(t[10]=R=>e.showSendTokens=R),position:"top",maximized:e.$q.screen.lt.sm,"backdrop-filter":"blur(2px) brightness(60%)","transition-show":"fade","transition-hide":"fade","no-backdrop-dismiss":"","full-height":"",onShow:e.onDialogShown},{default:f(()=>[c(Oe,{class:"q-pa-none q-pt-none qcard"},{default:f(()=>[e.showNumericKeyboard&&e.useNumericKeyboard?(b(),B(a,{key:0,"model-value":e.sendData.amount,"onUpdate:modelValue":t[0]||(t[0]=R=>e.sendData.amount=R),onDone:e.sendTokens},null,8,["model-value","onDone"])):N("",!0),e.sendData.tokens?(b(),V("div",Fu,[c(Ne,{class:"q-pa-none q-pt-md"},{default:f(()=>[e.qrCodeFragment?(b(),V("div",Ou,[c(fi,{ratio:1,class:"q-mx-none"},{default:f(()=>[c(y,{value:e.qrCodeFragment,options:{width:400},class:"rounded-borders",onClick:t[5]||(t[5]=R=>e.copyText(e.sendData.tokensBase64))},null,8,["value"])]),_:1}),m("div",zu,[e.runnerActive?(b(),B(vi,{key:0,indeterminate:"",color:"primary"})):N("",!0)])])):N("",!0),m("div",Vu,[e.showAnimatedQR?(b(),B(x,{key:0,flat:"",style:{"font-size":"10px"},color:"grey",class:"q-ma-none",onClick:e.changeSpeed},{default:f(()=>[c(ie,{name:"speed",style:{"margin-right":"8px"}}),E(" Speed: "+S(e.fragmentSpeedLabel),1)]),_:1},8,["onClick"])):N("",!0),c(Nt,{color:e.isV4Token?"grey":"primary",label:e.isV4Token?"V4":"V3",class:"q-my-sm q-mx-md cursor-pointer",onClick:e.toggleTokenEncoding,outline:e.isV4Token},null,8,["color","label","onClick","outline"]),e.showAnimatedQR?(b(),B(x,{key:1,flat:"",style:{"font-size":"10px"},class:"q-ma-none",color:"grey",onClick:e.changeSize},{default:f(()=>[c(ie,{name:"zoom_in",style:{"margin-right":"8px"}}),E(" Size: "+S(e.fragmentLengthLabel),1)]),_:1},8,["onClick"])):N("",!0)]),c(Ne,{class:"q-pa-sm"},{default:f(()=>[m("div",Wu,[c(Ge,{overline:"",class:"q-mb-sm text-white",style:{"font-size":"1rem"}},{default:f(()=>[E(S(e.sendData.historyToken.amount&&e.sendData.historyToken.amount<0?e.sendData.historyToken.status==="paid"?"Sent":"Pending":"Received")+" Ecash",1)]),_:1})]),m("div",ju,[c(Ge,{style:{"font-size":"30px"},class:"text-weight-bold"},{default:f(()=>[c(ie,{name:e.sendData.historyToken.amount>=0?"call_received":"call_made",color:e.sendData.historyToken.status==="paid"?e.sendData.historyToken.amount>=0?"green":"red":"",class:"q-mr-xs q-mb-xs",size:"sm"},null,8,["name","color"]),m("strong",null,S(e.displayUnit),1)]),_:1})]),e.paidFees?(b(),V("div",Qu,[c(Ge,{class:"text-weight-bold"},{default:f(()=>[E(" Fee: "+S(e.formatCurrency(e.paidFees,e.tokenUnit)),1)]),_:1})])):N("",!0),e.sendData.historyToken.amount&&e.sendData.historyToken.amount<0&&e.sendData.historyToken.status==="paid"?(b(),V("div",Ku)):N("",!0),m("div",Hu,[c(D,{encodedToken:e.sendData.tokensBase64,showAmount:!1,showP2PKCheck:!1},null,8,["encodedToken"])]),e.sendData.paymentRequest&&e.sendData.historyToken.amount<0&&e.sendData.historyToken.status==="pending"?(b(),V("div",Gu,[c(_)])):N("",!0),m("div",Xu,[m("div",Zu,[c(x,{class:"q-ml-md",size:"md",flat:"",dense:"",onClick:t[6]||(t[6]=R=>e.copyText(e.sendData.tokensBase64))},{default:f(()=>[E(S(e.$t("SendTokenDialog.actions.copy_tokens.label")),1)]),_:1}),c(x,{class:"q-mx-none",size:"md",flat:"",dense:"",onClick:e.toggleExpandButtons},{default:f(()=>[c(ie,{name:e.showExpandedButtons?"chevron_left":"chevron_right"},null,8,["name"])]),_:1},8,["onClick"]),e.showExpandedButtons?(b(),V("div",Yu,[c(x,{class:"q-mr-xs",size:"md",flat:"",dense:"",onClick:t[7]||(t[7]=R=>e.copyText(e.encodeToPeanut(e.sendData.tokensBase64)))},{default:f(()=>[E(S(e.$t("SendTokenDialog.actions.copy_emoji.label"))+" ",1),c(Le,null,{default:f(()=>[E(S(e.$t("SendTokenDialog.actions.copy_emoji.tooltip_text")),1)]),_:1})]),_:1}),c(x,{class:"q-mx-none",color:"grey",size:"md",dense:"",icon:"link",flat:"",onClick:t[8]||(t[8]=R=>e.copyText(e.baseURL+"#token="+e.sendData.tokensBase64))},{default:f(()=>[c(Le,null,{default:f(()=>[E(S(e.$t("SendTokenDialog.actions.copy_link.tooltip_text")),1)]),_:1})]),_:1}),e.webShareSupported?(b(),B(x,{key:0,class:"q-mx-none",color:"grey",size:"md",dense:"",flat:"",onClick:e.shareToken},{default:f(()=>[c(q,{size:"18"}),c(Le,null,{default:f(()=>[E(S(e.$t("SendTokenDialog.actions.share.tooltip_text")),1)]),_:1})]),_:1},8,["onClick"])):N("",!0),e.hasCamera&&!e.sendData.paymentRequest&&e.sendData.historyAmount<0?(b(),B(x,{key:1,unelevated:"",dense:"",size:"sm",class:"q-mx-none",onClick:e.showCamera},{default:f(()=>[c(l)]),_:1},8,["onClick"])):N("",!0),e.ndefSupported&&!e.sendData.paymentRequest&&e.sendData.historyAmount<0?(b(),B(x,{key:2,unelevated:"",dense:"",disabled:e.scanningCard,loading:e.scanningCard,class:"q-mx-none",size:"sm",onClick:e.writeTokensToCard,flat:""},{loading:f(()=>[c(zn,{onClick:e.closeCardScanner},null,8,["onClick"])]),default:f(()=>[c(I),c(Le,null,{default:f(()=>[E(S(e.ndefSupported?e.$t("SendTokenDialog.actions.write_tokens_to_card.tooltips.ndef_supported_text"):e.$t("SendTokenDialog.actions.write_tokens_to_card.tooltips.ndef_unsupported_text")),1)]),_:1})]),_:1},8,["disabled","loading","onClick"])):N("",!0),c(x,{class:"q-mx-none",color:"grey",dense:"",icon:"delete",size:"md",onClick:t[9]||(t[9]=R=>{e.showDeleteDialog=!0,e.closeCardScanner()}),flat:""},{default:f(()=>[c(Le,null,{default:f(()=>[E(S(e.$t("SendTokenDialog.actions.delete.tooltip_text")),1)]),_:1})]),_:1})])):N("",!0)]),Ae((b(),B(x,{onClick:e.closeCardScanner,flat:"",color:"grey",class:"q-ml-auto q-mr-md"},{default:f(()=>[E(S(e.$t("SendTokenDialog.actions.close_card_scanner.label")),1)]),_:1},8,["onClick"])),[[Be]])])]),_:1})]),_:1})])):(b(),V("div",Du,[c(Ne,{class:"q-pa-lg q-pt-md"},{default:f(()=>[m("div",Cu,[m("div",Pu,[e.sendData.paymentRequest?N("",!0):(b(),V("span",$u,S(e.$t("SendTokenDialog.title",{value:e.sendData.amount?e.formatCurrency(e.sendData.amount*e.activeUnitCurrencyMultiplyer,e.activeUnit):e.$t("SendTokenDialog.title_ecash_text")})),1)),e.sendData.paymentRequest?(b(),V("span",Tu,[E("Pay request "),e.sendData.paymentRequest.amount?(b(),V("span",qu," of "+S(e.formatCurrency(e.sendData.paymentRequest.amount,e.sendData.paymentRequest.unit)),1)):N("",!0)])):N("",!0),e.sendData.amount&&e.bitcoinPrice&&e.activeUnit=="points"?(b(),V("span",Mu," ("+S(e.formatCurrency(e.currentCurrencyPrice/1e8*e.sendData.amount*e.activeUnitCurrencyMultiplyer,e.bitcoinPriceCurrency,!0))+") ",1)):N("",!0)]),m("div",Su,[c(Ze,{appear:"","enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut"},{default:f(()=>[e.canSpendOffline&&!e.sendData.p2pkPubkey&&!e.showLockInput?(b(),B(Nt,{key:0,outline:"",rounded:"",color:"grey",class:"float-right",size:"lg"},{default:f(()=>[c(ie,{name:"check",color:"primary",class:"q-mr-sm",size:"sm"}),m("span",Au,S(e.$t("SendTokenDialog.badge_offline_text")),1)]),_:1})):N("",!0)]),_:1})])]),m("div",Iu,[m("div",Eu,[c(r)])]),c(gt,{type:"number",modelValue:e.sendData.amount,"onUpdate:modelValue":t[2]||(t[2]=R=>e.sendData.amount=R),modelModifiers:{number:!0},label:e.$t("SendTokenDialog.inputs.amount.label",{ticker:e.tickerShort}),mask:"#","fill-mask":"0","reverse-fill-mask":"",round:"",outlined:"",autofocus:"",class:"q-mb-lg",onKeyup:St(e.sendTokens,["enter"]),disable:e.sendData.paymentRequest&&e.sendData.amount&&e.sendData.paymentRequest.amount==e.sendData.amount},{default:f(()=>[c(x,{flat:"",color:"primary",onClick:t[1]||(t[1]=R=>e.toggleUnit()),label:e.activeUnitLabel},null,8,["label"])]),_:1},8,["modelValue","label","onKeyup","disable"]),c(Ze,{appear:"","enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut"},{default:f(()=>[e.showLockInput?(b(),V("div",Ru,[m("div",{class:cn(e.sendData.p2pkPubkey?"col-12":"col-8")},[c(gt,{modelValue:e.sendData.p2pkPubkey,"onUpdate:modelValue":t[3]||(t[3]=R=>e.sendData.p2pkPubkey=R),label:e.sendData.p2pkPubkey&&!e.isValidPubkey(e.sendData.p2pkPubkey)?e.$t("SendTokenDialog.inputs.p2pk_pubkey.label_invalid"):e.$t("SendTokenDialog.inputs.p2pk_pubkey.label"),outlined:"",clearable:"",color:e.sendData.p2pkPubkey&&!e.isValidPubkey(e.sendData.p2pkPubkey)?"red":"",onKeyup:St(e.lockTokens,["enter"])},null,8,["modelValue","label","color","onKeyup"])],2),m("div",Uu,[e.canPasteFromClipboard&&!e.sendData.p2pkPubkey?(b(),B(x,{key:0,unelevated:"",icon:"content_paste",onClick:e.pasteToP2PKField},{default:f(()=>[c(Le,null,{default:f(()=>[E(S(e.$t("SendTokenDialog.actions.paste_p2pk_pubkey.tooltip_text")),1)]),_:1})]),_:1},8,["onClick"])):N("",!0),e.sendData.p2pkPubkey?N("",!0):(b(),B(x,{key:1,align:"center",flat:"",outline:"",color:"primary",round:"",onClick:e.showCamera},{default:f(()=>[c(l,{size:"1.5em"})]),_:1},8,["onClick"]))])])):N("",!0)]),_:1}),e.activeBalance>=e.sendData.amount?(b(),V("div",xu,[e.sendData.tokens?N("",!0):(b(),B(x,{key:0,disable:e.sendData.amount==null||e.sendData.amount<=0||e.sendData.p2pkPubkey!=""&&!e.isValidPubkey(e.sendData.p2pkPubkey),onClick:e.sendTokens,color:"primary",rounded:"",type:"submit",loading:e.globalMutexLock},{loading:f(()=>[c(ht)]),default:f(()=>[E(S(e.$t("SendTokenDialog.actions.send.label"))+" ",1)]),_:1},8,["disable","onClick","loading"])),e.sendData.p2pkPubkey&&e.isValidPubkey(e.sendData.p2pkPubkey)?(b(),V("div",Nu,[c(Ze,{appear:"","enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut"},{default:f(()=>[c(Kt,{outline:"",color:"primary",icon:"lock",class:"q-ml-md q-pa-md"},{default:f(()=>[E(" Locked ")]),_:1})]),_:1})])):N("",!0),c(Ze,{appear:"","enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut"},{default:f(()=>[e.sendData.amount>0&&!e.showLockInput&&e.activeBalance>=e.sendData.amount?(b(),B(x,{key:0,disable:e.sendData.p2pkPubkey==null||e.sendData.amount<=0,color:"primary",class:"q-ml-sm",rounded:"",flat:"",onClick:t[4]||(t[4]=R=>e.showLockInput=!0)},{default:f(()=>[E(S(e.$t("SendTokenDialog.actions.lock.label")),1)]),_:1},8,["disable"])):N("",!0)]),_:1}),Ae((b(),B(x,{rounded:"",flat:"",color:"grey",class:"q-ml-auto"},{default:f(()=>[E(S(e.$t("SendTokenDialog.actions.close.label")),1)]),_:1})),[[Be]])])):(b(),V("div",Lu,[c(x,{unelevated:"",rounded:"",disabled:"",color:"yellow","text-color":"black"},{default:f(()=>[E(S(e.$t("SendTokenDialog.inputs.amount.invalid_too_much_error_text")),1)]),_:1}),Ae((b(),B(x,{rounded:"",flat:"",color:"grey",class:"q-ml-auto"},{default:f(()=>[E(S(e.$t("SendTokenDialog.actions.close.label")),1)]),_:1})),[[Be]])]))]),_:1}),c(Ne,{class:"q-pt-none"},{default:f(()=>[m("div",Bu,[c(x,{onClick:e.showParseDialog,flat:"",color:"primary",size:"sm"},{default:f(()=>[c(g,{size:"1em",class:"q-mr-xs"}),E(" "+S(e.$t("SendDialog.actions.lightning.label")),1)]),_:1},8,["onClick"])])]),_:1})]))]),_:1})]),_:1},8,["modelValue","maximized","onShow"]),c(Xe,{modelValue:e.showDeleteDialog,"onUpdate:modelValue":t[11]||(t[11]=R=>e.showDeleteDialog=R)},{default:f(()=>[c(Oe,{class:"q-pa-lg q-pt-md qcard"},{default:f(()=>[c(Ne,{class:"q-pa-none"},{default:f(()=>[Ju,m("div",ed,[m("div",td,[c(Ge,null,{default:f(()=>[E(" Are you sure you want to delete this transaction from your history? ")]),_:1}),c(Ge,{class:"q-pt-md text-weight-bold"},{default:f(()=>[E(" Warning: This action cannot be undone and there is no way to recover the token. ")]),_:1})])]),m("div",nd,[c(x,{onClick:e.deleteThisToken,color:"negative",rounded:"",class:"q-mr-sm"},{default:f(()=>[E("Delete")]),_:1},8,["onClick"]),Ae((b(),B(x,{rounded:"",flat:"",color:"grey",class:"q-ml-auto"},{default:f(()=>[E("Cancel")]),_:1})),[[Be]])])]),_:1})]),_:1})]),_:1},8,["modelValue"])],64)}var od=Te(bu,[["render",id]]),eo=Bt({name:"QForm",props:{autofocus:Boolean,noErrorFocus:Boolean,noResetFocus:Boolean,greedy:Boolean,onSubmit:Function},emits:["reset","validationSuccess","validationError"],setup(e,{slots:t,emit:n}){const i=Lt(),o=De(null);let s=0;const a=[];function r(q){const I=typeof q=="boolean"?q:e.noErrorFocus!==!0,R=++s,W=(F,X)=>{n(`validation${F===!0?"Success":"Error"}`,X)},K=F=>{const X=F.validate();return typeof X.then=="function"?X.then(re=>({valid:re,comp:F}),re=>({valid:!1,comp:F,err:re})):Promise.resolve({valid:X,comp:F})};return(e.greedy===!0?Promise.all(a.map(K)).then(F=>F.filter(X=>X.valid!==!0)):a.reduce((F,X)=>F.then(()=>K(X).then(re=>{if(re.valid===!1)return Promise.reject(re)})),Promise.resolve()).catch(F=>[F])).then(F=>{if(F===void 0||F.length===0)return R===s&&W(!0),!0;if(R===s){const{comp:X,err:re}=F[0];if(re!==void 0&&console.error(re),W(!1,X),I===!0){const fe=F.find(({comp:ye})=>typeof ye.focus=="function"&&os(ye.$)===!1);fe!==void 0&&fe.comp.focus()}}return!1})}function l(){s++,a.forEach(q=>{typeof q.resetValidation=="function"&&q.resetValidation()})}function g(q){q!==void 0&&ln(q);const I=s+1;r().then(R=>{I===s&&R===!0&&(e.onSubmit!==void 0?n("submit",q):q?.target!==void 0&&typeof q.target.submit=="function"&&q.target.submit())})}function y(q){q!==void 0&&ln(q),n("reset"),ss(()=>{l(),e.autofocus===!0&&e.noResetFocus!==!0&&D()})}function D(){_s(()=>{if(o.value===null)return;(o.value.querySelector("[autofocus][tabindex], [data-autofocus][tabindex]")||o.value.querySelector("[autofocus] [tabindex], [data-autofocus] [tabindex]")||o.value.querySelector("[autofocus], [data-autofocus]")||Array.prototype.find.call(o.value.querySelectorAll("[tabindex]"),I=>I.tabIndex!==-1))?.focus({preventScroll:!0})})}so(as,{bindComponent(q){a.push(q)},unbindComponent(q){const I=a.indexOf(q);I!==-1&&a.splice(I,1)}});let _=!1;return ao(()=>{_=!0}),ro(()=>{_===!0&&e.autofocus===!0&&D()}),ui(()=>{e.autofocus===!0&&D()}),Object.assign(i.proxy,{validate:r,resetValidation:l,submit:g,reset:y,focus:D,getValidationComponents:()=>a}),()=>me("form",{class:"q-form",ref:o,onSubmit:g,onReset:y},di(t.default))}});const to="q-slider__marker-labels",sd=e=>({value:e}),ad=({marker:e})=>me("div",{key:e.value,style:e.style,class:e.classes},e.label),Go=[34,37,40,33,39,38],rd={...mi,...ws,min:{type:Number,default:0},max:{type:Number,default:100},innerMin:Number,innerMax:Number,step:{type:Number,default:1,validator:e=>e>=0},snap:Boolean,vertical:Boolean,reverse:Boolean,color:String,markerLabelsClass:String,label:Boolean,labelColor:String,labelTextColor:String,labelAlways:Boolean,switchLabelSide:Boolean,markers:[Boolean,Number],markerLabels:[Boolean,Array,Object,Function],switchMarkerLabelsSide:Boolean,trackImg:String,trackColor:String,innerTrackImg:String,innerTrackColor:String,selectionColor:String,selectionImg:String,thumbSize:{type:String,default:"20px"},trackSize:{type:String,default:"4px"},disable:Boolean,readonly:Boolean,dense:Boolean,tabindex:[String,Number],thumbColor:String,thumbPath:{type:String,default:"M 4, 10 a 6,6 0 1,0 12,0 a 6,6 0 1,0 -12,0"}},ld=["pan","update:modelValue","change"];function cd({updateValue:e,updatePosition:t,getDragging:n,formAttrs:i}){const{props:o,emit:s,slots:a,proxy:{$q:r}}=Lt(),l=gi(o,r),g=ks(i),y=De(!1),D=De(!1),_=De(!1),q=De(!1),I=z(()=>o.vertical===!0?"--v":"--h"),R=z(()=>"-"+(o.switchLabelSide===!0?"switched":"standard")),W=z(()=>o.vertical===!0?o.reverse===!0:o.reverse!==(r.lang.rtl===!0)),K=z(()=>isNaN(o.innerMin)===!0||o.innerMin<o.min?o.min:o.innerMin),A=z(()=>isNaN(o.innerMax)===!0||o.innerMax>o.max?o.max:o.innerMax),F=z(()=>o.disable!==!0&&o.readonly!==!0&&K.value<A.value),X=z(()=>{if(o.step===0)return oe=>oe;const O=(String(o.step).trim().split(".")[1]||"").length;return oe=>parseFloat(oe.toFixed(O))}),re=z(()=>o.step===0?1:o.step),fe=z(()=>F.value===!0?o.tabindex||0:-1),ye=z(()=>o.max-o.min),d=z(()=>A.value-K.value),h=z(()=>Ke(K.value)),p=z(()=>Ke(A.value)),T=z(()=>o.vertical===!0?W.value===!0?"bottom":"top":W.value===!0?"right":"left"),v=z(()=>o.vertical===!0?"height":"width"),w=z(()=>o.vertical===!0?"width":"height"),P=z(()=>o.vertical===!0?"vertical":"horizontal"),k=z(()=>{const O={role:"slider","aria-valuemin":K.value,"aria-valuemax":A.value,"aria-orientation":P.value,"data-step":o.step};return o.disable===!0?O["aria-disabled"]="true":o.readonly===!0&&(O["aria-readonly"]="true"),O}),C=z(()=>`q-slider q-slider${I.value} q-slider--${y.value===!0?"":"in"}active inline no-wrap `+(o.vertical===!0?"row":"column")+(o.disable===!0?" disabled":" q-slider--enabled"+(F.value===!0?" q-slider--editable":""))+(_.value==="both"?" q-slider--focus":"")+(o.label||o.labelAlways===!0?" q-slider--label":"")+(o.labelAlways===!0?" q-slider--label-always":"")+(l.value===!0?" q-slider--dark":"")+(o.dense===!0?" q-slider--dense q-slider--dense"+I.value:""));function M(O){const oe="q-slider__"+O;return`${oe} ${oe}${I.value} ${oe}${I.value}${R.value}`}function $(O){const oe="q-slider__"+O;return`${oe} ${oe}${I.value}`}const U=z(()=>{const O=o.selectionColor||o.color;return"q-slider__selection absolute"+(O!==void 0?` text-${O}`:"")}),Z=z(()=>$("markers")+" absolute overflow-hidden"),G=z(()=>$("track-container")),ae=z(()=>M("pin")),Pe=z(()=>M("label")),qe=z(()=>M("text-container")),de=z(()=>M("marker-labels-container")+(o.markerLabelsClass!==void 0?` ${o.markerLabelsClass}`:"")),le=z(()=>"q-slider__track relative-position no-outline"+(o.trackColor!==void 0?` bg-${o.trackColor}`:"")),Fe=z(()=>{const O={[w.value]:o.trackSize};return o.trackImg!==void 0&&(O.backgroundImage=`url(${o.trackImg}) !important`),O}),kt=z(()=>"q-slider__inner absolute"+(o.innerTrackColor!==void 0?` bg-${o.innerTrackColor}`:"")),bt=z(()=>{const O=p.value-h.value,oe={[T.value]:`${100*h.value}%`,[v.value]:O===0?"2px":`${100*O}%`};return o.innerTrackImg!==void 0&&(oe.backgroundImage=`url(${o.innerTrackImg}) !important`),oe});function Dt(O){const{min:oe,max:ge,step:Re}=o;let He=oe+O*(ge-oe);if(Re>0){const Ct=(He-K.value)%Re;He+=(Math.abs(Ct)>=Re/2?(Ct<0?-1:1)*Re:0)-Ct}return He=X.value(He),Ut(He,K.value,A.value)}function Ke(O){return ye.value===0?0:(O-o.min)/ye.value}function vt(O,oe){const ge=rs(O),Re=o.vertical===!0?Ut((ge.top-oe.top)/oe.height,0,1):Ut((ge.left-oe.left)/oe.width,0,1);return Ut(W.value===!0?1-Re:Re,h.value,p.value)}const We=z(()=>ls(o.markers)===!0?o.markers:re.value),Me=z(()=>{const O=[],oe=We.value,ge=o.max;let Re=o.min;do O.push(Re),Re+=oe;while(Re<ge);return O.push(ge),O}),be=z(()=>{const O=` ${to}${I.value}-`;return to+`${O}${o.switchMarkerLabelsSide===!0?"switched":"standard"}${O}${W.value===!0?"rtl":"ltr"}`}),nn=z(()=>o.markerLabels===!1?null:Cn(o.markerLabels).map((O,oe)=>({index:oe,value:O.value,label:O.label||O.value,classes:be.value+(O.classes!==void 0?" "+O.classes:""),style:{...on(O.value),...O.style||{}}}))),bn=z(()=>({markerList:nn.value,markerMap:Qt.value,classes:be.value,getStyle:on})),Dn=z(()=>{const O=d.value===0?"2px":100*We.value/d.value;return{...bt.value,backgroundSize:o.vertical===!0?`2px ${O}%`:`${O}% 2px`}});function Cn(O){if(O===!1)return null;if(O===!0)return Me.value.map(sd);if(typeof O=="function")return Me.value.map(ge=>{const Re=O(ge);return Yn(Re)===!0?{...Re,value:ge}:{value:ge,label:Re}});const oe=({value:ge})=>ge>=o.min&&ge<=o.max;return Array.isArray(O)===!0?O.map(ge=>Yn(ge)===!0?ge:{value:ge}).filter(oe):Object.keys(O).map(ge=>{const Re=O[ge],He=Number(ge);return Yn(Re)===!0?{...Re,value:He}:{value:He,label:Re}}).filter(oe)}function on(O){return{[T.value]:`${100*(O-o.min)/ye.value}%`}}const Qt=z(()=>{if(o.markerLabels===!1)return null;const O={};return nn.value.forEach(oe=>{O[oe.value]=oe}),O});function Q(){if(a["marker-label-group"]!==void 0)return a["marker-label-group"](bn.value);const O=a["marker-label"]||ad;return nn.value.map(oe=>O({marker:oe,...bn.value}))}const ee=z(()=>[[Qs,ce,void 0,{[P.value]:!0,prevent:!0,stop:!0,mouse:!0,mouseAllDir:!0}]]);function ce(O){O.isFinal===!0?(q.value!==void 0&&(t(O.evt),O.touch===!0&&e(!0),q.value=void 0,s("pan","end")),y.value=!1,_.value=!1):O.isFirst===!0?(q.value=n(O.evt),t(O.evt),e(),y.value=!0,s("pan","start")):(t(O.evt),e())}function Se(){_.value=!1}function Ee(O){t(O,n(O)),e(),D.value=!0,y.value=!0,document.addEventListener("mouseup",ke,!0)}function ke(){D.value=!1,y.value=!1,e(!0),Se(),document.removeEventListener("mouseup",ke,!0)}function _e(O){t(O,n(O)),e(!0)}function je(O){Go.includes(O.keyCode)&&e(!0)}function rt(O){if(o.vertical===!0)return null;const oe=r.lang.rtl!==o.reverse?1-O:O;return{transform:`translateX(calc(${2*oe-1} * ${o.thumbSize} / 2 + ${50-100*oe}%))`}}function sn(O){const oe=z(()=>D.value===!1&&(_.value===O.focusValue||_.value==="both")?" q-slider--focus":""),ge=z(()=>`q-slider__thumb q-slider__thumb${I.value} q-slider__thumb${I.value}-${W.value===!0?"rtl":"ltr"} absolute non-selectable`+oe.value+(O.thumbColor.value!==void 0?` text-${O.thumbColor.value}`:"")),Re=z(()=>({width:o.thumbSize,height:o.thumbSize,[T.value]:`${100*O.ratio.value}%`,zIndex:_.value===O.focusValue?2:void 0})),He=z(()=>O.labelColor.value!==void 0?` text-${O.labelColor.value}`:""),Ct=z(()=>rt(O.ratio.value)),Gn=z(()=>"q-slider__text"+(O.labelTextColor.value!==void 0?` text-${O.labelTextColor.value}`:""));return()=>{const Xn=[me("svg",{class:"q-slider__thumb-shape absolute-full",viewBox:"0 0 20 20","aria-hidden":"true"},[me("path",{d:o.thumbPath})]),me("div",{class:"q-slider__focus-ring fit"})];return(o.label===!0||o.labelAlways===!0)&&(Xn.push(me("div",{class:ae.value+" absolute fit no-pointer-events"+He.value},[me("div",{class:Pe.value,style:{minWidth:o.thumbSize}},[me("div",{class:qe.value,style:Ct.value},[me("span",{class:Gn.value},O.label.value)])])])),o.name!==void 0&&o.disable!==!0&&g(Xn,"push")),me("div",{class:ge.value,style:Re.value,...O.getNodeData()},Xn)}}function Hn(O,oe,ge,Re){const He=[];o.innerTrackColor!=="transparent"&&He.push(me("div",{key:"inner",class:kt.value,style:bt.value})),o.selectionColor!=="transparent"&&He.push(me("div",{key:"selection",class:U.value,style:O.value})),o.markers!==!1&&He.push(me("div",{key:"marker",class:Z.value,style:Dn.value})),Re(He);const Ct=[lo("div",{key:"trackC",class:G.value,tabindex:oe.value,...ge.value},[me("div",{class:le.value,style:Fe.value},He)],"slide",F.value,()=>ee.value)];if(o.markerLabels!==!1){const Gn=o.switchMarkerLabelsSide===!0?"unshift":"push";Ct[Gn](me("div",{key:"markerL",class:de.value},Q()))}return Ct}return Fn(()=>{document.removeEventListener("mouseup",ke,!0)}),{state:{active:y,focus:_,preventFocus:D,dragging:q,editable:F,classes:C,tabindex:fe,attributes:k,roundValueFn:X,keyStep:re,trackLen:ye,innerMin:K,innerMinRatio:h,innerMax:A,innerMaxRatio:p,positionProp:T,sizeProp:v,isReversed:W},methods:{onActivate:Ee,onMobileClick:_e,onBlur:Se,onKeyup:je,getContent:Hn,getThumbRenderFn:sn,convertRatioToModel:Dt,convertModelToRatio:Ke,getDraggingRatio:vt}}}const ud=()=>({});var dd=Bt({name:"QSlider",props:{...rd,modelValue:{required:!0,default:null,validator:e=>typeof e=="number"||e===null},labelValue:[String,Number]},emits:ld,setup(e,{emit:t}){const{proxy:{$q:n}}=Lt(),{state:i,methods:o}=cd({updateValue:I,updatePosition:W,getDragging:R,formAttrs:bs(e)}),s=De(null),a=De(0),r=De(0);function l(){r.value=e.modelValue===null?i.innerMin.value:Ut(e.modelValue,i.innerMin.value,i.innerMax.value)}Rt(()=>`${e.modelValue}|${i.innerMin.value}|${i.innerMax.value}`,l),l();const g=z(()=>o.convertModelToRatio(r.value)),y=z(()=>i.active.value===!0?a.value:g.value),D=z(()=>{const F={[i.positionProp.value]:`${100*i.innerMinRatio.value}%`,[i.sizeProp.value]:`${100*(y.value-i.innerMinRatio.value)}%`};return e.selectionImg!==void 0&&(F.backgroundImage=`url(${e.selectionImg}) !important`),F}),_=o.getThumbRenderFn({focusValue:!0,getNodeData:ud,ratio:y,label:z(()=>e.labelValue!==void 0?e.labelValue:r.value),thumbColor:z(()=>e.thumbColor||e.color),labelColor:z(()=>e.labelColor),labelTextColor:z(()=>e.labelTextColor)}),q=z(()=>i.editable.value!==!0?{}:n.platform.is.mobile===!0?{onClick:o.onMobileClick}:{onMousedown:o.onActivate,onFocus:K,onBlur:o.onBlur,onKeydown:A,onKeyup:o.onKeyup});function I(F){r.value!==e.modelValue&&t("update:modelValue",r.value),F===!0&&t("change",r.value)}function R(){return s.value.getBoundingClientRect()}function W(F,X=i.dragging.value){const re=o.getDraggingRatio(F,X);r.value=o.convertRatioToModel(re),a.value=e.snap!==!0||e.step===0?re:o.convertModelToRatio(r.value)}function K(){i.focus.value=!0}function A(F){if(Go.includes(F.keyCode)===!1)return;ln(F);const X=([34,33].includes(F.keyCode)?10:1)*i.keyStep.value,re=([34,37,40].includes(F.keyCode)?-1:1)*(i.isReversed.value===!0?-1:1)*(e.vertical===!0?-1:1)*X;r.value=Ut(i.roundValueFn.value(r.value+re),i.innerMin.value,i.innerMax.value),I()}return()=>{const F=o.getContent(D,i.tabindex,q,X=>{X.push(_())});return me("div",{ref:s,class:i.classes.value+(e.modelValue===null?" q-slider--no-value":""),...i.attributes.value,"aria-valuenow":e.modelValue},F)}}});const fd=xe({name:"MultinutPaymentDialog",mixins:[windowMixin],components:{},data(){return{multiMeltButtonLoading:!1,selectedMints:[],showMultinutPaymentDialog:!1,mintStates:{},isPaymentInProgress:!1,mintProportions:{}}},computed:{...ne($e,["payInvoiceData"]),...ne(Ce,["multinutExperimentalWarningDismissed"]),...Y(ve,["mints","activeUnit","multiMints"]),totalSelectedBalance(){return this.selectedMints.reduce((e,t)=>{const n=this.mintClass(t);return e+n.unitBalance(this.activeUnit)},0)},canExecutePayment(){return this.selectedMints.length>0&&this.totalSelectedBalance>=this.payInvoiceData.meltQuote.response.amount&&this.totalDistributedAmount===this.payInvoiceData.meltQuote.response.amount&&!this.multiMeltButtonLoading},totalDistributedAmount(){if(this.selectedMints.length===0)return 0;const e=this.getPartialAmounts();return Object.values(e).reduce((t,n)=>t+n,0)}},methods:{...J($e,["meltQuote","melt"]),...J(ve,["activateMintUrl","updateMintMultinutSelection"]),mintClass(e){return new rn(e)},getShortUrl(e){return At(e)},isSelected(e){return this.selectedMints.some(t=>t.url===e.url)},toggleMint(e){const t=this.selectedMints.findIndex(n=>n.url===e.url);t>=0?(this.selectedMints.splice(t,1),this.updateMintMultinutSelection(e.url,!1),delete this.mintProportions[e.url]):(this.selectedMints.push(e),this.updateMintMultinutSelection(e.url,!0)),this.initializeMintProportions()},initializeMintProportions(){if(this.selectedMints.length===0){this.mintProportions={};return}this.payInvoiceData.meltQuote.response.amount;const{weights:e}=this.multiMintBalance(this.selectedMints,this.activeUnit),t={};this.selectedMints.forEach((i,o)=>{const s=e[o]*100,a=this.getMaxPercentageForMint(i);t[i.url]=Math.min(s,a)});const n=Object.values(t).reduce((i,o)=>i+o,0);if(n<100){const i=100-n,o=this.selectedMints.filter(s=>{const a=this.getMaxPercentageForMint(s);return t[s.url]<a});if(o.length>0){const s=o.reduce((a,r)=>{const l=this.getMaxPercentageForMint(r);return a+(l-t[r.url])},0);s>0&&o.forEach(a=>{const l=this.getMaxPercentageForMint(a)-t[a.url],g=l/s,y=Math.min(l,i*g);t[a.url]+=y})}}this.mintProportions={...t}},getMintProportion(e){return this.mintProportions[e.url]||0},getMaxPercentageForMint(e){const t=this.payInvoiceData.meltQuote.response.amount,n=this.mintClass(e).unitBalance(this.activeUnit);return Math.min(100,n/t*100)},getMintIconUrl(e){if(e.info)return e.info.icon_url?e.info.icon_url:void 0},updateMintProportion(e,t){if(this.selectedMints.length<=1)return;const n=this.payInvoiceData.meltQuote.response.amount,i=this.mintClass(e).unitBalance(this.activeUnit),o=Math.min(100,i/n*100),s=Math.min(t,o),a=this.mintProportions[e.url]||0,r=s-a;this.mintProportions={...this.mintProportions,[e.url]:s};const l=this.selectedMints.filter(y=>y.url!==e.url),g=l.reduce((y,D)=>y+(this.mintProportions[D.url]||0),0);if(g>0&&l.length>0){let y=r;const D=l.map(_=>{const q=this.mintClass(_).unitBalance(this.activeUnit),I=Math.min(100,q/n*100),R=this.mintProportions[_.url]||0,W=I-R;return{mint:_,currentPercentage:R,maxPercentage:I,availableCapacity:W,balance:q}}).sort((_,q)=>q.availableCapacity-_.availableCapacity);for(const _ of D){if(Math.abs(y)<.01)break;const q=_.currentPercentage/g;let I=r*q;r>0?I=Math.min(I,_.currentPercentage):I=Math.max(I,-_.availableCapacity);const R=Math.max(0,Math.min(_.maxPercentage,_.currentPercentage-I));this.mintProportions={...this.mintProportions,[_.mint.url]:R},y-=_.currentPercentage-R}}else if(l.length>0){const y=100-s,D=l.map(q=>{const I=this.mintClass(q).unitBalance(this.activeUnit),R=Math.min(100,I/n*100);return{mint:q,maxPercentage:R,balance:I}}),_=D.reduce((q,I)=>q+I.maxPercentage,0);_>0&&D.forEach(q=>{const I=q.maxPercentage/_,R=Math.min(q.maxPercentage,y*I);this.mintProportions={...this.mintProportions,[q.mint.url]:R}})}this.normalizeMintProportions()},normalizeMintProportions(){const e=this.payInvoiceData.meltQuote.response.amount,t=this.selectedMints.reduce((n,i)=>n+(this.mintProportions[i.url]||0),0);if(t>0&&Math.abs(t-100)>.01){const n=100/t,i={};let o=!0;for(const s of this.selectedMints){const r=(this.mintProportions[s.url]||0)*n,l=this.mintClass(s).unitBalance(this.activeUnit),g=Math.min(100,l/e*100);if(r>g){o=!1;break}}o?(this.selectedMints.forEach(s=>{i[s.url]=(this.mintProportions[s.url]||0)*n}),this.mintProportions={...i}):this.redistributeWithConstraints()}},redistributeWithConstraints(){const e=this.payInvoiceData.meltQuote.response.amount,t=this.selectedMints.map(s=>{const a=this.mintClass(s).unitBalance(this.activeUnit),r=Math.min(100,a/e*100),l=this.mintProportions[s.url]||0;return{mint:s,balance:a,maxPercentage:r,currentPercentage:l}});let n=0;const i={};t.forEach(s=>{const a=Math.min(s.maxPercentage,s.currentPercentage);i[s.mint.url]=a,n+=a});let o=100-n;for(;o>.01;){const s=t.filter(r=>i[r.mint.url]<r.maxPercentage);if(s.length===0)break;const a=s.reduce((r,l)=>r+(l.maxPercentage-i[l.mint.url]),0);if(a<=0)break;s.forEach(r=>{const l=r.maxPercentage-i[r.mint.url],g=l/a,y=Math.min(l,o*g);i[r.mint.url]+=y,o-=y})}this.mintProportions={...i}},getPartialAmount(e){return this.getPartialAmounts()[e.url]||0},getPartialAmounts(){const e=this.payInvoiceData.meltQuote.response.amount,t={};let n=0;this.selectedMints.forEach(o=>{const s=this.mintProportions[o.url]||0,a=Math.round(e*(s/100));t[o.url]=a,n+=a});const i=e-n;if(i!==0&&this.selectedMints.length>0){let o=null,s=0;if(this.selectedMints.forEach(a=>{t[a.url]>s&&(s=t[a.url],o=a)}),o){t[o.url]+=i;const a=this.mintClass(o).unitBalance(this.activeUnit);if(t[o.url]>a){t[o.url]=a;const r=i-(a-s),l=this.selectedMints.filter(g=>g.url!==o.url);for(const g of l){const y=this.mintClass(g).unitBalance(this.activeUnit),D=t[g.url],_=Math.min(r,y-D);if(_>0&&(t[g.url]+=_,r-=_,r===0))break}}}}return t},getStateText(e){switch(e){case"requesting":return"Requesting...";case"paying":return"Paying...";case"success":return"Success";case"error":return"Failed";default:return""}},getStateColor(e){switch(e){case"requesting":return"warning";case"paying":return"primary";case"success":return"positive";case"error":return"negative";default:return"grey"}},getStateProgress(e){switch(e){case"requesting":return .3;case"paying":return .7;case"success":return 1;case"error":return .1;default:return 0}},setMintState(e,t){this.mintStates={...this.mintStates,[e]:t}},clearMintStates(){this.mintStates={},this.isPaymentInProgress=!1},openMultinutDialog(){const e=ve(),t=e.multiMints.filter(n=>n.multinutSelected===!0);this.selectedMints=t.length>0?[...t]:[...e.multiMints],this.showMultinutPaymentDialog=!0,this.clearMintStates(),this.initializeMintProportions()},closeMultinutDialog(){this.showMultinutPaymentDialog=!1,this.clearMintStates(),this.$emit("return-to-pay-dialog")},multiMintBalance:function(e,t){const n=e,i=[],o=n.reduce((a,r)=>{const g=new rn(r).unitBalance(t);return i.push(g),a+g},0),s=i.map(a=>a/o);return{overallBalance:o,weights:s}},executeMultinutPayment:async function(){const e=Ce(),t=this.payInvoiceData.meltQuote.response.amount,n=ve().activeUnit;this.selectedMints.forEach(r=>{this.updateMintMultinutSelection(r.url,!0)}),this.clearMintStates(),this.isPaymentInProgress=!0,this.multiMeltButtonLoading=!0;let i=[],o=[],s;try{for(const l of this.selectedMints){const g=this.getPartialAmount(l);console.log(`partialAmount for mint ${l.url}: ${g}`),g>0?o.push([l,g]):this.selectedMints=this.selectedMints.filter(y=>y.url!==l.url)}const r=o.reduce((l,[g,y])=>l+y,0);if(console.log(`Total calculated: ${r}, Expected: ${t}`),r!==t){console.error(`Amount mismatch: calculated ${r}, expected ${t}`),Tt(`Amount calculation error: ${r} vs ${t}`);return}i=await Promise.all(o.map(async([l,g],y)=>{if(g<=0)return null;console.log(`Quoting mint: ${l.url}`);const D=$e().mintWallet(l.url,ve().activeUnit);try{this.setMintState(l.url,"requesting");const _=await this.meltQuote(D,this.payInvoiceData.input.request,g);return console.log(_),[l,_]}catch(_){throw console.error(`Quote failed for mint ${l.url}:`,_),this.setMintState(l.url,"error"),_}})),i=i.filter(l=>l!==null),s=await Promise.all(i.map(async([l,g])=>{try{this.setMintState(l.url,"paying");const y=$e().mintWallet(l.url,n),_=new rn(l).unitProofs(n),q=await this.melt(_,g,y,!0);return this.setMintState(l.url,"success"),q}catch(y){throw console.error(`Payment failed for mint ${l.url}:`,y),this.setMintState(l.url,"error"),y}}))}catch(r){throw console.error(`${r}`),setTimeout(()=>{this.clearMintStates()},3e3),r}finally{this.multiMeltButtonLoading=!1}e.vibrate();const a=i.reduce((r,l)=>r+l[1].amount+l[1].fee_reserve,0)-s.reduce((r,l)=>r+l.change.reduce((g,y)=>g+y.amount,0),0);un("Paid "+e.formatCurrency(a,n)+" via Lightning"),setTimeout(()=>{this.showMultinutPaymentDialog=!1,this.payInvoiceData.show=!1,this.clearMintStates()},2e3)},dismissExperimentalWarning(){this.multinutExperimentalWarningDismissed=!0}}}),Ei=e=>(mn("data-v-1ecd16ec"),e=e(),gn(),e),hd={class:"fullscreen bg-dark"},md={class:"multinut-content-container q-pa-md"},gd={class:"top-icons q-pt-md q-mb-lg"},pd={class:"multinut-header-container q-mb-lg"},vd={class:"multinut-header q-pa-md q-py-lg"},yd=Ei(()=>m("div",{class:"multinut-title q-mb-xs"},"Multinut Payment",-1)),_d={class:"multinut-amount"},wd={key:0,class:"multinut-description q-mt-sm"},kd={key:0,class:"experimental-warning q-mt-lg"},bd={class:"warning-content q-pa-md"},Dd=Ei(()=>m("div",{class:"warning-title q-mb-xs"},"Experimental Feature",-1)),Cd=Ei(()=>m("div",{class:"warning-text q-mb-md"}," This feature is highly experimental and may not work as expected. Make sure you don't try to pay an invoice that has already been paid before. You could lose funds. ",-1)),Pd={class:"mint-selection-section q-mb-lg"},$d={key:0,class:"mint-selection-description q-mb-md"},Td={class:"mints-container"},qd=["onClick"],Md={class:"mint-card-content q-pa-md"},Sd={class:"row items-center"},Ad={class:"col-auto q-mr-md"},Id={class:"col"},Ed={class:"row items-center"},Rd={class:"mint-info-container"},Ud={key:0,class:"mint-name"},xd={class:"text-grey-6 mint-url"},Nd={key:0,class:"col-auto state-indicator"},Ld={key:0,class:"payment-progress-section q-mt-md q-px-md"},Bd={class:"payment-state-text q-mt-xs"},Fd={key:1,class:"mint-balance-section q-mt-md"},Od={class:"currency-unit-badge"},zd={class:"currency-unit-text"},Vd={key:2,class:"mint-slider-section q-mt-md"},Wd={class:"row items-center q-gutter-sm no-wrap"},jd={class:"col-auto"},Qd={class:"allocation-badge"},Kd={class:"col slider-container"},Hd={class:"col-auto"},Gd={class:"total-balance-badge"},Xd={class:"action-buttons-section"};function Zd(e,t,n,i,o,s){return b(),B(Xe,{modelValue:e.showMultinutPaymentDialog,"onUpdate:modelValue":t[0]||(t[0]=a=>e.showMultinutPaymentDialog=a),position:"top",maximized:!0,"transition-show":"fade","transition-hide":"fade","full-width":"","full-height":"",seamless:"","no-backdrop-dismiss":"",onKeyup:St(e.closeMultinutDialog,["esc"])},{default:f(()=>[m("div",hd,[m("div",md,[m("div",gd,[c(ie,{name:"close",size:"24px",class:"close-icon cursor-pointer text-white",onClick:e.closeMultinutDialog},null,8,["onClick"])]),m("div",pd,[m("div",vd,[yd,m("div",_d,S(e.formatCurrency(e.payInvoiceData.meltQuote.response.amount,e.activeUnit)),1),e.isPaymentInProgress?N("",!0):(b(),V("div",wd," Pay using multiple mints "))]),c(Ze,{appear:"","enter-active-class":"animated pulse",name:"smooth-slide"},{default:f(()=>[!e.multinutExperimentalWarningDismissed&&!e.isPaymentInProgress?(b(),V("div",kd,[m("div",bd,[Dd,Cd,c(x,{flat:"",color:"warning",onClick:e.dismissExperimentalWarning,class:"warning-dismiss-btn"},{default:f(()=>[E(" I understand ")]),_:1},8,["onClick"])])])):N("",!0)]),_:1})]),m("div",Pd,[e.multinutExperimentalWarningDismissed&&!e.isPaymentInProgress?(b(),V("div",$d," Select funds from multiple mints to execute the payment. ")):N("",!0),m("div",Td,[(b(!0),V(Je,null,Ht(e.multiMints,a=>Ae((b(),V("div",{key:a.url,class:"mint-item q-mb-md"},[m("div",{class:cn(["mint-card cursor-pointer",{"mint-card-selected":e.isSelected(a),"cursor-not-allowed":e.isPaymentInProgress,"mint-card-success":e.isPaymentInProgress&&e.isSelected(a)&&e.mintStates[a.url]==="success","mint-card-error":e.isPaymentInProgress&&e.isSelected(a)&&e.mintStates[a.url]==="error"}]),onClick:r=>!e.isPaymentInProgress&&!e.isSelected(a)&&e.toggleMint(a)},[m("div",Md,[m("div",Sd,[m("div",Ad,[e.isPaymentInProgress?N("",!0):(b(),B(Hs,{key:0,"model-value":e.isSelected(a),"onUpdate:modelValue":r=>e.toggleMint(a),color:e.isSelected(a)?"primary":"grey",class:"cursor-pointer"},null,8,["model-value","onUpdate:modelValue","color"]))]),m("div",Id,[m("div",Ed,[e.getMintIconUrl(a)?(b(),B(On,{key:0,size:"34px",class:"q-mr-sm"},{default:f(()=>[c(pi,{"spinner-color":"white","spinner-size":"xs",src:e.getMintIconUrl(a),alt:"Mint Icon",style:{height:"34px","max-width":"34px","font-size":"12px"}},null,8,["src"])]),_:2},1024)):N("",!0),m("div",Rd,[a.nickname||a.info?.name?(b(),V("div",Ud,S(a.nickname||a.info?.name),1)):N("",!0),m("div",xd,S(e.getShortUrl(a.url)),1)])])]),e.isPaymentInProgress&&e.isSelected(a)?(b(),V("div",Nd,[e.mintStates[a.url]==="requesting"||e.mintStates[a.url]==="paying"?(b(),B(zn,{key:0,color:"primary",size:"24px"})):e.mintStates[a.url]==="success"?(b(),B(ie,{key:1,name:"check_circle",color:"positive",size:"24px"})):e.mintStates[a.url]==="error"?(b(),B(ie,{key:2,name:"error",color:"negative",size:"24px"})):N("",!0)])):N("",!0)]),e.isPaymentInProgress&&e.isSelected(a)&&e.mintStates[a.url]?(b(),V("div",Ld,[c(vi,{value:e.getStateProgress(e.mintStates[a.url]),color:e.getStateColor(e.mintStates[a.url]),size:"4px",rounded:"",class:"payment-progress"},null,8,["value","color"]),m("div",Bd,S(e.getStateText(e.mintStates[a.url])),1)])):N("",!0),e.isSelected(a)?N("",!0):(b(),V("div",Fd,[m("div",Od,[m("span",zd,S(e.formatCurrency(e.mintClass(a).unitBalance(this.activeUnit),this.activeUnit)),1)])])),e.isSelected(a)&&!e.isPaymentInProgress?(b(),V("div",Vd,[m("div",Wd,[m("div",jd,[m("div",Qd,S(e.formatCurrency(e.getPartialAmount(a),e.activeUnit)),1)]),m("div",Kd,[c(dd,{"model-value":e.getMintProportion(a),"onUpdate:modelValue":r=>e.updateMintProportion(a,r),min:0,max:e.getMaxPercentageForMint(a),step:1,color:"primary",disable:e.selectedMints.length<=1,class:"mint-slider q-px-md"},null,8,["model-value","onUpdate:modelValue","max","disable"])]),m("div",Hd,[m("div",Gd,S(e.formatCurrency(e.mintClass(a).unitBalance(this.activeUnit),e.activeUnit)),1)])])])):N("",!0)])],10,qd)])),[[cs,!e.isPaymentInProgress||e.isSelected(a)]])),128))])]),m("div",Xd,[c(x,{unelevated:"",rounded:"",color:"primary",disabled:!e.canExecutePayment,onClick:e.executeMultinutPayment,loading:e.multiMeltButtonLoading,class:"pay-button-fixed",size:"lg"},{loading:f(()=>[c(ht)]),default:f(()=>[E(" Pay Invoice ")]),_:1},8,["disabled","onClick","loading"])])])])]),_:1},8,["modelValue","onKeyup"])}var Yd=Te(fd,[["render",Zd],["__scopeId","data-v-1ecd16ec"]]);const Jd=xe({name:"PayInvoiceDialog",mixins:[windowMixin],components:{ChooseMint:Vn,ToggleUnit:wi,MultinutPaymentDialog:Yd,ScanIcon:Ft,CoinsIcon:Wn},props:{},data:function(){return{}},watch:{activeMintUrl:async function(){this.payInvoiceData.show&&await this.meltQuoteInvoiceData()},activeUnit:async function(){this.payInvoiceData.show&&await this.meltQuoteInvoiceData()}},computed:{...Y(Ce,["tickerShort","globalMutexLock"]),...Y(st,["multinutEnabled"]),...ne(Ve,["camera","hasCamera"]),...Y($e,["payInvoiceData"]),...ne(Zt,["showSendTokens","sendData","showLockInput"]),...Y(ve,["activeMintUrl","activeProofs","mints","activeUnit","totalUnitBalance","activeBalance","multiMints"]),...Y(Gt,["bitcoinPrice","bitcoinPrices","currentCurrencyPrice"]),...Y(st,["bitcoinPriceCurrency"]),canPasteFromClipboard:function(){return window.isSecureContext&&navigator.clipboard&&navigator.clipboard.readText},canMakePayments:function(){return!!this.mints.length},enoughtotalUnitBalance:function(){return this.activeBalance>=this.payInvoiceData.meltQuote.response.amount},hasMultinutSupport:function(){const e=this.multiMints.reduce((t,n)=>t+new rn(n).unitBalance(this.activeUnit),0);return this.multiMints.length>1&&this.payInvoiceData.meltQuote.response.amount>0&&e>=this.payInvoiceData.meltQuote.response.amount}},methods:{...J($e,["meltInvoiceData","meltQuoteInvoiceData","decodeRequest","lnurlPaySecond"]),...J(Ve,["closeCamera","showCamera"]),canPay:function(){return this.payInvoiceData.invoice?this.payInvoiceData.meltQuote.response.amount+this.payInvoiceData.meltQuote.response.fee_reserve<=this.totalUnitBalance:!1},closeParseDialog:function(){},decodeAndQuote:async function(e){await this.decodeRequest(e)},pasteToParseDialog:async function(){console.log("pasteToParseDialog");const e=await Ce().pasteFromClipboard();e&&(this.payInvoiceData.input.request=e.trim())},handleMeltButton:function(){if(this.payInvoiceData.blocking)throw new Error("already processing an invoice.");this.meltInvoiceData()},openMultinutDialog:function(){this.payInvoiceData.show=!1,this.$refs.multinutDialog.openMultinutDialog()},handleReturnToPayDialog:function(){this.payInvoiceData.show=!0},showSendTokensDialog:function(){if(!this.canMakePayments){dn(this.$i18n.t("SendDialog.actions.ecash.error_no_mints")),this.payInvoiceData.show=!1;return}this.sendData.tokens="",this.sendData.tokensBase64="",this.sendData.amount=null,this.sendData.memo="",this.sendData.p2pkPubkey="",this.sendData.paymentRequest=void 0,this.payInvoiceData.show=!1,this.showSendTokens=!0,this.showLockInput=!1}},created:function(){}}),Xo=e=>(mn("data-v-7224fad8"),e=e(),gn(),e),ef={key:0},tf={class:"row items-center no-wrap q-mb-sm"},nf={class:"col-10"},of={key:0},sf={class:"q-my-none inline-block"},af={key:0,class:"q-ml-xs text-subtitle2 text-grey-6"},rf={key:1,class:"q-my-none"},lf={key:2,class:"q-my-none"},cf={class:"col-2"},uf={class:"text-wrap"},df={key:0},ff=Xo(()=>m("br",null,null,-1)),hf={class:"col-12"},mf={key:0,class:"row q-mt-lg"},gf={key:1,class:"row q-mt-lg"},pf={key:1},vf={key:0,class:"q-my-none text-h6 text-center"},yf={key:1,class:"q-my-none text-h6 text-center"},_f=Xo(()=>m("br",null,null,-1)),wf={key:2,class:"row"},kf={class:"col text-justify text-italic"},bf={key:0,class:"col-4 q-pl-md"},Df={class:"row"},Cf={class:"col"},Pf={key:0,class:"col-8 q-pl-md"},$f={class:"row q-mt-lg"},Tf={key:2},qf={class:"row items-center no-wrap q-mb-xl"},Mf={class:"col-10"},Sf={class:"text-h6"},Af={class:"row q-mt-lg"},If={class:"q-pl-sm"},Ef={class:"text-center"};function Rf(e,t,n,i,o,s){const a=H("i18n-t"),r=H("ToggleUnit"),l=H("ChooseMint"),g=H("ScanIcon"),y=H("CoinsIcon"),D=H("MultinutPaymentDialog");return b(),V(Je,null,[e.camera.show?N("",!0):(b(),B(Xe,{key:0,modelValue:e.payInvoiceData.show,"onUpdate:modelValue":t[6]||(t[6]=_=>e.payInvoiceData.show=_),onHide:e.closeParseDialog,position:"top",maximized:e.$q.screen.lt.sm,"backdrop-filter":"blur(2px) brightness(60%)","transition-show":"fade","transition-hide":"fade","no-backdrop-dismiss":"","full-height":""},{default:f(()=>[c(Oe,{class:"q-pa-lg q-pt-xl qcard"},{default:f(()=>[e.payInvoiceData.invoice?(b(),V("div",ef,[m("div",tf,[m("div",nf,[e.payInvoiceData.meltQuote.response&&e.payInvoiceData.meltQuote.response.amount>0?(b(),V("div",of,[m("h6",sf,[c(a,{keypath:"PayInvoiceDialog.invoice.title"},{value:f(()=>[E(S(e.formatCurrency(e.payInvoiceData.meltQuote.response.amount,e.activeUnit,!0)),1)]),_:1})]),e.bitcoinPrice&&e.activeUnit=="points"?(b(),V("span",af," ("+S(e.formatCurrency(e.currentCurrencyPrice/1e8*e.payInvoiceData.meltQuote.response.amount,e.bitcoinPriceCurrency,!0))+") ",1)):N("",!0)])):e.payInvoiceData.meltQuote.error!=""?(b(),V("h6",rf,S(e.payInvoiceData.meltQuote.error),1)):(b(),V("h6",lf,S(e.$t("PayInvoiceDialog.invoice.processing_info_text")),1))]),m("div",cf,[c(r,{class:"q-mt-md"})])]),m("p",uf,[e.payInvoiceData.invoice.description?(b(),V("strong",df,S(e.$t("PayInvoiceDialog.invoice.memo.label"))+":",1)):N("",!0),E(" "+S(e.payInvoiceData.invoice.description),1),ff]),m("div",hf,[c(l)]),e.enoughtotalUnitBalance||e.hasMultinutSupport&&e.multinutEnabled||e.globalMutexLock?(b(),V("div",mf,[c(x,{unelevated:"",rounded:"",color:"primary",disabled:e.payInvoiceData.blocking||!e.enoughtotalUnitBalance||e.payInvoiceData.meltQuote.error!="",onClick:e.handleMeltButton,label:e.payInvoiceData.meltQuote.error!=""?e.$t("PayInvoiceDialog.invoice.actions.pay.error"):e.payInvoiceData.blocking?e.$t("PayInvoiceDialog.invoice.actions.pay.in_progress"):e.$t("PayInvoiceDialog.invoice.actions.pay.label"),loading:e.globalMutexLock&&!e.payInvoiceData.blocking,class:"q-px-lg"},{loading:f(()=>[c(ht)]),_:1},8,["disabled","onClick","label","loading"]),!e.payInvoiceData.blocking&&e.hasMultinutSupport&&e.multinutEnabled?(b(),B(x,{key:0,unelevated:"",rounded:"",outline:"",disabled:!e.hasMultinutSupport,onClick:e.openMultinutDialog,label:"Multi",class:"q-px-lg q-ml-sm"},null,8,["disabled","onClick"])):N("",!0),Ae((b(),B(x,{flat:"",color:"grey",class:"q-ml-auto"},{default:f(()=>[E(S(e.$t("PayInvoiceDialog.invoice.actions.close.label")),1)]),_:1})),[[Be]])])):(b(),V("div",gf,[c(x,{unelevated:"",rounded:"",disabled:"",color:"yellow","text-color":"black"},{default:f(()=>[E(S(e.$t("PayInvoiceDialog.invoice.balance_too_low_warning_text")),1)]),_:1}),Ae((b(),B(x,{flat:"",color:"grey",class:"q-ml-auto"},{default:f(()=>[E(S(e.$t("PayInvoiceDialog.invoice.actions.close.label")),1)]),_:1})),[[Be]])]))])):e.payInvoiceData.lnurlpay?(b(),V("div",pf,[c(eo,{onSubmit:e.lnurlPaySecond,class:"q-gutter-md"},{default:f(()=>[e.payInvoiceData.lnurlpay.maxSendable==e.payInvoiceData.lnurlpay.minSendable?(b(),V("p",vf,[c(a,{keypath:"PayInvoiceDialog.lnurlpay.amount_exact_label"},{payee:f(()=>[m("b",null,S(e.payInvoiceData.lnurlpay.domain),1)]),value:f(()=>[E(S(e.payInvoiceData.lnurlpay.maxSendable/1e3),1)]),ticker:f(()=>[E(S(e.tickerShort),1)]),_:1})])):(b(),V("p",yf,[c(a,{keypath:"PayInvoiceDialog.lnurlpay.amount_range_label"},{payee:f(()=>[m("b",null,S(e.payInvoiceData.lnurlpay.targetUser||e.payInvoiceData.lnurlpay.domain),1)]),br:f(()=>[_f]),min:f(()=>[m("b",null,S(e.payInvoiceData.lnurlpay.minSendable/1e3),1)]),max:f(()=>[m("b",null,S(e.payInvoiceData.lnurlpay.maxSendable/1e3),1)]),ticker:f(()=>[E(S(e.tickerShort),1)]),_:1})])),c(Es,{class:"q-my-sm"}),e.payInvoiceData.lnurlpay.description?(b(),V("div",wf,[m("p",kf,S(e.payInvoiceData.lnurlpay.description),1),e.payInvoiceData.lnurlpay.image?(b(),V("p",bf,[c(pi,{src:e.payInvoiceData.lnurlpay.image},null,8,["src"])])):N("",!0)])):N("",!0),m("div",Df,[m("div",Cf,[c(gt,{filled:"",dense:"",autofocus:"",modelValue:e.payInvoiceData.input.amount,"onUpdate:modelValue":t[0]||(t[0]=_=>e.payInvoiceData.input.amount=_),modelModifiers:{number:!0},type:"number",label:e.$t("PayInvoiceDialog.lnurlpay.inputs.amount.label",{ticker:e.tickerShort}),min:e.payInvoiceData.lnurlpay.minSendable/1e3,max:e.payInvoiceData.lnurlpay.maxSendable/1e3,readonly:e.payInvoiceData.lnurlpay.maxSendable==e.payInvoiceData.lnurlpay.minSendable},null,8,["modelValue","label","min","max","readonly"])]),e.payInvoiceData.lnurlpay.commentAllowed>0?(b(),V("div",Pf,[c(gt,{filled:"",dense:"",modelValue:e.payInvoiceData.input.comment,"onUpdate:modelValue":t[1]||(t[1]=_=>e.payInvoiceData.input.comment=_),_type:"payInvoiceData.lnurlpay.commentAllowed > 64 ? 'textarea' : 'text'",label:e.$t("PayInvoiceDialog.lnurlpay.inputs.comment.label"),maxlength:e.payInvoiceData.lnurlpay.commentAllowed},null,8,["modelValue","label","maxlength"])])):N("",!0)]),m("div",$f,[c(x,{unelevated:"",color:"primary",type:"submit"},{default:f(()=>[E(S(e.$t("PayInvoiceDialog.lnurlpay.actions.send.label")),1)]),_:1}),Ae((b(),B(x,{flat:"",color:"grey",class:"q-ml-auto"},{default:f(()=>[E(S(e.$t("PayInvoiceDialog.lnurlpay.actions.close.label")),1)]),_:1})),[[Be]])])]),_:1},8,["onSubmit"])])):(b(),V("div",Tf,[m("div",qf,[m("div",Mf,[m("span",Sf,S(e.$t("PayInvoiceDialog.input_data.title")),1)])]),e.camera.show?N("",!0):(b(),B(eo,{key:0,onSubmit:t[5]||(t[5]=_=>e.decodeAndQuote(e.payInvoiceData.input.request)),class:"q-gutter-md relative-container"},{default:f(()=>[c(gt,{ref:"parseDialogInput",round:"",outlined:"",class:"request-input",spellcheck:"false",modelValue:e.payInvoiceData.input.request,"onUpdate:modelValue":t[3]||(t[3]=_=>e.payInvoiceData.input.request=_),modelModifiers:{trim:!0},type:"textarea",label:e.$t("PayInvoiceDialog.input_data.inputs.invoice_data.label"),autofocus:"",onKeyup:t[4]||(t[4]=St(_=>e.decodeAndQuote(e.payInvoiceData.input.request),["enter"]))},{default:f(()=>[e.payInvoiceData.input.request?(b(),B(ie,{key:0,name:"close",color:"dark",class:"cursor-pointer floating-button",onClick:t[2]||(t[2]=_=>e.payInvoiceData.input.request="")})):N("",!0)]),_:1},8,["modelValue","label"]),m("div",Af,[e.payInvoiceData.input.request!=""?(b(),B(x,{key:0,rounded:"",color:"primary",class:"q-mr-sm",type:"submit"},{default:f(()=>[E(S(e.$t("PayInvoiceDialog.input_data.actions.enter.label")),1)]),_:1})):N("",!0),e.canPasteFromClipboard&&e.payInvoiceData.input.request==""?(b(),B(x,{key:1,unelevated:"",dense:"",onClick:e.pasteToParseDialog},{default:f(()=>[c(ie,{name:"content_paste",class:"q-pr-sm"}),E(S(e.$t("PayInvoiceDialog.input_data.actions.paste.label")),1)]),_:1},8,["onClick"])):N("",!0),e.hasCamera&&e.payInvoiceData.input.request==""?(b(),B(x,{key:2,unelevated:"",class:"q-mx-0",onClick:e.showCamera},{default:f(()=>[c(g),m("span",If,S(e.$t("PayInvoiceDialog.input_data.actions.scan.label")),1)]),_:1},8,["onClick"])):N("",!0),Ae((b(),B(x,{flat:"",rounded:"",color:"grey",class:"q-ml-auto"},{default:f(()=>[E(S(e.$t("PayInvoiceDialog.input_data.actions.close.label")),1)]),_:1})),[[Be]])])]),_:1}))])),c(Ne,{class:"q-pt-none"},{default:f(()=>[m("div",Ef,[c(x,{onClick:e.showSendTokensDialog,flat:"",color:"primary",size:"sm"},{default:f(()=>[c(y,{size:"1em",class:"q-mr-xs"}),E(" "+S(e.$t("SendDialog.actions.points.label")),1)]),_:1},8,["onClick"])])]),_:1})]),_:1})]),_:1},8,["modelValue","onHide","maximized"])),c(D,{ref:"multinutDialog",onReturnToPayDialog:e.handleReturnToPayDialog},null,8,["onReturnToPayDialog"])],64)}var Uf=Te(Jd,[["render",Rf],["__scopeId","data-v-7224fad8"]]);const xf=xe({name:"InvoiceDetailDialog",mixins:[windowMixin],components:{ChooseMint:Vn,VueQrcode:ko,NumericKeyboard:Ho},props:{},data:function(){return{createInvoiceButtonBlocked:!1}},watch:{showInvoiceDetails:function(e){e&&this.$nextTick(()=>{this.invoiceData.amount?this.showNumericKeyboard=!1:this.showNumericKeyboard=!0})}},computed:{...Y($e,["invoiceData"]),...Y(ve,["activeUnit","activeUnitLabel","activeUnitCurrencyMultiplyer"]),...Y(Xt,["invoiceWorkerRunning"]),...ne(Ce,["showInvoiceDetails","tickerShort","globalMutexLock","showNumericKeyboard"]),...Y(st,["useNumericKeyboard","bitcoinPriceCurrency"]),...Y(Gt,["bitcoinPrice","currentCurrencyPrice"]),displayUnit:function(){return this.formatCurrency(this.invoiceData.amount,this.invoiceData.unit,!0)},shortUrl:function(){return At(this.invoiceData.mint)},runnerActive:function(){return this.invoiceWorkerRunning},isSmallScreen(){return this.$q.screen.lt.sm}},methods:{...J($e,["requestMint","lnurlPaySecond","mintOnPaid"]),...J(ve,["toggleUnit"]),requestMintButton:async function(){if(!!this.invoiceData.amount)try{this.showNumericKeyboard=!1;const e=ve();this.invoiceData.amount*=this.activeUnitCurrencyMultiplyer,this.createInvoiceButtonBlocked=!0;const t=$e().mintWallet(e.activeMintUrl,e.activeUnit),n=await this.requestMint(this.invoiceData.amount,t);await this.mintOnPaid(n.quote)}catch(e){console.log("#### requestMintButton",e)}finally{this.createInvoiceButtonBlocked=!1}}}}),Nf={key:1},Lf={class:"row items-center no-wrap q-mb-sm q-pr-md q-py-lg"},Bf={class:"col-10"},Ff={class:"text-h6"},Of={key:0,class:"q-ml-xs text-subtitle2 text-grey-6"},zf={class:"row items-center no-wrap q-my-sm q-py-none"},Vf={class:"col-12"},Wf={class:"row items-center no-wrap q-my-sm q-py-none"},jf={key:2,class:"text-center q-mt-none q-pt-none"},Qf=["href"],Kf={class:"row justify-center"},Hf={class:"row justify-center"},Gf={class:"row justify-center q-py-md"},Xf={key:0,class:"row justify-center q-pt-sm"},Zf={key:1,class:"row justify-center"},Yf={class:"q-mt-lg text-h6"},Jf={class:"row q-mt-lg"};function eh(e,t,n,i,o,s){const a=H("NumericKeyboard"),r=H("ChooseMint"),l=H("vue-qrcode");return b(),B(Xe,{modelValue:e.showInvoiceDetails,"onUpdate:modelValue":t[4]||(t[4]=g=>e.showInvoiceDetails=g),position:"top",maximized:e.$q.screen.lt.sm,"full-width":e.$q.screen.lt.sm,"full-height":e.$q.screen.lt.sm,"backdrop-filter":"blur(2px) brightness(60%)","transition-show":"fade","transition-hide":"fade","no-backdrop-dismiss":""},{default:f(()=>[c(Oe,{class:"q-pa-lg q-px-sm qcard q-card-top"},{default:f(()=>[e.showNumericKeyboard&&e.useNumericKeyboard?(b(),B(a,{key:0,"model-value":e.invoiceData.amount,"onUpdate:modelValue":t[0]||(t[0]=g=>e.invoiceData.amount=g),onDone:e.requestMintButton},null,8,["model-value","onDone"])):N("",!0),e.invoiceData.bolt11?(b(),V("div",jf,[m("a",{class:"text-secondary",href:"lightning:"+e.invoiceData.bolt11},[c(fi,{ratio:1,class:"q-ma-none q-ma-none"},{default:f(()=>[c(l,{value:"lightning:"+e.invoiceData.bolt11.toUpperCase(),options:{width:340},class:"rounded-borders"},null,8,["value"])]),_:1})],8,Qf),m("div",Kf,[c(Ne,{class:"q-pa-sm"},{default:f(()=>[m("div",Hf,[c(Ge,{overline:"",class:"q-mb-sm q-pt-md text-white",style:{"font-size":"1rem"}},{default:f(()=>[E(S(e.$t("InvoiceDetailDialog.invoice.caption")),1)]),_:1})]),m("div",Gf,[c(Ge,{style:{"font-size":"28px"},class:"text-weight-bold"},{default:f(()=>[c(ie,{name:e.invoiceData.amount>=0?"call_received":"call_made",color:e.invoiceData.status==="paid"?e.invoiceData.amount>=0?"green":"red":"",class:"q-mr-sm",size:"sm"},null,8,["name","color"]),m("strong",null,S(e.displayUnit),1)]),_:1})]),this.invoiceData.mint!=null?(b(),V("div",Xf,[c(Kt,{outline:"",class:"q-pa-md",style:{height:"36px","font-family":"monospace"}},{default:f(()=>[c(ie,{name:"account_balance",size:"xs",class:"q-mr-sm"}),E(" "+S(e.shortUrl),1)]),_:1})])):N("",!0),e.invoiceData.amount>0&&e.invoiceData.status==="paid"?(b(),V("div",Zf,[c(Ze,{appear:"","enter-active-class":"animated tada"},{default:f(()=>[m("span",Yf,[c(ie,{name:"check_circle",size:"1.5rem",color:"positive",class:"q-mr-sm q-mb-xs"}),E(S(e.$t("InvoiceDetailDialog.invoice.status_paid_text")),1)])]),_:1})])):N("",!0)]),_:1})]),m("div",Jf,[e.invoiceData.bolt11?(b(),B(x,{key:0,class:"q-mx-xs",size:"md",flat:"",onClick:t[3]||(t[3]=g=>e.copyText(e.invoiceData.bolt11))},{default:f(()=>[E(S(e.$t("InvoiceDetailDialog.invoice.actions.copy.label")),1)]),_:1})):N("",!0),Ae((b(),B(x,{flat:"",color:"grey",class:"q-ml-auto"},{default:f(()=>[E(S(e.$t("InvoiceDetailDialog.invoice.actions.close.label")),1)]),_:1})),[[Be]])])])):(b(),V("div",Nf,[m("div",Lf,[m("div",Bf,[m("span",Ff,S(e.$t("InvoiceDetailDialog.title")),1),e.invoiceData.amount&&e.bitcoinPrice&&e.activeUnit=="points"?(b(),V("span",Of," ("+S(e.formatCurrency(e.currentCurrencyPrice/1e8*e.invoiceData.amount*e.activeUnitCurrencyMultiplyer,e.bitcoinPriceCurrency,!0))+") ",1)):N("",!0)])]),m("div",zf,[m("div",Vf,[c(r)])]),c(gt,{round:"",outlined:"",type:"number",modelValue:e.invoiceData.amount,"onUpdate:modelValue":t[2]||(t[2]=g=>e.invoiceData.amount=g),modelModifiers:{number:!0},label:e.$t("InvoiceDetailDialog.inputs.amount.label",{ticker:e.tickerShort}),mask:"#","fill-mask":"0","reverse-fill-mask":"",autofocus:"",class:"q-mb-lg",onKeyup:St(e.requestMintButton,["enter"])},{default:f(()=>[c(x,{flat:"",color:"primary",onClick:t[1]||(t[1]=g=>e.toggleUnit()),label:e.activeUnitLabel},null,8,["label"])]),_:1},8,["modelValue","label","onKeyup"]),m("div",Wf,[c(x,{color:"primary",rounded:"",onClick:e.requestMintButton,disable:!(e.invoiceData.amount>0)||e.createInvoiceButtonBlocked,label:e.createInvoiceButtonBlocked?e.$t("InvoiceDetailDialog.actions.create.label_blocked"):e.$t("InvoiceDetailDialog.actions.create.label"),loading:e.globalMutexLock},{loading:f(()=>[c(ht),E(" "+S(e.$t("InvoiceDetailDialog.actions.create.in_progress")),1)]),_:1},8,["onClick","disable","label","loading"]),Ae((b(),B(x,{rounded:"",flat:"",color:"grey",class:"q-ml-auto"},{default:f(()=>[E(S(e.$t("InvoiceDetailDialog.actions.close.label")),1)]),_:1})),[[Be]])])]))]),_:1})]),_:1},8,["modelValue","maximized","full-width","full-height"])}var th=Te(xf,[["render",eh],["__scopeId","data-v-12e6edb7"]]);const nh=xe({name:"SendDialog",components:{XIcon:_i,CoinsIcon:Wn,ZapIcon:pn,ScanIcon:Ft},mixins:[windowMixin],props:{},data:function(){return{currentPage:1,pageSize:5}},computed:{...Y(ve,["mints"]),...ne(Ce,["showInvoiceDetails","tab","showSendDialog","showReceiveDialog"]),...ne($e,["invoiceHistory","invoiceData","payInvoiceData"]),...ne(Ve,["camera"]),...ne(Zt,["showSendTokens","sendData","showLockInput"]),canMakePayments:function(){return!!this.mints.length}},methods:{...J(Ve,["closeCamera","showCamera"]),showParseDialog:function(){if(!this.canMakePayments){dn(this.$i18n.t("SendDialog.actions.lightning.error_no_mints")),this.showSendDialog=!1;return}this.payInvoiceData.show=!0,this.payInvoiceData.invoice=null,this.payInvoiceData.lnurlpay=null,this.payInvoiceData.domain="",this.payInvoiceData.lnurlauth=null,this.payInvoiceData.input.request="",this.payInvoiceData.input.comment="",this.camera.show=!1,this.showSendDialog=!1},showSendTokensDialog:function(){if(console.log("##### showSendTokensDialog"),!this.canMakePayments){dn(this.$i18n.t("SendDialog.actions.ecash.error_no_mints")),this.showSendDialog=!1;return}this.sendData.tokens="",this.sendData.tokensBase64="",this.sendData.amount=null,this.sendData.memo="",this.sendData.p2pkPubkey="",this.sendData.paymentRequest=void 0,this.showSendDialog=!1,this.showSendTokens=!0,this.showLockInput=!1}},created:function(){}}),ih={class:"col text-center"},oh={class:"text-h6"},sh={class:"q-gutter-y-md"},ah={class:"row items-center full-width"},rh={class:"icon-background q-mr-md"},lh={class:"text-left"},ch={class:"text-weight-bold custom-btn-text"},uh={class:"row items-center full-width"},dh={class:"icon-background q-mr-md"},fh={class:"text-left"},hh={class:"text-weight-bold custom-btn-text"};function mh(e,t,n,i,o,s){const a=H("XIcon"),r=H("ScanIcon"),l=H("CoinsIcon"),g=H("ZapIcon");return b(),B(Xe,{modelValue:e.showSendDialog,"onUpdate:modelValue":t[0]||(t[0]=y=>e.showSendDialog=y),position:"bottom",maximized:e.$q.screen.lt.sm,"transition-show":"slide-up","transition-hide":"slide-down","backdrop-filter":"blur(2px) brightness(60%)"},{default:f(()=>[c(Oe,{class:"bg-grey-10 text-white full-width-card q-pb-lg"},{default:f(()=>[c(Ne,{class:"row items-center q-pb-sm"},{default:f(()=>[Ae((b(),B(x,{flat:"",round:"",dense:"",class:"q-ml-sm",color:"primary"},{default:f(()=>[c(a)]),_:1})),[[Be]]),m("div",ih,[m("span",oh,S(e.$t("SendDialog.title")),1)]),c(x,{flat:"",round:"",dense:"",class:"q-mr-sm",onClick:e.showCamera,color:"primary"},{default:f(()=>[c(r)]),_:1},8,["onClick"])]),_:1}),c(Ne,{class:"q-pa-md"},{default:f(()=>[m("div",sh,[c(x,{class:"full-width custom-btn",onClick:e.showSendTokensDialog},{default:f(()=>[m("div",ah,[m("div",rh,[c(l)]),m("div",lh,[m("div",ch,S(e.$t("SendDialog.actions.points.label")),1)])])]),_:1},8,["onClick"]),c(x,{class:"full-width custom-btn",onClick:e.showParseDialog},{default:f(()=>[m("div",uh,[m("div",dh,[c(g)]),m("div",fh,[m("div",hh,S(e.$t("SendDialog.actions.lightning.label")),1)])])]),_:1},8,["onClick"])])]),_:1})]),_:1})]),_:1},8,["modelValue","maximized"])}var gh=Te(nh,[["render",mh],["__scopeId","data-v-42f49934"]]);const ph=xe({name:"PRDialog",mixins:[windowMixin],components:{VueQrcode:ko,ToggleUnit:wi},data(){const e=this.$i18n.t("PaymentRequestDialog.actions.add_amount.label");return{paymentRequestAmount:void 0,isEditingAmount:!1,amountInputValue:"",amountLabelDefault:e,amountLabel:e,defaultAnyMint:this.$i18n.t("PaymentRequestDialog.actions.use_active_mint.label"),chosenMintUrl:void 0,memo:""}},computed:{...Y(ft,["showPRKData"]),...Y(ve,["activeMintUrl","activeUnit","activeUnitCurrencyMultiplyer"]),...ne(ft,["showPRDialog"])},methods:{...J(ft,["newPaymentRequest"]),toggleUnit(){this.paymentRequestAmount=void 0,this.amountLabel=this.amountLabelDefault,this.newPaymentRequest(this.paymentRequestAmount,this.memo,this.chosenMintUrl)},newRequest(){this.newPaymentRequest(this.paymentRequestAmount,this.memo,this.chosenMintUrl)},getShortUrl(e){return e?At(e):this.defaultAnyMint},setActiveMintUrl(){this.activeMintUrl!=this.chosenMintUrl&&(this.chosenMintUrl=this.activeMintUrl,this.newPaymentRequest(this.paymentRequestAmount,this.memo,this.chosenMintUrl))},startEditingAmount(){this.isEditingAmount=!0,this.$nextTick(()=>{this.$refs.amountInput&&this.$refs.amountInput.focus()})},finishEditingAmount(){const e=parseFloat(this.amountInputValue);isNaN(e)||e<=0||this.amountInputValue==""?(this.paymentRequestAmount=void 0,this.amountLabel=this.amountLabelDefault):(this.paymentRequestAmount=e*this.activeUnitCurrencyMultiplyer,this.amountLabel=Ce().formatCurrency(e*this.activeUnitCurrencyMultiplyer,this.activeUnit)),this.newPaymentRequest(this.paymentRequestAmount,this.memo,this.chosenMintUrl),this.isEditingAmount=!1,this.amountInputValue=""}}}),vh={class:"text-center q-mb-md q-mt-none q-pt-none"},yh={class:"row justify-center"},_h={class:"row justify-center"},wh={class:"row justify-center q-pt-sm"},kh={class:"row justify-center"},bh={class:"row justify-center q-pt-sm"},Dh={class:"row justify-center"},Ch={class:"row justify-center q-pt-sm"},Ph={key:0},$h={key:1},Th={class:"row q-mt-lg"};function qh(e,t,n,i,o,s){const a=H("vue-qrcode"),r=H("ToggleUnit");return b(),B(Xe,{modelValue:e.showPRDialog,"onUpdate:modelValue":t[3]||(t[3]=l=>e.showPRDialog=l),position:"top","backdrop-filter":"blur(2px) brightness(60%)"},{default:f(()=>[e.showPRKData?(b(),B(Oe,{key:0,class:"q-px-lg q-pt-md q-pb-md qcard"},{default:f(()=>[m("div",vh,[c(fi,{ratio:1,class:"q-mx-md q-mt-none q-pt-none"},{default:f(()=>[c(a,{value:e.showPRKData,options:{width:340},class:"rounded-borders"},null,8,["value"])]),_:1}),m("div",yh,[c(Ne,{class:"q-pa-sm"},{default:f(()=>[m("div",_h,[c(Ge,{overline:"",class:"q-mb-sm q-pt-md text-white",style:{"font-size":"1rem"}},{default:f(()=>[E(S(e.$t("PaymentRequestDialog.payment_request.caption")),1)]),_:1})]),m("div",wh,[c(Ge,{caption:"",class:"text-weight-light text-white",style:{"font-size":"14px"}},{default:f(()=>[E(S(e.$t("PaymentRequestDialog.payment_request.description")),1)]),_:1})])]),_:1})]),m("div",kh,[c(Ne,{class:"q-pa-sm"},{default:f(()=>[m("div",bh,[c(Kt,{outline:"",clickable:"",class:"q-pa-md q-py-md",style:fo(e.chosenMintUrl==null?"":"height: 36px; font-family: monospace"),onClick:e.setActiveMintUrl},{default:f(()=>[c(ie,{name:"account_balance",size:"xs",class:"q-mr-sm"}),E(" "+S(e.getShortUrl(e.chosenMintUrl)),1)]),_:1},8,["style","onClick"]),m("div",{onClick:t[0]||(t[0]=(...l)=>e.toggleUnit&&e.toggleUnit(...l)),class:"q-mt-xs q-ml-sm"},[c(r,{class:"q-py-none",color:"white"})])])]),_:1})]),m("div",Dh,[c(Ne,{class:"q-pa-sm"},{default:f(()=>[m("div",Ch,[e.isEditingAmount?(b(),V("div",$h,[c(gt,{ref:"amountInput",modelValue:e.amountInputValue,"onUpdate:modelValue":t[1]||(t[1]=l=>e.amountInputValue=l),type:"number",placeholder:e.$t("PaymentRequestDialog.inputs.amount.placeholder"),onBlur:e.finishEditingAmount,onKeyup:St(e.finishEditingAmount,["enter"])},null,8,["modelValue","placeholder","onBlur","onKeyup"])])):(b(),V("div",Ph,[c(x,{color:"primary",rounded:"",onClick:e.startEditingAmount},{default:f(()=>[c(ie,{name:"edit_note",size:"xs",class:"q-mr-sm"}),E(" "+S(e.amountLabel),1)]),_:1},8,["onClick"])]))])]),_:1})]),c(x,{class:"q-mx-xs q-px-md q-mt-lg",size:"md",flat:"",rounded:"",dense:"",onClick:e.newRequest},{default:f(()=>[c(ie,{name:"refresh",class:"q-pr-sm",size:"xs"}),E(" "+S(e.$t("PaymentRequestDialog.actions.new_request.label")),1)]),_:1},8,["onClick"]),m("div",Th,[c(x,{class:"q-mx-xs",size:"md",flat:"",onClick:t[2]||(t[2]=l=>e.copyText(e.showPRKData))},{default:f(()=>[E(S(e.$t("PaymentRequestDialog.actions.copy.label")),1)]),_:1}),Ae((b(),B(x,{flat:"",color:"grey",class:"q-ml-auto"},{default:f(()=>[E(S(e.$t("PaymentRequestDialog.actions.close.label")),1)]),_:1})),[[Be]])])])]),_:1})):N("",!0)]),_:1},8,["modelValue"])}var Mh=Te(ph,[["render",qh]]);const Sh=xe({name:"ReceiveTokenDialog",mixins:[windowMixin],components:{P2PKDialog:ds,PRDialog:Mh,ChevronLeftIcon:Ia,ClipboardIcon:Ea,FileTextIcon:Ra,LockIcon:Ua,ScanIcon:Ft,NfcIcon:ki},data:function(){return{showP2PKDialog:!1}},computed:{...ne(ot,["showReceiveTokens","receiveData","scanningCard","watchClipboardPaste"]),...Y(Ce,["tickerShort","ndefSupported"]),...Y(ve,["activeProofs","activeUnit","addMintBlocking"]),...Y(st,["showNfcButtonInDrawer","autoPasteEcashReceive"]),...ne(Ce,["showReceiveEcashDrawer"]),...ne(ve,["addMintData","showAddMintDialog"]),...ne(ft,["showPRDialog"]),...Y(Ve,["hasCamera"]),...Y(dt,["p2pkKeys","showP2PkButtonInDrawer"]),...Y(ft,["enablePaymentRequest"]),...ne(Ce,["showReceiveDialog"]),...Y(Ve,["lastScannedResult"])},methods:{...J($e,["redeem"]),...J(Ve,["closeCamera","showCamera"]),...J(mt,["addPendingToken"]),...J(dt,["getPrivateKeyForP2PKEncodedToken","generateKeypair","showLastKey"]),...J(ve,["addMint"]),...J(ot,["receiveIfDecodes","decodeToken","knowThisMintOfTokenJson","toggleScanner","pasteToParseDialog"]),...ne(ot,["showReceiveTokens","receiveData"]),isiOsSafari(){const e=window.navigator.userAgent.toLowerCase(),t=/iphone|ipad|ipod/.test(e)&&/safari/.test(e);return console.log(`User agent: ${e}, is iOS Safari: ${t}`),t},handlePasteBtn:function(){this.receiveData.tokensBase64="",this.showReceiveTokens=!0,this.showReceiveEcashDrawer=!1,this.autoPasteEcashReceive&&(this.watchClipboardPaste=!0)},handleLockBtn:function(){this.showP2PKDialog=!this.showP2PKDialog,(!this.p2pkKeys.length||!this.showP2PKDialog)&&this.generateKeypair(),this.showLastKey(),this.showReceiveEcashDrawer=!1},handlePaymentRequestBtn:function(){const e=ft();this.showPRDialog=!this.showPRDialog,this.showPRDialog&&e.newPaymentRequest(),this.showReceiveEcashDrawer=!1},handleNFCBtn:function(){this.toggleScanner()},handleQrCodeDecode(e){console.log("QR code decoded:",e),this.closeCamera()},goBack:function(){this.showReceiveEcashDrawer=!1,this.showReceiveDialog=!0}}}),Ah={class:"col text-center"},Ih={class:"text-h6"},Eh={class:"q-gutter-y-md"},Rh={class:"row items-center full-width"},Uh={class:"icon-background q-mr-md"},xh={class:"text-left"},Nh={class:"text-weight-bold custom-btn-text"},Lh={class:"row items-center full-width"},Bh={class:"icon-background q-mr-md"},Fh={class:"text-left"},Oh={class:"text-weight-bold custom-btn-text"},zh={class:"row items-center full-width"},Vh={class:"icon-background q-mr-md"},Wh={class:"text-left"},jh={class:"text-weight-bold custom-btn-text"},Qh={class:"row items-center full-width"},Kh={class:"icon-background q-mr-md"},Hh={class:"text-left"},Gh={class:"text-weight-bold custom-btn-text"},Xh={class:"row items-center full-width"},Zh={class:"icon-background q-mr-md"},Yh={class:"text-left"},Jh={class:"text-weight-bold custom-btn-text"};function em(e,t,n,i,o,s){const a=H("ChevronLeftIcon"),r=H("ScanIcon"),l=H("ClipboardIcon"),g=H("FileTextIcon"),y=H("LockIcon"),D=H("NfcIcon"),_=H("P2PKDialog"),q=H("PRDialog");return b(),V(Je,null,[c(Xe,{modelValue:e.showReceiveEcashDrawer,"onUpdate:modelValue":t[0]||(t[0]=I=>e.showReceiveEcashDrawer=I),position:"bottom",maximized:e.$q.screen.lt.sm,"transition-show":"slide-up","transition-hide":"slide-down","backdrop-filter":"blur(2px) brightness(60%)"},{default:f(()=>[c(Oe,{class:"bg-grey-10 text-white full-width-card q-pb-lg"},{default:f(()=>[c(Ne,{class:"row items-center q-pb-sm"},{default:f(()=>[c(x,{flat:"",round:"",dense:"",onClick:e.goBack,class:"q-ml-sm",color:"primary"},{default:f(()=>[c(a)]),_:1},8,["onClick"]),m("div",Ah,[m("span",Ih,S(e.$t("ReceiveEcashDrawer.title")),1)]),c(x,{flat:"",round:"",dense:"",onClick:e.showCamera,class:"q-mr-sm",color:"primary"},{default:f(()=>[c(r)]),_:1},8,["onClick"])]),_:1}),c(Ne,{class:"q-pa-md"},{default:f(()=>[m("div",Eh,[c(x,{class:"full-width custom-btn",onClick:e.handlePasteBtn},{default:f(()=>[m("div",Rh,[m("div",Uh,[c(l)]),m("div",xh,[m("div",Nh,S(e.$t("ReceiveEcashDrawer.actions.paste.label")),1)])])]),_:1},8,["onClick"]),c(x,{class:"full-width custom-btn",onClick:e.showCamera},{default:f(()=>[m("div",Lh,[m("div",Bh,[c(r)]),m("div",Fh,[m("div",Oh,S(e.$t("ReceiveEcashDrawer.actions.scan.label")),1)])])]),_:1},8,["onClick"]),e.enablePaymentRequest?(b(),B(x,{key:0,class:"full-width custom-btn",onClick:e.handlePaymentRequestBtn},{default:f(()=>[m("div",zh,[m("div",Vh,[c(g)]),m("div",Wh,[m("div",jh,S(e.$t("ReceiveEcashDrawer.actions.request.label")),1)])])]),_:1},8,["onClick"])):N("",!0),e.showP2PkButtonInDrawer?(b(),B(x,{key:1,class:"full-width custom-btn",onClick:e.handleLockBtn},{default:f(()=>[m("div",Qh,[m("div",Kh,[c(y)]),m("div",Hh,[m("div",Gh,S(e.$t("ReceiveEcashDrawer.actions.lock.label")),1)])])]),_:1},8,["onClick"])):N("",!0),e.ndefSupported&&e.showNfcButtonInDrawer?(b(),B(x,{key:2,class:"full-width custom-btn",onClick:e.handleNFCBtn},{default:f(()=>[m("div",Xh,[m("div",Zh,[e.scanningCard?(b(),B(zn,{key:0,size:"sm"})):(b(),B(D,{key:1}))]),m("div",Yh,[m("div",Jh,S(e.$t("ReceiveEcashDrawer.actions.nfc.label"))+" "+S(e.scanningCard?e.$t("ReceiveEcashDrawer.actions.nfc.scanning_text"):""),1)])])]),_:1},8,["onClick"])):N("",!0)])]),_:1})]),_:1})]),_:1},8,["modelValue","maximized"]),c(_,{modelValue:e.showP2PKDialog,"onUpdate:modelValue":t[1]||(t[1]=I=>e.showP2PKDialog=I)},null,8,["modelValue"]),c(q,{modelValue:e.showPRDialog,"onUpdate:modelValue":t[2]||(t[2]=I=>e.showPRDialog=I)},null,8,["modelValue"])],64)}var tm=Te(Sh,[["render",em],["__scopeId","data-v-270dbfd2"]]);const nm=xe({name:"ReceiveDialog",components:{XIcon:_i,CoinsIcon:Wn,ZapIcon:pn,ScanIcon:Ft,ReceiveEcashDrawer:tm},mixins:[windowMixin],props:{},data:function(){return{currentPage:1,pageSize:5}},computed:{...ne(Ce,["showInvoiceDetails","showReceiveDialog","showReceiveEcashDrawer"]),...ne(ot,["showReceiveTokens","receiveData"]),...ne($e,["invoiceData"]),...Y(ve,["mints"]),canReceivePayments:function(){return!!this.mints.length}},methods:{toggleReceiveEcashDrawer:function(){this.showReceiveDialog=!1,this.showReceiveTokens=!1,this.showReceiveEcashDrawer=!0},showReceiveTokensDialog:function(){this.receiveData.tokensBase64="",this.showReceiveTokens=!0,this.showReceiveDialog=!1},showInvoiceCreateDialog:async function(){if(!this.canReceivePayments){dn(this.$i18n.t("ReceiveDialog.actions.lightning.error_no_mints")),this.showReceiveDialog=!1;return}console.log("##### showInvoiceCreateDialog"),this.invoiceData.amount="",this.invoiceData.bolt11="",this.invoiceData.hash="",this.invoiceData.memo="",this.showInvoiceDetails=!0,this.showReceiveDialog=!1},...J(Ve,["closeCamera","showCamera"])},created:function(){}}),im={class:"col text-center"},om={class:"text-h6"},sm={class:"q-gutter-y-md"},am={class:"row items-center full-width"},rm={class:"icon-background q-mr-md"},lm={class:"text-left"},cm={class:"text-weight-bold custom-btn-text"},um={class:"row items-center full-width"},dm={class:"icon-background q-mr-md"},fm={class:"text-left"},hm={class:"text-weight-bold custom-btn-text"};function mm(e,t,n,i,o,s){const a=H("XIcon"),r=H("ScanIcon"),l=H("CoinsIcon"),g=H("ZapIcon"),y=H("ReceiveEcashDrawer");return b(),V(Je,null,[c(Xe,{modelValue:e.showReceiveDialog,"onUpdate:modelValue":t[0]||(t[0]=D=>e.showReceiveDialog=D),position:"bottom",maximized:e.$q.screen.lt.sm,"transition-show":"slide-up","transition-hide":"slide-down","backdrop-filter":"blur(2px) brightness(60%)"},{default:f(()=>[c(Oe,{class:"bg-grey-10 text-white full-width-card q-pb-lg"},{default:f(()=>[c(Ne,{class:"row items-center q-pb-sm"},{default:f(()=>[Ae((b(),B(x,{flat:"",round:"",dense:"",class:"q-ml-sm",color:"primary"},{default:f(()=>[c(a)]),_:1})),[[Be]]),m("div",im,[m("span",om,S(e.$t("ReceiveDialog.title")),1)]),c(x,{flat:"",round:"",dense:"",class:"q-mr-sm",onClick:e.showCamera,color:"primary"},{default:f(()=>[c(r)]),_:1},8,["onClick"])]),_:1}),c(Ne,{class:"q-pa-md"},{default:f(()=>[m("div",sm,[c(x,{class:"full-width custom-btn",onClick:e.toggleReceiveEcashDrawer},{default:f(()=>[m("div",am,[m("div",rm,[c(l)]),m("div",lm,[m("div",cm,S(e.$t("ReceiveDialog.actions.points.label")),1)])])]),_:1},8,["onClick"]),c(x,{class:"full-width custom-btn",onClick:e.showInvoiceCreateDialog},{default:f(()=>[m("div",um,[m("div",dm,[c(g)]),m("div",fm,[m("div",hm,S(e.$t("ReceiveDialog.actions.lightning.label")),1)])])]),_:1},8,["onClick"])])]),_:1})]),_:1})]),_:1},8,["modelValue","maximized"]),c(y)],64)}var gm=Te(nm,[["render",mm],["__scopeId","data-v-21059e89"]]);class ue{constructor(t,n,i,o,s){this._legacyCanvasSize=ue.DEFAULT_CANVAS_SIZE,this._preferredCamera="environment",this._maxScansPerSecond=25,this._lastScanTimestamp=-1,this._destroyed=this._flashOn=this._paused=this._active=!1,this.$video=t,this.$canvas=document.createElement("canvas"),i&&typeof i=="object"?this._onDecode=n:(console.warn(i||o||s?"You're using a deprecated version of the QrScanner constructor which will be removed in the future":"Note that the type of the scan result passed to onDecode will change in the future. To already switch to the new api today, you can pass returnDetailedScanResult: true."),this._legacyOnDecode=n),n=typeof i=="object"?i:{},this._onDecodeError=n.onDecodeError||(typeof i=="function"?i:this._onDecodeError),this._calculateScanRegion=n.calculateScanRegion||(typeof o=="function"?o:this._calculateScanRegion),this._preferredCamera=n.preferredCamera||s||this._preferredCamera,this._legacyCanvasSize=typeof i=="number"?i:typeof o=="number"?o:this._legacyCanvasSize,this._maxScansPerSecond=n.maxScansPerSecond||this._maxScansPerSecond,this._onPlay=this._onPlay.bind(this),this._onLoadedMetaData=this._onLoadedMetaData.bind(this),this._onVisibilityChange=this._onVisibilityChange.bind(this),this._updateOverlay=this._updateOverlay.bind(this),t.disablePictureInPicture=!0,t.playsInline=!0,t.muted=!0;let a=!1;if(t.hidden&&(t.hidden=!1,a=!0),document.body.contains(t)||(document.body.appendChild(t),a=!0),i=t.parentElement,n.highlightScanRegion||n.highlightCodeOutline){if(o=!!n.overlay,this.$overlay=n.overlay||document.createElement("div"),s=this.$overlay.style,s.position="absolute",s.display="none",s.pointerEvents="none",this.$overlay.classList.add("scan-region-highlight"),!o&&n.highlightScanRegion){this.$overlay.innerHTML='<svg class="scan-region-highlight-svg" viewBox="0 0 238 238" preserveAspectRatio="none" style="position:absolute;width:100%;height:100%;left:0;top:0;fill:none;stroke:#e9b213;stroke-width:4;stroke-linecap:round;stroke-linejoin:round"><path d="M31 2H10a8 8 0 0 0-8 8v21M207 2h21a8 8 0 0 1 8 8v21m0 176v21a8 8 0 0 1-8 8h-21m-176 0H10a8 8 0 0 1-8-8v-21"/></svg>';try{this.$overlay.firstElementChild.animate({transform:["scale(.98)","scale(1.01)"]},{duration:400,iterations:1/0,direction:"alternate",easing:"ease-in-out"})}catch{}i.insertBefore(this.$overlay,this.$video.nextSibling)}n.highlightCodeOutline&&(this.$overlay.insertAdjacentHTML("beforeend",'<svg class="code-outline-highlight" preserveAspectRatio="none" style="display:none;width:100%;height:100%;fill:none;stroke:#e9b213;stroke-width:5;stroke-dasharray:25;stroke-linecap:round;stroke-linejoin:round"><polygon/></svg>'),this.$codeOutlineHighlight=this.$overlay.lastElementChild)}this._scanRegion=this._calculateScanRegion(t),requestAnimationFrame(()=>{let r=window.getComputedStyle(t);r.display==="none"&&(t.style.setProperty("display","block","important"),a=!0),r.visibility!=="visible"&&(t.style.setProperty("visibility","visible","important"),a=!0),a&&(console.warn("QrScanner has overwritten the video hiding style to avoid Safari stopping the playback."),t.style.opacity="0",t.style.width="0",t.style.height="0",this.$overlay&&this.$overlay.parentElement&&this.$overlay.parentElement.removeChild(this.$overlay),delete this.$overlay,delete this.$codeOutlineHighlight),this.$overlay&&this._updateOverlay()}),t.addEventListener("play",this._onPlay),t.addEventListener("loadedmetadata",this._onLoadedMetaData),document.addEventListener("visibilitychange",this._onVisibilityChange),window.addEventListener("resize",this._updateOverlay),this._qrEnginePromise=ue.createQrEngine()}static set WORKER_PATH(t){console.warn("Setting QrScanner.WORKER_PATH is not required and not supported anymore. Have a look at the README for new setup instructions.")}static async hasCamera(){try{return!!(await ue.listCameras(!1)).length}catch{return!1}}static async listCameras(t=!1){if(!navigator.mediaDevices)return[];let n=async()=>(await navigator.mediaDevices.enumerateDevices()).filter(o=>o.kind==="videoinput"),i;try{t&&(await n()).every(o=>!o.label)&&(i=await navigator.mediaDevices.getUserMedia({audio:!1,video:!0}))}catch{}try{return(await n()).map((o,s)=>({id:o.deviceId,label:o.label||(s===0?"Default Camera":`Camera ${s+1}`)}))}finally{i&&(console.warn("Call listCameras after successfully starting a QR scanner to avoid creating a temporary video stream"),ue._stopVideoStream(i))}}async hasFlash(){let t;try{if(this.$video.srcObject){if(!(this.$video.srcObject instanceof MediaStream))return!1;t=this.$video.srcObject}else t=(await this._getCameraStream()).stream;return"torch"in t.getVideoTracks()[0].getSettings()}catch{return!1}finally{t&&t!==this.$video.srcObject&&(console.warn("Call hasFlash after successfully starting the scanner to avoid creating a temporary video stream"),ue._stopVideoStream(t))}}isFlashOn(){return this._flashOn}async toggleFlash(){this._flashOn?await this.turnFlashOff():await this.turnFlashOn()}async turnFlashOn(){if(!this._flashOn&&!this._destroyed&&(this._flashOn=!0,this._active&&!this._paused))try{if(!await this.hasFlash())throw"No flash available";await this.$video.srcObject.getVideoTracks()[0].applyConstraints({advanced:[{torch:!0}]})}catch(t){throw this._flashOn=!1,t}}async turnFlashOff(){this._flashOn&&(this._flashOn=!1,await this._restartVideoStream())}destroy(){this.$video.removeEventListener("loadedmetadata",this._onLoadedMetaData),this.$video.removeEventListener("play",this._onPlay),document.removeEventListener("visibilitychange",this._onVisibilityChange),window.removeEventListener("resize",this._updateOverlay),this._destroyed=!0,this._flashOn=!1,this.stop(),ue._postWorkerMessage(this._qrEnginePromise,"close")}async start(){if(this._destroyed)throw Error("The QR scanner can not be started as it had been destroyed.");if((!this._active||this._paused)&&(window.location.protocol!=="https:"&&console.warn("The camera stream is only accessible if the page is transferred via https."),this._active=!0,!document.hidden))if(this._paused=!1,this.$video.srcObject)await this.$video.play();else try{let{stream:t,facingMode:n}=await this._getCameraStream();!this._active||this._paused?ue._stopVideoStream(t):(this._setVideoMirror(n),this.$video.srcObject=t,await this.$video.play(),this._flashOn&&(this._flashOn=!1,this.turnFlashOn().catch(()=>{})))}catch(t){if(!this._paused)throw this._active=!1,t}}stop(){this.pause(),this._active=!1}async pause(t=!1){if(this._paused=!0,!this._active)return!0;this.$video.pause(),this.$overlay&&(this.$overlay.style.display="none");let n=()=>{this.$video.srcObject instanceof MediaStream&&(ue._stopVideoStream(this.$video.srcObject),this.$video.srcObject=null)};return t?(n(),!0):(await new Promise(i=>setTimeout(i,300)),this._paused?(n(),!0):!1)}async setCamera(t){t!==this._preferredCamera&&(this._preferredCamera=t,await this._restartVideoStream())}static async scanImage(t,n,i,o,s=!1,a=!1){let r,l=!1;n&&("scanRegion"in n||"qrEngine"in n||"canvas"in n||"disallowCanvasResizing"in n||"alsoTryWithoutScanRegion"in n||"returnDetailedScanResult"in n)?(r=n.scanRegion,i=n.qrEngine,o=n.canvas,s=n.disallowCanvasResizing||!1,a=n.alsoTryWithoutScanRegion||!1,l=!0):console.warn(n||i||o||s||a?"You're using a deprecated api for scanImage which will be removed in the future.":"Note that the return type of scanImage will change in the future. To already switch to the new api today, you can pass returnDetailedScanResult: true."),n=!!i;try{let g,y;[i,g]=await Promise.all([i||ue.createQrEngine(),ue._loadImage(t)]),[o,y]=ue._drawToCanvas(g,r,o,s);let D;if(i instanceof Worker){let _=i;n||ue._postWorkerMessageSync(_,"inversionMode","both"),D=await new Promise((q,I)=>{let R,W,K,A=-1;W=X=>{X.data.id===A&&(_.removeEventListener("message",W),_.removeEventListener("error",K),clearTimeout(R),X.data.data!==null?q({data:X.data.data,cornerPoints:ue._convertPoints(X.data.cornerPoints,r)}):I(ue.NO_QR_CODE_FOUND))},K=X=>{_.removeEventListener("message",W),_.removeEventListener("error",K),clearTimeout(R),I("Scanner error: "+(X?X.message||X:"Unknown Error"))},_.addEventListener("message",W),_.addEventListener("error",K),R=setTimeout(()=>K("timeout"),1e4);let F=y.getImageData(0,0,o.width,o.height);A=ue._postWorkerMessageSync(_,"decode",F,[F.data.buffer])})}else D=await Promise.race([new Promise((_,q)=>window.setTimeout(()=>q("Scanner error: timeout"),1e4)),(async()=>{try{var[_]=await i.detect(o);if(!_)throw ue.NO_QR_CODE_FOUND;return{data:_.rawValue,cornerPoints:ue._convertPoints(_.cornerPoints,r)}}catch(q){if(_=q.message||q,/not implemented|service unavailable/.test(_))return ue._disableBarcodeDetector=!0,ue.scanImage(t,{scanRegion:r,canvas:o,disallowCanvasResizing:s,alsoTryWithoutScanRegion:a});throw`Scanner error: ${_}`}})()]);return l?D:D.data}catch(g){if(!r||!a)throw g;let y=await ue.scanImage(t,{qrEngine:i,canvas:o,disallowCanvasResizing:s});return l?y:y.data}finally{n||ue._postWorkerMessage(i,"close")}}setGrayscaleWeights(t,n,i,o=!0){ue._postWorkerMessage(this._qrEnginePromise,"grayscaleWeights",{red:t,green:n,blue:i,useIntegerApproximation:o})}setInversionMode(t){ue._postWorkerMessage(this._qrEnginePromise,"inversionMode",t)}static async createQrEngine(t){if(t&&console.warn("Specifying a worker path is not required and not supported anymore."),t=()=>ho(()=>import("./qr-scanner-worker.min.56d417f3.js"),[]).then(i=>i.createWorker()),!(!ue._disableBarcodeDetector&&"BarcodeDetector"in window&&BarcodeDetector.getSupportedFormats&&(await BarcodeDetector.getSupportedFormats()).includes("qr_code")))return t();let n=navigator.userAgentData;return n&&n.brands.some(({brand:i})=>/Chromium/i.test(i))&&/mac ?OS/i.test(n.platform)&&await n.getHighEntropyValues(["architecture","platformVersion"]).then(({architecture:i,platformVersion:o})=>/arm/i.test(i||"arm")&&13<=parseInt(o||"13")).catch(()=>!0)?t():new BarcodeDetector({formats:["qr_code"]})}_onPlay(){this._scanRegion=this._calculateScanRegion(this.$video),this._updateOverlay(),this.$overlay&&(this.$overlay.style.display=""),this._scanFrame()}_onLoadedMetaData(){this._scanRegion=this._calculateScanRegion(this.$video),this._updateOverlay()}_onVisibilityChange(){document.hidden?this.pause():this._active&&this.start()}_calculateScanRegion(t){let n=Math.round(.6666666666666666*Math.min(t.videoWidth,t.videoHeight));return{x:Math.round((t.videoWidth-n)/2),y:Math.round((t.videoHeight-n)/2),width:n,height:n,downScaledWidth:this._legacyCanvasSize,downScaledHeight:this._legacyCanvasSize}}_updateOverlay(){requestAnimationFrame(()=>{if(this.$overlay){var t=this.$video,n=t.videoWidth,i=t.videoHeight,o=t.offsetWidth,s=t.offsetHeight,a=t.offsetLeft,r=t.offsetTop,l=window.getComputedStyle(t),g=l.objectFit,y=n/i,D=o/s;switch(g){case"none":var _=n,q=i;break;case"fill":_=o,q=s;break;default:(g==="cover"?y>D:y<D)?(q=s,_=q*y):(_=o,q=_/y),g==="scale-down"&&(_=Math.min(_,n),q=Math.min(q,i))}var[I,R]=l.objectPosition.split(" ").map((K,A)=>{const F=parseFloat(K);return K.endsWith("%")?(A?s-q:o-_)*F/100:F});l=this._scanRegion.width||n,D=this._scanRegion.height||i,g=this._scanRegion.x||0;var W=this._scanRegion.y||0;y=this.$overlay.style,y.width=`${l/n*_}px`,y.height=`${D/i*q}px`,y.top=`${r+R+W/i*q}px`,i=/scaleX\(-1\)/.test(t.style.transform),y.left=`${a+(i?o-I-_:I)+(i?n-g-l:g)/n*_}px`,y.transform=t.style.transform}})}static _convertPoints(t,n){if(!n)return t;let i=n.x||0,o=n.y||0,s=n.width&&n.downScaledWidth?n.width/n.downScaledWidth:1;n=n.height&&n.downScaledHeight?n.height/n.downScaledHeight:1;for(let a of t)a.x=a.x*s+i,a.y=a.y*n+o;return t}_scanFrame(){!this._active||this.$video.paused||this.$video.ended||("requestVideoFrameCallback"in this.$video?this.$video.requestVideoFrameCallback.bind(this.$video):requestAnimationFrame)(async()=>{if(!(1>=this.$video.readyState)){var t=Date.now()-this._lastScanTimestamp,n=1e3/this._maxScansPerSecond;t<n&&await new Promise(o=>setTimeout(o,n-t)),this._lastScanTimestamp=Date.now();try{var i=await ue.scanImage(this.$video,{scanRegion:this._scanRegion,qrEngine:this._qrEnginePromise,canvas:this.$canvas})}catch(o){if(!this._active)return;this._onDecodeError(o)}!ue._disableBarcodeDetector||await this._qrEnginePromise instanceof Worker||(this._qrEnginePromise=ue.createQrEngine()),i?(this._onDecode?this._onDecode(i):this._legacyOnDecode&&this._legacyOnDecode(i.data),this.$codeOutlineHighlight&&(clearTimeout(this._codeOutlineHighlightRemovalTimeout),this._codeOutlineHighlightRemovalTimeout=void 0,this.$codeOutlineHighlight.setAttribute("viewBox",`${this._scanRegion.x||0} ${this._scanRegion.y||0} ${this._scanRegion.width||this.$video.videoWidth} ${this._scanRegion.height||this.$video.videoHeight}`),this.$codeOutlineHighlight.firstElementChild.setAttribute("points",i.cornerPoints.map(({x:o,y:s})=>`${o},${s}`).join(" ")),this.$codeOutlineHighlight.style.display="")):this.$codeOutlineHighlight&&!this._codeOutlineHighlightRemovalTimeout&&(this._codeOutlineHighlightRemovalTimeout=setTimeout(()=>this.$codeOutlineHighlight.style.display="none",100))}this._scanFrame()})}_onDecodeError(t){t!==ue.NO_QR_CODE_FOUND&&console.log(t)}async _getCameraStream(){if(!navigator.mediaDevices)throw"Camera not found.";let t=/^(environment|user)$/.test(this._preferredCamera)?"facingMode":"deviceId",n=[{width:{min:1024}},{width:{min:768}},{}],i=n.map(o=>Object.assign({},o,{[t]:{exact:this._preferredCamera}}));for(let o of[...i,...n])try{let s=await navigator.mediaDevices.getUserMedia({video:o,audio:!1}),a=this._getFacingMode(s)||(o.facingMode?this._preferredCamera:this._preferredCamera==="environment"?"user":"environment");return{stream:s,facingMode:a}}catch{}throw"Camera not found."}async _restartVideoStream(){let t=this._paused;await this.pause(!0)&&!t&&this._active&&await this.start()}static _stopVideoStream(t){for(let n of t.getTracks())n.stop(),t.removeTrack(n)}_setVideoMirror(t){this.$video.style.transform="scaleX("+(t==="user"?-1:1)+")"}_getFacingMode(t){return(t=t.getVideoTracks()[0])?/rear|back|environment/i.test(t.label)?"environment":/front|user|face/i.test(t.label)?"user":null:null}static _drawToCanvas(t,n,i,o=!1){i=i||document.createElement("canvas");let s=n&&n.x?n.x:0,a=n&&n.y?n.y:0,r=n&&n.width?n.width:t.videoWidth||t.width,l=n&&n.height?n.height:t.videoHeight||t.height;return o||(o=n&&n.downScaledWidth?n.downScaledWidth:r,n=n&&n.downScaledHeight?n.downScaledHeight:l,i.width!==o&&(i.width=o),i.height!==n&&(i.height=n)),n=i.getContext("2d",{alpha:!1}),n.imageSmoothingEnabled=!1,n.drawImage(t,s,a,r,l,0,0,i.width,i.height),[i,n]}static async _loadImage(t){if(t instanceof Image)return await ue._awaitImageLoad(t),t;if(t instanceof HTMLVideoElement||t instanceof HTMLCanvasElement||t instanceof SVGImageElement||"OffscreenCanvas"in window&&t instanceof OffscreenCanvas||"ImageBitmap"in window&&t instanceof ImageBitmap)return t;if(t instanceof File||t instanceof Blob||t instanceof URL||typeof t=="string"){let n=new Image;n.src=t instanceof File||t instanceof Blob?URL.createObjectURL(t):t.toString();try{return await ue._awaitImageLoad(n),n}finally{(t instanceof File||t instanceof Blob)&&URL.revokeObjectURL(n.src)}}else throw"Unsupported image type."}static async _awaitImageLoad(t){t.complete&&t.naturalWidth!==0||await new Promise((n,i)=>{let o=s=>{t.removeEventListener("load",o),t.removeEventListener("error",o),s instanceof ErrorEvent?i("Image load error"):n()};t.addEventListener("load",o),t.addEventListener("error",o)})}static async _postWorkerMessage(t,n,i,o){return ue._postWorkerMessageSync(await t,n,i,o)}static _postWorkerMessageSync(t,n,i,o){if(!(t instanceof Worker))return-1;let s=ue._workerMessageId++;return t.postMessage({id:s,type:n,data:i},o),s}}ue.DEFAULT_CANVAS_SIZE=400;ue.NO_QR_CODE_FOUND="No QR code found";ue._disableBarcodeDetector=!1;ue._workerMessageId=0;const pm={emits:["decode"],data(){return{qrScanner:null,urDecoder:null,urDecoderProgress:0,cameraWorking:!1}},async mounted(){try{if(!await this.requestCameraPermission()){console.error("Camera permission denied"),this.$q.notify({type:"negative",message:"Camera permission is required to scan QR codes",position:"top"});return}this.qrScanner=new ue(this.$refs.cameraEl,t=>{this.handleResult(t)},{returnDetailedScanResult:!0,highlightScanRegion:!0,highlightCodeOutline:!0,onDecodeError:t=>{console.debug("QR decode error:",t)}}),await this.qrScanner.start(),this.urDecoder=new cu,this.cameraWorking=!0,console.log("\u2705 Camera started successfully")}catch(e){console.error("\u274C Failed to start camera:",e),this.$q.notify({type:"negative",message:`Camera error: ${e}. Please check permissions in Settings.`,position:"top",timeout:5e3})}},computed:{...Y(Ve,["camera","hasCamera"]),canPasteFromClipboard:function(){return window.isSecureContext&&navigator.clipboard&&navigator.clipboard.readText}},methods:{...J(Ve,["closeCamera","showCamera"]),async requestCameraPermission(){try{return console.log("\u{1F4F7} Requesting camera permission via getUserMedia..."),(await navigator.mediaDevices.getUserMedia({video:{facingMode:"environment",width:{ideal:1280},height:{ideal:720}}})).getTracks().forEach(t=>t.stop()),console.log("\u2705 Camera permission granted via getUserMedia"),!0}catch(e){console.warn("\u274C getUserMedia failed, trying Capacitor Camera plugin...",e);try{const{Camera:t}=await ho(()=>import("./index.828d157d.js"),["assets/index.828d157d.js","assets/ui.64f31f6c.js","assets/index.7a0464ee.js","assets/index.b3bf3286.css","assets/index.81b98c8b.js","assets/i18n.e67af30b.js"]),n=await t.checkPermissions();if(console.log("\u{1F4F7} Current camera permissions:",n),n.camera==="granted")return console.log("\u2705 Camera permission already granted via Capacitor"),!0;const i=await t.requestPermissions();return console.log("\u{1F4F7} Camera permission request result:",i),i.camera==="granted"?(console.log("\u2705 Camera permission granted via Capacitor"),!0):(console.error("\u274C Camera permission denied via Capacitor:",i),!1)}catch(t){return console.error("\u274C Capacitor Camera plugin also failed:",t),!1}}},handleResult(e){if(e.data.toLowerCase().startsWith("ur:")){if(this.urDecoder?.receivePart(e.data),this.urDecoderProgress=this.urDecoder?.estimatedPercentComplete()||0,this.urDecoder?.isComplete()&&this.urDecoder?.isSuccess()){const n=(this.urDecoder?.resultUR()).decodeCBOR();this.$emit("decode",n.toString()),this.qrScanner?.stop(),document.activeElement?.blur(),this.urDecoderProgress=0}}else this.$emit("decode",e.data),this.qrScanner?.stop(),document.activeElement?.blur()},pasteToParseDialog:async function(){const e=await Ce().pasteFromClipboard();e&&this.$emit("decode",e)},async retryCameraPermission(){if(console.log("\u{1F504} Retrying camera permission..."),await this.requestCameraPermission())try{this.qrScanner=new ue(this.$refs.cameraEl,t=>{this.handleResult(t)},{returnDetailedScanResult:!0,highlightScanRegion:!0,highlightCodeOutline:!0,onDecodeError:t=>{console.debug("QR decode error:",t)}}),await this.qrScanner.start(),this.cameraWorking=!0,this.$q.notify({type:"positive",message:"Camera started successfully!",position:"top"})}catch(t){console.error("\u274C Failed to start camera after permission:",t),this.$q.notify({type:"negative",message:`Camera error: ${t}`,position:"top"})}else this.$q.notify({type:"negative",message:"Camera permission denied. Please enable in Settings.",position:"top"})}},unmounted(){try{this.qrScanner&&(this.qrScanner.stop(),this.qrScanner.destroy())}catch(e){console.warn("Error cleaning up camera:",e)}}},vm={class:"text-center"},ym={ref:"cameraEl",style:{width:"100%"}},_m={class:"row q-justify-center"},wm={class:"absolute-full flex flex-center"},km={class:"row q-my-sm"};function bm(e,t,n,i,o,s){return b(),B(Oe,null,{default:f(()=>[m("div",vm,[m("div",null,[m("video",ym,null,512)]),m("div",null,[m("div",_m,[o.urDecoderProgress>0?(b(),B(vi,{key:0,rounded:"",size:"30px",value:o.urDecoderProgress,indeterminate:o.urDecoderProgress===0,class:"q-mt-none",color:"secondary"},{default:f(()=>[m("div",wm,[c(Nt,{color:"white","text-color":"secondary",style:{"font-size":"1rem",padding:"5px"},class:"text-weight-bold",label:e.$t("QrcodeReader.progress.text",{percentage:e.$t("QrcodeReader.progress.percentage",{percentage:Math.round(o.urDecoderProgress*100)}),addon:o.urDecoderProgress>.9?e.$t("QrcodeReader.progress.keep_scanning_text"):""})},null,8,["label"])])]),_:1},8,["value","indeterminate"])):N("",!0)])])]),m("div",km,[s.canPasteFromClipboard?(b(),B(x,{key:0,unelevated:"",onClick:s.pasteToParseDialog},{default:f(()=>[c(ie,{name:"content_paste",class:"q-mr-sm"}),E(" "+S(e.$t("QrcodeReader.actions.paste.label")),1)]),_:1},8,["onClick"])):N("",!0),o.cameraWorking?N("",!0):(b(),B(x,{key:1,onClick:s.retryCameraPermission,color:"primary",class:"q-ml-sm"},{default:f(()=>[c(ie,{name:"camera_alt",class:"q-mr-sm"}),E(" Grant Camera Permission ")]),_:1},8,["onClick"])),c(x,{flat:"",round:"",icon:"close",color:"grey",onClick:e.closeCamera,class:"q-ml-auto"},{default:f(()=>[c(Le,null,{default:f(()=>[E("Close")]),_:1})]),_:1},8,["onClick"])])]),_:1})}var Dm=Te(pm,[["render",bm]]);const Cm=xe({name:"EcashClaimNotification",setup(){const e=po(),t=De(!1),n=De(!1),i=De(new Set),o=z(()=>e.unclaimedTokens.filter(_=>!_.claimed)),s=z(()=>o.value.length),a=z(()=>o.value.filter(_=>_.unit==="sat").reduce((_,q)=>_+q.amount,0));return{bluetoothStore:e,showDetails:t,claiming:n,claimingTokens:i,unclaimedTokens:o,unclaimedCount:s,unclaimedValue:a,formatNpub:_=>_?_.substring(0,12)+"..."+_.substring(_.length-6):"Unknown",formatTimestamp:_=>{const q=new Date(_),R=Date.now()-_;return R<6e4?"Just now":R<36e5?`${Math.floor(R/6e4)}m ago`:R<864e5?`${Math.floor(R/36e5)}h ago`:q.toLocaleDateString()},claimSingle:async _=>{i.value.add(_);try{await e.claimTokenSilently(_)&&un("Token processed successfully!")}catch(q){console.error("Failed to claim token:",q),Tt("Failed to claim token")}finally{i.value.delete(_),i.value=new Set(i.value)}},claimAll:async()=>{n.value=!0;try{await e.autoClaimTokensSilently(),un("All tokens processed!"),t.value=!1}catch(_){console.error("Failed to claim tokens:",_),Tt("Some tokens could not be claimed")}finally{n.value=!1}},clearAll:()=>{e.clearAllUnclaimedTokens(),t.value=!1}}}}),Pm={key:0,class:"ecash-claim-banner"},$m={class:"banner-content"},Tm={class:"text-h6"},qm={class:"text-caption"},Mm={key:0,class:"q-mt-sm"};function Sm(e,t,n,i,o,s){return e.unclaimedCount>0?(b(),V("div",Pm,[c(fs,{class:"bg-positive text-white",rounded:""},{avatar:f(()=>[c(ie,{name:"bluetooth",size:"md"})]),action:f(()=>[c(x,{flat:"",label:"Claim All",onClick:e.claimAll,loading:e.claiming},null,8,["onClick","loading"]),c(x,{flat:"",label:"Clear All",onClick:e.clearAll,color:"negative"},null,8,["onClick"]),c(x,{flat:"",icon:"expand_more",onClick:t[0]||(t[0]=a=>e.showDetails=!e.showDetails)})]),default:f(()=>[m("div",$m,[m("div",Tm,S(e.unclaimedCount)+" Ecash Token"+S(e.unclaimedCount!==1?"s":"")+" Received ",1),m("div",qm," Total: "+S(e.unclaimedValue)+" sats via Bluetooth ",1)])]),_:1}),c(Rs,null,{default:f(()=>[e.showDetails?(b(),V("div",Mm,[c(Oe,null,{default:f(()=>[c(yi,{separator:""},{default:f(()=>[(b(!0),V(Je,null,Ht(e.unclaimedTokens,a=>(b(),B(hi,{key:a.id},{default:f(()=>[c(xt,{avatar:""},{default:f(()=>[c(On,{color:"primary","text-color":"white"},{default:f(()=>[E(S(a.amount),1)]),_:2},1024)]),_:2},1024),c(xt,null,{default:f(()=>[c(Ge,null,{default:f(()=>[E(S(a.amount)+" "+S(a.unit),1)]),_:2},1024),c(Ge,{caption:""},{default:f(()=>[E(" From: "+S(e.formatNpub(a.sender)),1)]),_:2},1024),a.memo?(b(),B(Ge,{key:0,caption:""},{default:f(()=>[E(' "'+S(a.memo)+'" ',1)]),_:2},1024)):N("",!0),c(Ge,{caption:"",class:"text-grey-6"},{default:f(()=>[E(S(e.formatTimestamp(a.timestamp)),1)]),_:2},1024)]),_:2},1024),c(xt,{side:""},{default:f(()=>[c(x,{round:"",dense:"",flat:"",icon:"download",color:"primary",onClick:r=>e.claimSingle(a.id),loading:e.claimingTokens.has(a.id)},{default:f(()=>[c(Le,null,{default:f(()=>[E("Claim Token")]),_:1})]),_:2},1032,["onClick","loading"])]),_:2},1024)]),_:2},1024))),128))]),_:1})]),_:1})])):N("",!0)]),_:1})])):N("",!0)}var Am=Te(Cm,[["render",Sm],["__scopeId","data-v-3aad4629"]]);const Im=xe({name:"ActivityOrb",mixins:[windowMixin],components:{},props:{},data:function(){return{enableSpinner:!1}},mounted(){},computed:{...ne(Ce,["activityOrb"]),...Y($e,["activeWebsocketConnections"]),...Y(ot,["scanningCard"])},watch:{activityOrb:function(){this.activityOrb?(this.enableSpinner=!0,setTimeout(()=>{this.activityOrb=!1,this.enableSpinner=!1},2e3)):this.enableSpinner=!1},scanningCard:function(){this.scanningCard?this.enableSpinner=!0:this.enableSpinner=!1}},methods:{}}),Em={class:"row justify-center q-mb-none",style:{position:"absolute",top:"60px",left:"0",width:"100%"}};function Rm(e,t,n,i,o,s){return b(),V("div",Em,[m("div",null,[c(Ze,{appear:"","enter-active-class":"animated fadeIn","leave-active-class":"animated fadeOut"},{default:f(()=>[e.enableSpinner?(b(),B(ie,{key:0,name:"adjust",color:"primary",size:"1.5em"})):N("",!0)]),_:1})])])}var Um=Te(Im,[["render",Rm],["__scopeId","data-v-16d0a55d"]]);const xm=xe({name:"ReceiveTokenDialog",mixins:[windowMixin],components:{TokenInformation:Co,NfcIcon:ki,ScanIcon:Ft,ChooseMint:Vn},data:function(){return{showP2PKDialog:!1,swapSelected:!1}},watch:{watchClipboardPaste(e){e&&this.$nextTick(()=>{this.pasteToParseDialog(),this.watchClipboardPaste=!1})},"receiveData.tokensBase64":{handler(e){e&&this.tokenDecodesCorrectly&&this.autoReceiveIfValid()},immediate:!1}},computed:{...ne(ot,["showReceiveTokens","watchClipboardPaste","receiveData","scanningCard"]),...Y(Ce,["tickerShort","ndefSupported"]),...Y(Gt,["bitcoinPrice","bitcoinPrices","currentCurrencyPrice"]),...Y(st,["bitcoinPriceCurrency"]),...Y(ve,["activeMintUrl","activeProofs","activeUnit","addMintBlocking","mints"]),...Y(st,["enableReceiveSwaps"]),...ne(ve,["addMintData","showAddMintDialog"]),...ne(ft,["showPRDialog"]),...Y(Ve,["hasCamera"]),...Y(dt,["p2pkKeys"]),...Y(ft,["enablePaymentRequest"]),...Y(Bi,["swapBlocking"]),...ne(Ce,["showReceiveDialog"]),...Y(Ve,["lastScannedResult"]),canPasteFromClipboard:function(){return window.isSecureContext&&navigator.clipboard&&navigator.clipboard.readText},tokenDecodesCorrectly:function(){return this.decodeToken(this.receiveData.tokensBase64)!==void 0?!0:this.decodePeanut(this.receiveData.tokensBase64)!==void 0},knowThisMint:function(){const e=this.decodeToken(this.receiveData.tokensBase64);return e==null?!1:this.knowThisMintOfTokenJson(e)},tokenAmount:function(){if(!this.tokenDecodesCorrectly)return 0;const e=this.decodeToken(this.receiveData.tokensBase64);return this.getProofs(e).reduce((t,n)=>t+=n.amount,0)},tokenUnit:function(){if(!this.tokenDecodesCorrectly)return"";const e=this.decodeToken(this.receiveData.tokensBase64);return pe.getUnit(e)},tokenMint:function(){if(!this.tokenDecodesCorrectly)return"";const e=this.decodeToken(this.receiveData.tokensBase64);return this.getMint(e)},swapToMintAmount:function(){const e=this.decodeToken(this.receiveData.tokensBase64);return this.tokenAmount-Bi().meltToMintFees(e)}},methods:{...J($e,["redeem"]),...J(Ve,["closeCamera","showCamera"]),...J(mt,["addPendingToken"]),...J(dt,["getPrivateKeyForP2PKEncodedToken","generateKeypair","showLastKey"]),...J(ve,["addMint"]),...J(ot,["receiveIfDecodes","decodeToken","knowThisMintOfTokenJson","toggleScanner","pasteToParseDialog"]),decodePeanut:function(e){try{let t=[];const n=Array.from(e);if(!n.length)return;const i=function(o){const s=o.codePointAt(0);if(s>=65024&&s<=65039){const a=s-65024;return String.fromCharCode(a)}if(s>=917760&&s<=917999){const a=s-917760+16;return String.fromCharCode(a)}return null};for(const o of n){let s=i(o);if(s===null&&t.length>0)break;if(s===null)continue;t.push(s)}return t=t.join(""),t&&(this.receiveData.tokensBase64=t),this.decodeToken(t)}catch{return}},getProofs:function(e){return pe.getProofs(e)},getMint:function(e){return pe.getMint(e)},tokenAlreadyInHistory:function(e){return mt().historyTokens.find(n=>n.token===e)!==void 0},addPendingTokenToHistory:function(e){if(this.tokenAlreadyInHistory(e)){this.notifySuccess(this.$i18n.t("ReceiveTokenDialog.actions.later.already_in_history_success_text")),this.showReceiveTokens=!1;return}const t=mt(),n=this.decodeToken(e),i=this.getMint(n),o=pe.getUnit(n),s=this.getProofs(n).reduce((a,r)=>a+=r.amount,0);t.addPendingToken({amount:s,token:e,mintInToken:i,unitInToken:o}),this.showReceiveTokens=!1,this.notifySuccess(this.$i18n.t("ReceiveTokenDialog.actions.later.added_to_history_success_text"))},handleSwapToTrustedMint:async function(){const e=ve().activeMint().mint;await ot().meltTokenToMint(this.receiveData.tokensBase64,e),this.swapSelected=!1},autoReceiveIfValid:async function(){const e=dt();if(!(e.getPrivateKeyForP2PKEncodedToken(this.receiveData.tokensBase64)===null&&e.isP2PKEncodedToken(this.receiveData.tokensBase64)))try{await this.receiveIfDecodes()}catch(n){console.error("Auto-receive failed:",n)}}}}),Nm={class:"row items-center no-wrap q-mb-sm q-mb-sm q-py-lg"},Lm={class:"col-9"},Bm={class:"text-h6"},Fm={key:0,class:"q-ml-xs text-subtitle2 text-grey-6"},Om={class:"relative-container"},zm={class:"row"},Vm={key:1},Wm={class:"q-pl-sm"},jm={key:2,class:"q-mr-xl"},Qm={class:"row"},Km={key:0,class:"row q-pt-md"},Hm={key:1,class:"row q-pl-md q-pt-sm"},Gm={key:2,class:"row q-pt-xs"},Xm={key:3,class:"row q-pt-sm"};function Zm(e,t,n,i,o,s){const a=H("ScanIcon"),r=H("NfcIcon"),l=H("TokenInformation"),g=H("i18n-t"),y=H("ChooseMint");return b(),B(Xe,{modelValue:e.showReceiveTokens,"onUpdate:modelValue":t[7]||(t[7]=D=>e.showReceiveTokens=D),position:"top",maximized:e.$q.screen.lt.sm,"transition-show":"fade","transition-hide":"fade","no-backdrop-dismiss":""},{default:f(()=>[c(Oe,{modelValue:e.showReceiveTokens,"onUpdate:modelValue":t[6]||(t[6]=D=>e.showReceiveTokens=D),class:"q-pa-lg qcard q-card-top"},{default:f(()=>[Ae((b(),B(x,{rounded:"",flat:"",color:"grey",class:"close-btn-position"},{default:f(()=>[E(S(e.$t("ReceiveTokenDialog.actions.close.label")),1)]),_:1})),[[Be]]),m("div",null,[m("div",Nm,[m("div",Lm,[m("span",Bm,S(e.$t("ReceiveTokenDialog.title",{value:e.tokenAmount&&e.tokenUnit?e.formatCurrency(e.tokenAmount,e.tokenUnit):e.$t("ReceiveTokenDialog.title_ecash_text")})),1),e.tokenAmount&&e.tokenUnit&&e.tokenUnit=="points"&&e.bitcoinPrice?(b(),V("span",Fm," ("+S(e.formatCurrency(e.currentCurrencyPrice/1e8*e.tokenAmount,e.bitcoinPriceCurrency,!0))+") ",1)):N("",!0)])]),m("div",Om,[c(gt,{round:"",outlined:"",spellcheck:"false",modelValue:e.receiveData.tokensBase64,"onUpdate:modelValue":t[1]||(t[1]=D=>e.receiveData.tokensBase64=D),label:e.$t("ReceiveTokenDialog.inputs.tokens_base64.label"),type:"textarea",readonly:"",class:"q-mb-lg cashub-nowrap",onKeyup:St(e.receiveIfDecodes,["enter"])},{default:f(()=>[e.receiveData.tokensBase64?(b(),B(ie,{key:0,color:"dark",name:"close",class:"floating-button cursor-pointer",onClick:t[0]||(t[0]=D=>e.receiveData.tokensBase64="")})):N("",!0)]),_:1},8,["modelValue","label","onKeyup"])])]),m("div",zm,[e.receiveData.tokensBase64.length&&!e.tokenDecodesCorrectly?(b(),B(x,{key:0,disabled:"",color:"yellow","text-color":"black",rounded:"",unelevated:"",class:"q-ml-xs q-mr-sm",label:e.$t("ReceiveTokenDialog.errors.invalid_token.label")},null,8,["label"])):N("",!0),e.receiveData.tokensBase64.length?N("",!0):(b(),V("div",Vm,[e.canPasteFromClipboard?(b(),B(x,{key:0,unelevated:"",dense:"",class:"q-mr-sm",onClick:t[2]||(t[2]=D=>e.pasteToParseDialog(!0))},{default:f(()=>[c(ie,{name:"content_paste",class:"q-pr-sm"}),E(S(e.$t("ReceiveTokenDialog.actions.paste.label")),1)]),_:1})):N("",!0),e.hasCamera?(b(),B(x,{key:1,unelevated:"",dense:"",class:"q-mx-sm",onClick:e.showCamera},{default:f(()=>[c(a,{size:"1.5em"}),m("span",Wm,S(e.$t("ReceiveTokenDialog.actions.scan.label")),1)]),_:1},8,["onClick"])):N("",!0),e.ndefSupported?(b(),B(x,{key:2,unelevated:"",dense:"",class:"q-mx-sm",loading:e.scanningCard,disabled:e.scanningCard,onClick:e.toggleScanner},{loading:f(()=>[c(zn,{onClick:e.toggleScanner},null,8,["onClick"])]),default:f(()=>[c(r,{class:"q-pr-xs"}),c(Le,null,{default:f(()=>[E(S(e.ndefSupported?e.$t("ReceiveTokenDialog.actions.nfc.tooltips.ndef_supported_text"):e.$t("ReceiveTokenDialog.actions.nfc.tooltips.ndef_unsupported_text")),1)]),_:1}),E(" "+S(e.$t("ReceiveTokenDialog.actions.nfc.label")),1)]),_:1},8,["loading","disabled","onClick"])):N("",!0)])),e.tokenDecodesCorrectly?(b(),V("div",jm,[m("div",Qm,[c(l,{encodedToken:e.receiveData.tokensBase64,showAmount:!0,showMintCheck:!0,showP2PKCheck:!0},null,8,["encodedToken"])]),e.swapSelected?N("",!0):(b(),V("div",Km,[c(x,{onClick:e.receiveIfDecodes,color:"primary",rounded:"",class:"q-ml-xs q-mr-sm",disabled:e.addMintBlocking,loading:e.swapBlocking,label:e.knowThisMint?e.addMintBlocking?e.$t("ReceiveTokenDialog.actions.receive.label_adding_mint"):e.$t("ReceiveTokenDialog.actions.receive.label_known_mint"):e.$t("ReceiveTokenDialog.actions.receive.label")},{loading:f(()=>[c(ht)]),_:1},8,["onClick","disabled","loading","label"]),e.enableReceiveSwaps&&e.activeMintUrl&&e.mints.length?(b(),B(x,{key:0,onClick:t[3]||(t[3]=D=>e.swapSelected=!0),color:"primary",rounded:"",flat:"",class:"q-mr-none"},{default:f(()=>[c(ie,{name:"swap_horiz",class:"q-pr-sm"}),E(" "+S(e.$t("ReceiveTokenDialog.actions.swap.label"))+" ",1),c(Le,null,{default:f(()=>[E(S(e.$t("ReceiveTokenDialog.actions.swap.tooltip_text")),1)]),_:1})]),_:1})):N("",!0),c(x,{onClick:t[4]||(t[4]=D=>e.addPendingTokenToHistory(e.receiveData.tokensBase64)),color:"primary",rounded:"",flat:"",class:"q-mr-none"},{default:f(()=>[E(S(e.$t("ReceiveTokenDialog.actions.later.label"))+" ",1),c(Le,null,{default:f(()=>[E(S(e.$t("ReceiveTokenDialog.actions.later.tooltip_text")),1)]),_:1})]),_:1})])),e.swapSelected?(b(),V("div",Hm,[m("div",null,[c(ie,{name:"arrow_downward",class:"q-mr-xs",color:"positive"}),c(g,{keypath:"ReceiveTokenDialog.actions.swap.caption",tag:"span"},{value:f(()=>[m("strong",null,S(e.formatCurrency(e.swapToMintAmount,e.tokenUnit)),1)]),_:1})])])):N("",!0),e.swapSelected?(b(),V("div",Gm,[c(y,{rounded:!0,title:"",style:"font-family: monospace; font-size: 12px;"})])):N("",!0),e.swapSelected?(b(),V("div",Xm,[c(x,{onClick:e.handleSwapToTrustedMint,color:"primary",rounded:"",class:"q-pr-md",loading:e.swapBlocking,disabled:e.activeMintUrl==e.tokenMint},{loading:f(()=>[c(ht,{size:"xs"}),E(" "+S(e.$t("ReceiveTokenDialog.actions.confirm_swap.in_progress")),1)]),default:f(()=>[c(ie,{name:"swap_horiz",class:"q-pr-sm"}),E(" "+S(e.$t("ReceiveTokenDialog.actions.confirm_swap.label"))+" ",1),c(Le,null,{default:f(()=>[E(S(e.$t("ReceiveTokenDialog.actions.confirm_swap.tooltip_text")),1)]),_:1})]),_:1},8,["onClick","loading","disabled"]),e.swapBlocking?N("",!0):(b(),B(x,{key:0,onClick:t[5]||(t[5]=D=>e.swapSelected=!1),color:"grey",rounded:"",flat:"",class:"q-mr-none q-pr-sm"},{default:f(()=>[c(ie,{name:"close",class:"q-pr-sm"}),E(" "+S(e.$t("ReceiveTokenDialog.actions.cancel_swap.label"))+" ",1),c(Le,null,{default:f(()=>[E(S(e.$t("ReceiveTokenDialog.actions.cancel_swap.tooltip_text")),1)]),_:1})]),_:1}))])):N("",!0)])):N("",!0)])]),_:1},8,["modelValue"])]),_:1},8,["modelValue","maximized"])}var Ym=Te(xm,[["render",Zm],["__scopeId","data-v-518ac6de"]]);const Jm=co("migrations",{state:()=>({currentVersion:Gs("cashu.migrations.version",0),migrations:[]}),actions:{registerMigration(e){this.migrations.some(t=>t.version===e.version)||(this.migrations.push(e),this.migrations.sort((t,n)=>t.version-n.version))},async runMigrations(){const e=this.migrations.filter(n=>n.version>this.currentVersion);if(e.length===0){console.log("No migrations to run");return}console.log(`Running ${e.length} migrations...`);const t=Ce();await t.lockMutex();try{for(const n of e){console.log(`Running migration ${n.version}: ${n.name}`);try{await n.execute(),this.currentVersion=n.version,console.log(`Migration ${n.version} completed successfully`)}catch(i){console.error(`Migration ${n.version} failed:`,i);break}}}finally{await t.unlockMutex()}},async migrateStablenutsToCash(){const e=ve();let t=!1;for(let n=0;n<e.mints.length;n++)e.mints[n].url==="https://stablenut.umint.cash"&&(console.log("Updating mint URL from stablenuts.cash to umint.cash"),e.mints[n].url="https://stablenut.cashu.network",e.activeMintUrl==="https://stablenut.umint.cash"&&(e.activeMintUrl="https://stablenut.cashu.network"),t=!0);console.log(t?"Successfully updated mint URL":"No stablenuts.cash mint found to update")},initMigrations(){this.registerMigration({version:1,name:"Migrate stablenuts.cash to umint.cash",description:"Updates mint URL from https://stablenut.umint.cash to https://stablenut.cashu.network",execute:async()=>await this.migrateStablenutsToCash()})}}});const eg={mixins:[windowMixin],components:{BalanceView:Ca,MintSettings:mr,HistoryTable:Kr,NoMintWarnBanner:il,WelcomeDialog:fl,SendTokenDialog:od,ReceiveTokenDialog:Ym,PayInvoiceDialog:Uf,InvoiceDetailDialog:th,QrcodeReader:Dm,SendDialog:gh,ReceiveDialog:gm,iOSPWAPrompt:As,AndroidPWAPrompt:Is,ScanIcon:Ft,XIcon:_i,ZapIcon:pn,ActivityOrb:Um,EcashClaimNotification:Am,NearbyContactsDialog:hs,NostrContactsDialog:ms,FavoriteRequestsDialog:gs},data:function(){return{name:"",mintId:"",mintName:"",deferredPWAInstallPrompt:null,showNearbyDialog:!1,showContactsDialog:!1,showRequestsDialog:!1,action:"main",parse:{show:!1,invoice:null,lnurlpay:null,lnurlauth:null,data:{request:"",amount:0,comment:""},camera:{show:!1,camera:"auto"}},payments:[],paymentsChart:{show:!1},welcomeDialog:{show:!1},baseHost:location.protocol+"//"+location.host,baseURL:location.protocol+"//"+location.host+location.pathname,credit:0,newName:""}},computed:{...Y(Ce,["tickerShort"]),favoritesStore(){return ps()},isNativeApp:function(){if(window?.Capacitor&&typeof window.Capacitor.getPlatform=="function"){const e=window.Capacitor.getPlatform();return e==="android"||e==="ios"}return!1},...ne(Ce,["showInvoiceDetails","tab","showSendDialog","showReceiveDialog"]),...ne(Ce,["expandHistory"]),...ne(ot,["showReceiveTokens","receiveData"]),...ne(Zt,["showSendTokens","sendData"]),...Y(ve,["activeMintUrl","activeProofs","keys","mints","activeMint"]),...ne($e,["invoiceHistory","invoiceData","payInvoiceData"]),...ne(ve,["addMintData","showAddMintDialog"]),...ne(Xt,["invoiceCheckListener","tokensCheckSpendableListener"]),...Y(mt,["historyTokens"]),...Y(ft,["enablePaymentRequest"]),...ne(Ve,["camera","hasCamera"]),...ne(dt,["showP2PKDialog"]),...ne(Ui,["showNWCDialog","nwcEnabled"]),pendingPaymentsExist:function(){return this.payments.findIndex(e=>e.pending)!==-1},balance:function(){return this.activeProofs.map(e=>e).flat().reduce((e,t)=>e+=t.amount,0)}},filters:{},methods:{...J(wo,["serializeProofs","getProofsMint","serializeProofsV2","sumProofs","deleteProofs"]),...J(ve,["activateMintUrl","addMint","assertMintError","getBalance","setActiveProofs","setProofs","getKeysForKeyset"]),...J(Xt,["clearAllWorkers","invoiceCheckWorker","lightningAddressCheckWorker"]),...J(mt,["setTokenPaid"]),...J($e,["setInvoicePaid","mint","checkPendingTokens","decodeRequest","initializeMnemonic"]),...J(Ve,["closeCamera","showCamera"]),...J(Ui,["listenToNWCCommands"]),...J(Bs,["generateNPCConnection","claimAllTokens"]),...J(vs,["generateNPCV2Connection","getLatestQuotes"]),...J(Fs,["sendNip04DirectMessage","sendNip17DirectMessage","subscribeToNip04DirectMessages","subscribeToNip17DirectMessages","sendNip17DirectMessageToNprofile","initSigner"]),...J(Os,["migrateToDexie"]),...J(_o,["checkLocalStorage"]),...J(ft,["createPaymentRequest"]),...J(zs,["startInvoiceCheckerWorker","checkPendingInvoices"]),decodeToken:function(e){try{return pe.decode(e)}catch{return null}},getProofs:function(e){return pe.getProofs(e)},getMint:function(e){return pe.getMint(e)},autoClaimPendingNostrTokens:async function(){console.log("\u{1F50D} Checking for pending Nostr tokens to auto-claim...");const e=mt(),t=ot();if(!e.history||!Array.isArray(e.history)){console.log("\u2139\uFE0F Tokens history not yet initialized, skipping auto-claim");return}const n=e.history.filter(i=>i.amount>0&&i.token&&i.token.length>0);console.log(`Found ${n.length} pending token(s) in history`);for(const i of n)try{console.log(`\u{1F48E} Auto-claiming pending token: ${i.amount} ${i.unit}`),t.receiveData.tokensBase64=i.token,await t.receiveIfDecodes()&&(console.log(`\u2705 Auto-claimed ${i.amount} ${i.unit}`),notifySuccess(`\u{1F4B0} Auto-claimed ${i.amount} ${i.unit} from Nostr!`))}catch(o){console.warn("\u26A0\uFE0F Failed to auto-claim token:",o)}n.length>0&&console.log("\u2705 Finished auto-claiming pending tokens")},shortenString:function(e){return bo(e,20,10)},getTokenList:function(){const e=this.activeProofs.map(n=>n.amount),t={};for(const n of e)t[n]=t[n]?t[n]+1:1;return Object.keys(t).map(n=>({value:parseInt(n),count:parseInt(t[n]),sum:n*t[n]}))},paymentTableRowKey:function(e){return e.payment_hash+e.amount},showChart:function(){this.paymentsChart.show=!0,this.$nextTick(()=>{generateChart(this.$refs.canvas,this.payments)})},focusInput(e){},showParseDialog:function(){this.payInvoiceData.show=!0,this.payInvoiceData.invoice=null,this.payInvoiceData.lnurlpay=null,this.payInvoiceData.domain="",this.payInvoiceData.lnurlauth=null,this.payInvoiceData.input.request="",this.payInvoiceData.input.comment="",this.camera.show=!1,this.focusInput("parseDialogInput")},showWelcomePage:function(){if(ei().termsAccepted||(ei().showWelcome=!0),ei().showWelcome){const e=window.location.search,t=window.location.hash;this.$router.push("/welcome"+e+t)}},setTab:function(e){this.tab=e},decodeQR:function(e){this.camera.data=e,this.camera.show=!1,this.decodeRequest(e)},showInvoiceCreateDialog:async function(){console.log("##### showInvoiceCreateDialog"),this.invoiceData.amount="",this.invoiceData.bolt11="",this.invoiceData.hash="",this.invoiceData.memo="",this.showInvoiceDetails=!0,this.camera.show=!1},showSendTokensDialog:function(){console.log("##### showSendTokensDialog"),this.sendData.tokens="",this.sendData.tokensBase64="",this.sendData.amount=null,this.sendData.memo="",this.showSendTokens=!0},hideSendTokensDialog:function(){this.showSendTokens=!1},showReceiveTokensDialog:function(){this.receiveData.tokensBase64="",this.showReceiveTokens=!0},registerPWAEventHook:function(){window.addEventListener("beforeinstallprompt",e=>{this.deferredPWAInstallPrompt=e,console.log("'beforeinstallprompt' event was fired.",this.getPwaDisplayMode())})},getPwaDisplayMode:function(){const e=window.matchMedia("(display-mode: standalone)").matches;return document.referrer.startsWith("android-app://")?"twa":navigator.standalone||e?"standalone":"browser"},triggerPwaInstall:function(){this.deferredPWAInstallPrompt.prompt(),this.deferredPWAInstallPrompt.userChoice.then(e=>{e.outcome==="accepted"?(console.log("User accepted the install prompt"),this.setWelcomeDialogSeen()):console.log("User dismissed the install prompt")})},registerBroadcastChannel:async function(){sessionStorage.getItem("tabId")||sessionStorage.setItem("tabId",Math.random().toString(36).substring(2)+new Date().getTime().toString(36));const e=sessionStorage.getItem("tabId"),t=new BroadcastChannel("app_channel");t.postMessage({type:"new_tab_opened",senderId:e}),t.onmessage=async n=>{n.data.senderId!==e&&(n.data.type=="new_tab_opened"?t.postMessage({type:"already_running",senderId:e}):n.data.type=="already_running"&&this.$router.push("/already-running"))}},initializeBluetooth:async function(){try{const e=po();await e.initialize(),this.isNativeApp?(await e.startService(),console.log("Bluetooth mesh service auto-started (native app)")):console.log('\u{1F4A1} Bluetooth ready. Go to Settings \u2192 Bluetooth Mesh and click "Connect Device" to enable.')}catch(e){console.error("Failed to initialize Bluetooth:",e)}},equalizeButtonWidths:function(){this.$nextTick(()=>{const e=document.querySelectorAll(".wallet-action-btn");if(e.length>=2){e.forEach(n=>{n.style.width="auto"});let t=0;e.forEach(n=>{t=Math.max(t,n.offsetWidth)}),e.forEach(n=>{n.style.width=`${t}px`})}})}},watch:{},mounted:function(){this.generateNPCConnection(),this.claimAllTokens(),this.generateNPCV2Connection(),this.getLatestQuotes(),this.lightningAddressCheckWorker(),this.initializeBluetooth(),this.$nextTick(this.equalizeButtonWidths),window.addEventListener("resize",this.equalizeButtonWidths)},beforeUnmount:function(){window.removeEventListener("resize",this.equalizeButtonWidths)},created:async function(){console.log("Git commit: v0.1.2-5-g04c7f8c-dirty");const e=Jm();e.initMigrations(),await e.runMigrations(),this.registerBroadcastChannel();let t=new URL(document.location).searchParams,n=new URL(document.location).hash;if(t.get("mint")){let s=t.get("mint");await this.setTab("mints"),this.showAddMintDialog=!0,this.addMintData={url:s}}try{if(!localStorage.getItem("cashu.activeMintUrl")||localStorage.getItem("cashu.activeMintUrl")==="")await this.activateMintUrl("https://ecash.trailscoffee.com",!1,!0);else{const s=ve();if(s.mints.find(r=>r.url==="https://ecash.trailscoffee.com"))console.log("Trails Coffee mint already exists, ensuring it's active..."),s.activeMintUrl!=="https://ecash.trailscoffee.com"&&await this.activateMintUrl("https://ecash.trailscoffee.com",!1,!0);else{console.log("Adding Trails Coffee mint...");const r=await s.addMint({url:"https://ecash.trailscoffee.com",nickname:"Trails Coffee"},!1);console.log("Added mint:",r),s.activeMintUrl!=="https://ecash.trailscoffee.com"&&(console.log("Activating Trails Coffee mint..."),await this.activateMintUrl("https://ecash.trailscoffee.com",!1,!0))}}}catch(s){console.error("Error initializing Trails Coffee mint:",s)}console.log("Mint URL "+this.activeMintUrl),console.log("Wallet URL "+this.baseURL);try{const s=ve(),a=s.mints.find(r=>r.url===this.activeMintUrl);if(a){if(console.log("Active mint keysets:",a.keysets),console.log("Active mint keys:",a.keys),!a.keysets||a.keysets.length===0){console.log("No keysets found, attempting to fetch...");try{await s.fetchMintKeys(a),console.log("Keysets fetched successfully:",a.keysets)}catch(r){console.error("Failed to fetch keysets:",r)}}}else console.log("No active mint found")}catch(s){console.error("Error in debug section:",s)}if(t.get("token")||n.includes("token")){let s=t.get("token")||n.split("token=")[1],a=!1;for(var i=0;i<this.historyTokens.length;i++){var o=this.historyTokens[i].token;o==s&&this.historyTokens[i].amount>0&&(a=!0)}a||(this.receiveData.tokensBase64=s,this.showReceiveTokens=!0)}t.get("lightning")&&(this.showParseDialog(),this.payInvoiceData.input.request=t.get("lightning")),console.log(`location.hash: ${window.location.hash}`),Ce().enableDebugConsole(),await this.migrateToDexie(),this.checkLocalStorage(),this.registerPWAEventHook(),this.initializeMnemonic(),this.initSigner(),this.showWelcomePage(),this.nwcEnabled&&this.listenToNWCCommands(),this.enablePaymentRequest&&this.subscribeToNip17DirectMessages(),console.log("\u{1F514} Subscribing to NIP-04 DMs for contacts..."),this.subscribeToNip04DirectMessages(),this.autoClaimPendingNostrTokens(),this.startInvoiceCheckerWorker(),this.checkPendingInvoices()}},tg={class:"wallet-container"},ng={class:"row q-col-gutter-y-sm justify-center q-pt-sm q-pb-sm"},ig={class:"col-12 col-sm-11 col-md-8 text-center q-gutter-y-sm"},og={class:"row items-center justify-center no-wrap q-mb-sm q-mx-none q-px-none q-pt-sm q-pb-sm position-relative"},sg={class:"col-6 q-mb-sm flex justify-center items-center"},ag={class:"button-content"},rg={class:"scan-button-container"},lg={class:"col-6 q-mb-sm flex justify-center items-center"},cg={class:"button-content"},ug={key:3,class:"row justify-center q-gutter-sm q-mt-sm q-mb-md"},dg=m("span",null,"Send to Nearby",-1),fg=m("span",null,"Contacts",-1),hg=m("span",null,"Requests",-1),mg={style:{"margin-bottom":"0rem","margin-top":"0rem"}},gg={class:"row q-pt-none"},pg={class:"col-12 q-pt-xs"},vg={class:"footer-section"},yg={class:"row justify-center"},_g={class:"col-12 col-sm-11 col-md-8 text-center"},wg={class:"credits-footer"},kg={class:"q-mb-xs text-caption text-grey-5"},bg=m("a",{href:"https://github.com/cashubtc/cashu.me",target:"_blank",class:"text-primary"}," cashu.me ",-1),Dg=m("p",{class:"q-mb-none text-caption text-grey-6"},[E(" Support digital cash development: "),m("a",{href:"https://cashu.space",target:"_blank",class:"text-primary"},"cashu.space"),E(" \u2022 "),m("a",{href:"https://opencash.dev/",target:"_blank",class:"text-primary"},"OpenCash.dev")],-1),Cg={class:"col text-center"},Pg={class:"text-h6"},$g=m("div",{class:"q-mr-sm"},null,-1),Tg={class:"q-pt-md text-center"};function qg(e,t,n,i,o,s){const a=H("ActivityOrb"),r=H("NoMintWarnBanner"),l=H("EcashClaimNotification"),g=H("BalanceView"),y=H("ScanIcon"),D=H("ReceiveDialog"),_=H("SendDialog"),q=H("NearbyContactsDialog"),I=H("NostrContactsDialog"),R=H("FavoriteRequestsDialog"),W=H("HistoryTable"),K=H("MintSettings"),A=H("iOSPWAPrompt"),F=H("AndroidPWAPrompt"),X=H("PayInvoiceDialog"),re=H("XIcon"),fe=H("QrcodeReader"),ye=H("ZapIcon"),d=H("WelcomeDialog"),h=H("InvoiceDetailDialog"),p=H("SendTokenDialog"),T=H("ReceiveTokenDialog");return b(),V(Je,null,[m("div",tg,[m("div",ng,[m("div",ig,[c(a),e.mints.length==0?(b(),B(r,{key:0})):N("",!0),s.isNativeApp?(b(),B(l,{key:1})):N("",!0),e.mints.length>0?(b(),B(g,{key:2,"set-tab":s.setTab},null,8,["set-tab"])):N("",!0),m("div",og,[m("div",sg,[c(x,{rounded:"",dense:"",class:"q-px-md q-mr-md wallet-action-btn",color:"primary",onClick:e.showCamera},{default:f(()=>[m("div",ag,[c(ie,{name:"south_west",size:"1.2rem",class:"q-mr-xs"}),m("span",null,S(e.$t("WalletPage.actions.receive.label")),1)])]),_:1},8,["onClick"])]),c(Ze,{appear:"","enter-active-class":"animated pulse"},{default:f(()=>[m("div",rg,[c(x,{size:"lg",outline:"",color:"primary",flat:"",onClick:e.showCamera},{default:f(()=>[c(y,{size:"2em"})]),_:1},8,["onClick"])])]),_:1}),m("div",lg,[c(x,{rounded:"",dense:"",class:"q-px-md q-ml-md wallet-action-btn",color:"primary",onClick:s.showSendTokensDialog},{default:f(()=>[m("div",cg,[c(ie,{name:"north_east",size:"1.2rem",class:"q-mr-xs"}),m("span",null,S(e.$t("WalletPage.actions.send.label")),1)])]),_:1},8,["onClick"])]),c(D,{modelValue:e.showReceiveDialog,"onUpdate:modelValue":t[0]||(t[0]=v=>e.showReceiveDialog=v)},null,8,["modelValue"]),c(_,{modelValue:e.showSendDialog,"onUpdate:modelValue":t[1]||(t[1]=v=>e.showSendDialog=v)},null,8,["modelValue"])]),s.isNativeApp?(b(),V("div",ug,[c(x,{rounded:"",outline:"",color:"secondary",class:"q-px-lg",onClick:t[2]||(t[2]=v=>e.showNearbyDialog=!0)},{default:f(()=>[c(ie,{name:"bluetooth",size:"1.2rem",class:"q-mr-sm"}),dg]),_:1}),c(x,{rounded:"",outline:"",color:"primary",class:"q-px-lg",onClick:t[3]||(t[3]=v=>e.showContactsDialog=!0)},{default:f(()=>[c(ie,{name:"contacts",size:"1.2rem",class:"q-mr-sm"}),fg,s.favoritesStore.pendingCount>0?(b(),B(Nt,{key:0,color:"red",floating:""},{default:f(()=>[E(S(s.favoritesStore.pendingCount),1)]),_:1})):N("",!0)]),_:1}),s.favoritesStore.pendingCount>0?(b(),B(x,{key:0,rounded:"",outline:"",color:"orange",class:"q-px-lg",onClick:t[4]||(t[4]=v=>e.showRequestsDialog=!0)},{default:f(()=>[c(ie,{name:"inbox",size:"1.2rem",class:"q-mr-sm"}),hg,c(Nt,{color:"red",floating:""},{default:f(()=>[E(S(s.favoritesStore.pendingCount),1)]),_:1})]),_:1})):N("",!0)])):N("",!0),c(Xe,{modelValue:e.showNearbyDialog,"onUpdate:modelValue":t[6]||(t[6]=v=>e.showNearbyDialog=v),position:"bottom"},{default:f(()=>[c(Oe,{style:{width:"100%","max-width":"600px"}},{default:f(()=>[c(q,{onClose:t[5]||(t[5]=v=>e.showNearbyDialog=!1)}),c(In,{align:"right"},{default:f(()=>[Ae((b(),B(x,{flat:"",round:"",icon:"close",color:"grey"},{default:f(()=>[c(Le,null,{default:f(()=>[E("Close")]),_:1})]),_:1})),[[Be]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),c(Xe,{modelValue:e.showContactsDialog,"onUpdate:modelValue":t[7]||(t[7]=v=>e.showContactsDialog=v),position:"bottom"},{default:f(()=>[c(Oe,{style:{width:"100%","max-width":"600px"}},{default:f(()=>[c(I),c(In,{align:"right"},{default:f(()=>[Ae((b(),B(x,{flat:"",round:"",icon:"close",color:"grey"},{default:f(()=>[c(Le,null,{default:f(()=>[E("Close")]),_:1})]),_:1})),[[Be]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),c(Xe,{modelValue:e.showRequestsDialog,"onUpdate:modelValue":t[8]||(t[8]=v=>e.showRequestsDialog=v),position:"bottom"},{default:f(()=>[c(Oe,{style:{width:"100%","max-width":"600px"}},{default:f(()=>[c(R),c(In,{align:"right"},{default:f(()=>[Ae((b(),B(x,{flat:"",round:"",icon:"close",color:"grey"},{default:f(()=>[c(Le,null,{default:f(()=>[E("Close")]),_:1})]),_:1})),[[Be]])]),_:1})]),_:1})]),_:1},8,["modelValue"]),c(vo,{"expand-icon-class":"hidden",modelValue:e.expandHistory,"onUpdate:modelValue":t[11]||(t[11]=v=>e.expandHistory=v)},{header:f(({expanded:v})=>[c(xt,{class:"item-center text-center"},{default:f(()=>[m("span",null,[c(ie,{color:"primary",name:v?"keyboard_arrow_up":"keyboard_arrow_down"},null,8,["name"])])]),_:2},1024)]),default:f(()=>[c(na,{modelValue:e.tab,"onUpdate:modelValue":t[9]||(t[9]=v=>e.tab=v),"no-caps":"",class:cn(e.$q.dark.isActive?"bg-dark":"bg-white")},{default:f(()=>[c(Fi,{name:"history",class:"text-secondary",label:e.$t("WalletPage.tabs.history.label")},null,8,["label"]),c(Fi,{name:"mints",class:"text-secondary",label:e.$t("WalletPage.tabs.mints.label")},null,8,["label"])]),_:1},8,["modelValue","class"]),c(ia,{class:cn(e.$q.dark.isActive?"bg-dark":"bg-white"),modelValue:e.tab,"onUpdate:modelValue":t[10]||(t[10]=v=>e.tab=v),animated:""},{default:f(()=>[c(Oi,{name:"history"},{default:f(()=>[c(W)]),_:1}),c(Oi,{name:"mints",class:"q-px-sm"},{default:f(()=>[c(K)]),_:1})]),_:1},8,["class","modelValue"])]),_:1},8,["modelValue"]),m("div",mg,[m("div",gg,[m("div",pg,[!s.isNativeApp&&s.getPwaDisplayMode()=="browser"&&e.deferredPWAInstallPrompt!=null?(b(),B(x,{key:0,class:"q-mx-xs q-px-sm q-my-sm",outline:"",size:"0.6rem",color:"primary",onClick:t[12]||(t[12]=v=>s.triggerPwaInstall())},{default:f(()=>[m("b",null,S(e.$t("WalletPage.install.text")),1),c(Le,null,{default:f(()=>[E(S(e.$t("WalletPage.install.tooltip")),1)]),_:1})]),_:1})):N("",!0)])])]),s.isNativeApp?N("",!0):(b(),B(A,{key:4})),s.isNativeApp?N("",!0):(b(),B(F,{key:5}))])]),m("div",vg,[m("div",yg,[m("div",_g,[m("div",wg,[m("p",kg,[E(" Built with "),c(ie,{name:"favorite",color:"red",size:"xs"}),E(" using the open-source "),bg,E(" wallet ")]),Dg])])])])]),c(X,{modelValue:e.payInvoiceData.show,"onUpdate:modelValue":t[13]||(t[13]=v=>e.payInvoiceData.show=v)},null,8,["modelValue"]),c(Xe,{modelValue:e.camera.show,"onUpdate:modelValue":t[14]||(t[14]=v=>e.camera.show=v),"backdrop-filter":"blur(2px) brightness(60%)"},{default:f(()=>[c(Oe,{class:"bg-grey-10 text-white full-width-card q-pb-lg"},{default:f(()=>[c(Ne,{class:"row items-center q-pb-sm"},{default:f(()=>[Ae((b(),B(x,{flat:"",round:"",dense:"",class:"q-ml-sm",color:"primary"},{default:f(()=>[c(re)]),_:1})),[[Be]]),m("div",Cg,[m("span",Pg,S(e.$t("ReceiveDialog.title")),1)]),$g]),_:1}),c(Ne,{class:"q-pa-md"},{default:f(()=>[c(fe,{onDecode:s.decodeQR},null,8,["onDecode"]),m("div",Tg,[c(x,{onClick:s.showInvoiceCreateDialog,flat:"",color:"primary",size:"sm"},{default:f(()=>[c(ye,{size:"1em",class:"q-mr-xs"}),E(" "+S(e.$t("ReceiveDialog.actions.lightning.label")),1)]),_:1},8,["onClick"])])]),_:1})]),_:1})]),_:1},8,["modelValue"]),c(d,{"welcome-dialog":e.welcomeDialog,"trigger-pwa-install":s.triggerPwaInstall,"set-tab":s.setTab,"get-pwa-display-mode":s.getPwaDisplayMode,"set-welcome-dialog-seen":e.setWelcomeDialogSeen},null,8,["welcome-dialog","trigger-pwa-install","set-tab","get-pwa-display-mode","set-welcome-dialog-seen"]),c(h,{modelValue:e.showInvoiceDetails,"onUpdate:modelValue":t[15]||(t[15]=v=>e.showInvoiceDetails=v)},null,8,["modelValue"]),c(p,{modelValue:e.showSendTokens,"onUpdate:modelValue":t[16]||(t[16]=v=>e.showSendTokens=v)},null,8,["modelValue"]),c(T,{modelValue:e.showReceiveTokens,"onUpdate:modelValue":t[17]||(t[17]=v=>e.showReceiveTokens=v)},null,8,["modelValue"])],64)}var ap=Te(eg,[["render",qg]]);export{ap as default};
